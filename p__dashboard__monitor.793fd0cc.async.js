(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"+K+b":function(Ie,x,o){var b=o("JHRd");function v(Z){var F=new Z.constructor(Z.byteLength);return new b(F).set(new b(Z)),F}Ie.exports=v},"+Qka":function(Ie,x,o){var b=o("fmRc"),v=o("t2Dn"),Z=o("cq/+"),F=o("T1AV"),a=o("GoyQ"),Y=o("mTTR"),B=o("itsj");function Q(re,we,J,Ke,Ge){re!==we&&Z(we,function(_e,Re){if(Ge||(Ge=new b),a(_e))F(re,we,Re,J,Q,Ke,Ge);else{var at=Ke?Ke(B(re,Re),_e,Re+"",re,we,Ge):void 0;at===void 0&&(at=_e),v(re,Re,at)}},Y)}Ie.exports=Q},"+VLl":function(Ie,x,o){"use strict";o.d(x,"a",function(){return _e});var b=o("lSNA"),v=o.n(b),Z=o("J4zp"),F=o.n(Z),a=o("Hel2"),Y=Math.PI/3,B=[0,Y,2*Y,3*Y,4*Y,5*Y];function Q(Re){return Re[0]}function re(Re){return Re[1]}var we=function(){var Re=0,at=0,Oe=1,xt=1,Mt=Q,Et=re,St,or,$t;function Ht(Xe){var Tt={},ze=[],st,Wt=Xe.length;for(st=0;st<Wt;++st)if(!(isNaN(dt=+Mt.call(null,bt=Xe[st],st,Xe))||isNaN(H=+Et.call(null,bt,st,Xe)))){var bt,dt,H,z=Math.round(H=H/$t),V=Math.round(dt=dt/or-(z&1)/2),Se=H-z;if(Math.abs(Se)*3>1){var ve=dt-V,ce=V+(dt<V?-1:1)/2,fe=z+(H<z?-1:1),ke=dt-ce,lt=H-fe;ve*ve+Se*Se>ke*ke+lt*lt&&(V=ce+(z&1?1:-1)/2,z=fe)}var nt=V+"-"+z,le=Tt[nt];le?le.push(bt):(ze.push(le=Tt[nt]=[bt]),le.x=(V+(z&1)/2)*or,le.y=z*$t)}return ze}function mt(Xe){var Tt=0,ze=0;return B.map(function(st){var Wt=Math.sin(st)*Xe,bt=-Math.cos(st)*Xe,dt=Wt-Tt,H=bt-ze;return Tt=Wt,ze=bt,[dt,H]})}return Ht.hexagon=function(Xe){return"m"+mt(Xe==null?St:+Xe).join("l")+"z"},Ht.centers=function(){for(var Xe=[],Tt=Math.round(at/$t),ze=Math.round(Re/or),st=Tt*$t;st<xt+St;st+=$t,++Tt)for(var Wt=ze*or+(Tt&1)*or/2;Wt<Oe+or/2;Wt+=or)Xe.push([Wt,st]);return Xe},Ht.mesh=function(){var Xe=mt(St).slice(0,4).join("l");return Ht.centers().map(function(Tt){return"M"+Tt+"m"+Xe}).join("")},Ht.x=function(Xe){return arguments.length?(Mt=Xe,Ht):Mt},Ht.y=function(Xe){return arguments.length?(Et=Xe,Ht):Et},Ht.radius=function(Xe){return arguments.length?(St=+Xe,or=St*2*Math.sin(Y),$t=St*1.5,Ht):St},Ht.size=function(Xe){return arguments.length?(Re=at=0,Oe=+Xe[0],xt=+Xe[1],Ht):[Oe-Re,xt-at]},Ht.extent=function(Xe){return arguments.length?(Re=+Xe[0][0],at=+Xe[0][1],Oe=+Xe[1][0],xt=+Xe[1][1],Ht):[[Re,at],[Oe,xt]]},Ht.radius(1)};function J(Re,at){var Oe=Object.keys(Re);if(Object.getOwnPropertySymbols){var xt=Object.getOwnPropertySymbols(Re);at&&(xt=xt.filter(function(Mt){return Object.getOwnPropertyDescriptor(Re,Mt).enumerable})),Oe.push.apply(Oe,xt)}return Oe}function Ke(Re){for(var at=1;at<arguments.length;at++){var Oe=arguments[at]!=null?arguments[at]:{};at%2?J(Object(Oe),!0).forEach(function(xt){v()(Re,xt,Oe[xt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Re,Object.getOwnPropertyDescriptors(Oe)):J(Object(Oe)).forEach(function(xt){Object.defineProperty(Re,xt,Object.getOwnPropertyDescriptor(Oe,xt))})}return Re}var Ge=6378e3;function _e(Re,at){var Oe=Re.dataArray,xt=at.size,Mt=xt===void 0?10:xt,Et=at.method,St=Et===void 0?"sum":Et,or=Mt/(2*Math.PI*Ge)*(256<<20)/2,$t=Oe.map(function(Tt){var ze=Object(a.d)(Tt.coordinates),st=F()(ze,2),Wt=st[0],bt=st[1];return Ke(Ke({},Tt),{},{coordinates:[Wt,bt]})}),Ht=we().radius(or).x(function(Tt){return Tt.coordinates[0]}).y(function(Tt){return Tt.coordinates[1]}),mt=Ht($t),Xe={dataArray:mt.map(function(Tt,ze){var st;if(at.field&&St){var Wt=a.c.getColumn(Tt,at.field);Tt[St]=a.c.statMap[St](Wt)}return st={},v()(st,at.method,Tt[St]),v()(st,"count",Tt.length),v()(st,"rawData",Tt),v()(st,"coordinates",[Tt.x,Tt.y]),v()(st,"_id",ze),st}),radius:or,xOffset:or,yOffset:or,type:"hexagon"};return Xe}},"+em5":function(Ie,x,o){"use strict";o.d(x,"a",function(){return H});var b=o("lSNA"),v=o.n(b),Z=o("yG8O"),F=o.n(Z),a=o("lwsE"),Y=o.n(a),B=o("W8MJ"),Q=o.n(B),re=o("U+yc"),we=o.n(re),J=o("1ABj"),Ke=o.n(J),Ge=o("gQMU"),_e=o.n(Ge),Re=o("J2iB"),at=o.n(Re),Oe=o("u6S6"),xt=o.n(Oe),Mt=o("4cb6"),Et=o.n(Mt),St=o("h1nZ"),or=o("bB6j"),$t=o("bPkA"),Ht,mt,Xe,Tt,ze,st;function Wt(z,V){var Se=Object.keys(z);if(Object.getOwnPropertySymbols){var ve=Object.getOwnPropertySymbols(z);V&&(ve=ve.filter(function(ce){return Object.getOwnPropertyDescriptor(z,ce).enumerable})),Se.push.apply(Se,ve)}return Se}function bt(z){for(var V=1;V<arguments.length;V++){var Se=arguments[V]!=null?arguments[V]:{};V%2?Wt(Object(Se),!0).forEach(function(ve){v()(z,ve,Se[ve])}):Object.getOwnPropertyDescriptors?Object.defineProperties(z,Object.getOwnPropertyDescriptors(Se)):Wt(Object(Se)).forEach(function(ve){Object.defineProperty(z,ve,Object.getOwnPropertyDescriptor(Se,ve))})}return z}var dt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,H=(Ht=Object(Mt.injectable)(),mt=Object(Mt.inject)(or.a.IShaderModuleService),Ht(Xe=(Tt=(st=function(){function z(){Y()(this,z),F()(this,"shaderModuleService",ze,this),this.rendererService=void 0,this.config=void 0,this.quad=dt,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return Q()(z,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Se){this.name=Se}},{key:"getType",value:function(){return $t.a.PostProcessing}},{key:"init",value:function(Se,ve){this.config=ve,this.rendererService=Se.getContainer().get(or.a.IRendererService);var ce=this.rendererService,fe=ce.createAttribute,ke=ce.createBuffer,lt=ce.createModel,nt=this.setupShaders(),le=nt.vs,ye=nt.fs,He=nt.uniforms;this.model=lt({vs:le,fs:ye,attributes:{a_Position:fe({buffer:ke({data:[-4,-4,4,-4,0,4],type:St.gl.FLOAT}),size:2})},uniforms:bt(bt({u_Texture:null},He),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(Se){var ve=this,ce=Se.multiPassRenderer.getPostProcessor(),fe=this.rendererService,ke=fe.useFramebuffer,lt=fe.getViewportSize,nt=fe.clear,le=lt(),ye=le.width,He=le.height;ke(this.renderToScreen?null:ce.getWriteFBO(),function(){nt({framebuffer:ce.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),ve.model.draw({uniforms:bt({u_Texture:ce.getReadFBO(),u_ViewportSize:[ye,He]},ve.convertOptionsToUniforms(ve.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Se){this.enabled=Se}},{key:"setRenderToScreen",value:function(Se){this.renderToScreen=Se}},{key:"updateOptions",value:function(Se){this.optionsToUpdate=bt(bt({},this.optionsToUpdate),Se)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Se){var ve={};return Object.keys(Se).forEach(function(ce){at()(Se[ce])||(ve["u_".concat(_e()(xt()(ce)))]=Se[ce])}),ve}}]),z}(),st),ze=we()(Tt.prototype,"shaderModuleService",[mt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tt))||Xe)},"+iFO":function(Ie,x,o){var b=o("dTAl"),v=o("LcsW"),Z=o("6sVZ");function F(a){return typeof a.constructor=="function"&&!Z(a)?b(v(a)):{}}Ie.exports=F},"/33/":function(Ie,x){},"/Uc5":function(Ie,x){},"/ezw":function(Ie,x,o){"use strict";var b=o("rePB"),v=o("wx14"),Z=o("U8pU"),F=o("q1tI"),a=o("TSYQ"),Y=o.n(a),B=function(H){var z=H.prefixCls,V=H.className,Se=H.width,ve=H.style;return F.createElement("h3",{className:Y()(z,V),style:Object(v.a)({width:Se},ve)})},Q=B,re=o("KQm4"),we=function(H){var z=function(lt){var nt=H.width,le=H.rows,ye=le===void 0?2:le;if(Array.isArray(nt))return nt[lt];if(ye-1===lt)return nt},V=H.prefixCls,Se=H.className,ve=H.style,ce=H.rows,fe=Object(re.a)(Array(ce)).map(function(ke,lt){return F.createElement("li",{key:lt,style:{width:z(lt)}})});return F.createElement("ul",{className:Y()(V,Se),style:ve},fe)},J=we,Ke=o("H84U"),Ge=function(H){var z,V,Se=H.prefixCls,ve=H.className,ce=H.style,fe=H.size,ke=H.shape,lt=Y()((z={},Object(b.a)(z,"".concat(Se,"-lg"),fe==="large"),Object(b.a)(z,"".concat(Se,"-sm"),fe==="small"),z)),nt=Y()((V={},Object(b.a)(V,"".concat(Se,"-circle"),ke==="circle"),Object(b.a)(V,"".concat(Se,"-square"),ke==="square"),Object(b.a)(V,"".concat(Se,"-round"),ke==="round"),V)),le=typeof fe=="number"?{width:fe,height:fe,lineHeight:"".concat(fe,"px")}:{};return F.createElement("span",{className:Y()(Se,lt,nt,ve),style:Object(v.a)(Object(v.a)({},le),ce)})},_e=Ge,Re=o("bT9E"),at=function(H){var z=function(Se){var ve=Se.getPrefixCls,ce=H.prefixCls,fe=H.className,ke=H.active,lt=ve("skeleton",ce),nt=Object(Re.a)(H,["prefixCls"]),le=Y()(lt,"".concat(lt,"-element"),Object(b.a)({},"".concat(lt,"-active"),ke),fe);return F.createElement("div",{className:le},F.createElement(_e,Object(v.a)({prefixCls:"".concat(lt,"-avatar")},nt)))};return F.createElement(Ke.a,null,z)};at.defaultProps={size:"default",shape:"circle"};var Oe=at,xt=function(H){var z=function(Se){var ve=Se.getPrefixCls,ce=H.prefixCls,fe=H.className,ke=H.active,lt=ve("skeleton",ce),nt=Object(Re.a)(H,["prefixCls"]),le=Y()(lt,"".concat(lt,"-element"),Object(b.a)({},"".concat(lt,"-active"),ke),fe);return F.createElement("div",{className:le},F.createElement(_e,Object(v.a)({prefixCls:"".concat(lt,"-button")},nt)))};return F.createElement(Ke.a,null,z)};xt.defaultProps={size:"default"};var Mt=xt,Et=function(H){var z=function(Se){var ve=Se.getPrefixCls,ce=H.prefixCls,fe=H.className,ke=H.active,lt=ve("skeleton",ce),nt=Object(Re.a)(H,["prefixCls"]),le=Y()(lt,"".concat(lt,"-element"),Object(b.a)({},"".concat(lt,"-active"),ke),fe);return F.createElement("div",{className:le},F.createElement(_e,Object(v.a)({prefixCls:"".concat(lt,"-input")},nt)))};return F.createElement(Ke.a,null,z)};Et.defaultProps={size:"default"};var St=Et,or="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",$t=function(H){var z=function(Se){var ve=Se.getPrefixCls,ce=H.prefixCls,fe=H.className,ke=H.style,lt=ve("skeleton",ce),nt=Y()(lt,"".concat(lt,"-element"),fe);return F.createElement("div",{className:nt},F.createElement("div",{className:Y()("".concat(lt,"-image"),fe),style:ke},F.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(lt,"-image-svg")},F.createElement("path",{d:or,className:"".concat(lt,"-image-path")}))))};return F.createElement(Ke.a,null,z)},Ht=$t;function mt(dt){return dt&&Object(Z.a)(dt)==="object"?dt:{}}function Xe(dt,H){return dt&&!H?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Tt(dt,H){return!dt&&H?{width:"38%"}:dt&&H?{width:"50%"}:{}}function ze(dt,H){var z={};return(!dt||!H)&&(z.width="61%"),!dt&&H?z.rows=3:z.rows=2,z}var st=function(H){var z=function(Se){var ve=Se.getPrefixCls,ce=Se.direction,fe=H.prefixCls,ke=H.loading,lt=H.className,nt=H.children,le=H.avatar,ye=H.title,He=H.paragraph,ft=H.active,De=H.round,Ze=ve("skeleton",fe);if(ke||!("loading"in H)){var w,R=!!le,q=!!ye,he=!!He,Ve;if(R){var Ye=Object(v.a)(Object(v.a)({prefixCls:"".concat(Ze,"-avatar")},Xe(q,he)),mt(le));Ve=F.createElement("div",{className:"".concat(Ze,"-header")},F.createElement(_e,Ye))}var yt;if(q||he){var it;if(q){var Nt=Object(v.a)(Object(v.a)({prefixCls:"".concat(Ze,"-title")},Tt(R,he)),mt(ye));it=F.createElement(Q,Nt)}var $;if(he){var $e=Object(v.a)(Object(v.a)({prefixCls:"".concat(Ze,"-paragraph")},ze(R,q)),mt(He));$=F.createElement(J,$e)}yt=F.createElement("div",{className:"".concat(Ze,"-content")},it,$)}var ie=Y()(Ze,(w={},Object(b.a)(w,"".concat(Ze,"-with-avatar"),R),Object(b.a)(w,"".concat(Ze,"-active"),ft),Object(b.a)(w,"".concat(Ze,"-rtl"),ce==="rtl"),Object(b.a)(w,"".concat(Ze,"-round"),De),w),lt);return F.createElement("div",{className:ie},Ve,yt)}return nt};return F.createElement(Ke.a,null,z)};st.defaultProps={avatar:!1,title:!0,paragraph:!0},st.Button=Mt,st.Avatar=Oe,st.Input=St,st.Image=Ht;var Wt=st,bt=x.a=Wt},"0JQy":function(Ie,x){var o="\\ud800-\\udfff",b="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",F=b+v+Z,a="\\ufe0e\\ufe0f",Y="["+o+"]",B="["+F+"]",Q="\\ud83c[\\udffb-\\udfff]",re="(?:"+B+"|"+Q+")",we="[^"+o+"]",J="(?:\\ud83c[\\udde6-\\uddff]){2}",Ke="[\\ud800-\\udbff][\\udc00-\\udfff]",Ge="\\u200d",_e=re+"?",Re="["+a+"]?",at="(?:"+Ge+"(?:"+[we,J,Ke].join("|")+")"+Re+_e+")*",Oe=Re+_e+at,xt="(?:"+[we+B+"?",B,J,Ke,Y].join("|")+")",Mt=RegExp(Q+"(?="+Q+")|"+xt+Oe,"g");function Et(St){return St.match(Mt)||[]}Ie.exports=Et},"0ZTe":function(Ie,x,o){var b=o("wy8a"),v=o("quyA"),Z=o("Em2t"),F=o("dt0z");function a(Y){return function(B){B=F(B);var Q=v(B)?Z(B):void 0,re=Q?Q[0]:B.charAt(0),we=Q?b(Q,1).join(""):B.slice(1);return re[Y]()+we}}Ie.exports=a},"0eqD":function(Ie,x){},"0gSV":function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.tagged=void 0;var b=o("GXnB"),v=o("Ztfv");function Z(F,a){return function(Y,B,Q){var re=new b.Metadata(F,a);typeof Q=="number"?v.tagParameter(Y,B,Q,re):v.tagProperty(Y,B,re)}}x.tagged=Z},"0wsv":function(Ie,x,o){"use strict";o.d(x,"b",function(){return a}),o.d(x,"f",function(){return B}),o.d(x,"e",function(){return J}),o.d(x,"g",function(){return Mt}),o.d(x,"a",function(){return Ht}),o.d(x,"c",function(){return Tt}),o.d(x,"d",function(){return ze});var b=63710088e-1,v={centimeters:b*100,centimetres:b*100,degrees:b/111325,feet:b*3.28084,inches:b*39.37,kilometers:b/1e3,kilometres:b/1e3,meters:b,metres:b,miles:b/1609.344,millimeters:b*1e3,millimetres:b*1e3,nauticalmiles:b/1852,radians:1,yards:b/1.0936},Z={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/b,yards:1/1.0936},F={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function a(bt,dt,H){H===void 0&&(H={});var z={type:"Feature"};return(H.id===0||H.id)&&(z.id=H.id),H.bbox&&(z.bbox=H.bbox),z.properties=dt||{},z.geometry=bt,z}function Y(bt,dt,H){switch(H===void 0&&(H={}),bt){case"Point":return B(dt).geometry;case"LineString":return J(dt).geometry;case"Polygon":return re(dt).geometry;case"MultiPoint":return Re(dt).geometry;case"MultiLineString":return _e(dt).geometry;case"MultiPolygon":return at(dt).geometry;default:throw new Error(bt+" is invalid")}}function B(bt,dt,H){if(H===void 0&&(H={}),!bt)throw new Error("coordinates is required");if(!Array.isArray(bt))throw new Error("coordinates must be an Array");if(bt.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Tt(bt[0])||!Tt(bt[1]))throw new Error("coordinates must contain numbers");var z={type:"Point",coordinates:bt};return a(z,dt,H)}function Q(bt,dt,H){return H===void 0&&(H={}),Ge(bt.map(function(z){return B(z,dt)}),H)}function re(bt,dt,H){H===void 0&&(H={});for(var z=0,V=bt;z<V.length;z++){var Se=V[z];if(Se.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var ve=0;ve<Se[Se.length-1].length;ve++)if(Se[Se.length-1][ve]!==Se[0][ve])throw new Error("First and last Position are not equivalent.")}var ce={type:"Polygon",coordinates:bt};return a(ce,dt,H)}function we(bt,dt,H){return H===void 0&&(H={}),Ge(bt.map(function(z){return re(z,dt)}),H)}function J(bt,dt,H){if(H===void 0&&(H={}),bt.length<2)throw new Error("coordinates must be an array of two or more positions");var z={type:"LineString",coordinates:bt};return a(z,dt,H)}function Ke(bt,dt,H){return H===void 0&&(H={}),Ge(bt.map(function(z){return J(z,dt)}),H)}function Ge(bt,dt){dt===void 0&&(dt={});var H={type:"FeatureCollection"};return dt.id&&(H.id=dt.id),dt.bbox&&(H.bbox=dt.bbox),H.features=bt,H}function _e(bt,dt,H){H===void 0&&(H={});var z={type:"MultiLineString",coordinates:bt};return a(z,dt,H)}function Re(bt,dt,H){H===void 0&&(H={});var z={type:"MultiPoint",coordinates:bt};return a(z,dt,H)}function at(bt,dt,H){H===void 0&&(H={});var z={type:"MultiPolygon",coordinates:bt};return a(z,dt,H)}function Oe(bt,dt,H){H===void 0&&(H={});var z={type:"GeometryCollection",geometries:bt};return a(z,dt,H)}function xt(bt,dt){if(dt===void 0&&(dt=0),dt&&!(dt>=0))throw new Error("precision must be a positive number");var H=Math.pow(10,dt||0);return Math.round(bt*H)/H}function Mt(bt,dt){dt===void 0&&(dt="kilometers");var H=v[dt];if(!H)throw new Error(dt+" units is invalid");return bt*H}function Et(bt,dt){dt===void 0&&(dt="kilometers");var H=v[dt];if(!H)throw new Error(dt+" units is invalid");return bt/H}function St(bt,dt){return $t(Et(bt,dt))}function or(bt){var dt=bt%360;return dt<0&&(dt+=360),dt}function $t(bt){var dt=bt%(2*Math.PI);return dt*180/Math.PI}function Ht(bt){var dt=bt%360;return dt*Math.PI/180}function mt(bt,dt,H){if(dt===void 0&&(dt="kilometers"),H===void 0&&(H="kilometers"),!(bt>=0))throw new Error("length must be a positive number");return Mt(Et(bt,dt),H)}function Xe(bt,dt,H){if(dt===void 0&&(dt="meters"),H===void 0&&(H="kilometers"),!(bt>=0))throw new Error("area must be a positive number");var z=F[dt];if(!z)throw new Error("invalid original units");var V=F[H];if(!V)throw new Error("invalid final units");return bt/z*V}function Tt(bt){return!isNaN(bt)&&bt!==null&&!Array.isArray(bt)}function ze(bt){return!!bt&&bt.constructor===Object}function st(bt){if(!bt)throw new Error("bbox is required");if(!Array.isArray(bt))throw new Error("bbox must be an Array");if(bt.length!==4&&bt.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");bt.forEach(function(dt){if(!Tt(dt))throw new Error("bbox must only contain numbers")})}function Wt(bt){if(!bt)throw new Error("id is required");if(["string","number"].indexOf(typeof bt)===-1)throw new Error("id must be a number or a string")}},"1+5i":function(Ie,x,o){var b=o("w/wX"),v=o("sEf8"),Z=o("mdPL"),F=Z&&Z.isSet,a=F?v(F):b;Ie.exports=a},"14J3":function(Ie,x,o){"use strict";var b=o("cIOH"),v=o.n(b),Z=o("1GLa")},"1ABj":function(Ie,x){function o(b,v){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}Ie.exports=o},"1XEM":function(Ie,x,o){Ie.exports={tagCloud:"antd-pro-pages-dashboard-monitor-components-charts-tag-cloud-index-tagCloud"}},"1gqn":function(Ie,x){Ie.exports=function(b){return b&&typeof b=="object"&&typeof b.copy=="function"&&typeof b.fill=="function"&&typeof b.readUInt8=="function"}},"1jvM":function(Ie,x){},2:function(Ie,x){},"2ajD":function(Ie,x){function o(b){return b!==b}Ie.exports=o},"3DfO":function(Ie,x){function o(b){return b==null}Ie.exports=o},"3L66":function(Ie,x,o){var b=o("MMmD"),v=o("ExA7");function Z(F){return v(F)&&b(F)}Ie.exports=Z},"3cYt":function(Ie,x){function o(b){return function(v){return b==null?void 0:b[v]}}Ie.exports=o},"406g":function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingOnSyntax=void 0;var b=o("z4Hk"),v=function(){function Z(F){this._binding=F}return Z.prototype.onActivation=function(F){return this._binding.onActivation=F,new b.BindingWhenSyntax(this._binding)},Z}();x.BindingOnSyntax=v},"4U9+":function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.default=function(Re){return(0,v.default)((0,Q.default)(Re)&&Re.length>=1,"Must merge at least 1 JSON schema."),F.default.apply(void 0,[{}].concat(_e(Re),[function(at,Oe,xt){if(!(0,Y.default)(at)){if(xt==="required")return(0,we.default)(at.concat(Oe));if((0,Ke.default)(at)){if(!(0,Ke.default)(Oe))throw new Error('Failed to merge schemas because "'+xt+'" has different values.');return}v.default.deepEqual(at,Oe,'Failed to merge schemas because "'+xt+'" has different values: '+JSON.stringify(at)+" and "+JSON.stringify(Oe)+".")}}]))};var b=o("9lTW"),v=Ge(b),Z=o("qd8s"),F=Ge(Z),a=o("3DfO"),Y=Ge(a),B=o("WFAs"),Q=Ge(B),re=o("w26f"),we=Ge(re),J=o("zZPE"),Ke=Ge(J);function Ge(Re){return Re&&Re.__esModule?Re:{default:Re}}function _e(Re){if(Array.isArray(Re)){for(var at=0,Oe=Array(Re.length);at<Re.length;at++)Oe[at]=Re[at];return Oe}else return Array.from(Re)}Ie.exports=x.default},"4ZJM":function(Ie,x,o){(function(b,v){Ie.exports=v()})(this,function(){"use strict";var b,v,Z;function F(a,Y){if(!b)b=Y;else if(!v)v=Y;else{var B="var sharedChunk = {}; ("+b+")(sharedChunk); ("+v+")(sharedChunk);",Q={};b(Q),Z=Y(Q),typeof window!="undefined"&&(Z.workerUrl=window.URL.createObjectURL(new Blob([B],{type:"text/javascript"})))}}return F(["exports"],function(a){"use strict";function Y(e,t){return e(t={exports:{}},t.exports),t.exports}var B=Q;function Q(e,t,r,l){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=r,this.p2y=l}Q.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},Q.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},Q.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},Q.prototype.solveCurveX=function(e,t){var r,l,f,m,A;for(t===void 0&&(t=1e-6),f=e,A=0;A<8;A++){if(m=this.sampleCurveX(f)-e,Math.abs(m)<t)return f;var I=this.sampleCurveDerivativeX(f);if(Math.abs(I)<1e-6)break;f-=m/I}if((f=e)<(r=0))return r;if(f>(l=1))return l;for(;r<l;){if(m=this.sampleCurveX(f),Math.abs(m-e)<t)return f;e>m?r=f:l=f,f=.5*(l-r)+r}return f},Q.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var re=we;function we(e,t){this.x=e,this.y=t}we.prototype={clone:function(){return new we(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,l=t.y-this.y;return r*r+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),l=Math.sin(t),f=l*this.x+r*this.y;return this.x=r*this.x-l*this.y,this.y=f,this},_rotateAround:function(t,r){var l=Math.cos(t),f=Math.sin(t),m=r.y+f*(this.x-r.x)+l*(this.y-r.y);return this.x=r.x+l*(this.x-r.x)-f*(this.y-r.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},we.convert=function(e){return e instanceof we?e:Array.isArray(e)?new we(e[0],e[1]):e};var J=typeof self!="undefined"?self:{},Ke=Math.pow(2,53)-1;function Ge(e,t,r,l){var f=new B(e,t,r,l);return function(m){return f.solve(m)}}var _e=Ge(.25,.1,.25,1);function Re(e,t,r){return Math.min(r,Math.max(t,e))}function at(e,t,r){var l=r-t,f=((e-t)%l+l)%l+t;return f===t?r:f}function Oe(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var A in m)e[A]=m[A]}return e}var xt=1;function Mt(){return xt++}function Et(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function St(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function or(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function $t(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ht(e,t,r){var l={};for(var f in e)l[f]=t.call(r||this,e[f],f,e);return l}function mt(e,t,r){var l={};for(var f in e)t.call(r||this,e[f],f,e)&&(l[f]=e[f]);return l}function Xe(e){return Array.isArray(e)?e.map(Xe):typeof e=="object"&&e?Ht(e,Xe):e}var Tt={};function ze(e){Tt[e]||(typeof console!="undefined"&&console.warn(e),Tt[e]=!0)}function st(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Wt(e){for(var t=0,r=0,l=e.length,f=l-1,m=void 0,A=void 0;r<l;f=r++)t+=((A=e[f]).x-(m=e[r]).x)*(m.y+A.y);return t}function bt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function dt(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,f,m,A){var I=m||A;return t[f]=!I||I.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var H=null;function z(e){if(H==null){var t=e.navigator?e.navigator.userAgent:null;H=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return H}function V(e){try{var t=J[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var Se,ve,ce,fe,ke=J.performance&&J.performance.now?J.performance.now.bind(J.performance):Date.now.bind(Date),lt=J.requestAnimationFrame||J.mozRequestAnimationFrame||J.webkitRequestAnimationFrame||J.msRequestAnimationFrame,nt=J.cancelAnimationFrame||J.mozCancelAnimationFrame||J.webkitCancelAnimationFrame||J.msCancelAnimationFrame,le={now:ke,frame:function(t){var r=lt(t);return{cancel:function(){return nt(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var l=J.document.createElement("canvas"),f=l.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return l.width=t.width,l.height=t.height,f.drawImage(t,0,0,t.width,t.height),f.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return Se||(Se=J.document.createElement("a")),Se.href=t,Se.href},hardwareConcurrency:J.navigator&&J.navigator.hardwareConcurrency||4,get devicePixelRatio(){return J.devicePixelRatio},get prefersReducedMotion(){return!!J.matchMedia&&(ve==null&&(ve=J.matchMedia("(prefers-reduced-motion: reduce)")),ve.matches)}},ye={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},He={supported:!1,testSupport:function(t){!ft&&fe&&(De?Ze(t):ce=t)}},ft=!1,De=!1;function Ze(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,fe),e.isContextLost())return;He.supported=!0}catch(r){}e.deleteTexture(t),ft=!0}J.document&&((fe=J.document.createElement("img")).onload=function(){ce&&Ze(ce),ce=null,De=!0},fe.onerror=function(){ft=!0,ce=null},fe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var w="01",R=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function q(e){return e.indexOf("mapbox:")===0}R.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",w,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},R.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},R.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},R.prototype.normalizeStyleURL=function(e,t){if(!q(e))return e;var r=yt(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeGlyphsURL=function(e,t){if(!q(e))return e;var r=yt(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSourceURL=function(e,t){if(!q(e))return e;var r=yt(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSpriteURL=function(e,t,r,l){var f=yt(e);return q(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+r,this._makeAPIURL(f,this._customAccessToken||l)):(f.path+=""+t+r,it(f))},R.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!q(e))return e;var r=yt(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(le.devicePixelRatio>=2||t===512?"@2x":"")+(He.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var l=this._customAccessToken||function(f){for(var m=0,A=f;m<A.length;m+=1){var I=A[m].match(/^access_token=(.*)$/);if(I)return I[1]}return null}(r.params)||ye.ACCESS_TOKEN;return ye.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,l)},R.prototype.canonicalizeTileURL=function(e,t){var r=yt(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=r.path.replace("/v4/","");var f=r.params;return t&&(f=f.filter(function(m){return!m.match(/^access_token=/)})),f.length&&(l+="?"+f.join("&")),l},R.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&q(t),l=[],f=0,m=e.tiles||[];f<m.length;f+=1){var A=m[f];Ve(A)?l.push(this.canonicalizeTileURL(A,r)):l.push(A)}return l},R.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=yt(ye.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!ye.REQUIRE_ACCESS_TOKEN)return it(e);if(!(t=t||ye.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),it(e)};var he=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ve(e){return he.test(e)}var Ye=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function yt(e){var t=e.match(Ye);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function it(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Nt(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(J.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var $=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};$.prototype.getStorageKey=function(e){var t,r=Nt(ye.ACCESS_TOKEN);return t=r&&r.u?J.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(l,f){return String.fromCharCode(Number("0x"+f))})):ye.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},$.prototype.fetchEventData=function(){var e=V("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var l=J.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var f=J.localStorage.getItem(r);f&&(this.anonId=f)}catch(m){ze("Unable to read from LocalStorage")}},$.prototype.saveEventData=function(){var e=V("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{J.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&J.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(l){ze("Unable to write to LocalStorage")}},$.prototype.processRequests=function(e){},$.prototype.postEvent=function(e,t,r,l){var f=this;if(ye.EVENTS_URL){var m=yt(ye.EVENTS_URL);m.params.push("access_token="+(l||ye.ACCESS_TOKEN||""));var A={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.0",skuId:w,userId:this.anonId},I=t?Oe(A,t):A,G={url:it(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([I])};this.pendingRequest=Vn(G,function(te){f.pendingRequest=null,r(te),f.saveEventData(),f.processRequests(l)})}},$.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var $e,ie,qe=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,l,f,m){this.skuToken=f,(ye.EVENTS_URL&&m||ye.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(A){return q(A)||Ve(A)}))&&this.queueRequest({id:l,timestamp:Date.now()},m)},t.prototype.processRequests=function(r){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),m=f.id,A=f.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),St(this.anonId)||(this.anonId=Et()),this.postEvent(A,{skuToken:this.skuToken},function(I){I||m&&(l.success[m]=!0)},r))}},t}($),jt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,l){ye.EVENTS_URL&&ye.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(f){return q(f)||Ve(f)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(r){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=Nt(ye.ACCESS_TOKEN),m=f?f.u:ye.ACCESS_TOKEN,A=m!==this.eventData.tokenU;St(this.anonId)||(this.anonId=Et(),A=!0);var I=this.queue.shift();if(this.eventData.lastSuccess){var G=new Date(this.eventData.lastSuccess),te=new Date(I),pe=(I-this.eventData.lastSuccess)/864e5;A=A||pe>=1||pe<-1||G.getDate()!==te.getDate()}else A=!0;if(!A)return this.processRequests();this.postEvent(I,{"enabled.telemetry":!1},function(Ce){Ce||(l.eventData.lastSuccess=I,l.eventData.tokenU=m)},r)}},t}($)),lr=jt.postTurnstileEvent.bind(jt),ct=new qe,ht=ct.postMapLoadEvent.bind(ct),Pt=500,vt=50;function Pe(){J.caches&&!$e&&($e=J.caches.open("mapbox-tiles"))}function ut(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Qe,Vt=1/0;function pr(){return Qe==null&&(Qe=J.OffscreenCanvas&&new J.OffscreenCanvas(1,1).getContext("2d")&&typeof J.createImageBitmap=="function"),Qe}var Zr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Zr);var cr=function(e){function t(r,l,f){l===401&&Ve(f)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=l,this.url=f,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),jn=bt()?function(){return self.worker&&self.worker.referrer}:function(){return(J.location.protocol==="blob:"?J.parent:J).location.href},En,ni,fi=function(t,r){if(!(/^file:/.test(l=t.url)||/^file:/.test(jn())&&!/^\w+:/.test(l))){if(J.fetch&&J.Request&&J.AbortController&&J.Request.prototype.hasOwnProperty("signal"))return function(f,m){var A,I=new J.AbortController,G=new J.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:jn(),signal:I.signal}),te=!1,pe=!1,Ce=(A=G.url).indexOf("sku=")>0&&Ve(A);f.type==="json"&&G.headers.set("Accept","application/json");var Me=function(Ct,Xt,Zt){if(!pe){if(Ct&&Ct.message!=="SecurityError"&&ze(Ct),Xt&&Zt)return ot(Xt);var ar=Date.now();J.fetch(G).then(function(dr){if(dr.ok){var br=Ce?dr.clone():null;return ot(dr,br,ar)}return m(new cr(dr.statusText,dr.status,f.url))}).catch(function(dr){dr.code!==20&&m(new Error(dr.message))})}},ot=function(Ct,Xt,Zt){(f.type==="arrayBuffer"?Ct.arrayBuffer():f.type==="json"?Ct.json():Ct.text()).then(function(ar){pe||(Xt&&Zt&&function(dr,br,Nr){if(Pe(),$e){var Rr={status:br.status,statusText:br.statusText,headers:new J.Headers};br.headers.forEach(function(hn,Ln){return Rr.headers.set(Ln,hn)});var pn=dt(br.headers.get("Cache-Control")||"");pn["no-store"]||(pn["max-age"]&&Rr.headers.set("Expires",new Date(Nr+1e3*pn["max-age"]).toUTCString()),new Date(Rr.headers.get("Expires")).getTime()-Nr<42e4||function(hn,Ln){if(ie===void 0)try{new Response(new ReadableStream),ie=!0}catch(Jn){ie=!1}ie?Ln(hn.body):hn.blob().then(Ln)}(br,function(hn){var Ln=new J.Response(hn,Rr);Pe(),$e&&$e.then(function(Jn){return Jn.put(ut(dr.url),Ln)}).catch(function(Jn){return ze(Jn.message)})}))}}(G,Xt,Zt),te=!0,m(null,ar,Ct.headers.get("Cache-Control"),Ct.headers.get("Expires")))}).catch(function(ar){pe||m(new Error(ar.message))})};return Ce?function(_t,Ct){if(Pe(),!$e)return Ct(null);var Xt=ut(_t.url);$e.then(function(Zt){Zt.match(Xt).then(function(ar){var dr=function(br){if(!br)return!1;var Nr=new Date(br.headers.get("Expires")||0),Rr=dt(br.headers.get("Cache-Control")||"");return Nr>Date.now()&&!Rr["no-cache"]}(ar);Zt.delete(Xt),dr&&Zt.put(Xt,ar.clone()),Ct(null,ar,dr)}).catch(Ct)}).catch(Ct)}(G,Me):Me(null,null),{cancel:function(){pe=!0,te||I.abort()}}}(t,r);if(bt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var l;return function(f,m){var A=new J.XMLHttpRequest;for(var I in A.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(A.responseType="arraybuffer"),f.headers)A.setRequestHeader(I,f.headers[I]);return f.type==="json"&&(A.responseType="text",A.setRequestHeader("Accept","application/json")),A.withCredentials=f.credentials==="include",A.onerror=function(){m(new Error(A.statusText))},A.onload=function(){if((A.status>=200&&A.status<300||A.status===0)&&A.response!==null){var G=A.response;if(f.type==="json")try{G=JSON.parse(A.response)}catch(te){return m(te)}m(null,G,A.getResponseHeader("Cache-Control"),A.getResponseHeader("Expires"))}else m(new cr(A.statusText,A.status,f.url))},A.send(f.body),{cancel:function(){return A.abort()}}}(t,r)},Zn=function(t,r){return fi(Oe(t,{type:"arrayBuffer"}),r)},Vn=function(t,r){return fi(Oe(t,{method:"POST"}),r)},Te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";En=[],ni=0;var de=function e(t,r){if(He.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ni>=ye.MAX_PARALLEL_IMAGE_REQUESTS){var l={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return En.push(l),l}ni++;var f=!1,m=function(){if(!f)for(f=!0,ni--;En.length&&ni<ye.MAX_PARALLEL_IMAGE_REQUESTS;){var G=En.shift();G.cancelled||(G.cancel=e(G.requestParameters,G.callback).cancel)}},A=Zn(t,function(I,G,te,pe){m(),I?r(I):G&&(pr()?function(Ce,Me){var ot=new J.Blob([new Uint8Array(Ce)],{type:"image/png"});J.createImageBitmap(ot).then(function(_t){Me(null,_t)}).catch(function(_t){Me(new Error("Could not load image because of "+_t.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(G,r):function(Ce,Me,ot,_t){var Ct=new J.Image,Xt=J.URL;Ct.onload=function(){Me(null,Ct),Xt.revokeObjectURL(Ct.src),Ct.onload=null,Ct.src=Te},Ct.onerror=function(){return Me(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Zt=new J.Blob([new Uint8Array(Ce)],{type:"image/png"});Ct.cacheControl=ot,Ct.expires=_t,Ct.src=Ce.byteLength?Xt.createObjectURL(Zt):Te}(G,r,te,pe))});return{cancel:function(){A.cancel(),m()}}};function W(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function se(e,t,r){if(r&&r[e]){var l=r[e].indexOf(t);l!==-1&&r[e].splice(l,1)}}var Le=function(t,r){r===void 0&&(r={}),Oe(this,r),this.type=t},et=function(e){function t(r,l){l===void 0&&(l={}),e.call(this,"error",Oe({error:r},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Le),wt=function(){};wt.prototype.on=function(e,t){return this._listeners=this._listeners||{},W(e,t,this._listeners),this},wt.prototype.off=function(e,t){return se(e,t,this._listeners),se(e,t,this._oneTimeListeners),this},wt.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},W(e,t,this._oneTimeListeners),this},wt.prototype.fire=function(e,t){typeof e=="string"&&(e=new Le(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var l=0,f=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];l<f.length;l+=1)f[l].call(this,e);for(var m=0,A=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];m<A.length;m+=1){var I=A[m];se(r,I,this._oneTimeListeners),I.call(this,e)}var G=this._eventedParent;G&&(Oe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),G.fire(e))}else e instanceof et&&console.error(e.error);return this},wt.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},wt.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Ne={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},gt=function(t,r,l,f){this.message=(t?t+": ":"")+l,f&&(this.identifier=f),r!=null&&r.__line__&&(this.line=r.__line__)};function qt(e){var t=e.value;return t?[new gt(e.key,t,"constants have been deprecated as of v8")]:[]}function zr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var l=0,f=t;l<f.length;l+=1){var m=f[l];for(var A in m)e[A]=m[A]}return e}function Br(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function sr(e){if(Array.isArray(e))return e.map(sr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=sr(e[r]);return t}return Br(e)}var kr=function(e){function t(r,l){e.call(this,l),this.message=l,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Cn=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var l=0,f=r;l<f.length;l+=1){var m=f[l];this.bindings[m[0]]=m[1]}};Cn.prototype.concat=function(e){return new Cn(this,e)},Cn.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Cn.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var dn={kind:"null"},Er={kind:"number"},Tn={kind:"string"},vn={kind:"boolean"},mn={kind:"color"},Ar={kind:"object"},$r={kind:"value"},Mn={kind:"collator"},Ki={kind:"formatted"},vi={kind:"resolvedImage"};function Mi(e,t){return{kind:"array",itemType:e,N:t}}function zi(e){if(e.kind==="array"){var t=zi(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var Ka=[dn,Er,Tn,vn,mn,Ki,Ar,Mi($r),vi];function hi(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!hi(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,l=Ka;r<l.length;r+=1)if(!hi(l[r],t))return null}}return"Expected "+zi(e)+" but found "+zi(t)+" instead."}function ya(e,t){return t.some(function(r){return r.kind===e.kind})}function Ii(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var yi=Y(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(I){return(I=Math.round(I))<0?0:I>255?255:I}function f(I){return l(I[I.length-1]==="%"?parseFloat(I)/100*255:parseInt(I))}function m(I){return(G=I[I.length-1]==="%"?parseFloat(I)/100:parseFloat(I))<0?0:G>1?1:G;var G}function A(I,G,te){return te<0?te+=1:te>1&&(te-=1),6*te<1?I+(G-I)*te*6:2*te<1?G:3*te<2?I+(G-I)*(2/3-te)*6:I}try{t.parseCSSColor=function(I){var G,te=I.replace(/ /g,"").toLowerCase();if(te in r)return r[te].slice();if(te[0]==="#")return te.length===4?(G=parseInt(te.substr(1),16))>=0&&G<=4095?[(3840&G)>>4|(3840&G)>>8,240&G|(240&G)>>4,15&G|(15&G)<<4,1]:null:te.length===7&&(G=parseInt(te.substr(1),16))>=0&&G<=16777215?[(16711680&G)>>16,(65280&G)>>8,255&G,1]:null;var pe=te.indexOf("("),Ce=te.indexOf(")");if(pe!==-1&&Ce+1===te.length){var Me=te.substr(0,pe),ot=te.substr(pe+1,Ce-(pe+1)).split(","),_t=1;switch(Me){case"rgba":if(ot.length!==4)return null;_t=m(ot.pop());case"rgb":return ot.length!==3?null:[f(ot[0]),f(ot[1]),f(ot[2]),_t];case"hsla":if(ot.length!==4)return null;_t=m(ot.pop());case"hsl":if(ot.length!==3)return null;var Ct=(parseFloat(ot[0])%360+360)%360/360,Xt=m(ot[1]),Zt=m(ot[2]),ar=Zt<=.5?Zt*(Xt+1):Zt+Xt-Zt*Xt,dr=2*Zt-ar;return[l(255*A(dr,ar,Ct+1/3)),l(255*A(dr,ar,Ct)),l(255*A(dr,ar,Ct-1/3)),_t];default:return null}}return null}}catch(I){}}).parseCSSColor,ci=function(t,r,l,f){f===void 0&&(f=1),this.r=t,this.g=r,this.b=l,this.a=f};ci.parse=function(e){if(e){if(e instanceof ci)return e;if(typeof e=="string"){var t=yi(e);if(t)return new ci(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ci.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+l+")"},ci.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},ci.black=new ci(0,0,0,1),ci.white=new ci(1,1,1,1),ci.transparent=new ci(0,0,0,0),ci.red=new ci(1,0,0,1);var Ra=function(t,r,l){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ra.prototype.compare=function(e,t){return this.collator.compare(e,t)},Ra.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var xo=function(t,r,l,f,m){this.text=t,this.image=r,this.scale=l,this.fontStack=f,this.textColor=m},$a=function(t){this.sections=t};$a.fromString=function(e){return new $a([new xo(e,null,null,null,null)])},$a.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},$a.factory=function(e){return e instanceof $a?e:$a.fromString(e)},$a.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},$a.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var l=r[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var f={};l.fontStack&&(f["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(f["font-scale"]=l.scale),l.textColor&&(f["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(f)}}return e};var Ko=function(t){this.name=t.name,this.available=t.available};function Uu(e,t,r,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,r,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,r,l]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Gi(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof ci||e instanceof Ra||e instanceof $a||e instanceof Ko)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Gi(r[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!Gi(e[l]))return!1;return!0}return!1}function Pa(e){if(e===null)return dn;if(typeof e=="string")return Tn;if(typeof e=="boolean")return vn;if(typeof e=="number")return Er;if(e instanceof ci)return mn;if(e instanceof Ra)return Mn;if(e instanceof $a)return Ki;if(e instanceof Ko)return vi;if(Array.isArray(e)){for(var t,r=e.length,l=0,f=e;l<f.length;l+=1){var m=Pa(f[l]);if(t){if(t===m)continue;t=$r;break}t=m}return Mi(t||$r,r)}return Ar}function ns(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof ci||e instanceof $a||e instanceof Ko?e.toString():JSON.stringify(e)}Ko.prototype.toString=function(){return this.name},Ko.fromString=function(e){return e?new Ko({name:e,available:!1}):null},Ko.prototype.serialize=function(){return["image",this.name]};var na=function(t,r){this.type=t,this.value=r};na.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Gi(e[1]))return t.error("invalid value");var r=e[1],l=Pa(r),f=t.expectedType;return l.kind!=="array"||l.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(l=f),new na(l,r)},na.prototype.evaluate=function(){return this.value},na.prototype.eachChild=function(){},na.prototype.outputDefined=function(){return!0},na.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ci?["rgba"].concat(this.value.toArray()):this.value instanceof $a?this.value.serialize():this.value};var Ja=function(t){this.name="ExpressionEvaluationError",this.message=t};Ja.prototype.toJSON=function(){return this.message};var is={string:Tn,number:Er,boolean:vn,object:Ar},Ji=function(t,r){this.type=t,this.args=r};Ji.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,l=1,f=e[0];if(f==="array"){var m,A;if(e.length>2){var I=e[1];if(typeof I!="string"||!(I in is)||I==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=is[I],l++}else m=$r;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);A=e[2],l++}r=Mi(m,A)}else r=is[f];for(var G=[];l<e.length;l++){var te=t.parse(e[l],l,$r);if(!te)return null;G.push(te)}return new Ji(r,G)},Ji.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!hi(this.type,Pa(r)))return r;if(t===this.args.length-1)throw new Ja("Expected value to be of type "+zi(this.type)+", but found "+zi(Pa(r))+" instead.")}return null},Ji.prototype.eachChild=function(e){this.args.forEach(e)},Ji.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ji.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var lo=function(t){this.type=Ki,this.sections=t};lo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var l=[],f=!1,m=1;m<=e.length-1;++m){var A=e[m];if(f&&typeof A=="object"&&!Array.isArray(A)){f=!1;var I=null;if(A["font-scale"]&&!(I=t.parse(A["font-scale"],1,Er)))return null;var G=null;if(A["text-font"]&&!(G=t.parse(A["text-font"],1,Mi(Tn))))return null;var te=null;if(A["text-color"]&&!(te=t.parse(A["text-color"],1,mn)))return null;var pe=l[l.length-1];pe.scale=I,pe.font=G,pe.textColor=te}else{var Ce=t.parse(e[m],1,$r);if(!Ce)return null;var Me=Ce.type.kind;if(Me!=="string"&&Me!=="value"&&Me!=="null"&&Me!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,l.push({content:Ce,scale:null,font:null,textColor:null})}}return new lo(l)},lo.prototype.evaluate=function(e){return new $a(this.sections.map(function(t){var r=t.content.evaluate(e);return Pa(r)===vi?new xo("",r,null,null,null):new xo(ns(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},lo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var l=r[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},lo.prototype.outputDefined=function(){return!1},lo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var l=r[t];e.push(l.content.serialize());var f={};l.scale&&(f["font-scale"]=l.scale.serialize()),l.font&&(f["text-font"]=l.font.serialize()),l.textColor&&(f["text-color"]=l.textColor.serialize()),e.push(f)}return e};var co=function(t){this.type=vi,this.input=t};co.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Tn);return r?new co(r):t.error("No image name provided.")},co.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Ko.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},co.prototype.eachChild=function(e){e(this.input)},co.prototype.outputDefined=function(){return!1},co.prototype.serialize=function(){return["image",this.input.serialize()]};var Ks={"to-boolean":vn,"to-color":mn,"to-number":Er,"to-string":Tn},wo=function(t,r){this.type=t,this.args=r};wo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=Ks[r],f=[],m=1;m<e.length;m++){var A=t.parse(e[m],m,$r);if(!A)return null;f.push(A)}return new wo(l,f)},wo.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,l=0,f=this.args;l<f.length;l+=1){if(r=null,(t=f[l].evaluate(e))instanceof ci)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Uu(t[0],t[1],t[2],t[3])))return new ci(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Ja(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var A=null,I=0,G=this.args;I<G.length;I+=1){if((A=G[I].evaluate(e))===null)return 0;var te=Number(A);if(!isNaN(te))return te}throw new Ja("Could not convert "+JSON.stringify(A)+" to number.")}return this.type.kind==="formatted"?$a.fromString(ns(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ko.fromString(ns(this.args[0].evaluate(e))):ns(this.args[0].evaluate(e))},wo.prototype.eachChild=function(e){this.args.forEach(e)},wo.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},wo.prototype.serialize=function(){if(this.type.kind==="formatted")return new lo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new co(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Zl=["Unknown","Point","LineString","Polygon"],$s=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};$s.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},$s.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Zl[this.feature.type]:this.feature.type:null},$s.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},$s.prototype.canonicalID=function(){return this.canonical},$s.prototype.properties=function(){return this.feature&&this.feature.properties||{}},$s.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ci.parse(e)),t};var Po=function(t,r,l,f){this.name=t,this.type=r,this._evaluate=l,this.args=f};Po.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Po.prototype.eachChild=function(e){this.args.forEach(e)},Po.prototype.outputDefined=function(){return!1},Po.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Po.parse=function(e,t){var r,l=e[0],f=Po.definitions[l];if(!f)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(f)?f[0]:f.type,A=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,I=A.filter(function(Kn){var Nn=Kn[0];return!Array.isArray(Nn)||Nn.length===e.length-1}),G=null,te=0,pe=I;te<pe.length;te+=1){var Ce=pe[te],Me=Ce[0],ot=Ce[1];G=new lu(t.registry,t.path,null,t.scope);for(var _t=[],Ct=!1,Xt=1;Xt<e.length;Xt++){var Zt=e[Xt],ar=Array.isArray(Me)?Me[Xt-1]:Me.type,dr=G.parse(Zt,1+_t.length,ar);if(!dr){Ct=!0;break}_t.push(dr)}if(!Ct)if(Array.isArray(Me)&&Me.length!==_t.length)G.error("Expected "+Me.length+" arguments, but found "+_t.length+" instead.");else{for(var br=0;br<_t.length;br++){var Nr=Array.isArray(Me)?Me[br]:Me.type,Rr=_t[br];G.concat(br+1).checkSubtype(Nr,Rr.type)}if(G.errors.length===0)return new Po(l,m,ot,_t)}}if(I.length===1)(r=t.errors).push.apply(r,G.errors);else{for(var pn=(I.length?I:A).map(function(Kn){var Nn;return Nn=Kn[0],Array.isArray(Nn)?"("+Nn.map(zi).join(", ")+")":"("+zi(Nn.type)+"...)"}).join(" | "),hn=[],Ln=1;Ln<e.length;Ln++){var Jn=t.parse(e[Ln],1+hn.length);if(!Jn)return null;hn.push(zi(Jn.type))}t.error("Expected arguments of type "+pn+", but found ("+hn.join(", ")+") instead.")}return null},Po.register=function(e,t){for(var r in Po.definitions=t,t)e[r]=Po};var Bt=function(t,r,l){this.type=Mn,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=r};function Fe(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Ot(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function fr(e,t){var r=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*8192),Math.round(l*f*8192)]}function rn(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function bn(e,t){for(var r,l,f,m,A,I,G,te=!1,pe=0,Ce=t.length;pe<Ce;pe++)for(var Me=t[pe],ot=0,_t=Me.length;ot<_t-1;ot++){if((m=(r=e)[0]-(l=Me[ot])[0])*(G=r[1]-(f=Me[ot+1])[1])-(I=r[0]-f[0])*(A=r[1]-l[1])==0&&m*I<=0&&A*G<=0)return!1;rn(e,Me[ot],Me[ot+1])&&(te=!te)}return te}function Un(e,t){for(var r=0;r<t.length;r++)if(bn(e,t[r]))return!0;return!1}function Da(e,t,r,l){var f=l[0]-r[0],m=l[1]-r[1],A=(e[0]-r[0])*m-f*(e[1]-r[1]),I=(t[0]-r[0])*m-f*(t[1]-r[1]);return A>0&&I<0||A<0&&I>0}function ao(e,t,r){for(var l=0,f=r;l<f.length;l+=1)for(var m=f[l],A=0;A<m.length-1;++A)if((Ce=[(pe=m[A+1])[0]-(te=m[A])[0],pe[1]-te[1]])[0]*(Me=[(G=t)[0]-(I=e)[0],G[1]-I[1]])[1]-Ce[1]*Me[0]!=0&&Da(I,G,te,pe)&&Da(te,pe,I,G))return!0;var I,G,te,pe,Ce,Me;return!1}function bo(e,t){for(var r=0;r<e.length;++r)if(!bn(e[r],t))return!1;for(var l=0;l<e.length-1;++l)if(ao(e[l],e[l+1],t))return!1;return!0}function Fo(e,t){for(var r=0;r<t.length;r++)if(bo(e,t[r]))return!0;return!1}function Vu(e,t,r){for(var l=[],f=0;f<e.length;f++){for(var m=[],A=0;A<e[f].length;A++){var I=fr(e[f][A],r);Fe(t,I),m.push(I)}l.push(m)}return l}function Wl(e,t,r){for(var l=[],f=0;f<e.length;f++){var m=Vu(e[f],t,r);l.push(m)}return l}function Js(e,t,r,l){if(e[0]<r[0]||e[0]>r[2]){var f=.5*l,m=e[0]-r[0]>f?-l:r[0]-e[0]>f?l:0;m===0&&(m=e[0]-r[2]>f?-l:r[2]-e[0]>f?l:0),e[0]+=m}Fe(t,e)}function Ic(e,t,r,l){for(var f=8192*Math.pow(2,l.z),m=[8192*l.x,8192*l.y],A=[],I=0,G=e;I<G.length;I+=1)for(var te=0,pe=G[I];te<pe.length;te+=1){var Ce=pe[te],Me=[Ce.x+m[0],Ce.y+m[1]];Js(Me,t,r,f),A.push(Me)}return A}function Il(e,t,r,l){for(var f,m=8192*Math.pow(2,l.z),A=[8192*l.x,8192*l.y],I=[],G=0,te=e;G<te.length;G+=1){for(var pe=[],Ce=0,Me=te[G];Ce<Me.length;Ce+=1){var ot=Me[Ce],_t=[ot.x+A[0],ot.y+A[1]];Fe(t,_t),pe.push(_t)}I.push(pe)}if(t[2]-t[0]<=m/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var Ct=0,Xt=I;Ct<Xt.length;Ct+=1)for(var Zt=0,ar=Xt[Ct];Zt<ar.length;Zt+=1)Js(ar[Zt],t,r,m)}return I}Bt.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var l=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,vn);if(!l)return null;var f=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,vn);if(!f)return null;var m=null;return r.locale&&!(m=t.parse(r.locale,1,Tn))?null:new Bt(l,f,m)},Bt.prototype.evaluate=function(e){return new Ra(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Bt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Bt.prototype.outputDefined=function(){return!1},Bt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var hs=function(t,r){this.type=vn,this.geojson=t,this.geometries=r};function Ns(e){if(e instanceof Po&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof hs)return!1;var t=!0;return e.eachChild(function(r){t&&!Ns(r)&&(t=!1)}),t}function fo(e){if(e instanceof Po&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!fo(r)&&(t=!1)}),t}function ds(e,t){if(e instanceof Po&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(l){r&&!ds(l,t)&&(r=!1)}),r}hs.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Gi(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var l=0;l<r.features.length;++l){var f=r.features[l].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new hs(r,r.features[l].geometry)}else if(r.type==="Feature"){var m=r.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new hs(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new hs(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},hs.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(r.type==="Polygon"){var A=Vu(r.coordinates,f,m),I=Ic(t.geometry(),l,f,m);if(!Ot(l,f))return!1;for(var G=0,te=I;G<te.length;G+=1)if(!bn(te[G],A))return!1}if(r.type==="MultiPolygon"){var pe=Wl(r.coordinates,f,m),Ce=Ic(t.geometry(),l,f,m);if(!Ot(l,f))return!1;for(var Me=0,ot=Ce;Me<ot.length;Me+=1)if(!Un(ot[Me],pe))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var l=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(r.type==="Polygon"){var A=Vu(r.coordinates,f,m),I=Il(t.geometry(),l,f,m);if(!Ot(l,f))return!1;for(var G=0,te=I;G<te.length;G+=1)if(!bo(te[G],A))return!1}if(r.type==="MultiPolygon"){var pe=Wl(r.coordinates,f,m),Ce=Il(t.geometry(),l,f,m);if(!Ot(l,f))return!1;for(var Me=0,ot=Ce;Me<ot.length;Me+=1)if(!Fo(ot[Me],pe))return!1}return!0}(e,this.geometries)}return!1},hs.prototype.eachChild=function(){},hs.prototype.outputDefined=function(){return!0},hs.prototype.serialize=function(){return["within",this.geojson]};var Qs=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};Qs.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Qs(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Qs.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Qs.prototype.eachChild=function(){},Qs.prototype.outputDefined=function(){return!1},Qs.prototype.serialize=function(){return["var",this.name]};var lu=function(t,r,l,f,m){r===void 0&&(r=[]),f===void 0&&(f=new Cn),m===void 0&&(m=[]),this.registry=t,this.path=r,this.key=r.map(function(A){return"["+A+"]"}).join(""),this.scope=f,this.errors=m,this.expectedType=l};function Xl(e,t){for(var r,l=e.length-1,f=0,m=l,A=0;f<=m;)if((r=e[A=Math.floor((f+m)/2)])<=t){if(A===l||t<e[A+1])return A;f=A+1}else{if(!(r>t))throw new Ja("Input is not a number.");m=A-1}return 0}lu.prototype.parse=function(e,t,r,l,f){return f===void 0&&(f={}),t?this.concat(t,r,l)._parse(e,f):this._parse(e,f)},lu.prototype._parse=function(e,t){function r(te,pe,Ce){return Ce==="assert"?new Ji(pe,[te]):Ce==="coerce"?new wo(pe,[te]):te}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[l];if(f){var m=f.parse(e,this);if(!m)return null;if(this.expectedType){var A=this.expectedType,I=m.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||I.kind!=="value")if(A.kind!=="color"&&A.kind!=="formatted"&&A.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string"){if(this.checkSubtype(A,I))return null}else m=r(m,A,t.typeAnnotation||"coerce");else m=r(m,A,t.typeAnnotation||"assert")}if(!(m instanceof na)&&m.type.kind!=="resolvedImage"&&function te(pe){if(pe instanceof Qs)return te(pe.boundExpression);if(pe instanceof Po&&pe.name==="error"||pe instanceof Bt||pe instanceof hs)return!1;var Ce=pe instanceof wo||pe instanceof Ji,Me=!0;return pe.eachChild(function(ot){Me=Ce?Me&&te(ot):Me&&ot instanceof na}),!!Me&&Ns(pe)&&ds(pe,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var G=new $s;try{m=new na(m.type,m.evaluate(G))}catch(te){return this.error(te.message),null}}return m}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},lu.prototype.concat=function(e,t,r){var l=typeof e=="number"?this.path.concat(e):this.path,f=r?this.scope.concat(r):this.scope;return new lu(this.registry,l,t||null,f,this.errors)},lu.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var l=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new kr(l,e))},lu.prototype.checkSubtype=function(e,t){var r=hi(e,t);return r&&this.error(r),r};var xa=function(t,r,l){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var f=0,m=l;f<m.length;f+=1){var A=m[f],I=A[1];this.labels.push(A[0]),this.outputs.push(I)}};function ka(e,t,r){return e*(1-r)+t*r}xa.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,Er);if(!r)return null;var l=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var m=1;m<e.length;m+=2){var A=m===1?-1/0:e[m],I=e[m+1],G=m,te=m+1;if(typeof A!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(l.length&&l[l.length-1][0]>=A)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',G);var pe=t.parse(I,te,f);if(!pe)return null;f=f||pe.type,l.push([A,pe])}return new xa(f,r,l)},xa.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return r[0].evaluate(e);var f=t.length;return l>=t[f-1]?r[f-1].evaluate(e):r[Xl(t,l)].evaluate(e)},xa.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},xa.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},xa.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var ml=Object.freeze({__proto__:null,number:ka,color:function(t,r,l){return new ci(ka(t.r,r.r,l),ka(t.g,r.g,l),ka(t.b,r.b,l),ka(t.a,r.a,l))},array:function(t,r,l){return t.map(function(f,m){return ka(f,r[m],l)})}}),Fs=6/29*3*(6/29),ps=Math.PI/180,It=180/Math.PI;function ir(e){return e>.008856451679035631?Math.pow(e,1/3):e/Fs+4/29}function Mr(e){return e>6/29?e*e*e:Fs*(e-4/29)}function Gn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Qi(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function za(e){var t=Qi(e.r),r=Qi(e.g),l=Qi(e.b),f=ir((.4124564*t+.3575761*r+.1804375*l)/.95047),m=ir((.2126729*t+.7151522*r+.072175*l)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-ir((.0193339*t+.119192*r+.9503041*l)/1.08883)),alpha:e.a}}function Za(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*Mr(t),r=.95047*Mr(r),l=1.08883*Mr(l),new ci(Gn(3.2404542*r-1.5371385*t-.4985314*l),Gn(-.969266*r+1.8760108*t+.041556*l),Gn(.0556434*r-.2040259*t+1.0572252*l),e.alpha)}function qi(e,t,r){var l=t-e;return e+r*(l>180||l<-180?l-360*Math.round(l/360):l)}var ba={forward:za,reverse:Za,interpolate:function(t,r,l){return{l:ka(t.l,r.l,l),a:ka(t.a,r.a,l),b:ka(t.b,r.b,l),alpha:ka(t.alpha,r.alpha,l)}}},_o={forward:function(t){var r=za(t),l=r.l,f=r.a,m=r.b,A=Math.atan2(m,f)*It;return{h:A<0?A+360:A,c:Math.sqrt(f*f+m*m),l,alpha:t.a}},reverse:function(t){var r=t.h*ps,l=t.c;return Za({l:t.l,a:Math.cos(r)*l,b:Math.sin(r)*l,alpha:t.alpha})},interpolate:function(t,r,l){return{h:qi(t.h,r.h,l),c:ka(t.c,r.c,l),l:ka(t.l,r.l,l),alpha:ka(t.alpha,r.alpha,l)}}},Bs=Object.freeze({__proto__:null,lab:ba,hcl:_o}),ha=function(t,r,l,f,m){this.type=t,this.operator=r,this.interpolation=l,this.input=f,this.labels=[],this.outputs=[];for(var A=0,I=m;A<I.length;A+=1){var G=I[A],te=G[1];this.labels.push(G[0]),this.outputs.push(te)}};function Yl(e,t,r,l){var f=l-r,m=e-r;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}ha.interpolationFactor=function(e,t,r,l){var f=0;if(e.name==="exponential")f=Yl(t,e.base,r,l);else if(e.name==="linear")f=Yl(t,1,r,l);else if(e.name==="cubic-bezier"){var m=e.controlPoints;f=new B(m[0],m[1],m[2],m[3]).solve(Yl(t,1,r,l))}return f},ha.parse=function(e,t){var r=e[0],l=e[1],f=e[2],m=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var A=l[1];if(typeof A!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:A}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var I=l.slice(1);if(I.length!==4||I.some(function(Xt){return typeof Xt!="number"||Xt<0||Xt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:I}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,Er)))return null;var G=[],te=null;r==="interpolate-hcl"||r==="interpolate-lab"?te=mn:t.expectedType&&t.expectedType.kind!=="value"&&(te=t.expectedType);for(var pe=0;pe<m.length;pe+=2){var Ce=m[pe],Me=m[pe+1],ot=pe+3,_t=pe+4;if(typeof Ce!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ot);if(G.length&&G[G.length-1][0]>=Ce)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ot);var Ct=t.parse(Me,_t,te);if(!Ct)return null;te=te||Ct.type,G.push([Ce,Ct])}return te.kind==="number"||te.kind==="color"||te.kind==="array"&&te.itemType.kind==="number"&&typeof te.N=="number"?new ha(te,r,l,f,G):t.error("Type "+zi(te)+" is not interpolatable.")},ha.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return r[0].evaluate(e);var f=t.length;if(l>=t[f-1])return r[f-1].evaluate(e);var m=Xl(t,l),A=ha.interpolationFactor(this.interpolation,l,t[m],t[m+1]),I=r[m].evaluate(e),G=r[m+1].evaluate(e);return this.operator==="interpolate"?ml[this.type.kind.toLowerCase()](I,G,A):this.operator==="interpolate-hcl"?_o.reverse(_o.interpolate(_o.forward(I),_o.forward(G),A)):ba.reverse(ba.interpolate(ba.forward(I),ba.forward(G),A))},ha.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},ha.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},ha.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var cu=function(t,r){this.type=t,this.args=r};cu.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,l=t.expectedType;l&&l.kind!=="value"&&(r=l);for(var f=[],m=0,A=e.slice(1);m<A.length;m+=1){var I=t.parse(A[m],1+f.length,r,void 0,{typeAnnotation:"omit"});if(!I)return null;r=r||I.type,f.push(I)}var G=l&&f.some(function(te){return hi(l,te.type)});return new cu(G?$r:r,f)},cu.prototype.evaluate=function(e){for(var t,r=null,l=0,f=0,m=this.args;f<m.length&&(l++,(r=m[f].evaluate(e))&&r instanceof Ko&&!r.available&&(t||(t=r.name),r=null,l===this.args.length&&(r=t)),r===null);f+=1);return r},cu.prototype.eachChild=function(e){this.args.forEach(e)},cu.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},cu.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var _s=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};_s.prototype.evaluate=function(e){return this.result.evaluate(e)},_s.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},_s.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],l=1;l<e.length-1;l+=2){var f=e[l];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",l);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var m=t.parse(e[l+1],l+1);if(!m)return null;r.push([f,m])}var A=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return A?new _s(r,A):null},_s.prototype.outputDefined=function(){return this.result.outputDefined()},_s.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var l=r[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var gl=function(t,r,l){this.type=t,this.index=r,this.input=l};gl.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Er),l=t.parse(e[2],2,Mi(t.expectedType||$r));return r&&l?new gl(l.type.itemType,r,l):null},gl.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Ja("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Ja("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Ja("Array index must be an integer, but found "+t+" instead.");return r[t]},gl.prototype.eachChild=function(e){e(this.index),e(this.input)},gl.prototype.outputDefined=function(){return!1},gl.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var fu=function(t,r){this.type=vn,this.needle=t,this.haystack=r};fu.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,$r),l=t.parse(e[2],2,$r);return r&&l?ya(r.type,[vn,Tn,Er,dn,$r])?new fu(r,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+zi(r.type)+" instead"):null},fu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Ii(t,["boolean","string","number","null"]))throw new Ja("Expected first argument to be of type boolean, string, number or null, but found "+zi(Pa(t))+" instead.");if(!Ii(r,["string","array"]))throw new Ja("Expected second argument to be of type array or string, but found "+zi(Pa(r))+" instead.");return r.indexOf(t)>=0},fu.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},fu.prototype.outputDefined=function(){return!0},fu.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Gu=function(t,r,l){this.type=Er,this.needle=t,this.haystack=r,this.fromIndex=l};Gu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,$r),l=t.parse(e[2],2,$r);if(!r||!l)return null;if(!ya(r.type,[vn,Tn,Er,dn,$r]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+zi(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Er);return f?new Gu(r,l,f):null}return new Gu(r,l)},Gu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Ii(t,["boolean","string","number","null"]))throw new Ja("Expected first argument to be of type boolean, string, number or null, but found "+zi(Pa(t))+" instead.");if(!Ii(r,["string","array"]))throw new Ja("Expected second argument to be of type array or string, but found "+zi(Pa(r))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return r.indexOf(t,l)}return r.indexOf(t)},Gu.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Gu.prototype.outputDefined=function(){return!1},Gu.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var qs=function(t,r,l,f,m,A){this.inputType=t,this.type=r,this.input=l,this.cases=f,this.outputs=m,this.otherwise=A};qs.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var f={},m=[],A=2;A<e.length-1;A+=2){var I=e[A],G=e[A+1];Array.isArray(I)||(I=[I]);var te=t.concat(A);if(I.length===0)return te.error("Expected at least one branch label.");for(var pe=0,Ce=I;pe<Ce.length;pe+=1){var Me=Ce[pe];if(typeof Me!="number"&&typeof Me!="string")return te.error("Branch labels must be numbers or strings.");if(typeof Me=="number"&&Math.abs(Me)>Number.MAX_SAFE_INTEGER)return te.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Me=="number"&&Math.floor(Me)!==Me)return te.error("Numeric branch labels must be integer values.");if(r){if(te.checkSubtype(r,Pa(Me)))return null}else r=Pa(Me);if(f[String(Me)]!==void 0)return te.error("Branch labels must be unique.");f[String(Me)]=m.length}var ot=t.parse(G,A,l);if(!ot)return null;l=l||ot.type,m.push(ot)}var _t=t.parse(e[1],1,$r);if(!_t)return null;var Ct=t.parse(e[e.length-1],e.length-1,l);return Ct?_t.type.kind!=="value"&&t.concat(1).checkSubtype(r,_t.type)?null:new qs(r,l,_t,f,m,Ct):null},qs.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Pa(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},qs.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},qs.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},qs.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],l={},f=0,m=Object.keys(this.cases).sort();f<m.length;f+=1){var A=m[f];(Ce=l[this.cases[A]])===void 0?(l[this.cases[A]]=r.length,r.push([this.cases[A],[A]])):r[Ce][1].push(A)}for(var I=function(_t){return e.inputType.kind==="number"?Number(_t):_t},G=0,te=r;G<te.length;G+=1){var pe=te[G],Ce=pe[0],Me=pe[1];t.push(Me.length===1?I(Me[0]):Me.map(I)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var rl=function(t,r,l){this.type=t,this.branches=r,this.otherwise=l};rl.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var l=[],f=1;f<e.length-1;f+=2){var m=t.parse(e[f],f,vn);if(!m)return null;var A=t.parse(e[f+1],f+1,r);if(!A)return null;l.push([m,A]),r=r||A.type}var I=t.parse(e[e.length-1],e.length-1,r);return I?new rl(r,l,I):null},rl.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var l=r[t],f=l[1];if(l[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},rl.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var l=r[t],f=l[1];e(l[0]),e(f)}e(this.otherwise)},rl.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},rl.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var hu=function(t,r,l,f){this.type=t,this.input=r,this.beginIndex=l,this.endIndex=f};function pc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function _f(e,t,r,l){return l.compare(t,r)===0}function da(e,t,r){var l=e!=="=="&&e!=="!=";return function(){function f(m,A,I){this.type=vn,this.lhs=m,this.rhs=A,this.collator=I,this.hasUntypedArgument=m.type.kind==="value"||A.type.kind==="value"}return f.parse=function(m,A){if(m.length!==3&&m.length!==4)return A.error("Expected two or three arguments.");var I=m[0],G=A.parse(m[1],1,$r);if(!G)return null;if(!pc(I,G.type))return A.concat(1).error('"'+I+`" comparisons are not supported for type '`+zi(G.type)+"'.");var te=A.parse(m[2],2,$r);if(!te)return null;if(!pc(I,te.type))return A.concat(2).error('"'+I+`" comparisons are not supported for type '`+zi(te.type)+"'.");if(G.type.kind!==te.type.kind&&G.type.kind!=="value"&&te.type.kind!=="value")return A.error("Cannot compare types '"+zi(G.type)+"' and '"+zi(te.type)+"'.");l&&(G.type.kind==="value"&&te.type.kind!=="value"?G=new Ji(te.type,[G]):G.type.kind!=="value"&&te.type.kind==="value"&&(te=new Ji(G.type,[te])));var pe=null;if(m.length===4){if(G.type.kind!=="string"&&te.type.kind!=="string"&&G.type.kind!=="value"&&te.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(!(pe=A.parse(m[3],3,Mn)))return null}return new f(G,te,pe)},f.prototype.evaluate=function(m){var A=this.lhs.evaluate(m),I=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){var G=Pa(A),te=Pa(I);if(G.kind!==te.kind||G.kind!=="string"&&G.kind!=="number")throw new Ja('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+G.kind+", "+te.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var pe=Pa(A),Ce=Pa(I);if(pe.kind!=="string"||Ce.kind!=="string")return t(m,A,I)}return this.collator?r(m,A,I,this.collator.evaluate(m)):t(m,A,I)},f.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var m=[e];return this.eachChild(function(A){m.push(A.serialize())}),m},f}()}hu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,$r),l=t.parse(e[2],2,Er);if(!r||!l)return null;if(!ya(r.type,[Mi($r),Tn,$r]))return t.error("Expected first argument to be of type array or string, but found "+zi(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,Er);return f?new hu(r.type,r,l,f):null}return new hu(r.type,r,l)},hu.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Ii(t,["string","array"]))throw new Ja("Expected first argument to be of type array or string, but found "+zi(Pa(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(r,l)}return t.slice(r)},hu.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},hu.prototype.outputDefined=function(){return!1},hu.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Oc=da("==",function(e,t,r){return t===r},_f),vc=da("!=",function(e,t,r){return t!==r},function(e,t,r,l){return!_f(0,t,r,l)}),qc=da("<",function(e,t,r){return t<r},function(e,t,r,l){return l.compare(t,r)<0}),ef=da(">",function(e,t,r){return t>r},function(e,t,r,l){return l.compare(t,r)>0}),tf=da("<=",function(e,t,r){return t<=r},function(e,t,r,l){return l.compare(t,r)<=0}),Qa=da(">=",function(e,t,r){return t>=r},function(e,t,r,l){return l.compare(t,r)>=0}),Au=function(t,r,l,f,m){this.type=Tn,this.number=t,this.locale=r,this.currency=l,this.minFractionDigits=f,this.maxFractionDigits=m};Au.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Er);if(!r)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var f=null;if(l.locale&&!(f=t.parse(l.locale,1,Tn)))return null;var m=null;if(l.currency&&!(m=t.parse(l.currency,1,Tn)))return null;var A=null;if(l["min-fraction-digits"]&&!(A=t.parse(l["min-fraction-digits"],1,Er)))return null;var I=null;return l["max-fraction-digits"]&&!(I=t.parse(l["max-fraction-digits"],1,Er))?null:new Au(r,f,m,A,I)},Au.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Au.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Au.prototype.outputDefined=function(){return!1},Au.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var eu=function(t){this.type=Er,this.input=t};eu.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+zi(r.type)+" instead."):new eu(r):null},eu.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Ja("Expected value to be of type string or array, but found "+zi(Pa(t))+" instead.")},eu.prototype.eachChild=function(e){e(this.input)},eu.prototype.outputDefined=function(){return!1},eu.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var vs={"==":Oc,"!=":vc,">":ef,"<":qc,">=":Qa,"<=":tf,array:Ji,at:gl,boolean:Ji,case:rl,coalesce:cu,collator:Bt,format:lo,image:co,in:fu,"index-of":Gu,interpolate:ha,"interpolate-hcl":ha,"interpolate-lab":ha,length:eu,let:_s,literal:na,match:qs,number:Ji,"number-format":Au,object:Ji,slice:hu,step:xa,string:Ji,"to-boolean":wo,"to-color":wo,"to-number":wo,"to-string":wo,var:Qs,within:hs};function Lc(e,t){var r=t[0],l=t[1],f=t[2],m=t[3];r=r.evaluate(e),l=l.evaluate(e),f=f.evaluate(e);var A=m?m.evaluate(e):1,I=Uu(r,l,f,A);if(I)throw new Ja(I);return new ci(r/255*A,l/255*A,f/255*A,A)}function mc(e,t){return e in t}function yl(e,t){var r=t[e];return r===void 0?null:r}function nl(e){return{type:e}}function gc(e){return{result:"success",value:e}}function tu(e){return{result:"error",value:e}}function Hu(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Rc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Kl(e){return!!e.expression&&e.expression.interpolated}function _a(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Dc(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Mf(e){return e}function yc(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function zc(e,t,r,l,f){return yc(typeof r===f?l[r]:void 0,e.default,t.default)}function $l(e,t,r){if(_a(r)!=="number")return yc(e.default,t.default);var l=e.stops.length;if(l===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[l-1][0])return e.stops[l-1][1];var f=Xl(e.stops.map(function(m){return m[0]}),r);return e.stops[f][1]}function Zu(e,t,r){var l=e.base!==void 0?e.base:1;if(_a(r)!=="number")return yc(e.default,t.default);var f=e.stops.length;if(f===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var m=Xl(e.stops.map(function(Ce){return Ce[0]}),r),A=function(Ce,Me,ot,_t){var Ct=_t-ot,Xt=Ce-ot;return Ct===0?0:Me===1?Xt/Ct:(Math.pow(Me,Xt)-1)/(Math.pow(Me,Ct)-1)}(r,l,e.stops[m][0],e.stops[m+1][0]),I=e.stops[m][1],G=e.stops[m+1][1],te=ml[t.type]||Mf;if(e.colorSpace&&e.colorSpace!=="rgb"){var pe=Bs[e.colorSpace];te=function(Me,ot){return pe.reverse(pe.interpolate(pe.forward(Me),pe.forward(ot),A))}}return typeof I.evaluate=="function"?{evaluate:function(){for(var Me=[],ot=arguments.length;ot--;)Me[ot]=arguments[ot];var _t=I.evaluate.apply(void 0,Me),Ct=G.evaluate.apply(void 0,Me);if(_t!==void 0&&Ct!==void 0)return te(_t,Ct,A)}}:te(I,G,A)}function Cu(e,t,r){return t.type==="color"?r=ci.parse(r):t.type==="formatted"?r=$a.fromString(r.toString()):t.type==="resolvedImage"?r=Ko.fromString(r.toString()):_a(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),yc(r,e.default,t.default)}Po.register(vs,{error:[{kind:"error"},[Tn],function(e,t){throw new Ja(t[0].evaluate(e))}],typeof:[Tn,[$r],function(e,t){return zi(Pa(t[0].evaluate(e)))}],"to-rgba":[Mi(Er,4),[mn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[mn,[Er,Er,Er],Lc],rgba:[mn,[Er,Er,Er,Er],Lc],has:{type:vn,overloads:[[[Tn],function(e,t){return mc(t[0].evaluate(e),e.properties())}],[[Tn,Ar],function(e,t){var r=t[1];return mc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:$r,overloads:[[[Tn],function(e,t){return yl(t[0].evaluate(e),e.properties())}],[[Tn,Ar],function(e,t){var r=t[1];return yl(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[$r,[Tn],function(e,t){return yl(t[0].evaluate(e),e.featureState||{})}],properties:[Ar,[],function(e){return e.properties()}],"geometry-type":[Tn,[],function(e){return e.geometryType()}],id:[$r,[],function(e){return e.id()}],zoom:[Er,[],function(e){return e.globals.zoom}],"heatmap-density":[Er,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Er,[],function(e){return e.globals.lineProgress||0}],accumulated:[$r,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Er,nl(Er),function(e,t){for(var r=0,l=0,f=t;l<f.length;l+=1)r+=f[l].evaluate(e);return r}],"*":[Er,nl(Er),function(e,t){for(var r=1,l=0,f=t;l<f.length;l+=1)r*=f[l].evaluate(e);return r}],"-":{type:Er,overloads:[[[Er,Er],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[Er],function(e,t){return-t[0].evaluate(e)}]]},"/":[Er,[Er,Er],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[Er,[Er,Er],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[Er,[],function(){return Math.LN2}],pi:[Er,[],function(){return Math.PI}],e:[Er,[],function(){return Math.E}],"^":[Er,[Er,Er],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[Er,[Er],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Er,[Er],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Er,[Er],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Er,[Er],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Er,[Er],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Er,[Er],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Er,[Er],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Er,[Er],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Er,[Er],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Er,[Er],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Er,nl(Er),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[Er,nl(Er),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[Er,[Er],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Er,[Er],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Er,[Er],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Er,[Er],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[vn,[Tn,$r],function(e,t){var r=t[0],l=t[1];return e.properties()[r.value]===l.value}],"filter-id-==":[vn,[$r],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[vn,[Tn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[vn,[Tn,$r],function(e,t){var r=t[0],l=t[1],f=e.properties()[r.value],m=l.value;return typeof f==typeof m&&f<m}],"filter-id-<":[vn,[$r],function(e,t){var r=t[0],l=e.id(),f=r.value;return typeof l==typeof f&&l<f}],"filter->":[vn,[Tn,$r],function(e,t){var r=t[0],l=t[1],f=e.properties()[r.value],m=l.value;return typeof f==typeof m&&f>m}],"filter-id->":[vn,[$r],function(e,t){var r=t[0],l=e.id(),f=r.value;return typeof l==typeof f&&l>f}],"filter-<=":[vn,[Tn,$r],function(e,t){var r=t[0],l=t[1],f=e.properties()[r.value],m=l.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[vn,[$r],function(e,t){var r=t[0],l=e.id(),f=r.value;return typeof l==typeof f&&l<=f}],"filter->=":[vn,[Tn,$r],function(e,t){var r=t[0],l=t[1],f=e.properties()[r.value],m=l.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[vn,[$r],function(e,t){var r=t[0],l=e.id(),f=r.value;return typeof l==typeof f&&l>=f}],"filter-has":[vn,[$r],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[vn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[vn,[Mi(Tn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[vn,[Mi($r)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[vn,[Tn,Mi($r)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[vn,[Tn,Mi($r)],function(e,t){var r=t[0],l=t[1];return function(f,m,A,I){for(;A<=I;){var G=A+I>>1;if(m[G]===f)return!0;m[G]>f?I=G-1:A=G+1}return!1}(e.properties()[r.value],l.value,0,l.value.length-1)}],all:{type:vn,overloads:[[[vn,vn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[nl(vn),function(e,t){for(var r=0,l=t;r<l.length;r+=1)if(!l[r].evaluate(e))return!1;return!0}]]},any:{type:vn,overloads:[[[vn,vn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[nl(vn),function(e,t){for(var r=0,l=t;r<l.length;r+=1)if(l[r].evaluate(e))return!0;return!1}]]},"!":[vn,[vn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[vn,[Tn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[Tn,[Tn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Tn,[Tn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Tn,nl($r),function(e,t){return t.map(function(r){return ns(r.evaluate(e))}).join("")}],"resolved-locale":[Tn,[Mn],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Ol=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new $s,this._defaultValue=r?function(l){return l.type==="color"&&Dc(l.default)?new ci(0,0,0,0):l.type==="color"?ci.parse(l.default)||null:l.default===void 0?null:l.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function Bo(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in vs}function Jl(e,t){var r=new lu(vs,[],t?function(f){var m={color:mn,string:Tn,number:Er,enum:Tn,boolean:vn,formatted:Ki,resolvedImage:vi};return f.type==="array"?Mi(m[f.value]||$r,f.length):m[f.type]}(t):void 0),l=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?gc(new Ol(l,t)):tu(r.errors)}Ol.prototype.evaluateWithoutErrorHandling=function(e,t,r,l,f,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},Ol.prototype.evaluate=function(e,t,r,l,f,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=l,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{var A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Ja("Expected value to be one of "+Object.keys(this._enumValues).map(function(I){return JSON.stringify(I)}).join(", ")+", but found "+JSON.stringify(A)+" instead.");return A}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console!="undefined"&&console.warn(I.message)),this._defaultValue}};var Ll=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!fo(r.expression)};Ll.prototype.evaluateWithoutErrorHandling=function(e,t,r,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,l,f,m)},Ll.prototype.evaluate=function(e,t,r,l,f,m){return this._styleExpression.evaluate(e,t,r,l,f,m)};var xl=function(t,r,l,f){this.kind=t,this.zoomStops=l,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!fo(r.expression),this.interpolationType=f};function Nc(e,t){if((e=Jl(e,t)).result==="error")return e;var r=e.value.expression,l=Ns(r);if(!l&&!Hu(t))return tu([new kr("","data expressions not supported")]);var f=ds(r,["zoom"]);if(!f&&!Rc(t))return tu([new kr("","zoom expressions not supported")]);var m=function A(I){var G=null;if(I instanceof _s)G=A(I.result);else if(I instanceof cu)for(var te=0,pe=I.args;te<pe.length&&!(G=A(pe[te]));te+=1);else(I instanceof xa||I instanceof ha)&&I.input instanceof Po&&I.input.name==="zoom"&&(G=I);return G instanceof kr||I.eachChild(function(Ce){var Me=A(Ce);Me instanceof kr?G=Me:!G&&Me?G=new kr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):G&&Me&&G!==Me&&(G=new kr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),G}(r);return m||f?m instanceof kr?tu([m]):m instanceof ha&&!Kl(t)?tu([new kr("",'"interpolate" expressions cannot be used with this property')]):gc(m?new xl(l?"camera":"composite",e.value,m.labels,m instanceof ha?m.interpolation:void 0):new Ll(l?"constant":"source",e.value)):tu([new kr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}xl.prototype.evaluateWithoutErrorHandling=function(e,t,r,l,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,l,f,m)},xl.prototype.evaluate=function(e,t,r,l,f,m){return this._styleExpression.evaluate(e,t,r,l,f,m)},xl.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?ha.interpolationFactor(this.interpolationType,e,t,r):0};var Rl=function(t,r){this._parameters=t,this._specification=r,zr(this,function l(f,m){var A,I,G,te=m.type==="color",pe=f.stops&&typeof f.stops[0][0]=="object",Ce=pe||!(pe||f.property!==void 0),Me=f.type||(Kl(m)?"exponential":"interval");if(te&&((f=zr({},f)).stops&&(f.stops=f.stops.map(function(Kn){return[Kn[0],ci.parse(Kn[1])]})),f.default=ci.parse(f.default?f.default:m.default)),f.colorSpace&&f.colorSpace!=="rgb"&&!Bs[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if(Me==="exponential")A=Zu;else if(Me==="interval")A=$l;else if(Me==="categorical"){A=zc,I=Object.create(null);for(var ot=0,_t=f.stops;ot<_t.length;ot+=1){var Ct=_t[ot];I[Ct[0]]=Ct[1]}G=typeof f.stops[0][0]}else{if(Me!=="identity")throw new Error('Unknown function type "'+Me+'"');A=Cu}if(pe){for(var Xt={},Zt=[],ar=0;ar<f.stops.length;ar++){var dr=f.stops[ar],br=dr[0].zoom;Xt[br]===void 0&&(Xt[br]={zoom:br,type:f.type,property:f.property,default:f.default,stops:[]},Zt.push(br)),Xt[br].stops.push([dr[0].value,dr[1]])}for(var Nr=[],Rr=0,pn=Zt;Rr<pn.length;Rr+=1){var hn=pn[Rr];Nr.push([Xt[hn].zoom,l(Xt[hn],m)])}var Ln={name:"linear"};return{kind:"composite",interpolationType:Ln,interpolationFactor:ha.interpolationFactor.bind(void 0,Ln),zoomStops:Nr.map(function(Kn){return Kn[0]}),evaluate:function(Nn,Si){var li=Nn.zoom;return Zu({stops:Nr,base:f.base},m,li).evaluate(li,Si)}}}if(Ce){var Jn=Me==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Jn,interpolationFactor:ha.interpolationFactor.bind(void 0,Jn),zoomStops:f.stops.map(function(Kn){return Kn[0]}),evaluate:function(Nn){return A(f,m,Nn.zoom,I,G)}}}return{kind:"source",evaluate:function(Nn,Si){var li=Si&&Si.properties?Si.properties[f.property]:void 0;return li===void 0?yc(f.default,m.default):A(f,m,li,I,G)}}}(this._parameters,this._specification))};function ru(e){var t=e.key,r=e.value,l=e.valueSpec||{},f=e.objectElementValidators||{},m=e.style,A=e.styleSpec,I=[],G=_a(r);if(G!=="object")return[new gt(t,r,"object expected, "+G+" found")];for(var te in r){var pe=te.split(".")[0],Ce=l[pe]||l["*"],Me=void 0;if(f[pe])Me=f[pe];else if(l[pe])Me=Ni;else if(f["*"])Me=f["*"];else{if(!l["*"]){I.push(new gt(t,r[te],'unknown property "'+te+'"'));continue}Me=Ni}I=I.concat(Me({key:(t&&t+".")+te,value:r[te],valueSpec:Ce,style:m,styleSpec:A,object:r,objectKey:te},r))}for(var ot in l)f[ot]||l[ot].required&&l[ot].default===void 0&&r[ot]===void 0&&I.push(new gt(t,r,'missing required property "'+ot+'"'));return I}function mf(e){var t=e.value,r=e.valueSpec,l=e.style,f=e.styleSpec,m=e.key,A=e.arrayElementValidator||Ni;if(_a(t)!=="array")return[new gt(m,t,"array expected, "+_a(t)+" found")];if(r.length&&t.length!==r.length)return[new gt(m,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new gt(m,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var I={type:r.value,values:r.values};f.$version<7&&(I.function=r.function),_a(r.value)==="object"&&(I=r.value);for(var G=[],te=0;te<t.length;te++)G=G.concat(A({array:t,arrayIndex:te,value:t[te],valueSpec:I,style:l,styleSpec:f,key:m+"["+te+"]"}));return G}function gf(e){var t=e.key,r=e.value,l=e.valueSpec,f=_a(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new gt(t,r,"number expected, "+f+" found")]:"minimum"in l&&r<l.minimum?[new gt(t,r,r+" is less than the minimum value "+l.minimum)]:"maximum"in l&&r>l.maximum?[new gt(t,r,r+" is greater than the maximum value "+l.maximum)]:[]}function rf(e){var t,r,l,f=e.valueSpec,m=Br(e.value.type),A={},I=m!=="categorical"&&e.value.property===void 0,G=!I,te=_a(e.value.stops)==="array"&&_a(e.value.stops[0])==="array"&&_a(e.value.stops[0][0])==="object",pe=ru({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(_t){if(m==="identity")return[new gt(_t.key,_t.value,'identity function may not have a "stops" property')];var Ct=[],Xt=_t.value;return Ct=Ct.concat(mf({key:_t.key,value:Xt,valueSpec:_t.valueSpec,style:_t.style,styleSpec:_t.styleSpec,arrayElementValidator:Ce})),_a(Xt)==="array"&&Xt.length===0&&Ct.push(new gt(_t.key,Xt,"array must have at least one stop")),Ct},default:function(_t){return Ni({key:_t.key,value:_t.value,valueSpec:f,style:_t.style,styleSpec:_t.styleSpec})}}});return m==="identity"&&I&&pe.push(new gt(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||pe.push(new gt(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!Kl(e.valueSpec)&&pe.push(new gt(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(G&&!Hu(e.valueSpec)?pe.push(new gt(e.key,e.value,"property functions not supported")):I&&!Rc(e.valueSpec)&&pe.push(new gt(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!te||e.value.property!==void 0||pe.push(new gt(e.key,e.value,'"property" property is required')),pe;function Ce(ot){var _t=[],Ct=ot.value,Xt=ot.key;if(_a(Ct)!=="array")return[new gt(Xt,Ct,"array expected, "+_a(Ct)+" found")];if(Ct.length!==2)return[new gt(Xt,Ct,"array length 2 expected, length "+Ct.length+" found")];if(te){if(_a(Ct[0])!=="object")return[new gt(Xt,Ct,"object expected, "+_a(Ct[0])+" found")];if(Ct[0].zoom===void 0)return[new gt(Xt,Ct,"object stop key must have zoom")];if(Ct[0].value===void 0)return[new gt(Xt,Ct,"object stop key must have value")];if(l&&l>Br(Ct[0].zoom))return[new gt(Xt,Ct[0].zoom,"stop zoom values must appear in ascending order")];Br(Ct[0].zoom)!==l&&(l=Br(Ct[0].zoom),r=void 0,A={}),_t=_t.concat(ru({key:Xt+"[0]",value:Ct[0],valueSpec:{zoom:{}},style:ot.style,styleSpec:ot.styleSpec,objectElementValidators:{zoom:gf,value:Me}}))}else _t=_t.concat(Me({key:Xt+"[0]",value:Ct[0],valueSpec:{},style:ot.style,styleSpec:ot.styleSpec},Ct));return Bo(sr(Ct[1]))?_t.concat([new gt(Xt+"[1]",Ct[1],"expressions are not allowed in function stops.")]):_t.concat(Ni({key:Xt+"[1]",value:Ct[1],valueSpec:f,style:ot.style,styleSpec:ot.styleSpec}))}function Me(ot,_t){var Ct=_a(ot.value),Xt=Br(ot.value),Zt=ot.value!==null?ot.value:_t;if(t){if(Ct!==t)return[new gt(ot.key,Zt,Ct+" stop domain type must match previous stop domain type "+t)]}else t=Ct;if(Ct!=="number"&&Ct!=="string"&&Ct!=="boolean")return[new gt(ot.key,Zt,"stop domain value must be a number, string, or boolean")];if(Ct!=="number"&&m!=="categorical"){var ar="number expected, "+Ct+" found";return Hu(f)&&m===void 0&&(ar+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new gt(ot.key,Zt,ar)]}return m!=="categorical"||Ct!=="number"||isFinite(Xt)&&Math.floor(Xt)===Xt?m!=="categorical"&&Ct==="number"&&r!==void 0&&Xt<r?[new gt(ot.key,Zt,"stop domain values must appear in ascending order")]:(r=Xt,m==="categorical"&&Xt in A?[new gt(ot.key,Zt,"stop domain values must be unique")]:(A[Xt]=!0,[])):[new gt(ot.key,Zt,"integer expected, found "+Xt)]}}function bl(e){var t=(e.expressionContext==="property"?Nc:Jl)(sr(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new gt(""+e.key+l.key,e.value,l.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new gt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!fo(r))return[new gt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!fo(r))return[new gt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!ds(r,["zoom","feature-state"]))return[new gt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Ns(r))return[new gt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ja(e){var t=e.key,r=e.value,l=e.valueSpec,f=[];return Array.isArray(l.values)?l.values.indexOf(Br(r))===-1&&f.push(new gt(t,r,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(l.values).indexOf(Br(r))===-1&&f.push(new gt(t,r,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(r)+" found")),f}function il(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var l=r[t];if(!il(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}Rl.deserialize=function(e){return new Rl(e._parameters,e._specification)},Rl.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Dl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function xc(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};il(e)||(e=zl(e));var t=Jl(e,Dl);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(l,f,m){return t.value.evaluate(l,f,{},m)},needGeometry:function r(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var f=1;f<l.length;f++)if(r(l[f]))return!0;return!1}(e)}}function Fc(e,t){return e<t?-1:e>t?1:0}function zl(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?If(e[1],e[2],"=="):r==="!="?Sl(If(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?If(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(zl))):r==="all"?["all"].concat(e.slice(1).map(zl)):r==="none"?["all"].concat(e.slice(1).map(zl).map(Sl)):r==="in"?Of(e[1],e.slice(2)):r==="!in"?Sl(Of(e[1],e.slice(2))):r==="has"?nf(e[1]):r==="!has"?Sl(nf(e[1])):r!=="within"||e}function If(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function Of(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Fc)]]:["filter-in-small",e,["literal",t]]}}function nf(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Sl(e){return["!",e]}function Ql(e){return il(sr(e.value))?bl(zr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var l=r.value,f=r.key;if(_a(l)!=="array")return[new gt(f,l,"array expected, "+_a(l)+" found")];var m,A=r.styleSpec,I=[];if(l.length<1)return[new gt(f,l,"filter array must have at least 1 element")];switch(I=I.concat(ja({key:f+"[0]",value:l[0],valueSpec:A.filter_operator,style:r.style,styleSpec:r.styleSpec})),Br(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Br(l[1])==="$type"&&I.push(new gt(f,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&I.push(new gt(f,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(m=_a(l[1]))!=="string"&&I.push(new gt(f+"[1]",l[1],"string expected, "+m+" found"));for(var G=2;G<l.length;G++)m=_a(l[G]),Br(l[1])==="$type"?I=I.concat(ja({key:f+"["+G+"]",value:l[G],valueSpec:A.geometry_type,style:r.style,styleSpec:r.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&I.push(new gt(f+"["+G+"]",l[G],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var te=1;te<l.length;te++)I=I.concat(t({key:f+"["+te+"]",value:l[te],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":m=_a(l[1]),l.length!==2?I.push(new gt(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="string"&&I.push(new gt(f+"[1]",l[1],"string expected, "+m+" found"));break;case"within":m=_a(l[1]),l.length!==2?I.push(new gt(f,l,'filter array for "'+l[0]+'" operator must have 2 elements')):m!=="object"&&I.push(new gt(f+"[1]",l[1],"object expected, "+m+" found"))}return I}(e)}function wu(e,t){var r=e.key,l=e.style,f=e.styleSpec,m=e.value,A=e.objectKey,I=f[t+"_"+e.layerType];if(!I)return[];var G=A.match(/^(.*)-transition$/);if(t==="paint"&&G&&I[G[1]]&&I[G[1]].transition)return Ni({key:r,value:m,valueSpec:f.transition,style:l,styleSpec:f});var te,pe=e.valueSpec||I[A];if(!pe)return[new gt(r,m,'unknown property "'+A+'"')];if(_a(m)==="string"&&Hu(pe)&&!pe.tokens&&(te=/^{([^}]+)}$/.exec(m)))return[new gt(r,m,'"'+A+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(te[1])+" }`.")];var Ce=[];return e.layerType==="symbol"&&(A==="text-field"&&l&&!l.glyphs&&Ce.push(new gt(r,m,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&Dc(sr(m))&&Br(m.type)==="identity"&&Ce.push(new gt(r,m,'"text-font" does not support identity functions'))),Ce.concat(Ni({key:e.key,value:m,valueSpec:pe,style:l,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:A}))}function ks(e){return wu(e,"paint")}function al(e){return wu(e,"layout")}function Bc(e){var t=[],r=e.value,l=e.key,f=e.style,m=e.styleSpec;r.type||r.ref||t.push(new gt(l,r,'either "type" or "ref" is required'));var A,I=Br(r.type),G=Br(r.ref);if(r.id)for(var te=Br(r.id),pe=0;pe<e.arrayIndex;pe++){var Ce=f.layers[pe];Br(Ce.id)===te&&t.push(new gt(l,r.id,'duplicate layer id "'+r.id+'", previously used at line '+Ce.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(_t){_t in r&&t.push(new gt(l,r[_t],'"'+_t+'" is prohibited for ref layers'))}),f.layers.forEach(function(_t){Br(_t.id)===G&&(A=_t)}),A?A.ref?t.push(new gt(l,r.ref,"ref cannot reference another ref layer")):I=Br(A.type):t.push(new gt(l,r.ref,'ref layer "'+G+'" not found'));else if(I!=="background")if(r.source){var Me=f.sources&&f.sources[r.source],ot=Me&&Br(Me.type);Me?ot==="vector"&&I==="raster"?t.push(new gt(l,r.source,'layer "'+r.id+'" requires a raster source')):ot==="raster"&&I!=="raster"?t.push(new gt(l,r.source,'layer "'+r.id+'" requires a vector source')):ot!=="vector"||r["source-layer"]?ot==="raster-dem"&&I!=="hillshade"?t.push(new gt(l,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):I!=="line"||!r.paint||!r.paint["line-gradient"]||ot==="geojson"&&Me.lineMetrics||t.push(new gt(l,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new gt(l,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new gt(l,r.source,'source "'+r.source+'" not found'))}else t.push(new gt(l,r,'missing required property "source"'));return t=t.concat(ru({key:l,value:r,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ni({key:l+".type",value:r.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Ql,layout:function(Ct){return ru({layer:r,key:Ct.key,value:Ct.value,style:Ct.style,styleSpec:Ct.styleSpec,objectElementValidators:{"*":function(Zt){return al(zr({layerType:I},Zt))}}})},paint:function(Ct){return ru({layer:r,key:Ct.key,value:Ct.value,style:Ct.style,styleSpec:Ct.styleSpec,objectElementValidators:{"*":function(Zt){return ks(zr({layerType:I},Zt))}}})}}}))}function Wu(e){var t=e.value,r=e.key,l=_a(t);return l!=="string"?[new gt(r,t,"string expected, "+l+" found")]:[]}var Ua={promoteId:function(t){var r=t.key,l=t.value;if(_a(l)==="string")return Wu({key:r,value:l});var f=[];for(var m in l)f.push.apply(f,Wu({key:r+"."+m,value:l[m]}));return f}};function du(e){var t=e.value,r=e.key,l=e.styleSpec,f=e.style;if(!t.type)return[new gt(r,t,'"type" is required')];var m,A=Br(t.type);switch(A){case"vector":case"raster":case"raster-dem":return ru({key:r,value:t,valueSpec:l["source_"+A.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Ua});case"geojson":if(m=ru({key:r,value:t,valueSpec:l.source_geojson,style:f,styleSpec:l,objectElementValidators:Ua}),t.cluster)for(var I in t.clusterProperties){var G=t.clusterProperties[I],te=G[0],pe=typeof te=="string"?[te,["accumulated"],["get",I]]:te;m.push.apply(m,bl({key:r+"."+I+".map",value:G[1],expressionContext:"cluster-map"})),m.push.apply(m,bl({key:r+"."+I+".reduce",value:pe,expressionContext:"cluster-reduce"}))}return m;case"video":return ru({key:r,value:t,valueSpec:l.source_video,style:f,styleSpec:l});case"image":return ru({key:r,value:t,valueSpec:l.source_image,style:f,styleSpec:l});case"canvas":return[new gt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ja({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:l})}}function ol(e){var t=e.value,r=e.styleSpec,l=r.light,f=e.style,m=[],A=_a(t);if(t===void 0)return m;if(A!=="object")return m.concat([new gt("light",t,"object expected, "+A+" found")]);for(var I in t){var G=I.match(/^(.*)-transition$/);m=m.concat(G&&l[G[1]]&&l[G[1]].transition?Ni({key:I,value:t[I],valueSpec:r.transition,style:f,styleSpec:r}):l[I]?Ni({key:I,value:t[I],valueSpec:l[I],style:f,styleSpec:r}):[new gt(I,t[I],'unknown property "'+I+'"')])}return m}var sl={"*":function(){return[]},array:mf,boolean:function(t){var r=t.value,l=t.key,f=_a(r);return f!=="boolean"?[new gt(l,r,"boolean expected, "+f+" found")]:[]},number:gf,color:function(t){var r=t.key,l=t.value,f=_a(l);return f!=="string"?[new gt(r,l,"color expected, "+f+" found")]:yi(l)===null?[new gt(r,l,'color expected, "'+l+'" found')]:[]},constants:qt,enum:ja,filter:Ql,function:rf,layer:Bc,object:ru,source:du,light:ol,string:Wu,formatted:function(t){return Wu(t).length===0?[]:bl(t)},resolvedImage:function(t){return Wu(t).length===0?[]:bl(t)}};function Ni(e){var t=e.value,r=e.valueSpec,l=e.styleSpec;return r.expression&&Dc(Br(t))?rf(e):r.expression&&Bo(sr(t))?bl(e):r.type&&sl[r.type]?sl[r.type](e):ru(zr({},e,{valueSpec:r.type?l[r.type]:r}))}function pa(e){var t=e.value,r=e.key,l=Wu(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new gt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new gt(r,t,'"glyphs" url must include a "{range}" token'))),l}function Ms(e,t){t===void 0&&(t=Ne);var r=[];return r=r.concat(Ni({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:pa,"*":function(){return[]}}})),e.constants&&(r=r.concat(qt({key:"constants",value:e.constants,style:e,styleSpec:t}))),Ea(r)}function Ea(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Zi(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Ea(e.apply(this,t))}}Ms.source=Zi(du),Ms.light=Zi(ol),Ms.layer=Zi(Bc),Ms.filter=Zi(Ql),Ms.paintProperty=Zi(ks),Ms.layoutProperty=Zi(al);var ql=Ms,yf=ql.light,as=ql.paintProperty,ul=ql.layoutProperty;function pu(e,t){var r=!1;if(t&&t.length)for(var l=0,f=t;l<f.length;l+=1)e.fire(new et(new Error(f[l].message))),r=!0;return r}var Xu=oo;function oo(e,t,r){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(r=f[2]);for(var m=0;m<this.d*this.d;m++){var A=f[3+m],I=f[3+m+1];l.push(A===I?null:f.subarray(A,I))}var G=f[3+l.length+1];this.keys=f.subarray(f[3+l.length],G),this.bboxes=f.subarray(G),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var te=0;te<this.d*this.d;te++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var pe=r/t*e;this.min=-pe,this.max=e+pe}oo.prototype.insert=function(e,t,r,l,f){this._forEachCell(t,r,l,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(f)},oo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},oo.prototype._insertCell=function(e,t,r,l,f,m){this.cells[f].push(m)},oo.prototype.query=function(e,t,r,l,f){var m=this.min,A=this.max;if(e<=m&&t<=m&&A<=r&&A<=l&&!f)return Array.prototype.slice.call(this.keys);var I=[];return this._forEachCell(e,t,r,l,this._queryCell,I,{},f),I},oo.prototype._queryCell=function(e,t,r,l,f,m,A,I){var G=this.cells[f];if(G!==null)for(var te=this.keys,pe=this.bboxes,Ce=0;Ce<G.length;Ce++){var Me=G[Ce];if(A[Me]===void 0){var ot=4*Me;(I?I(pe[ot+0],pe[ot+1],pe[ot+2],pe[ot+3]):e<=pe[ot+2]&&t<=pe[ot+3]&&r>=pe[ot+0]&&l>=pe[ot+1])?(A[Me]=!0,m.push(te[Me])):A[Me]=!1}}},oo.prototype._forEachCell=function(e,t,r,l,f,m,A,I){for(var G=this._convertToCellCoord(e),te=this._convertToCellCoord(t),pe=this._convertToCellCoord(r),Ce=this._convertToCellCoord(l),Me=G;Me<=pe;Me++)for(var ot=te;ot<=Ce;ot++){var _t=this.d*ot+Me;if((!I||I(this._convertFromCellCoord(Me),this._convertFromCellCoord(ot),this._convertFromCellCoord(Me+1),this._convertFromCellCoord(ot+1)))&&f.call(this,e,t,r,l,_t,m,A,I))return}},oo.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},oo.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},oo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,l=0;l<this.cells.length;l++)r+=this.cells[l].length;var f=new Int32Array(t+r+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=t,A=0;A<e.length;A++){var I=e[A];f[3+A]=m,f.set(I,m),m+=I.length}return f[3+e.length]=m,f.set(this.keys,m),f[3+e.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var os=J.ImageData,Nl=J.ImageBitmap,ho={};function In(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),ho[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var js in In("Object",Object),Xu.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},Xu.deserialize=function(e){return new Xu(e.buffer)},In("Grid",Xu),In("Color",ci),In("Error",Error),In("ResolvedImage",Ko),In("StylePropertyFunction",Rl),In("StyleExpression",Ol,{omit:["_evaluator"]}),In("ZoomDependentExpression",xl),In("ZoomConstantExpression",Ll),In("CompoundExpression",Po,{omit:["_evaluate"]}),vs)vs[js]._classRegistryKey||In("Expression_"+js,vs[js]);function bc(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function El(e){return Nl&&e instanceof Nl}function Pu(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(bc(e)||El(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof os)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],f=0,m=e;f<m.length;f+=1)l.push(Pu(m[f],t));return l}if(typeof e=="object"){var A=e.constructor,I=A._classRegistryKey;if(!I)throw new Error("can't serialize object of unregistered class");var G=A.serialize?A.serialize(e,t):{};if(!A.serialize){for(var te in e)if(e.hasOwnProperty(te)&&!(ho[I].omit.indexOf(te)>=0)){var pe=e[te];G[te]=ho[I].shallow.indexOf(te)>=0?pe:Pu(pe,t)}e instanceof Error&&(G.message=e.message)}if(G.$name)throw new Error("$name property is reserved for worker serialization logic.");return I!=="Object"&&(G.$name=I),G}throw new Error("can't serialize object of type "+typeof e)}function Us(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||bc(e)||El(e)||ArrayBuffer.isView(e)||e instanceof os)return e;if(Array.isArray(e))return e.map(Us);if(typeof e=="object"){var t=e.$name||"Object",r=ho[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var l=Object.create(r.prototype),f=0,m=Object.keys(e);f<m.length;f+=1){var A=m[f];if(A!=="$name"){var I=e[A];l[A]=ho[t].shallow.indexOf(A)>=0?I:Us(I)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var ea=function(){this.first=!0};ea.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var en={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function kc(e){for(var t=0,r=e;t<r.length;t+=1)if(Sc(r[t].charCodeAt(0)))return!0;return!1}function Sc(e){return!(e!==746&&e!==747&&(e<4352||!(en["Bopomofo Extended"](e)||en.Bopomofo(e)||en["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||en["CJK Compatibility Ideographs"](e)||en["CJK Compatibility"](e)||en["CJK Radicals Supplement"](e)||en["CJK Strokes"](e)||!(!en["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||en["CJK Unified Ideographs Extension A"](e)||en["CJK Unified Ideographs"](e)||en["Enclosed CJK Letters and Months"](e)||en["Hangul Compatibility Jamo"](e)||en["Hangul Jamo Extended-A"](e)||en["Hangul Jamo Extended-B"](e)||en["Hangul Jamo"](e)||en["Hangul Syllables"](e)||en.Hiragana(e)||en["Ideographic Description Characters"](e)||en.Kanbun(e)||en["Kangxi Radicals"](e)||en["Katakana Phonetic Extensions"](e)||en.Katakana(e)&&e!==12540||!(!en["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!en["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||en["Unified Canadian Aboriginal Syllabics"](e)||en["Unified Canadian Aboriginal Syllabics Extended"](e)||en["Vertical Forms"](e)||en["Yijing Hexagram Symbols"](e)||en["Yi Syllables"](e)||en["Yi Radicals"](e))))}function ll(e){return!(Sc(e)||function(t){return!!(en["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||en["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||en["Letterlike Symbols"](t)||en["Number Forms"](t)||en["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||en["Control Pictures"](t)&&t!==9251||en["Optical Character Recognition"](t)||en["Enclosed Alphanumerics"](t)||en["Geometric Shapes"](t)||en["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||en["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||en["CJK Symbols and Punctuation"](t)||en.Katakana(t)||en["Private Use Area"](t)||en["CJK Compatibility Forms"](t)||en["Small Form Variants"](t)||en["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function vu(e){return e>=1424&&e<=2303||en["Arabic Presentation Forms-A"](e)||en["Arabic Presentation Forms-B"](e)}function Is(e,t){return!(!t&&vu(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||en.Khmer(e))}function Os(e){for(var t=0,r=e;t<r.length;t+=1)if(vu(r[t].charCodeAt(0)))return!0;return!1}var $o=null,ko="unavailable",cl=null,Tl=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(ko="error"),$o&&$o(t)};function Fl(){af.fire(new Le("pluginStateChange",{pluginStatus:ko,pluginURL:cl}))}var af=new wt,Bl=function(){return ko},Ls=function(){if(ko!=="deferred"||!cl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ko="loading",Fl(),cl&&Zn({url:cl},function(t){t?Tl(t):(ko="loaded",Fl())})},ss={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return ko==="loaded"||ss.applyArabicShaping!=null},isLoading:function(){return ko==="loading"},setState:function(t){ko=t.pluginStatus,cl=t.pluginURL},isParsed:function(){return ss.applyArabicShaping!=null&&ss.processBidirectionalText!=null&&ss.processStyledBidirectionalText!=null},getPluginURL:function(){return cl}},Oi=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ea,this.transition={})};Oi.prototype.isSupportedScript=function(e){return function(t,r){for(var l=0,f=t;l<f.length;l+=1)if(!Is(f[l].charCodeAt(0),r))return!1;return!0}(e,ss.isLoaded())},Oi.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Oi.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var Yu=function(t,r){this.property=t,this.value=r,this.expression=function(l,f){if(Dc(l))return new Rl(l,f);if(Bo(l)){var m=Nc(l,f);if(m.result==="error")throw new Error(m.value.map(function(I){return I.key+": "+I.message}).join(", "));return m.value}var A=l;return typeof l=="string"&&f.type==="color"&&(A=ci.parse(l)),{kind:"constant",evaluate:function(){return A}}}(r===void 0?t.specification.default:r,t.specification)};Yu.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Yu.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Va=function(t){this.property=t,this.value=new Yu(t,void 0)};Va.prototype.transitioned=function(e,t){return new Al(this.property,this.value,t,Oe({},e.transition,this.transition),e.now)},Va.prototype.untransitioned=function(){return new Al(this.property,this.value,null,{},0)};var Mo=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Mo.prototype.getValue=function(e){return Xe(this._values[e].value.value)},Mo.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Va(this._values[e].property)),this._values[e].value=new Yu(this._values[e].property,t===null?void 0:Xe(t))},Mo.prototype.getTransition=function(e){return Xe(this._values[e].transition)},Mo.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Va(this._values[e].property)),this._values[e].transition=Xe(t)||void 0},Mo.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var l=r[t],f=this.getValue(l);f!==void 0&&(e[l]=f);var m=this.getTransition(l);m!==void 0&&(e[l+"-transition"]=m)}return e},Mo.prototype.transitioned=function(e,t){for(var r=new mu(this._properties),l=0,f=Object.keys(this._values);l<f.length;l+=1){var m=f[l];r._values[m]=this._values[m].transitioned(e,t._values[m])}return r},Mo.prototype.untransitioned=function(){for(var e=new mu(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var l=r[t];e._values[l]=this._values[l].untransitioned()}return e};var Al=function(t,r,l,f,m){this.property=t,this.value=r,this.begin=m+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=l)};Al.prototype.possiblyEvaluate=function(e,t,r){var l=e.now||0,f=this.value.possiblyEvaluate(e,t,r),m=this.prior;if(m){if(l>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(l<this.begin)return m.possiblyEvaluate(e,t,r);var A=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,r),f,function(I){if(I<=0)return 0;if(I>=1)return 1;var G=I*I,te=G*I;return 4*(I<.5?te:3*(I-G)+te-.75)}(A))}return f};var mu=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};mu.prototype.possiblyEvaluate=function(e,t,r){for(var l=new Ec(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var A=m[f];l._values[A]=this._values[A].possiblyEvaluate(e,t,r)}return l},mu.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var gu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};gu.prototype.getValue=function(e){return Xe(this._values[e].value)},gu.prototype.setValue=function(e,t){this._values[e]=new Yu(this._values[e].property,t===null?void 0:Xe(t))},gu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var l=r[t],f=this.getValue(l);f!==void 0&&(e[l]=f)}return e},gu.prototype.possiblyEvaluate=function(e,t,r){for(var l=new Ec(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var A=m[f];l._values[A]=this._values[A].possiblyEvaluate(e,t,r)}return l};var Ts=function(t,r,l){this.property=t,this.value=r,this.parameters=l};Ts.prototype.isConstant=function(){return this.value.kind==="constant"},Ts.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Ts.prototype.evaluate=function(e,t,r,l){return this.property.evaluate(this.value,this.parameters,e,t,r,l)};var Ec=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Ec.prototype.get=function(e){return this._values[e]};var $n=function(t){this.specification=t};$n.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},$n.prototype.interpolate=function(e,t,r){var l=ml[this.specification.type];return l?l(e,t,r):e};var Fn=function(t,r){this.specification=t,this.overrides=r};Fn.prototype.possiblyEvaluate=function(e,t,r,l){return new Ts(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,l)}:e.expression,t)},Fn.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Ts(this,{kind:"constant",value:void 0},e.parameters);var l=ml[this.specification.type];return l?new Ts(this,{kind:"constant",value:l(e.value.value,t.value.value,r)},e.parameters):e},Fn.prototype.evaluate=function(e,t,r,l,f,m){return e.kind==="constant"?e.value:e.evaluate(t,r,l,f,m)};var Tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,l,f,m){if(r.value===void 0)return new Ts(this,{kind:"constant",value:void 0},l);if(r.expression.kind==="constant"){var A=r.expression.evaluate(l,null,{},f,m),I=r.property.specification.type==="resolvedImage"&&typeof A!="string"?A.name:A,G=this._calculate(I,I,I,l);return new Ts(this,{kind:"constant",value:G},l)}if(r.expression.kind==="camera"){var te=this._calculate(r.expression.evaluate({zoom:l.zoom-1}),r.expression.evaluate({zoom:l.zoom}),r.expression.evaluate({zoom:l.zoom+1}),l);return new Ts(this,{kind:"constant",value:te},l)}return new Ts(this,r.expression,l)},t.prototype.evaluate=function(r,l,f,m,A,I){if(r.kind==="source"){var G=r.evaluate(l,f,m,A,I);return this._calculate(G,G,G,l)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(l.zoom)-1},f,m),r.evaluate({zoom:Math.floor(l.zoom)},f,m),r.evaluate({zoom:Math.floor(l.zoom)+1},f,m),l):r.value},t.prototype._calculate=function(r,l,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:l}:{from:f,to:l}},t.prototype.interpolate=function(r){return r},t}(Fn),ms=function(t){this.specification=t};ms.prototype.possiblyEvaluate=function(e,t,r,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},r,l);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new Oi(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Oi(Math.floor(t.zoom),t)),e.expression.evaluate(new Oi(Math.floor(t.zoom+1),t)),t)}},ms.prototype._calculate=function(e,t,r,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},ms.prototype.interpolate=function(e){return e};var jo=function(t){this.specification=t};jo.prototype.possiblyEvaluate=function(e,t,r,l){return!!e.expression.evaluate(t,null,{},r,l)},jo.prototype.interpolate=function(){return!1};var Io=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var l=t[r];l.specification.overridable&&this.overridableProperties.push(r);var f=this.defaultPropertyValues[r]=new Yu(l,void 0),m=this.defaultTransitionablePropertyValues[r]=new Va(l);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=f.possiblyEvaluate({})}};In("DataDrivenProperty",Fn),In("DataConstantProperty",$n),In("CrossFadedDataDrivenProperty",Tc),In("CrossFadedProperty",ms),In("ColorRampProperty",jo);var nu=function(e){function t(r,l){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),l.layout&&(this._unevaluatedLayout=new gu(l.layout)),l.paint)){for(var f in this._transitionablePaint=new Mo(l.paint),r.paint)this.setPaintProperty(f,r.paint[f],{validate:!1});for(var m in r.layout)this.setLayoutProperty(m,r.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ec(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,l,f){f===void 0&&(f={}),l!=null&&this._validate(ul,"layers."+this.id+".layout."+r,r,l,f)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,l):this.visibility=l)},t.prototype.getPaintProperty=function(r){return $t(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,l,f){if(f===void 0&&(f={}),l!=null&&this._validate(as,"layers."+this.id+".paint."+r,r,l,f))return!1;if($t(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),l||void 0),!1;var m=this._transitionablePaint._values[r],A=m.property.specification["property-type"]==="cross-faded-data-driven",I=m.value.isDataDriven(),G=m.value;this._transitionablePaint.setValue(r,l),this._handleSpecialPaintPropertyUpdate(r);var te=this._transitionablePaint._values[r].value;return te.isDataDriven()||I||A||this._handleOverridablePaintPropertyUpdate(r,G,te)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,l,f){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,l){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,l)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),mt(r,function(l,f){return!(l===void 0||f==="layout"&&!Object.keys(l).length||f==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(r,l,f,m,A){return A===void 0&&(A={}),(!A||A.validate!==!1)&&pu(this,r.call(ql,{key:l,layerType:this.type,objectKey:f,value:m,styleSpec:Ne,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var l=this.paint.get(r);if(l instanceof Ts&&Hu(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(wt),_u={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ec=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Wi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Wa(e,t){t===void 0&&(t=1);var r=0,l=0;return{members:e.map(function(f){var m=_u[f.type].BYTES_PER_ELEMENT,A=r=fl(r,Math.max(t,m)),I=f.components||1;return l=Math.max(l,m),r+=m*I,{name:f.name,type:f.type,components:I,offset:A}}),size:fl(r,Math.max(l,t)),alignment:t}}function fl(e,t){return Math.ceil(e/t)*t}Wi.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Wi.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Wi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Wi.prototype.clear=function(){this.length=0},Wi.prototype.resize=function(e){this.reserve(e),this.length=e},Wi.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Wi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l){var f=this.length;return this.resize(f+1),this.emplace(f,r,l)},t.prototype.emplace=function(r,l,f){var m=2*r;return this.int16[m+0]=l,this.int16[m+1]=f,r},t}(Wi);hl.prototype.bytesPerElement=4,In("StructArrayLayout2i4",hl);var tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m){var A=this.length;return this.resize(A+1),this.emplace(A,r,l,f,m)},t.prototype.emplace=function(r,l,f,m,A){var I=4*r;return this.int16[I+0]=l,this.int16[I+1]=f,this.int16[I+2]=m,this.int16[I+3]=A,r},t}(Wi);tc.prototype.bytesPerElement=8,In("StructArrayLayout4i8",tc);var Mu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I){var G=this.length;return this.resize(G+1),this.emplace(G,r,l,f,m,A,I)},t.prototype.emplace=function(r,l,f,m,A,I,G){var te=6*r;return this.int16[te+0]=l,this.int16[te+1]=f,this.int16[te+2]=m,this.int16[te+3]=A,this.int16[te+4]=I,this.int16[te+5]=G,r},t}(Wi);Mu.prototype.bytesPerElement=12,In("StructArrayLayout2i4i12",Mu);var Rs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I){var G=this.length;return this.resize(G+1),this.emplace(G,r,l,f,m,A,I)},t.prototype.emplace=function(r,l,f,m,A,I,G){var te=4*r,pe=8*r;return this.int16[te+0]=l,this.int16[te+1]=f,this.uint8[pe+4]=m,this.uint8[pe+5]=A,this.uint8[pe+6]=I,this.uint8[pe+7]=G,r},t}(Wi);Rs.prototype.bytesPerElement=8,In("StructArrayLayout2i4ub8",Rs);var kl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l){var f=this.length;return this.resize(f+1),this.emplace(f,r,l)},t.prototype.emplace=function(r,l,f){var m=2*r;return this.float32[m+0]=l,this.float32[m+1]=f,r},t}(Wi);kl.prototype.bytesPerElement=8,In("StructArrayLayout2f8",kl);var gs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I,G,te,pe,Ce){var Me=this.length;return this.resize(Me+1),this.emplace(Me,r,l,f,m,A,I,G,te,pe,Ce)},t.prototype.emplace=function(r,l,f,m,A,I,G,te,pe,Ce,Me){var ot=10*r;return this.uint16[ot+0]=l,this.uint16[ot+1]=f,this.uint16[ot+2]=m,this.uint16[ot+3]=A,this.uint16[ot+4]=I,this.uint16[ot+5]=G,this.uint16[ot+6]=te,this.uint16[ot+7]=pe,this.uint16[ot+8]=Ce,this.uint16[ot+9]=Me,r},t}(Wi);gs.prototype.bytesPerElement=20,In("StructArrayLayout10ui20",gs);var xf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I,G,te,pe,Ce,Me,ot){var _t=this.length;return this.resize(_t+1),this.emplace(_t,r,l,f,m,A,I,G,te,pe,Ce,Me,ot)},t.prototype.emplace=function(r,l,f,m,A,I,G,te,pe,Ce,Me,ot,_t){var Ct=12*r;return this.int16[Ct+0]=l,this.int16[Ct+1]=f,this.int16[Ct+2]=m,this.int16[Ct+3]=A,this.uint16[Ct+4]=I,this.uint16[Ct+5]=G,this.uint16[Ct+6]=te,this.uint16[Ct+7]=pe,this.int16[Ct+8]=Ce,this.int16[Ct+9]=Me,this.int16[Ct+10]=ot,this.int16[Ct+11]=_t,r},t}(Wi);xf.prototype.bytesPerElement=24,In("StructArrayLayout4i4ui4i24",xf);var jl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)},t.prototype.emplace=function(r,l,f,m){var A=3*r;return this.float32[A+0]=l,this.float32[A+1]=f,this.float32[A+2]=m,r},t}(Wi);jl.prototype.bytesPerElement=12,In("StructArrayLayout3f12",jl);var jc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var l=this.length;return this.resize(l+1),this.emplace(l,r)},t.prototype.emplace=function(r,l){return this.uint32[1*r+0]=l,r},t}(Wi);jc.prototype.bytesPerElement=4,In("StructArrayLayout1ul4",jc);var bf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I,G,te,pe){var Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,r,l,f,m,A,I,G,te,pe)},t.prototype.emplace=function(r,l,f,m,A,I,G,te,pe,Ce){var Me=10*r,ot=5*r;return this.int16[Me+0]=l,this.int16[Me+1]=f,this.int16[Me+2]=m,this.int16[Me+3]=A,this.int16[Me+4]=I,this.int16[Me+5]=G,this.uint32[ot+3]=te,this.uint16[Me+8]=pe,this.uint16[Me+9]=Ce,r},t}(Wi);bf.prototype.bytesPerElement=20,In("StructArrayLayout6i1ul2ui20",bf);var Vs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I){var G=this.length;return this.resize(G+1),this.emplace(G,r,l,f,m,A,I)},t.prototype.emplace=function(r,l,f,m,A,I,G){var te=6*r;return this.int16[te+0]=l,this.int16[te+1]=f,this.int16[te+2]=m,this.int16[te+3]=A,this.int16[te+4]=I,this.int16[te+5]=G,r},t}(Wi);Vs.prototype.bytesPerElement=12,In("StructArrayLayout2i2i2i12",Vs);var Cl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A){var I=this.length;return this.resize(I+1),this.emplace(I,r,l,f,m,A)},t.prototype.emplace=function(r,l,f,m,A,I){var G=4*r,te=8*r;return this.float32[G+0]=l,this.float32[G+1]=f,this.float32[G+2]=m,this.int16[te+6]=A,this.int16[te+7]=I,r},t}(Wi);Cl.prototype.bytesPerElement=16,In("StructArrayLayout2f1f2i16",Cl);var Ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m){var A=this.length;return this.resize(A+1),this.emplace(A,r,l,f,m)},t.prototype.emplace=function(r,l,f,m,A){var I=12*r,G=3*r;return this.uint8[I+0]=l,this.uint8[I+1]=f,this.float32[G+1]=m,this.float32[G+2]=A,r},t}(Wi);Ul.prototype.bytesPerElement=12,In("StructArrayLayout2ub2f12",Ul);var Iu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)},t.prototype.emplace=function(r,l,f,m){var A=3*r;return this.uint16[A+0]=l,this.uint16[A+1]=f,this.uint16[A+2]=m,r},t}(Wi);Iu.prototype.bytesPerElement=6,In("StructArrayLayout3ui6",Iu);var Ou=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I,G,te,pe,Ce,Me,ot,_t,Ct,Xt,Zt,ar){var dr=this.length;return this.resize(dr+1),this.emplace(dr,r,l,f,m,A,I,G,te,pe,Ce,Me,ot,_t,Ct,Xt,Zt,ar)},t.prototype.emplace=function(r,l,f,m,A,I,G,te,pe,Ce,Me,ot,_t,Ct,Xt,Zt,ar,dr){var br=24*r,Nr=12*r,Rr=48*r;return this.int16[br+0]=l,this.int16[br+1]=f,this.uint16[br+2]=m,this.uint16[br+3]=A,this.uint32[Nr+2]=I,this.uint32[Nr+3]=G,this.uint32[Nr+4]=te,this.uint16[br+10]=pe,this.uint16[br+11]=Ce,this.uint16[br+12]=Me,this.float32[Nr+7]=ot,this.float32[Nr+8]=_t,this.uint8[Rr+36]=Ct,this.uint8[Rr+37]=Xt,this.uint8[Rr+38]=Zt,this.uint32[Nr+10]=ar,this.int16[br+22]=dr,r},t}(Wi);Ou.prototype.bytesPerElement=48,In("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ou);var wl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m,A,I,G,te,pe,Ce,Me,ot,_t,Ct,Xt,Zt,ar,dr,br,Nr,Rr,pn,hn,Ln,Jn,Kn,Nn,Si){var li=this.length;return this.resize(li+1),this.emplace(li,r,l,f,m,A,I,G,te,pe,Ce,Me,ot,_t,Ct,Xt,Zt,ar,dr,br,Nr,Rr,pn,hn,Ln,Jn,Kn,Nn,Si)},t.prototype.emplace=function(r,l,f,m,A,I,G,te,pe,Ce,Me,ot,_t,Ct,Xt,Zt,ar,dr,br,Nr,Rr,pn,hn,Ln,Jn,Kn,Nn,Si,li){var ei=34*r,$i=17*r;return this.int16[ei+0]=l,this.int16[ei+1]=f,this.int16[ei+2]=m,this.int16[ei+3]=A,this.int16[ei+4]=I,this.int16[ei+5]=G,this.int16[ei+6]=te,this.int16[ei+7]=pe,this.uint16[ei+8]=Ce,this.uint16[ei+9]=Me,this.uint16[ei+10]=ot,this.uint16[ei+11]=_t,this.uint16[ei+12]=Ct,this.uint16[ei+13]=Xt,this.uint16[ei+14]=Zt,this.uint16[ei+15]=ar,this.uint16[ei+16]=dr,this.uint16[ei+17]=br,this.uint16[ei+18]=Nr,this.uint16[ei+19]=Rr,this.uint16[ei+20]=pn,this.uint16[ei+21]=hn,this.uint16[ei+22]=Ln,this.uint32[$i+12]=Jn,this.float32[$i+13]=Kn,this.float32[$i+14]=Nn,this.float32[$i+15]=Si,this.float32[$i+16]=li,r},t}(Wi);wl.prototype.bytesPerElement=68,In("StructArrayLayout8i15ui1ul4f68",wl);var Ku=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var l=this.length;return this.resize(l+1),this.emplace(l,r)},t.prototype.emplace=function(r,l){return this.float32[1*r+0]=l,r},t}(Wi);Ku.prototype.bytesPerElement=4,In("StructArrayLayout1f4",Ku);var Ds=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)},t.prototype.emplace=function(r,l,f,m){var A=3*r;return this.int16[A+0]=l,this.int16[A+1]=f,this.int16[A+2]=m,r},t}(Wi);Ds.prototype.bytesPerElement=6,In("StructArrayLayout3i6",Ds);var Ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)},t.prototype.emplace=function(r,l,f,m){var A=4*r;return this.uint32[2*r+0]=l,this.uint16[A+2]=f,this.uint16[A+3]=m,r},t}(Wi);Ac.prototype.bytesPerElement=8,In("StructArrayLayout1ul2ui8",Ac);var rc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l){var f=this.length;return this.resize(f+1),this.emplace(f,r,l)},t.prototype.emplace=function(r,l,f){var m=2*r;return this.uint16[m+0]=l,this.uint16[m+1]=f,r},t}(Wi);rc.prototype.bytesPerElement=4,In("StructArrayLayout2ui4",rc);var nc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var l=this.length;return this.resize(l+1),this.emplace(l,r)},t.prototype.emplace=function(r,l){return this.uint16[1*r+0]=l,r},t}(Wi);nc.prototype.bytesPerElement=2,In("StructArrayLayout1ui2",nc);var ic=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,l,f,m){var A=this.length;return this.resize(A+1),this.emplace(A,r,l,f,m)},t.prototype.emplace=function(r,l,f,m,A){var I=4*r;return this.float32[I+0]=l,this.float32[I+1]=f,this.float32[I+2]=m,this.float32[I+3]=A,r},t}(Wi);ic.prototype.bytesPerElement=16,In("StructArrayLayout4f16",ic);var u=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new re(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(ec);u.prototype.size=20;var i=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new u(this,r)},t}(bf);In("CollisionBoxArray",i);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(ec);n.prototype.size=48;var c=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(Ou);In("PlacedSymbolArray",c);var y=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(ec);y.prototype.size=68;var _=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new y(this,r)},t}(wl);In("SymbolInstanceArray",_);var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Ku);In("GlyphOffsetArray",O);var k=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Ds);In("SymbolLineVertexArray",k);var ue=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(ec);ue.prototype.size=8;var Ae=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new ue(this,r)},t}(Ac);In("FeatureIndexArray",Ae);var We=Wa([{name:"a_pos",components:2,type:"Int16"}],4).members,Je=function(t){t===void 0&&(t=[]),this.segments=t};function rt(e,t){return 256*(e=Re(Math.floor(e),0,255))+Re(Math.floor(t),0,255)}Je.prototype.prepareSegment=function(e,t,r,l){var f=this.segments[this.segments.length-1];return e>Je.MAX_VERTEX_ARRAY_LENGTH&&ze("Max vertices per segment is "+Je.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>Je.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==l)&&(f={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},l!==void 0&&(f.sortKey=l),this.segments.push(f)),f},Je.prototype.get=function(){return this.segments},Je.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var l in r.vaos)r.vaos[l].destroy()}},Je.simpleSegment=function(e,t,r,l){return new Je([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:l,vaos:{},sortKey:0}])},Je.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,In("SegmentVector",Je);var Ft=Wa([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Rt=Y(function(e){e.exports=function(t,r){var l,f,m,A,I,G,te,pe;for(f=t.length-(l=3&t.length),m=r,I=3432918353,G=461845907,pe=0;pe<f;)te=255&t.charCodeAt(pe)|(255&t.charCodeAt(++pe))<<8|(255&t.charCodeAt(++pe))<<16|(255&t.charCodeAt(++pe))<<24,++pe,m=27492+(65535&(A=5*(65535&(m=(m^=te=(65535&(te=(te=(65535&te)*I+(((te>>>16)*I&65535)<<16)&4294967295)<<15|te>>>17))*G+(((te>>>16)*G&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(te=0,l){case 3:te^=(255&t.charCodeAt(pe+2))<<16;case 2:te^=(255&t.charCodeAt(pe+1))<<8;case 1:m^=te=(65535&(te=(te=(65535&(te^=255&t.charCodeAt(pe)))*I+(((te>>>16)*I&65535)<<16)&4294967295)<<15|te>>>17))*G+(((te>>>16)*G&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),Yt=Y(function(e){e.exports=function(t,r){for(var l,f=t.length,m=r^f,A=0;f>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(A)|(255&t.charCodeAt(++A))<<8|(255&t.charCodeAt(++A))<<16|(255&t.charCodeAt(++A))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),f-=4,++A;switch(f){case 3:m^=(255&t.charCodeAt(A+2))<<16;case 2:m^=(255&t.charCodeAt(A+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(A)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),zt=Rt,Ut=Yt;zt.murmur3=Rt,zt.murmur2=Ut;var nr=function(){this.ids=[],this.positions=[],this.indexed=!1};nr.prototype.add=function(e,t,r,l){this.ids.push(Or(e)),this.positions.push(t,r,l)},nr.prototype.getPositions=function(e){for(var t=Or(e),r=0,l=this.ids.length-1;r<l;){var f=r+l>>1;this.ids[f]>=t?l=f:r=f+1}for(var m=[];this.ids[r]===t;)m.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return m},nr.serialize=function(e,t){var r=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function f(m,A,I,G){for(;I<G;){for(var te=m[I+G>>1],pe=I-1,Ce=G+1;;){do pe++;while(m[pe]<te);do Ce--;while(m[Ce]>te);if(pe>=Ce)break;hr(m,pe,Ce),hr(A,3*pe,3*Ce),hr(A,3*pe+1,3*Ce+1),hr(A,3*pe+2,3*Ce+2)}Ce-I<G-Ce?(f(m,A,I,Ce),I=Ce+1):(f(m,A,Ce+1,G),G=Ce)}}(r,l,0,r.length-1),t&&t.push(r.buffer,l.buffer),{ids:r,positions:l}},nr.deserialize=function(e){var t=new nr;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var rr=Math.pow(2,53)-1;function Or(e){var t=+e;return!isNaN(t)&&t<=rr?t:zt(String(e))}function hr(e,t,r){var l=e[t];e[t]=e[r],e[r]=l}In("FeaturePositionMap",nr);var Tr=function(t,r){this.gl=t.gl,this.location=r},Cr=function(e){function t(r,l){e.call(this,r,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Tr),an=function(e){function t(r,l){e.call(this,r,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Tr),Yr=function(e){function t(r,l){e.call(this,r,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Tr),yn=function(e){function t(r,l){e.call(this,r,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Tr),On=function(e){function t(r,l){e.call(this,r,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Tr),Qn=function(e){function t(r,l){e.call(this,r,l),this.current=ci.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Tr),oi=new Float32Array(16),xi=function(e){function t(r,l){e.call(this,r,l),this.current=oi}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var l=1;l<16;l++)if(r[l]!==this.current[l]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(Tr);function Xi(e){return[rt(255*e.r,255*e.g),rt(255*e.b,255*e.a)]}var An=function(t,r,l){this.value=t,this.uniformNames=r.map(function(f){return"u_"+f}),this.type=l};An.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},An.prototype.getBinding=function(e,t,r){return this.type==="color"?new Qn(e,t):new an(e,t)};var si=function(t,r){this.uniformNames=r.map(function(l){return"u_"+l}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};si.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},si.prototype.setUniform=function(e,t,r,l){var f=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},si.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new On(e,t):new an(e,t)};var bi=function(t,r,l,f){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=r.map(function(m){return{name:"a_"+m,type:"Float32",components:l==="color"?2:1,offset:0}}),this.paintVertexArray=new f};bi.prototype.populatePaintArray=function(e,t,r,l,f){var m=this.paintVertexArray.length,A=this.expression.evaluate(new Oi(0),t,{},l,[],f);this.paintVertexArray.resize(e),this._setPaintValue(m,e,A)},bi.prototype.updatePaintArray=function(e,t,r,l){var f=this.expression.evaluate({zoom:0},r,l);this._setPaintValue(e,t,f)},bi.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var l=Xi(r),f=e;f<t;f++)this.paintVertexArray.emplace(f,l[0],l[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},bi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},bi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Wn=function(t,r,l,f,m,A){this.expression=t,this.uniformNames=r.map(function(I){return"u_"+I+"_t"}),this.type=l,this.useIntegerZoom=f,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map(function(I){return{name:"a_"+I,type:"Float32",components:l==="color"?4:2,offset:0}}),this.paintVertexArray=new A};Wn.prototype.populatePaintArray=function(e,t,r,l,f){var m=this.expression.evaluate(new Oi(this.zoom),t,{},l,[],f),A=this.expression.evaluate(new Oi(this.zoom+1),t,{},l,[],f),I=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(I,e,m,A)},Wn.prototype.updatePaintArray=function(e,t,r,l){var f=this.expression.evaluate({zoom:this.zoom},r,l),m=this.expression.evaluate({zoom:this.zoom+1},r,l);this._setPaintValue(e,t,f,m)},Wn.prototype._setPaintValue=function(e,t,r,l){if(this.type==="color")for(var f=Xi(r),m=Xi(l),A=e;A<t;A++)this.paintVertexArray.emplace(A,f[0],f[1],m[0],m[1]);else{for(var I=e;I<t;I++)this.paintVertexArray.emplace(I,r,l);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(l))}},Wn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Wn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Wn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=Re(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(l)},Wn.prototype.getBinding=function(e,t,r){return new an(e,t)};var Ti=function(t,r,l,f,m,A){this.expression=t,this.type=r,this.useIntegerZoom=l,this.zoom=f,this.layerId=A,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m};Ti.prototype.populatePaintArray=function(e,t,r){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],r)},Ti.prototype.updatePaintArray=function(e,t,r,l,f){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],f)},Ti.prototype._setPaintValues=function(e,t,r,l){if(l&&r){var f=l[r.min],m=l[r.mid],A=l[r.max];if(f&&m&&A)for(var I=e;I<t;I++)this.zoomInPaintVertexArray.emplace(I,m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],m.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(I,m.tl[0],m.tl[1],m.br[0],m.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],m.pixelRatio,A.pixelRatio)}},Ti.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ft.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ft.members,this.expression.isStateDependent))},Ti.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ii=function(t,r,l){this.binders={},this._buffers=[];var f=[];for(var m in t.paint._values)if(l(m)){var A=t.paint.get(m);if(A instanceof Ts&&Hu(A.property.specification)){var I=ji(m,t.type),G=A.value,te=A.property.specification.type,pe=A.property.useIntegerZoom,Ce=A.property.specification["property-type"],Me=Ce==="cross-faded"||Ce==="cross-faded-data-driven";if(G.kind==="constant")this.binders[m]=Me?new si(G.value,I):new An(G.value,I,te),f.push("/u_"+m);else if(G.kind==="source"||Me){var ot=qa(m,te,"source");this.binders[m]=Me?new Ti(G,te,pe,r,ot,t.id):new bi(G,I,te,ot),f.push("/a_"+m)}else{var _t=qa(m,te,"composite");this.binders[m]=new Wn(G,I,te,pe,r,_t),f.push("/z_"+m)}}}this.cacheKey=f.sort().join("")};ii.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof bi||t instanceof Wn?t.maxValue:0},ii.prototype.populatePaintArrays=function(e,t,r,l,f){for(var m in this.binders){var A=this.binders[m];(A instanceof bi||A instanceof Wn||A instanceof Ti)&&A.populatePaintArray(e,t,r,l,f)}},ii.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var l=this.binders[r];l instanceof si&&l.setConstantPatternPositions(e,t)}},ii.prototype.updatePaintArrays=function(e,t,r,l,f){var m=!1;for(var A in e)for(var I=0,G=t.getPositions(A);I<G.length;I+=1){var te=G[I],pe=r.feature(te.index);for(var Ce in this.binders){var Me=this.binders[Ce];if((Me instanceof bi||Me instanceof Wn||Me instanceof Ti)&&Me.expression.isStateDependent===!0){var ot=l.paint.get(Ce);Me.expression=ot.value,Me.updatePaintArray(te.start,te.end,pe,e[A],f),m=!0}}}return m},ii.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof An||r instanceof si)&&e.push.apply(e,r.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},ii.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof bi||r instanceof Wn)for(var l=0;l<r.paintVertexAttributes.length;l++)e.push(r.paintVertexAttributes[l].name);else if(r instanceof Ti)for(var f=0;f<Ft.members.length;f++)e.push(Ft.members[f].name)}return e},ii.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof An||r instanceof si||r instanceof Wn)for(var l=0,f=r.uniformNames;l<f.length;l+=1)e.push(f[l])}return e},ii.prototype.getPaintVertexBuffers=function(){return this._buffers},ii.prototype.getUniforms=function(e,t){var r=[];for(var l in this.binders){var f=this.binders[l];if(f instanceof An||f instanceof si||f instanceof Wn)for(var m=0,A=f.uniformNames;m<A.length;m+=1){var I=A[m];if(t[I]){var G=f.getBinding(e,t[I],I);r.push({name:I,property:l,binding:G})}}}return r},ii.prototype.setUniforms=function(e,t,r,l){for(var f=0,m=t;f<m.length;f+=1){var A=m[f],I=A.name,G=A.property;this.binders[G].setUniform(A.binding,l,r.get(G),I)}},ii.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Ti){var l=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(r instanceof bi||r instanceof Wn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},ii.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof bi||r instanceof Wn||r instanceof Ti)&&r.upload(e)}this.updatePaintBuffers()},ii.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof bi||t instanceof Wn||t instanceof Ti)&&t.destroy()}};var Li=function(t,r,l){l===void 0&&(l=function(){return!0}),this.programConfigurations={};for(var f=0,m=t;f<m.length;f+=1){var A=m[f];this.programConfigurations[A.id]=new ii(A,r,l)}this.needsUpload=!1,this._featureMap=new nr,this._bufferOffset=0};function ji(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function qa(e,t,r){var l={color:{source:kl,composite:ic},number:{source:Ku,composite:kl}},f=function(m){return{"line-pattern":{source:gs,composite:gs},"fill-pattern":{source:gs,composite:gs},"fill-extrusion-pattern":{source:gs,composite:gs}}[m]}(e);return f&&f[r]||l[t][r]}Li.prototype.populatePaintArrays=function(e,t,r,l,f,m){for(var A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(e,t,l,f,m);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Li.prototype.updatePaintArrays=function(e,t,r,l){for(var f=0,m=r;f<m.length;f+=1){var A=m[f];this.needsUpload=this.programConfigurations[A.id].updatePaintArrays(e,this._featureMap,t,A,l)||this.needsUpload}},Li.prototype.get=function(e){return this.programConfigurations[e]},Li.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Li.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},In("ConstantBinder",An),In("CrossFadedConstantBinder",si),In("SourceExpressionBinder",bi),In("CrossFadedCompositeBinder",Ti),In("CompositeExpressionBinder",Wn),In("ProgramConfiguration",ii,{omit:["_buffers"]}),In("ProgramConfigurationSet",Li);var Ma=Math.pow(2,14)-1,So=-Ma-1;function Ta(e){for(var t=8192/e.extent,r=e.loadGeometry(),l=0;l<r.length;l++)for(var f=r[l],m=0;m<f.length;m++){var A=f[m],I=Math.round(A.x*t),G=Math.round(A.y*t);A.x=Re(I,So,Ma),A.y=Re(G,So,Ma),(I<A.x||I>A.x+1||G<A.y||G>A.y+1)&&ze("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Xa(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Ta(e):[]}}function zs(e,t,r,l,f){e.emplaceBack(2*t+(l+1)/2,2*r+(f+1)/2)}var Eo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new hl,this.indexArray=new Iu,this.segments=new Je,this.programConfigurations=new Li(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function yu(e,t){for(var r=0;r<e.length;r++)if(Ru(t,e[r]))return!0;for(var l=0;l<t.length;l++)if(Ru(e,t[l]))return!0;return!!Lu(e,t)}function xu(e,t,r){return!!Ru(e,t)||!!$u(t,e,r)}function Uo(e,t){if(e.length===1)return sc(t,e[0]);for(var r=0;r<t.length;r++)for(var l=t[r],f=0;f<l.length;f++)if(Ru(e,l[f]))return!0;for(var m=0;m<e.length;m++)if(sc(t,e[m]))return!0;for(var A=0;A<t.length;A++)if(Lu(e,t[A]))return!0;return!1}function As(e,t,r){if(e.length>1){if(Lu(e,t))return!0;for(var l=0;l<t.length;l++)if($u(t[l],e,r))return!0}for(var f=0;f<e.length;f++)if($u(e[f],t,r))return!0;return!1}function Lu(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var l=e[r],f=e[r+1],m=0;m<t.length-1;m++)if(ac(l,f,t[m],t[m+1]))return!0;return!1}function ac(e,t,r,l){return st(e,r,l)!==st(t,r,l)&&st(e,t,r)!==st(e,t,l)}function $u(e,t,r){var l=r*r;if(t.length===1)return e.distSqr(t[0])<l;for(var f=1;f<t.length;f++)if(oc(e,t[f-1],t[f])<l)return!0;return!1}function oc(e,t,r){var l=t.distSqr(r);if(l===0)return e.distSqr(t);var f=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/l;return e.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function sc(e,t){for(var r,l,f,m=!1,A=0;A<e.length;A++)for(var I=0,G=(r=e[A]).length-1;I<r.length;G=I++)(l=r[I]).y>t.y!=(f=r[G]).y>t.y&&t.x<(f.x-l.x)*(t.y-l.y)/(f.y-l.y)+l.x&&(m=!m);return m}function Ru(e,t){for(var r=!1,l=0,f=e.length-1;l<e.length;f=l++){var m=e[l],A=e[f];m.y>t.y!=A.y>t.y&&t.x<(A.x-m.x)*(t.y-m.y)/(A.y-m.y)+m.x&&(r=!r)}return r}function dl(e,t,r){var l=r[0],f=r[2];if(e.x<l.x&&t.x<l.x||e.x>f.x&&t.x>f.x||e.y<l.y&&t.y<l.y||e.y>f.y&&t.y>f.y)return!1;var m=st(e,t,r[0]);return m!==st(e,t,r[1])||m!==st(e,t,r[2])||m!==st(e,t,r[3])}function Cs(e,t,r){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:r.programConfigurations.get(t.id).getMaxValue(e)}function po(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Du(e,t,r,l,f){if(!t[0]&&!t[1])return e;var m=re.convert(t)._mult(f);r==="viewport"&&m._rotate(-l);for(var A=[],I=0;I<e.length;I++)A.push(e[I].sub(m));return A}Eo.prototype.populate=function(e,t,r){var l=this.layers[0],f=[],m=null;l.type==="circle"&&(m=l.layout.get("circle-sort-key"));for(var A=0,I=e;A<I.length;A+=1){var G=I[A],te=G.feature,pe=G.id,Ce=G.index,Me=G.sourceLayerIndex,ot=this.layers[0]._featureFilter.needGeometry,_t=Xa(te,ot);if(this.layers[0]._featureFilter.filter(new Oi(this.zoom),_t,r)){var Ct=m?m.evaluate(_t,{},r):void 0,Xt={id:pe,properties:te.properties,type:te.type,sourceLayerIndex:Me,index:Ce,geometry:ot?_t.geometry:Ta(te),patterns:{},sortKey:Ct};f.push(Xt)}}m&&f.sort(function(hn,Ln){return hn.sortKey-Ln.sortKey});for(var Zt=0,ar=f;Zt<ar.length;Zt+=1){var dr=ar[Zt],br=dr.geometry,Nr=dr.index,Rr=dr.sourceLayerIndex,pn=e[Nr].feature;this.addFeature(dr,br,Nr,r),t.featureIndex.insert(pn,br,Nr,Rr,this.index)}},Eo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Eo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Eo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Eo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,We),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Eo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Eo.prototype.addFeature=function(e,t,r,l){for(var f=0,m=t;f<m.length;f+=1)for(var A=0,I=m[f];A<I.length;A+=1){var G=I[A],te=G.x,pe=G.y;if(!(te<0||te>=8192||pe<0||pe>=8192)){var Ce=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),Me=Ce.vertexLength;zs(this.layoutVertexArray,te,pe,-1,-1),zs(this.layoutVertexArray,te,pe,1,-1),zs(this.layoutVertexArray,te,pe,1,1),zs(this.layoutVertexArray,te,pe,-1,1),this.indexArray.emplaceBack(Me,Me+1,Me+2),this.indexArray.emplaceBack(Me,Me+3,Me+2),Ce.vertexLength+=4,Ce.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},l)},In("CircleBucket",Eo,{omit:["layers"]});var bu=new Io({"circle-sort-key":new Fn(Ne.layout_circle["circle-sort-key"])}),Oo={paint:new Io({"circle-radius":new Fn(Ne.paint_circle["circle-radius"]),"circle-color":new Fn(Ne.paint_circle["circle-color"]),"circle-blur":new Fn(Ne.paint_circle["circle-blur"]),"circle-opacity":new Fn(Ne.paint_circle["circle-opacity"]),"circle-translate":new $n(Ne.paint_circle["circle-translate"]),"circle-translate-anchor":new $n(Ne.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new $n(Ne.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new $n(Ne.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Fn(Ne.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Fn(Ne.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Fn(Ne.paint_circle["circle-stroke-opacity"])}),layout:bu},Lo=typeof Float32Array!="undefined"?Float32Array:Array;function Ro(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Jo(e,t,r){var l=t[0],f=t[1],m=t[2],A=t[3],I=t[4],G=t[5],te=t[6],pe=t[7],Ce=t[8],Me=t[9],ot=t[10],_t=t[11],Ct=t[12],Xt=t[13],Zt=t[14],ar=t[15],dr=r[0],br=r[1],Nr=r[2],Rr=r[3];return e[0]=dr*l+br*I+Nr*Ce+Rr*Ct,e[1]=dr*f+br*G+Nr*Me+Rr*Xt,e[2]=dr*m+br*te+Nr*ot+Rr*Zt,e[3]=dr*A+br*pe+Nr*_t+Rr*ar,e[4]=(dr=r[4])*l+(br=r[5])*I+(Nr=r[6])*Ce+(Rr=r[7])*Ct,e[5]=dr*f+br*G+Nr*Me+Rr*Xt,e[6]=dr*m+br*te+Nr*ot+Rr*Zt,e[7]=dr*A+br*pe+Nr*_t+Rr*ar,e[8]=(dr=r[8])*l+(br=r[9])*I+(Nr=r[10])*Ce+(Rr=r[11])*Ct,e[9]=dr*f+br*G+Nr*Me+Rr*Xt,e[10]=dr*m+br*te+Nr*ot+Rr*Zt,e[11]=dr*A+br*pe+Nr*_t+Rr*ar,e[12]=(dr=r[12])*l+(br=r[13])*I+(Nr=r[14])*Ce+(Rr=r[15])*Ct,e[13]=dr*f+br*G+Nr*Me+Rr*Xt,e[14]=dr*m+br*te+Nr*ot+Rr*Zt,e[15]=dr*A+br*pe+Nr*_t+Rr*ar,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var To,Vo=Jo;function Gs(e,t,r){var l=t[0],f=t[1],m=t[2],A=t[3];return e[0]=r[0]*l+r[4]*f+r[8]*m+r[12]*A,e[1]=r[1]*l+r[5]*f+r[9]*m+r[13]*A,e[2]=r[2]*l+r[6]*f+r[10]*m+r[14]*A,e[3]=r[3]*l+r[7]*f+r[11]*m+r[15]*A,e}To=new Lo(3),Lo!=Float32Array&&(To[0]=0,To[1]=0,To[2]=0),function(){var e=new Lo(4);Lo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Pl=(function(){var e=new Lo(2);Lo!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,Oo)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Eo(r)},t.prototype.queryRadius=function(r){var l=r;return Cs("circle-radius",this,l)+Cs("circle-stroke-width",this,l)+po(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,l,f,m,A,I,G,te){for(var pe=Du(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),I.angle,G),Ce=this.paint.get("circle-radius").evaluate(l,f)+this.paint.get("circle-stroke-width").evaluate(l,f),Me=this.paint.get("circle-pitch-alignment")==="map",ot=Me?pe:function(pn,hn){return pn.map(function(Ln){return Uc(Ln,hn)})}(pe,te),_t=Me?Ce*G:Ce,Ct=0,Xt=m;Ct<Xt.length;Ct+=1)for(var Zt=0,ar=Xt[Ct];Zt<ar.length;Zt+=1){var dr=ar[Zt],br=Me?dr:Uc(dr,te),Nr=_t,Rr=Gs([],[dr.x,dr.y,0,1],te);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Nr*=Rr[3]/I.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Nr*=I.cameraToCenterDistance/Rr[3]),xu(ot,br,Nr))return!0}return!1},t}(nu));function Uc(e,t){var r=Gs([],[e.x,e.y,0,1],t);return new re(r[0]/r[3],r[1]/r[3])}var Vl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Eo);function Ju(e,t,r,l){var f=t.width,m=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==f*m*r)throw new RangeError("mismatched image size")}else l=new Uint8Array(f*m*r);return e.width=f,e.height=m,e.data=l,e}function zu(e,t,r){var l=t.width,f=t.height;if(l!==e.width||f!==e.height){var m=Ju({},{width:l,height:f},r);Nu(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,f)},r),e.width=l,e.height=f,e.data=m.data}}function Nu(e,t,r,l,f,m){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||r.x>e.width-f.width||r.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||l.x>t.width-f.width||l.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var A=e.data,I=t.data,G=0;G<f.height;G++)for(var te=((r.y+G)*e.width+r.x)*m,pe=((l.y+G)*t.width+l.x)*m,Ce=0;Ce<f.width*m;Ce++)I[pe+Ce]=A[te+Ce];return t}In("HeatmapBucket",Vl,{omit:["layers"]});var Hs=function(t,r){Ju(this,t,1,r)};Hs.prototype.resize=function(e){zu(this,e,1)},Hs.prototype.clone=function(){return new Hs({width:this.width,height:this.height},new Uint8Array(this.data))},Hs.copy=function(e,t,r,l,f){Nu(e,t,r,l,f,1)};var Do=function(t,r){Ju(this,t,4,r)};Do.prototype.resize=function(e){zu(this,e,4)},Do.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Do.prototype.clone=function(){return new Do({width:this.width,height:this.height},new Uint8Array(this.data))},Do.copy=function(e,t,r,l,f){Nu(e,t,r,l,f,4)},In("AlphaImage",Hs),In("RGBAImage",Do);var Vc={paint:new Io({"heatmap-radius":new Fn(Ne.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Fn(Ne.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new $n(Ne.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jo(Ne.paint_heatmap["heatmap-color"]),"heatmap-opacity":new $n(Ne.paint_heatmap["heatmap-opacity"])})};function ys(e){var t={},r=e.resolution||256,l=e.clips?e.clips.length:1,f=e.image||new Do({width:r,height:l}),m=function(Ct,Xt,Zt){t[e.evaluationKey]=Zt;var ar=e.expression.evaluate(t);f.data[Ct+Xt+0]=Math.floor(255*ar.r/ar.a),f.data[Ct+Xt+1]=Math.floor(255*ar.g/ar.a),f.data[Ct+Xt+2]=Math.floor(255*ar.b/ar.a),f.data[Ct+Xt+3]=Math.floor(255*ar.a)};if(e.clips)for(var A=0,I=0;A<l;++A,I+=4*r)for(var G=0,te=0;G<r;G++,te+=4){var pe=G/(r-1),Ce=e.clips[A];m(I,te,Ce.start*(1-pe)+Ce.end*pe)}else for(var Me=0,ot=0;Me<r;Me++,ot+=4)m(0,ot,Me/(r-1));return f}var of=function(e){function t(r){e.call(this,r,Vc),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Vl(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=ys({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(nu),Lf={paint:new Io({"hillshade-illumination-direction":new $n(Ne.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new $n(Ne.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new $n(Ne.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new $n(Ne.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new $n(Ne.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new $n(Ne.paint_hillshade["hillshade-accent-color"])})},Rf=function(e){function t(r){e.call(this,r,Lf)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(nu),Uf=Wa([{name:"a_pos",components:2,type:"Int16"}],4).members,Qu=sf,Sf=sf;function sf(e,t,r){r=r||2;var l,f,m,A,I,G,te,pe=t&&t.length,Ce=pe?t[0]*r:e.length,Me=uc(e,0,Ce,r,!0),ot=[];if(!Me||Me.next===Me.prev)return ot;if(pe&&(Me=function(Ct,Xt,Zt,ar){var dr,br,Nr,Rr=[];for(dr=0,br=Xt.length;dr<br;dr++)(Nr=uc(Ct,Xt[dr]*ar,dr<br-1?Xt[dr+1]*ar:Ct.length,ar,!1))===Nr.next&&(Nr.steiner=!0),Rr.push(ch(Nr));for(Rr.sort(Hf),dr=0;dr<Rr.length;dr++)ah(Rr[dr],Zt),Zt=Fu(Zt,Zt.next);return Zt}(e,t,Me,r)),e.length>80*r){l=m=e[0],f=A=e[1];for(var _t=r;_t<Ce;_t+=r)(I=e[_t])<l&&(l=I),(G=e[_t+1])<f&&(f=G),I>m&&(m=I),G>A&&(A=G);te=(te=Math.max(m-l,A-f))!==0?1/te:0}return lc(Me,ot,r,l,f,te),ot}function uc(e,t,r,l,f){var m,A;if(f===Zc(e,t,r,l)>0)for(m=t;m<r;m+=l)A=Tf(m,e[m],e[m+1],A);else for(m=r-l;m>=t;m-=l)A=Tf(m,e[m],e[m+1],A);return A&&Gl(A,A.next)&&(Hc(A),A=A.next),A}function Fu(e,t){if(!e)return e;t||(t=e);var r,l=e;do if(r=!1,l.steiner||!Gl(l,l.next)&&so(l.prev,l,l.next)!==0)l=l.next;else{if(Hc(l),(l=t=l.prev)===l.next)break;r=!0}while(r||l!==t);return t}function lc(e,t,r,l,f,m,A){if(e){!A&&m&&function(pe,Ce,Me,ot){var _t=pe;do _t.z===null&&(_t.z=Df(_t.x,_t.y,Ce,Me,ot)),_t.prevZ=_t.prev,_t.nextZ=_t.next,_t=_t.next;while(_t!==pe);_t.prevZ.nextZ=null,_t.prevZ=null,function(Ct){var Xt,Zt,ar,dr,br,Nr,Rr,pn,hn=1;do{for(Zt=Ct,Ct=null,br=null,Nr=0;Zt;){for(Nr++,ar=Zt,Rr=0,Xt=0;Xt<hn&&(Rr++,ar=ar.nextZ);Xt++);for(pn=hn;Rr>0||pn>0&&ar;)Rr!==0&&(pn===0||!ar||Zt.z<=ar.z)?(dr=Zt,Zt=Zt.nextZ,Rr--):(dr=ar,ar=ar.nextZ,pn--),br?br.nextZ=dr:Ct=dr,dr.prevZ=br,br=dr;Zt=ar}br.nextZ=null,hn*=2}while(Nr>1)}(_t)}(e,l,f,m);for(var I,G,te=e;e.prev!==e.next;)if(I=e.prev,G=e.next,m?Cc(e,l,f,m):Vf(e))t.push(I.i/r),t.push(e.i/r),t.push(G.i/r),Hc(e),e=G.next,te=G.next;else if((e=G)===te){A?A===1?lc(e=wc(Fu(e),t,r),t,r,l,f,m,2):A===2&&Gf(e,t,r,l,f,m):lc(Fu(e),t,r,l,f,m,1);break}}}function Vf(e){var t=e.prev,r=e,l=e.next;if(so(t,r,l)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(cc(t.x,t.y,r.x,r.y,l.x,l.y,f.x,f.y)&&so(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Cc(e,t,r,l){var f=e.prev,m=e,A=e.next;if(so(f,m,A)>=0)return!1;for(var I=f.x>m.x?f.x>A.x?f.x:A.x:m.x>A.x?m.x:A.x,G=f.y>m.y?f.y>A.y?f.y:A.y:m.y>A.y?m.y:A.y,te=Df(f.x<m.x?f.x<A.x?f.x:A.x:m.x<A.x?m.x:A.x,f.y<m.y?f.y<A.y?f.y:A.y:m.y<A.y?m.y:A.y,t,r,l),pe=Df(I,G,t,r,l),Ce=e.prevZ,Me=e.nextZ;Ce&&Ce.z>=te&&Me&&Me.z<=pe;){if(Ce!==e.prev&&Ce!==e.next&&cc(f.x,f.y,m.x,m.y,A.x,A.y,Ce.x,Ce.y)&&so(Ce.prev,Ce,Ce.next)>=0||(Ce=Ce.prevZ,Me!==e.prev&&Me!==e.next&&cc(f.x,f.y,m.x,m.y,A.x,A.y,Me.x,Me.y)&&so(Me.prev,Me,Me.next)>=0))return!1;Me=Me.nextZ}for(;Ce&&Ce.z>=te;){if(Ce!==e.prev&&Ce!==e.next&&cc(f.x,f.y,m.x,m.y,A.x,A.y,Ce.x,Ce.y)&&so(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.prevZ}for(;Me&&Me.z<=pe;){if(Me!==e.prev&&Me!==e.next&&cc(f.x,f.y,m.x,m.y,A.x,A.y,Me.x,Me.y)&&so(Me.prev,Me,Me.next)>=0)return!1;Me=Me.nextZ}return!0}function wc(e,t,r){var l=e;do{var f=l.prev,m=l.next.next;!Gl(f,m)&&lf(f,l,l.next,m)&&_l(f,m)&&_l(m,f)&&(t.push(f.i/r),t.push(l.i/r),t.push(m.i/r),Hc(l),Hc(l.next),l=e=m),l=l.next}while(l!==e);return Fu(l)}function Gf(e,t,r,l,f,m){var A=e;do{for(var I=A.next.next;I!==A.prev;){if(A.i!==I.i&&uf(A,I)){var G=Ef(A,I);return A=Fu(A,A.next),G=Fu(G,G.next),lc(A,t,r,l,f,m),void lc(G,t,r,l,f,m)}I=I.next}A=A.next}while(A!==e)}function Hf(e,t){return e.x-t.x}function ah(e,t){if(t=function(l,f){var m,A=f,I=l.x,G=l.y,te=-1/0;do{if(G<=A.y&&G>=A.next.y&&A.next.y!==A.y){var pe=A.x+(G-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(pe<=I&&pe>te){if(te=pe,pe===I){if(G===A.y)return A;if(G===A.next.y)return A.next}m=A.x<A.next.x?A:A.next}}A=A.next}while(A!==f);if(!m)return null;if(I===te)return m;var Ce,Me=m,ot=m.x,_t=m.y,Ct=1/0;A=m;do I>=A.x&&A.x>=ot&&I!==A.x&&cc(G<_t?I:te,G,ot,_t,G<_t?te:I,G,A.x,A.y)&&(Ce=Math.abs(G-A.y)/(I-A.x),_l(A,l)&&(Ce<Ct||Ce===Ct&&(A.x>m.x||A.x===m.x&&Zf(m,A)))&&(m=A,Ct=Ce)),A=A.next;while(A!==Me);return m}(e,t)){var r=Ef(t,e);Fu(t,t.next),Fu(r,r.next)}}function Zf(e,t){return so(e.prev,e,t.prev)<0&&so(t.next,e,e.next)<0}function Df(e,t,r,l,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ch(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function cc(e,t,r,l,f,m,A,I){return(f-A)*(t-I)-(e-A)*(m-I)>=0&&(e-A)*(l-I)-(r-A)*(t-I)>=0&&(r-A)*(m-I)-(f-A)*(l-I)>=0}function uf(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,l){var f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==l.i&&f.next.i!==l.i&&lf(f,f.next,r,l))return!0;f=f.next}while(f!==r);return!1}(e,t)&&(_l(e,t)&&_l(t,e)&&function(r,l){var f=r,m=!1,A=(r.x+l.x)/2,I=(r.y+l.y)/2;do f.y>I!=f.next.y>I&&f.next.y!==f.y&&A<(f.next.x-f.x)*(I-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==r);return m}(e,t)&&(so(e.prev,e,t.prev)||so(e,t.prev,t))||Gl(e,t)&&so(e.prev,e,e.next)>0&&so(t.prev,t,t.next)>0)}function so(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Gl(e,t){return e.x===t.x&&e.y===t.y}function lf(e,t,r,l){var f=iu(so(e,t,r)),m=iu(so(e,t,l)),A=iu(so(r,l,e)),I=iu(so(r,l,t));return f!==m&&A!==I||!(f!==0||!Gc(e,r,t))||!(m!==0||!Gc(e,l,t))||!(A!==0||!Gc(r,e,l))||!(I!==0||!Gc(r,t,l))}function Gc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function iu(e){return e>0?1:e<0?-1:0}function _l(e,t){return so(e.prev,e,e.next)<0?so(e,t,e.next)>=0&&so(e,e.prev,t)>=0:so(e,t,e.prev)<0||so(e,e.next,t)<0}function Ef(e,t){var r=new cf(e.i,e.x,e.y),l=new cf(t.i,t.x,t.y),f=e.next,m=t.prev;return e.next=t,t.prev=e,r.next=f,f.prev=r,l.next=r,r.prev=l,m.next=l,l.prev=m,l}function Tf(e,t,r,l){var f=new cf(e,t,r);return l?(f.next=l.next,f.prev=l,l.next.prev=f,l.next=f):(f.prev=f,f.next=f),f}function Hc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function cf(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Zc(e,t,r,l){for(var f=0,m=t,A=r-l;m<r;m+=l)f+=(e[A]-e[m])*(e[m+1]+e[A+1]),A=m;return f}function Hl(e,t,r,l,f){(function m(A,I,G,te,pe){for(;te>G;){if(te-G>600){var Ce=te-G+1,Me=I-G+1,ot=Math.log(Ce),_t=.5*Math.exp(2*ot/3),Ct=.5*Math.sqrt(ot*_t*(Ce-_t)/Ce)*(Me-Ce/2<0?-1:1);m(A,I,Math.max(G,Math.floor(I-Me*_t/Ce+Ct)),Math.min(te,Math.floor(I+(Ce-Me)*_t/Ce+Ct)),pe)}var Xt=A[I],Zt=G,ar=te;for(ne(A,G,I),pe(A[te],Xt)>0&&ne(A,G,te);Zt<ar;){for(ne(A,Zt,ar),Zt++,ar--;pe(A[Zt],Xt)<0;)Zt++;for(;pe(A[ar],Xt)>0;)ar--}pe(A[G],Xt)===0?ne(A,G,ar):ne(A,++ar,te),ar<=I&&(G=ar+1),I<=ar&&(te=ar-1)}})(e,t,r||0,l||e.length-1,f||oe)}function ne(e,t,r){var l=e[t];e[t]=e[r],e[r]=l}function oe(e,t){return e<t?-1:e>t?1:0}function D(e,t){var r=e.length;if(r<=1)return[e];for(var l,f,m=[],A=0;A<r;A++){var I=Wt(e[A]);I!==0&&(e[A].area=Math.abs(I),f===void 0&&(f=I<0),f===I<0?(l&&m.push(l),l=[e[A]]):l.push(e[A]))}if(l&&m.push(l),t>1)for(var G=0;G<m.length;G++)m[G].length<=t||(Hl(m[G],t,1,m[G].length-1,U),m[G]=m[G].slice(0,t));return m}function U(e,t){return t.area-e.area}function Ee(e,t,r){for(var l=r.patternDependencies,f=!1,m=0,A=t;m<A.length;m+=1){var I=A[m].paint.get(e+"-pattern");I.isConstant()||(f=!0);var G=I.constantOr(null);G&&(f=!0,l[G.to]=!0,l[G.from]=!0)}return f}function tt(e,t,r,l,f){for(var m=f.patternDependencies,A=0,I=t;A<I.length;A+=1){var G=I[A],te=G.paint.get(e+"-pattern").value;if(te.kind!=="constant"){var pe=te.evaluate({zoom:l-1},r,{},f.availableImages),Ce=te.evaluate({zoom:l},r,{},f.availableImages),Me=te.evaluate({zoom:l+1},r,{},f.availableImages);Ce=Ce&&Ce.name?Ce.name:Ce,Me=Me&&Me.name?Me.name:Me,m[pe=pe&&pe.name?pe.name:pe]=!0,m[Ce]=!0,m[Me]=!0,r.patterns[G.id]={min:pe,mid:Ce,max:Me}}}return r}sf.deviation=function(e,t,r,l){var f=t&&t.length,m=Math.abs(Zc(e,0,f?t[0]*r:e.length,r));if(f)for(var A=0,I=t.length;A<I;A++)m-=Math.abs(Zc(e,t[A]*r,A<I-1?t[A+1]*r:e.length,r));var G=0;for(A=0;A<l.length;A+=3){var te=l[A]*r,pe=l[A+1]*r,Ce=l[A+2]*r;G+=Math.abs((e[te]-e[Ce])*(e[pe+1]-e[te+1])-(e[te]-e[pe])*(e[Ce+1]-e[te+1]))}return m===0&&G===0?0:Math.abs((G-m)/m)},sf.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},l=0,f=0;f<e.length;f++){for(var m=0;m<e[f].length;m++)for(var A=0;A<t;A++)r.vertices.push(e[f][m][A]);f>0&&r.holes.push(l+=e[f-1].length)}return r},Qu.default=Sf;var Gt=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new hl,this.indexArray=new Iu,this.indexArray2=new rc,this.programConfigurations=new Li(t.layers,t.zoom),this.segments=new Je,this.segments2=new Je,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Gt.prototype.populate=function(e,t,r){this.hasPattern=Ee("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),f=[],m=0,A=e;m<A.length;m+=1){var I=A[m],G=I.feature,te=I.id,pe=I.index,Ce=I.sourceLayerIndex,Me=this.layers[0]._featureFilter.needGeometry,ot=Xa(G,Me);if(this.layers[0]._featureFilter.filter(new Oi(this.zoom),ot,r)){var _t=l?l.evaluate(ot,{},r,t.availableImages):void 0,Ct={id:te,properties:G.properties,type:G.type,sourceLayerIndex:Ce,index:pe,geometry:Me?ot.geometry:Ta(G),patterns:{},sortKey:_t};f.push(Ct)}}l&&f.sort(function(pn,hn){return pn.sortKey-hn.sortKey});for(var Xt=0,Zt=f;Xt<Zt.length;Xt+=1){var ar=Zt[Xt],dr=ar.geometry,br=ar.index,Nr=ar.sourceLayerIndex;if(this.hasPattern){var Rr=tt("fill",this.layers,ar,this.zoom,t);this.patternFeatures.push(Rr)}else this.addFeature(ar,dr,br,r,{});t.featureIndex.insert(e[br].feature,dr,br,Nr,this.index)}},Gt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Gt.prototype.addFeatures=function(e,t,r){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,r)}},Gt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Gt.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Gt.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Uf),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Gt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Gt.prototype.addFeature=function(e,t,r,l,f){for(var m=0,A=D(t,500);m<A.length;m+=1){for(var I=A[m],G=0,te=0,pe=I;te<pe.length;te+=1)G+=pe[te].length;for(var Ce=this.segments.prepareSegment(G,this.layoutVertexArray,this.indexArray),Me=Ce.vertexLength,ot=[],_t=[],Ct=0,Xt=I;Ct<Xt.length;Ct+=1){var Zt=Xt[Ct];if(Zt.length!==0){Zt!==I[0]&&_t.push(ot.length/2);var ar=this.segments2.prepareSegment(Zt.length,this.layoutVertexArray,this.indexArray2),dr=ar.vertexLength;this.layoutVertexArray.emplaceBack(Zt[0].x,Zt[0].y),this.indexArray2.emplaceBack(dr+Zt.length-1,dr),ot.push(Zt[0].x),ot.push(Zt[0].y);for(var br=1;br<Zt.length;br++)this.layoutVertexArray.emplaceBack(Zt[br].x,Zt[br].y),this.indexArray2.emplaceBack(dr+br-1,dr+br),ot.push(Zt[br].x),ot.push(Zt[br].y);ar.vertexLength+=Zt.length,ar.primitiveLength+=Zt.length}}for(var Nr=Qu(ot,_t),Rr=0;Rr<Nr.length;Rr+=3)this.indexArray.emplaceBack(Me+Nr[Rr],Me+Nr[Rr+1],Me+Nr[Rr+2]);Ce.vertexLength+=G,Ce.primitiveLength+=Nr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,l)},In("FillBucket",Gt,{omit:["layers","patternFeatures"]});var tr=new Io({"fill-sort-key":new Fn(Ne.layout_fill["fill-sort-key"])}),er={paint:new Io({"fill-antialias":new $n(Ne.paint_fill["fill-antialias"]),"fill-opacity":new Fn(Ne.paint_fill["fill-opacity"]),"fill-color":new Fn(Ne.paint_fill["fill-color"]),"fill-outline-color":new Fn(Ne.paint_fill["fill-outline-color"]),"fill-translate":new $n(Ne.paint_fill["fill-translate"]),"fill-translate-anchor":new $n(Ne.paint_fill["fill-translate-anchor"]),"fill-pattern":new Tc(Ne.paint_fill["fill-pattern"])}),layout:tr},Pr=function(e){function t(r){e.call(this,r,er)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,l){e.prototype.recalculate.call(this,r,l);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Gt(r)},t.prototype.queryRadius=function(){return po(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,l,f,m,A,I,G){return Uo(Du(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),I.angle,G),m)},t.prototype.isTileClipped=function(){return!0},t}(nu),Jr=Wa([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Rn=Xn;function Xn(e,t,r,l,f){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=f,e.readFields(ri,this,t)}function ri(e,t,r){e==1?t.id=r.readVarint():e==2?function(l,f){for(var m=l.readVarint()+l.pos;l.pos<m;){var A=f._keys[l.readVarint()],I=f._values[l.readVarint()];f.properties[A]=I}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function wi(e){for(var t,r,l=0,f=0,m=e.length,A=m-1;f<m;A=f++)l+=((r=e[A]).x-(t=e[f]).x)*(t.y+r.y);return l}Xn.types=["Unknown","Point","LineString","Polygon"],Xn.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,l=1,f=0,m=0,A=0,I=[];e.pos<r;){if(f<=0){var G=e.readVarint();l=7&G,f=G>>3}if(f--,l===1||l===2)m+=e.readSVarint(),A+=e.readSVarint(),l===1&&(t&&I.push(t),t=[]),t.push(new re(m,A));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&I.push(t),I},Xn.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,l=0,f=0,m=0,A=1/0,I=-1/0,G=1/0,te=-1/0;e.pos<t;){if(l<=0){var pe=e.readVarint();r=7&pe,l=pe>>3}if(l--,r===1||r===2)(f+=e.readSVarint())<A&&(A=f),f>I&&(I=f),(m+=e.readSVarint())<G&&(G=m),m>te&&(te=m);else if(r!==7)throw new Error("unknown command "+r)}return[A,G,I,te]},Xn.prototype.toGeoJSON=function(e,t,r){var l,f,m=this.extent*Math.pow(2,r),A=this.extent*e,I=this.extent*t,G=this.loadGeometry(),te=Xn.types[this.type];function pe(ot){for(var _t=0;_t<ot.length;_t++){var Ct=ot[_t];ot[_t]=[360*(Ct.x+A)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ct.y+I)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var Ce=[];for(l=0;l<G.length;l++)Ce[l]=G[l][0];pe(G=Ce);break;case 2:for(l=0;l<G.length;l++)pe(G[l]);break;case 3:for(G=function(ot){var _t=ot.length;if(_t<=1)return[ot];for(var Ct,Xt,Zt=[],ar=0;ar<_t;ar++){var dr=wi(ot[ar]);dr!==0&&(Xt===void 0&&(Xt=dr<0),Xt===dr<0?(Ct&&Zt.push(Ct),Ct=[ot[ar]]):Ct.push(ot[ar]))}return Ct&&Zt.push(Ct),Zt}(G),l=0;l<G.length;l++)for(f=0;f<G[l].length;f++)pe(G[l][f])}G.length===1?G=G[0]:te="Multi"+te;var Me={type:"Feature",geometry:{type:te,coordinates:G},properties:this.properties};return"id"in this&&(Me.id=this.id),Me};var Pi=ia;function ia(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(ra,this,t),this.length=this._features.length}function ra(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(l){for(var f=null,m=l.readVarint()+l.pos;l.pos<m;){var A=l.readVarint()>>3;f=A===1?l.readString():A===2?l.readFloat():A===3?l.readDouble():A===4?l.readVarint64():A===5?l.readVarint():A===6?l.readSVarint():A===7?l.readBoolean():null}return f}(r))}function Ia(e,t,r){if(e===3){var l=new Pi(r,r.readVarint()+r.pos);l.length&&(t[l.name]=l)}}ia.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Rn(this._pbf,t,this.extent,this._keys,this._values)};var uo={VectorTile:function(t,r){this.layers=t.readFields(Ia,{},r)},VectorTileFeature:Rn,VectorTileLayer:Pi},eo=uo.VectorTileFeature.types,Na=Math.pow(2,13);function vo(e,t,r,l,f,m,A,I){e.emplaceBack(t,r,2*Math.floor(l*Na)+A,f*Na*2,m*Na*2,Math.round(I))}var Fi=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Mu,this.indexArray=new Iu,this.programConfigurations=new Li(t.layers,t.zoom),this.segments=new Je,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function to(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Fi.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Ee("fill-extrusion",this.layers,t);for(var l=0,f=e;l<f.length;l+=1){var m=f[l],A=m.feature,I=m.id,G=m.index,te=m.sourceLayerIndex,pe=this.layers[0]._featureFilter.needGeometry,Ce=Xa(A,pe);if(this.layers[0]._featureFilter.filter(new Oi(this.zoom),Ce,r)){var Me={id:I,sourceLayerIndex:te,index:G,geometry:pe?Ce.geometry:Ta(A),properties:A.properties,type:A.type,patterns:{}};this.hasPattern?this.features.push(tt("fill-extrusion",this.layers,Me,this.zoom,t)):this.addFeature(Me,Me.geometry,G,r,{}),t.featureIndex.insert(A,Me.geometry,G,te,this.index,!0)}}},Fi.prototype.addFeatures=function(e,t,r){for(var l=0,f=this.features;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,r)}},Fi.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Fi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Fi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Fi.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jr),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Fi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Fi.prototype.addFeature=function(e,t,r,l,f){for(var m=0,A=D(t,500);m<A.length;m+=1){for(var I=A[m],G=0,te=0,pe=I;te<pe.length;te+=1)G+=pe[te].length;for(var Ce=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Me=0,ot=I;Me<ot.length;Me+=1){var _t=ot[Me];if(_t.length!==0&&!(($i=_t).every(function(Di){return Di.x<0})||$i.every(function(Di){return Di.x>8192})||$i.every(function(Di){return Di.y<0})||$i.every(function(Di){return Di.y>8192})))for(var Ct=0,Xt=0;Xt<_t.length;Xt++){var Zt=_t[Xt];if(Xt>=1){var ar=_t[Xt-1];if(!to(Zt,ar)){Ce.vertexLength+4>Je.MAX_VERTEX_ARRAY_LENGTH&&(Ce=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var dr=Zt.sub(ar)._perp()._unit(),br=ar.dist(Zt);Ct+br>32768&&(Ct=0),vo(this.layoutVertexArray,Zt.x,Zt.y,dr.x,dr.y,0,0,Ct),vo(this.layoutVertexArray,Zt.x,Zt.y,dr.x,dr.y,0,1,Ct),vo(this.layoutVertexArray,ar.x,ar.y,dr.x,dr.y,0,0,Ct+=br),vo(this.layoutVertexArray,ar.x,ar.y,dr.x,dr.y,0,1,Ct);var Nr=Ce.vertexLength;this.indexArray.emplaceBack(Nr,Nr+2,Nr+1),this.indexArray.emplaceBack(Nr+1,Nr+2,Nr+3),Ce.vertexLength+=4,Ce.primitiveLength+=2}}}}if(Ce.vertexLength+G>Je.MAX_VERTEX_ARRAY_LENGTH&&(Ce=this.segments.prepareSegment(G,this.layoutVertexArray,this.indexArray)),eo[e.type]==="Polygon"){for(var Rr=[],pn=[],hn=Ce.vertexLength,Ln=0,Jn=I;Ln<Jn.length;Ln+=1){var Kn=Jn[Ln];if(Kn.length!==0){Kn!==I[0]&&pn.push(Rr.length/2);for(var Nn=0;Nn<Kn.length;Nn++){var Si=Kn[Nn];vo(this.layoutVertexArray,Si.x,Si.y,0,0,1,1,0),Rr.push(Si.x),Rr.push(Si.y)}}}for(var li=Qu(Rr,pn),ei=0;ei<li.length;ei+=3)this.indexArray.emplaceBack(hn+li[ei],hn+li[ei+2],hn+li[ei+1]);Ce.primitiveLength+=li.length/3,Ce.vertexLength+=G}}var $i;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,l)},In("FillExtrusionBucket",Fi,{omit:["layers","features"]});var us={paint:new Io({"fill-extrusion-opacity":new $n(Ne["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Fn(Ne["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new $n(Ne["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new $n(Ne["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Tc(Ne["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Fn(Ne["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Fn(Ne["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new $n(Ne["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},va=function(e){function t(r){e.call(this,r,us)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Fi(r)},t.prototype.queryRadius=function(){return po(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,l,f,m,A,I,G,te){var pe=Du(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),I.angle,G),Ce=this.paint.get("fill-extrusion-height").evaluate(l,f),Me=this.paint.get("fill-extrusion-base").evaluate(l,f),ot=function(Ct,Xt,Zt,ar){for(var dr=[],br=0,Nr=Ct;br<Nr.length;br+=1){var Rr=Nr[br],pn=[Rr.x,Rr.y,0,1];Gs(pn,pn,Xt),dr.push(new re(pn[0]/pn[3],pn[1]/pn[3]))}return dr}(pe,te),_t=function(Ct,Xt,Zt,ar){for(var dr=[],br=[],Nr=ar[8]*Xt,Rr=ar[9]*Xt,pn=ar[10]*Xt,hn=ar[11]*Xt,Ln=ar[8]*Zt,Jn=ar[9]*Zt,Kn=ar[10]*Zt,Nn=ar[11]*Zt,Si=0,li=Ct;Si<li.length;Si+=1){for(var ei=[],$i=[],Di=0,Ga=li[Si];Di<Ga.length;Di+=1){var gi=Ga[Di],aa=gi.x,Zo=gi.y,Sa=ar[0]*aa+ar[4]*Zo+ar[12],Wo=ar[1]*aa+ar[5]*Zo+ar[13],Xo=ar[2]*aa+ar[6]*Zo+ar[14],cs=ar[3]*aa+ar[7]*Zo+ar[15],Eu=Xo+pn,fs=cs+hn,el=Sa+Ln,ou=Wo+Jn,tl=Xo+Kn,su=cs+Nn,Xs=new re((Sa+Nr)/fs,(Wo+Rr)/fs);Xs.z=Eu/fs,ei.push(Xs);var uu=new re(el/su,ou/su);uu.z=tl/su,$i.push(uu)}dr.push(ei),br.push($i)}return[dr,br]}(m,Me,Ce,te);return function(Ct,Xt,Zt){var ar=1/0;Uo(Zt,Xt)&&(ar=mi(Zt,Xt[0]));for(var dr=0;dr<Xt.length;dr++)for(var br=Xt[dr],Nr=Ct[dr],Rr=0;Rr<br.length-1;Rr++){var pn=br[Rr],hn=[pn,br[Rr+1],Nr[Rr+1],Nr[Rr],pn];yu(Zt,hn)&&(ar=Math.min(ar,mi(Zt,hn)))}return ar!==1/0&&ar}(_t[0],_t[1],ot)},t}(nu);function Aa(e,t){return e.x*t.x+e.y*t.y}function mi(e,t){if(e.length===1){for(var r,l=0,f=t[l++];!r||f.equals(r);)if(!(r=t[l++]))return 1/0;for(;l<t.length;l++){var m=t[l],A=e[0],I=r.sub(f),G=m.sub(f),te=A.sub(f),pe=Aa(I,I),Ce=Aa(I,G),Me=Aa(G,G),ot=Aa(te,I),_t=Aa(te,G),Ct=pe*Me-Ce*Ce,Xt=(Me*ot-Ce*_t)/Ct,Zt=(pe*_t-Ce*ot)/Ct,ar=f.z*(1-Xt-Zt)+r.z*Xt+m.z*Zt;if(isFinite(ar))return ar}return 1/0}for(var dr=1/0,br=0,Nr=t;br<Nr.length;br+=1)dr=Math.min(dr,Nr[br].z);return dr}var zo=Wa([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,fc=Wa([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Wf=uo.VectorTileFeature.types,fh=Math.cos(Math.PI/180*37.5),Xf=Math.pow(2,14)/.5,Bu=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(l){r.gradients[l.id]={}}),this.layoutVertexArray=new Rs,this.layoutVertexArray2=new kl,this.indexArray=new Iu,this.programConfigurations=new Li(t.layers,t.zoom),this.segments=new Je,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};Bu.prototype.populate=function(e,t,r){this.hasPattern=Ee("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),f=[],m=0,A=e;m<A.length;m+=1){var I=A[m],G=I.feature,te=I.id,pe=I.index,Ce=I.sourceLayerIndex,Me=this.layers[0]._featureFilter.needGeometry,ot=Xa(G,Me);if(this.layers[0]._featureFilter.filter(new Oi(this.zoom),ot,r)){var _t=l?l.evaluate(ot,{},r):void 0,Ct={id:te,properties:G.properties,type:G.type,sourceLayerIndex:Ce,index:pe,geometry:Me?ot.geometry:Ta(G),patterns:{},sortKey:_t};f.push(Ct)}}l&&f.sort(function(pn,hn){return pn.sortKey-hn.sortKey});for(var Xt=0,Zt=f;Xt<Zt.length;Xt+=1){var ar=Zt[Xt],dr=ar.geometry,br=ar.index,Nr=ar.sourceLayerIndex;if(this.hasPattern){var Rr=tt("line",this.layers,ar,this.zoom,t);this.patternFeatures.push(Rr)}else this.addFeature(ar,dr,br,r,{});t.featureIndex.insert(e[br].feature,dr,br,Nr,this.index)}},Bu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Bu.prototype.addFeatures=function(e,t,r){for(var l=0,f=this.patternFeatures;l<f.length;l+=1){var m=f[l];this.addFeature(m,m.geometry,m.index,t,r)}},Bu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Bu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Bu.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,fc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Bu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Bu.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Bu.prototype.addFeature=function(e,t,r,l,f){var m=this.layers[0].layout,A=m.get("line-join").evaluate(e,{}),I=m.get("line-cap"),G=m.get("line-miter-limit"),te=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var pe=0,Ce=t;pe<Ce.length;pe+=1)this.addLine(Ce[pe],e,A,I,G,te);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,l)},Bu.prototype.addLine=function(e,t,r,l,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var A=0;A<e.length-1;A++)this.totalDistance+=e[A].dist(e[A+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var I=Wf[t.type]==="Polygon",G=e.length;G>=2&&e[G-1].equals(e[G-2]);)G--;for(var te=0;te<G-1&&e[te].equals(e[te+1]);)te++;if(!(G<(I?3:2))){r==="bevel"&&(f=1.05);var pe,Ce=this.overscaling<=16?122880/(512*this.overscaling):0,Me=this.segments.prepareSegment(10*G,this.layoutVertexArray,this.indexArray),ot=void 0,_t=void 0,Ct=void 0,Xt=void 0;this.e1=this.e2=-1,I&&(Xt=e[te].sub(pe=e[G-2])._unit()._perp());for(var Zt=te;Zt<G;Zt++)if(!(_t=Zt===G-1?I?e[te+1]:void 0:e[Zt+1])||!e[Zt].equals(_t)){Xt&&(Ct=Xt),pe&&(ot=pe),pe=e[Zt],Xt=_t?_t.sub(pe)._unit()._perp():Ct;var ar=(Ct=Ct||Xt).add(Xt);ar.x===0&&ar.y===0||ar._unit();var dr=Ct.x*Xt.x+Ct.y*Xt.y,br=ar.x*Xt.x+ar.y*Xt.y,Nr=br!==0?1/br:1/0,Rr=2*Math.sqrt(2-2*br),pn=br<fh&&ot&&_t,hn=Ct.x*Xt.y-Ct.y*Xt.x>0;if(pn&&Zt>te){var Ln=pe.dist(ot);if(Ln>2*Ce){var Jn=pe.sub(pe.sub(ot)._mult(Ce/Ln)._round());this.updateDistance(ot,Jn),this.addCurrentVertex(Jn,Ct,0,0,Me),ot=Jn}}var Kn=ot&&_t,Nn=Kn?r:I?"butt":l;if(Kn&&Nn==="round"&&(Nr<m?Nn="miter":Nr<=2&&(Nn="fakeround")),Nn==="miter"&&Nr>f&&(Nn="bevel"),Nn==="bevel"&&(Nr>2&&(Nn="flipbevel"),Nr<f&&(Nn="miter")),ot&&this.updateDistance(ot,pe),Nn==="miter")ar._mult(Nr),this.addCurrentVertex(pe,ar,0,0,Me);else if(Nn==="flipbevel"){if(Nr>100)ar=Xt.mult(-1);else{var Si=Nr*Ct.add(Xt).mag()/Ct.sub(Xt).mag();ar._perp()._mult(Si*(hn?-1:1))}this.addCurrentVertex(pe,ar,0,0,Me),this.addCurrentVertex(pe,ar.mult(-1),0,0,Me)}else if(Nn==="bevel"||Nn==="fakeround"){var li=-Math.sqrt(Nr*Nr-1),ei=hn?li:0,$i=hn?0:li;if(ot&&this.addCurrentVertex(pe,Ct,ei,$i,Me),Nn==="fakeround")for(var Di=Math.round(180*Rr/Math.PI/20),Ga=1;Ga<Di;Ga++){var gi=Ga/Di;if(gi!==.5){var aa=gi-.5;gi+=gi*aa*(gi-1)*((1.0904+dr*(dr*(3.55645-1.43519*dr)-3.2452))*aa*aa+(.848013+dr*(.215638*dr-1.06021)))}var Zo=Xt.sub(Ct)._mult(gi)._add(Ct)._unit()._mult(hn?-1:1);this.addHalfVertex(pe,Zo.x,Zo.y,!1,hn,0,Me)}_t&&this.addCurrentVertex(pe,Xt,-ei,-$i,Me)}else if(Nn==="butt")this.addCurrentVertex(pe,ar,0,0,Me);else if(Nn==="square"){var Sa=ot?1:-1;this.addCurrentVertex(pe,ar,Sa,Sa,Me)}else Nn==="round"&&(ot&&(this.addCurrentVertex(pe,Ct,0,0,Me),this.addCurrentVertex(pe,Ct,1,1,Me,!0)),_t&&(this.addCurrentVertex(pe,Xt,-1,-1,Me,!0),this.addCurrentVertex(pe,Xt,0,0,Me)));if(pn&&Zt<G-1){var Wo=pe.dist(_t);if(Wo>2*Ce){var Xo=pe.add(_t.sub(pe)._mult(Ce/Wo)._round());this.updateDistance(pe,Xo),this.addCurrentVertex(Xo,Xt,0,0,Me),pe=Xo}}}}},Bu.prototype.addCurrentVertex=function(e,t,r,l,f,m){m===void 0&&(m=!1);var A=t.y*l-t.x,I=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,m,!1,r,f),this.addHalfVertex(e,A,I,m,!0,-l,f),this.distance>Xf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,l,f,m))},Bu.prototype.addHalfVertex=function(e,t,r,l,f,m,A){var I=.5*(this.lineClips?this.scaledDistance*(Xf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(m===0?0:m<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var G=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,G),A.primitiveLength++),f?this.e2=G:this.e1=G},Bu.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Bu.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},In("LineBucket",Bu,{omit:["layers","patternFeatures"]});var Yf=new Io({"line-cap":new $n(Ne.layout_line["line-cap"]),"line-join":new Fn(Ne.layout_line["line-join"]),"line-miter-limit":new $n(Ne.layout_line["line-miter-limit"]),"line-round-limit":new $n(Ne.layout_line["line-round-limit"]),"line-sort-key":new Fn(Ne.layout_line["line-sort-key"])}),ff={paint:new Io({"line-opacity":new Fn(Ne.paint_line["line-opacity"]),"line-color":new Fn(Ne.paint_line["line-color"]),"line-translate":new $n(Ne.paint_line["line-translate"]),"line-translate-anchor":new $n(Ne.paint_line["line-translate-anchor"]),"line-width":new Fn(Ne.paint_line["line-width"]),"line-gap-width":new Fn(Ne.paint_line["line-gap-width"]),"line-offset":new Fn(Ne.paint_line["line-offset"]),"line-blur":new Fn(Ne.paint_line["line-blur"]),"line-dasharray":new ms(Ne.paint_line["line-dasharray"]),"line-pattern":new Tc(Ne.paint_line["line-pattern"]),"line-gradient":new jo(Ne.paint_line["line-gradient"])}),layout:Yf},Kf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,l){return l=new Oi(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,r,l)},t.prototype.evaluate=function(r,l,f,m){return l=Oe({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,r,l,f,m)},t}(Fn))(ff.paint.properties["line-width"].specification);Kf.useIntegerZoom=!0;var Th=function(e){function t(r){e.call(this,r,ff),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof xa,this.gradientVersion=(this.gradientVersion+1)%Ke)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,l){e.prototype.recalculate.call(this,r,l),this.paint._values["line-floorwidth"]=Kf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Bu(r)},t.prototype.queryRadius=function(r){var l=r,f=hh(Cs("line-width",this,l),Cs("line-gap-width",this,l)),m=Cs("line-offset",this,l);return f/2+Math.abs(m)+po(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,l,f,m,A,I,G){var te=Du(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),I.angle,G),pe=G/2*hh(this.paint.get("line-width").evaluate(l,f),this.paint.get("line-gap-width").evaluate(l,f)),Ce=this.paint.get("line-offset").evaluate(l,f);return Ce&&(m=function(Me,ot){for(var _t=[],Ct=new re(0,0),Xt=0;Xt<Me.length;Xt++){for(var Zt=Me[Xt],ar=[],dr=0;dr<Zt.length;dr++){var br=Zt[dr],Nr=Zt[dr+1],Rr=dr===0?Ct:br.sub(Zt[dr-1])._unit()._perp(),pn=dr===Zt.length-1?Ct:Nr.sub(br)._unit()._perp(),hn=Rr._add(pn)._unit();hn._mult(1/(hn.x*pn.x+hn.y*pn.y)),ar.push(hn._mult(ot)._add(br))}_t.push(ar)}return _t}(m,Ce*G)),function(Me,ot,_t){for(var Ct=0;Ct<ot.length;Ct++){var Xt=ot[Ct];if(Me.length>=3){for(var Zt=0;Zt<Xt.length;Zt++)if(Ru(Me,Xt[Zt]))return!0}if(As(Me,Xt,_t))return!0}return!1}(te,m,pe)},t.prototype.isTileClipped=function(){return!0},t}(nu);function hh(e,t){return t>0?t+2*e:e}var Af=Wa([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),oh=Wa([{name:"a_projected_pos",components:3,type:"Float32"}],4),$f=(Wa([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Wa([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),dh=(Wa([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Wa([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Fh=Wa([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Cf(e,t,r){return e.sections.forEach(function(l){l.text=function(f,m,A){var I=m.layout.get("text-transform").evaluate(A,{});return I==="uppercase"?f=f.toLocaleUpperCase():I==="lowercase"&&(f=f.toLocaleLowerCase()),ss.applyArabicShaping&&(f=ss.applyArabicShaping(f)),f}(l.text,t,r)}),e}Wa([{name:"triangle",components:3,type:"Uint16"}]),Wa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Wa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Wa([{type:"Float32",name:"offsetX"}]),Wa([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var zf={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Ah=function(t,r,l,f,m){var A,I,G=8*m-f-1,te=(1<<G)-1,pe=te>>1,Ce=-7,Me=l?m-1:0,ot=l?-1:1,_t=t[r+Me];for(Me+=ot,A=_t&(1<<-Ce)-1,_t>>=-Ce,Ce+=G;Ce>0;A=256*A+t[r+Me],Me+=ot,Ce-=8);for(I=A&(1<<-Ce)-1,A>>=-Ce,Ce+=f;Ce>0;I=256*I+t[r+Me],Me+=ot,Ce-=8);if(A===0)A=1-pe;else{if(A===te)return I?NaN:1/0*(_t?-1:1);I+=Math.pow(2,f),A-=pe}return(_t?-1:1)*I*Math.pow(2,A-f)},xe=function(t,r,l,f,m,A){var I,G,te,pe=8*A-m-1,Ce=(1<<pe)-1,Me=Ce>>1,ot=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,_t=f?0:A-1,Ct=f?1:-1,Xt=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(G=isNaN(r)?1:0,I=Ce):(I=Math.floor(Math.log(r)/Math.LN2),r*(te=Math.pow(2,-I))<1&&(I--,te*=2),(r+=I+Me>=1?ot/te:ot*Math.pow(2,1-Me))*te>=2&&(I++,te/=2),I+Me>=Ce?(G=0,I=Ce):I+Me>=1?(G=(r*te-1)*Math.pow(2,m),I+=Me):(G=r*Math.pow(2,Me-1)*Math.pow(2,m),I=0));m>=8;t[l+_t]=255&G,_t+=Ct,G/=256,m-=8);for(I=I<<m|G,pe+=m;pe>0;t[l+_t]=255&I,_t+=Ct,I/=256,pe-=8);t[l+_t-Ct]|=128*Xt},je=At;function At(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}At.Varint=0,At.Fixed64=1,At.Bytes=2,At.Fixed32=5;var gr=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Ir(e){return e.type===At.Bytes?e.readVarint()+e.pos:e.pos+1}function wr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function xr(e,t,r){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(l);for(var f=r.pos-1;f>=e;f--)r.buf[f+l]=r.buf[f]}function Wr(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function sn(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function tn(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function qr(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function fn(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function wn(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function cn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function nn(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function yr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function vr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Xr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function _n(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Lr(e,t,r){e===1&&r.readMessage(qn,t)}function qn(e,t,r){if(e===3){var l=r.readMessage(Qr,{}),f=l.width,m=l.height,A=l.left,I=l.top,G=l.advance;t.push({id:l.id,bitmap:new Hs({width:f+6,height:m+6},l.bitmap),metrics:{width:f,height:m,left:A,top:I,advance:G}})}}function Qr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function jr(e){for(var t=0,r=0,l=0,f=e;l<f.length;l+=1){var m=f[l];t+=m.w*m.h,r=Math.max(r,m.w)}e.sort(function(Ct,Xt){return Xt.h-Ct.h});for(var A=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],I=0,G=0,te=0,pe=e;te<pe.length;te+=1)for(var Ce=pe[te],Me=A.length-1;Me>=0;Me--){var ot=A[Me];if(!(Ce.w>ot.w||Ce.h>ot.h)){if(Ce.x=ot.x,Ce.y=ot.y,G=Math.max(G,Ce.y+Ce.h),I=Math.max(I,Ce.x+Ce.w),Ce.w===ot.w&&Ce.h===ot.h){var _t=A.pop();Me<A.length&&(A[Me]=_t)}else Ce.h===ot.h?(ot.x+=Ce.w,ot.w-=Ce.w):Ce.w===ot.w?(ot.y+=Ce.h,ot.h-=Ce.h):(A.push({x:ot.x+Ce.w,y:ot.y,w:ot.w-Ce.w,h:Ce.h}),ot.y+=Ce.h,ot.h-=Ce.h);break}}return{w:I,h:G,fill:t/(I*G)||0}}At.prototype={destroy:function(){this.buf=null},readFields:function(t,r,l){for(l=l||this.length;this.pos<l;){var f=this.readVarint(),m=f>>3,A=this.pos;this.type=7&f,t(m,r,this),this.pos===A&&this.skip(f)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=vr(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=_n(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=vr(this.buf,this.pos)+4294967296*vr(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=vr(this.buf,this.pos)+4294967296*_n(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Ah(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ah(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,l,f=this.buf;return r=127&(l=f[this.pos++]),l<128?r:(r|=(127&(l=f[this.pos++]))<<7,l<128?r:(r|=(127&(l=f[this.pos++]))<<14,l<128?r:(r|=(127&(l=f[this.pos++]))<<21,l<128?r:function(m,A,I){var G,te,pe=I.buf;if(G=(112&(te=pe[I.pos++]))>>4,te<128||(G|=(127&(te=pe[I.pos++]))<<3,te<128)||(G|=(127&(te=pe[I.pos++]))<<10,te<128)||(G|=(127&(te=pe[I.pos++]))<<17,te<128)||(G|=(127&(te=pe[I.pos++]))<<24,te<128)||(G|=(1&(te=pe[I.pos++]))<<31,te<128))return wr(m,G,A);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(l=f[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&gr?function(l,f,m){return gr.decode(l.subarray(f,m))}(this.buf,r,t):function(l,f,m){for(var A="",I=f;I<m;){var G,te,pe,Ce=l[I],Me=null,ot=Ce>239?4:Ce>223?3:Ce>191?2:1;if(I+ot>m)break;ot===1?Ce<128&&(Me=Ce):ot===2?(192&(G=l[I+1]))==128&&(Me=(31&Ce)<<6|63&G)<=127&&(Me=null):ot===3?(te=l[I+2],(192&(G=l[I+1]))==128&&(192&te)==128&&((Me=(15&Ce)<<12|(63&G)<<6|63&te)<=2047||Me>=55296&&Me<=57343)&&(Me=null)):ot===4&&(te=l[I+2],pe=l[I+3],(192&(G=l[I+1]))==128&&(192&te)==128&&(192&pe)==128&&((Me=(15&Ce)<<18|(63&G)<<12|(63&te)<<6|63&pe)<=65535||Me>=1114112)&&(Me=null)),Me===null?(Me=65533,ot=1):Me>65535&&(Me-=65536,A+=String.fromCharCode(Me>>>10&1023|55296),Me=56320|1023&Me),A+=String.fromCharCode(Me),I+=ot}return A}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==At.Bytes)return t.push(this.readVarint(r));var l=Ir(this);for(t=t||[];this.pos<l;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==At.Bytes)return t.push(this.readSVarint());var r=Ir(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==At.Bytes)return t.push(this.readBoolean());var r=Ir(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==At.Bytes)return t.push(this.readFloat());var r=Ir(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==At.Bytes)return t.push(this.readDouble());var r=Ir(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==At.Bytes)return t.push(this.readFixed32());var r=Ir(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==At.Bytes)return t.push(this.readSFixed32());var r=Ir(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==At.Bytes)return t.push(this.readFixed64());var r=Ir(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==At.Bytes)return t.push(this.readSFixed64());var r=Ir(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===At.Varint)for(;this.buf[this.pos++]>127;);else if(r===At.Bytes)this.pos=this.readVarint()+this.pos;else if(r===At.Fixed32)this.pos+=4;else{if(r!==At.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var l=new Uint8Array(r);l.set(this.buf),this.buf=l,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Xr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Xr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Xr(this.buf,-1&t,this.pos),Xr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Xr(this.buf,-1&t,this.pos),Xr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,l){var f,m;if(r>=0?(f=r%4294967296|0,m=r/4294967296|0):(m=~(-r/4294967296),4294967295^(f=~(-r%4294967296))?f=f+1|0:(f=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(A,I,G){G.buf[G.pos++]=127&A|128,A>>>=7,G.buf[G.pos++]=127&A|128,A>>>=7,G.buf[G.pos++]=127&A|128,A>>>=7,G.buf[G.pos++]=127&A|128,G.buf[G.pos]=127&(A>>>=7)}(f,0,l),function(A,I){var G=(7&A)<<4;I.buf[I.pos++]|=G|((A>>>=3)?128:0),A&&(I.buf[I.pos++]=127&A|((A>>>=7)?128:0),A&&(I.buf[I.pos++]=127&A|((A>>>=7)?128:0),A&&(I.buf[I.pos++]=127&A|((A>>>=7)?128:0),A&&(I.buf[I.pos++]=127&A|((A>>>=7)?128:0),A&&(I.buf[I.pos++]=127&A)))))}(m,l)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(f,m,A){for(var I,G,te=0;te<m.length;te++){if((I=m.charCodeAt(te))>55295&&I<57344){if(!G){I>56319||te+1===m.length?(f[A++]=239,f[A++]=191,f[A++]=189):G=I;continue}if(I<56320){f[A++]=239,f[A++]=191,f[A++]=189,G=I;continue}I=G-55296<<10|I-56320|65536,G=null}else G&&(f[A++]=239,f[A++]=191,f[A++]=189,G=null);I<128?f[A++]=I:(I<2048?f[A++]=I>>6|192:(I<65536?f[A++]=I>>12|224:(f[A++]=I>>18|240,f[A++]=I>>12&63|128),f[A++]=I>>6&63|128),f[A++]=63&I|128)}return A}(this.buf,t,this.pos);var l=this.pos-r;l>=128&&xr(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l},writeFloat:function(t){this.realloc(4),xe(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),xe(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var l=0;l<r;l++)this.buf[this.pos++]=t[l]},writeRawMessage:function(t,r){this.pos++;var l=this.pos;t(r,this);var f=this.pos-l;f>=128&&xr(l,f,this),this.pos=l-1,this.writeVarint(f),this.pos+=f},writeMessage:function(t,r,l){this.writeTag(t,At.Bytes),this.writeRawMessage(r,l)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Wr,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,sn,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,fn,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,tn,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,qr,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,wn,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,cn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,nn,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,yr,r)},writeBytesField:function(t,r){this.writeTag(t,At.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,At.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,At.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,At.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,At.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,At.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,At.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,At.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,At.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,At.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Vr=function(t,r){var l=r.pixelRatio,f=r.version,m=r.stretchX,A=r.stretchY,I=r.content;this.paddedRect=t,this.pixelRatio=l,this.stretchX=m,this.stretchY=A,this.content=I,this.version=f},Kr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Kr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Kr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Kr.tlbr.get=function(){return this.tl.concat(this.br)},Kr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Vr.prototype,Kr);var Yn=function(t,r){var l={},f={};this.haveRenderCallbacks=[];var m=[];this.addImages(t,l,m),this.addImages(r,f,m);var A=jr(m),I=new Do({width:A.w||1,height:A.h||1});for(var G in t){var te=t[G],pe=l[G].paddedRect;Do.copy(te.data,I,{x:0,y:0},{x:pe.x+1,y:pe.y+1},te.data)}for(var Ce in r){var Me=r[Ce],ot=f[Ce].paddedRect,_t=ot.x+1,Ct=ot.y+1,Xt=Me.data.width,Zt=Me.data.height;Do.copy(Me.data,I,{x:0,y:0},{x:_t,y:Ct},Me.data),Do.copy(Me.data,I,{x:0,y:Zt-1},{x:_t,y:Ct-1},{width:Xt,height:1}),Do.copy(Me.data,I,{x:0,y:0},{x:_t,y:Ct+Zt},{width:Xt,height:1}),Do.copy(Me.data,I,{x:Xt-1,y:0},{x:_t-1,y:Ct},{width:1,height:Zt}),Do.copy(Me.data,I,{x:0,y:0},{x:_t+Xt,y:Ct},{width:1,height:Zt})}this.image=I,this.iconPositions=l,this.patternPositions=f};Yn.prototype.addImages=function(e,t,r){for(var l in e){var f=e[l],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};r.push(m),t[l]=new Vr(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},Yn.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Yn.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;r.update(t.data,void 0,{x:l[0],y:l[1]})}},In("ImagePosition",Vr),In("ImageAtlas",Yn);var ti={horizontal:1,vertical:2,horizontalOnly:3},un=function(){this.scale=1,this.fontStack="",this.imageName=null};un.forText=function(e,t){var r=new un;return r.scale=e||1,r.fontStack=t,r},un.forImage=function(e){var t=new un;return t.imageName=e,t};var Gr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Fr(e,t,r,l,f,m,A,I,G,te,pe,Ce,Me,ot,_t,Ct){var Xt,Zt=Gr.fromFeature(e,f);Ce===ti.vertical&&Zt.verticalizePunctuation();var ar=ss.processBidirectionalText,dr=ss.processStyledBidirectionalText;if(ar&&Zt.sections.length===1){Xt=[];for(var br=0,Nr=ar(Zt.toString(),ca(Zt,te,m,t,l,ot,_t));br<Nr.length;br+=1){var Rr=Nr[br],pn=new Gr;pn.text=Rr,pn.sections=Zt.sections;for(var hn=0;hn<Rr.length;hn++)pn.sectionIndex.push(0);Xt.push(pn)}}else if(dr){Xt=[];for(var Ln=0,Jn=dr(Zt.text,Zt.sectionIndex,ca(Zt,te,m,t,l,ot,_t));Ln<Jn.length;Ln+=1){var Kn=Jn[Ln],Nn=new Gr;Nn.text=Kn[0],Nn.sectionIndex=Kn[1],Nn.sections=Zt.sections,Xt.push(Nn)}}else Xt=function(ei,$i){for(var Di=[],Ga=ei.text,gi=0,aa=0,Zo=$i;aa<Zo.length;aa+=1){var Sa=Zo[aa];Di.push(ei.substring(gi,Sa)),gi=Sa}return gi<Ga.length&&Di.push(ei.substring(gi,Ga.length)),Di}(Zt,ca(Zt,te,m,t,l,ot,_t));var Si=[],li={positionedLines:Si,text:Zt.toString(),top:pe[1],bottom:pe[1],left:pe[0],right:pe[0],writingMode:Ce,iconsInText:!1,verticalizable:!1};return function(ei,$i,Di,Ga,gi,aa,Zo,Sa,Wo,Xo,cs,Eu){for(var fs=0,el=-17,ou=0,tl=0,su=Sa==="right"?1:Sa==="left"?0:.5,Xs=0,uu=0,ga=gi;uu<ga.length;uu+=1){var oa=ga[uu];oa.trim();var ro=oa.getMaxScale(),yo=24*(ro-1),Tu={positionedGlyphs:[],lineOffset:0};ei.positionedLines[Xs]=Tu;var Ao=Tu.positionedGlyphs,Yo=0;if(oa.length()){for(var ku=0;ku<oa.length();ku++){var fa=oa.getSection(ku),eh=oa.getSectionIndex(ku),Yc=oa.getCharCode(ku),pf=0,dc=null,ju=null,Bf=null,kf=24,th=!(Wo===ti.horizontal||!cs&&!Sc(Yc)||cs&&(di[Yc]||(vh=Yc,en.Arabic(vh)||en["Arabic Supplement"](vh)||en["Arabic Extended-A"](vh)||en["Arabic Presentation Forms-A"](vh)||en["Arabic Presentation Forms-B"](vh))));if(fa.imageName){var Ph=Ga[fa.imageName];if(!Ph)continue;Bf=fa.imageName,ei.iconsInText=ei.iconsInText||!0,ju=Ph.paddedRect;var Pf=Ph.displaySize;fa.scale=24*fa.scale/Eu,pf=yo+(24-Pf[1]*fa.scale),kf=(dc={width:Pf[0],height:Pf[1],left:1,top:-3,advance:th?Pf[1]:Pf[0]}).advance;var _h=th?Pf[0]*fa.scale-24*ro:Pf[1]*fa.scale-24*ro;_h>0&&_h>Yo&&(Yo=_h)}else{var rh=Di[fa.fontStack],ph=rh&&rh[Yc];if(ph&&ph.rect)ju=ph.rect,dc=ph.metrics;else{var Wh=$i[fa.fontStack],Bh=Wh&&Wh[Yc];if(!Bh)continue;dc=Bh.metrics}pf=24*(ro-fa.scale)}th?(ei.verticalizable=!0,Ao.push({glyph:Yc,imageName:Bf,x:fs,y:el+pf,vertical:th,scale:fa.scale,fontStack:fa.fontStack,sectionIndex:eh,metrics:dc,rect:ju}),fs+=kf*fa.scale+Xo):(Ao.push({glyph:Yc,imageName:Bf,x:fs,y:el+pf,vertical:th,scale:fa.scale,fontStack:fa.fontStack,sectionIndex:eh,metrics:dc,rect:ju}),fs+=dc.advance*fa.scale+Xo)}Ao.length!==0&&(ou=Math.max(fs-Xo,ou),Ho(Ao,0,Ao.length-1,su,Yo)),fs=0;var Xh=aa*ro+Yo;Tu.lineOffset=Math.max(Yo,yo),el+=Xh,tl=Math.max(Xh,tl),++Xs}else el+=aa,++Xs}var vh,Mh=el- -17,Yh=Go(Zo),mh=Yh.horizontalAlign,nh=Yh.verticalAlign;(function(sh,Kh,kh,gh,jh,Ih,yh,Uh,Vh){var Oh,Lh=(Kh-kh)*jh;Oh=Ih!==yh?-Uh*gh- -17:(-gh*Vh+.5)*yh;for(var xh=0,Rh=sh;xh<Rh.length;xh+=1)for(var bh=0,jf=Rh[xh].positionedGlyphs;bh<jf.length;bh+=1){var Dh=jf[bh];Dh.x+=Lh,Dh.y+=Oh}})(ei.positionedLines,su,mh,nh,ou,tl,aa,Mh,gi.length),ei.top+=-nh*Mh,ei.bottom=ei.top+Mh,ei.left+=-mh*ou,ei.right=ei.left+ou}(li,t,r,l,Xt,A,I,G,Ce,te,Me,Ct),!function(ei){for(var $i=0,Di=ei;$i<Di.length;$i+=1)if(Di[$i].positionedGlyphs.length!==0)return!1;return!0}(Si)&&li}Gr.fromFeature=function(e,t){for(var r=new Gr,l=0;l<e.sections.length;l++){var f=e.sections[l];f.image?r.addImageSection(f):r.addTextSection(f,t)}return r},Gr.prototype.length=function(){return this.text.length},Gr.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Gr.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Gr.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Gr.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var l=e.charCodeAt(r+1)||null,f=e.charCodeAt(r-1)||null;t+=l&&ll(l)&&!zf[e[r+1]]||f&&ll(f)&&!zf[e[r-1]]||!zf[e[r]]?e[r]:zf[e[r]]}return t}(this.text)},Gr.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&di[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,l=this.text.length-1;l>=0&&l>=e&&di[this.text.charCodeAt(l)];l--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},Gr.prototype.substring=function(e,t){var r=new Gr;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},Gr.prototype.toString=function(){return this.text},Gr.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},Gr.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(un.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(r)},Gr.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(un.forImage(t)),this.sectionIndex.push(this.sections.length-1)):ze("Reached maximum number of images 6401")}else ze("Can't add FormattedSection with an empty image.")},Gr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var di={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pi={};function kn(e,t,r,l,f,m){if(t.imageName){var A=l[t.imageName];return A?A.displaySize[0]*t.scale*24/m+f:0}var I=r[t.fontStack],G=I&&I[e];return G?G.metrics.advance*t.scale+f:0}function Bi(e,t,r,l){var f=Math.pow(e-t,2);return l?e<t?f/2:2*f:f+Math.abs(r)*r}function _i(e,t,r){var l=0;return e===10&&(l-=1e4),r&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function Ui(e,t,r,l,f,m){for(var A=null,I=Bi(t,r,f,m),G=0,te=l;G<te.length;G+=1){var pe=te[G],Ce=Bi(t-pe.x,r,f,m)+pe.badness;Ce<=I&&(A=pe,I=Ce)}return{index:e,x:t,priorBreak:A,badness:I}}function ca(e,t,r,l,f,m,A){if(m!=="point")return[];if(!e)return[];for(var I,G=[],te=function(Xt,Zt,ar,dr,br,Nr){for(var Rr=0,pn=0;pn<Xt.length();pn++){var hn=Xt.getSection(pn);Rr+=kn(Xt.getCharCode(pn),hn,dr,br,Zt,Nr)}return Rr/Math.max(1,Math.ceil(Rr/ar))}(e,t,r,l,f,A),pe=e.text.indexOf("\u200B")>=0,Ce=0,Me=0;Me<e.length();Me++){var ot=e.getSection(Me),_t=e.getCharCode(Me);if(di[_t]||(Ce+=kn(_t,ot,l,f,t,A)),Me<e.length()-1){var Ct=!((I=_t)<11904||!(en["Bopomofo Extended"](I)||en.Bopomofo(I)||en["CJK Compatibility Forms"](I)||en["CJK Compatibility Ideographs"](I)||en["CJK Compatibility"](I)||en["CJK Radicals Supplement"](I)||en["CJK Strokes"](I)||en["CJK Symbols and Punctuation"](I)||en["CJK Unified Ideographs Extension A"](I)||en["CJK Unified Ideographs"](I)||en["Enclosed CJK Letters and Months"](I)||en["Halfwidth and Fullwidth Forms"](I)||en.Hiragana(I)||en["Ideographic Description Characters"](I)||en["Kangxi Radicals"](I)||en["Katakana Phonetic Extensions"](I)||en.Katakana(I)||en["Vertical Forms"](I)||en["Yi Radicals"](I)||en["Yi Syllables"](I)));(pi[_t]||Ct||ot.imageName)&&G.push(Ui(Me+1,Ce,te,G,_i(_t,e.getCharCode(Me+1),Ct&&pe),!1))}}return function Xt(Zt){return Zt?Xt(Zt.priorBreak).concat(Zt.index):[]}(Ui(e.length(),Ce,te,G,0,!0))}function Go(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Ho(e,t,r,l,f){if(l||f)for(var m=e[r],A=(e[r].x+m.metrics.advance*m.scale)*l,I=t;I<=r;I++)e[I].x-=A,e[I].y+=f}function ta(e,t,r,l,f,m){var A,I=e.image;if(I.content){var G=I.content,te=I.pixelRatio||1;A=[G[0]/te,G[1]/te,I.displaySize[0]-G[2]/te,I.displaySize[1]-G[3]/te]}var pe,Ce,Me,ot,_t=t.left*m,Ct=t.right*m;r==="width"||r==="both"?(ot=f[0]+_t-l[3],Ce=f[0]+Ct+l[1]):Ce=(ot=f[0]+(_t+Ct-I.displaySize[0])/2)+I.displaySize[0];var Xt=t.top*m,Zt=t.bottom*m;return r==="height"||r==="both"?(pe=f[1]+Xt-l[0],Me=f[1]+Zt+l[2]):Me=(pe=f[1]+(Xt+Zt-I.displaySize[1])/2)+I.displaySize[1],{image:I,top:pe,right:Ce,bottom:Me,left:ot,collisionPadding:A}}pi[10]=!0,pi[32]=!0,pi[38]=!0,pi[40]=!0,pi[41]=!0,pi[43]=!0,pi[45]=!0,pi[47]=!0,pi[173]=!0,pi[183]=!0,pi[8203]=!0,pi[8208]=!0,pi[8211]=!0,pi[8231]=!0;var mo=function(e){function t(r,l,f,m){e.call(this,r,l),this.angle=f,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(re);function Oa(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Oi(e+1))};if(r.kind==="source")return{kind:"source"};for(var l=r.zoomStops,f=r.interpolationType,m=0;m<l.length&&l[m]<=e;)m++;for(var A=m=Math.max(0,m-1);A<l.length&&l[A]<e+1;)A++;A=Math.min(l.length-1,A);var I=l[m],G=l[A];return r.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:G,interpolationType:f}:{kind:"camera",minZoom:I,maxZoom:G,minSize:r.evaluate(new Oi(I)),maxSize:r.evaluate(new Oi(G)),interpolationType:f}}function ws(e,t,r){var l=t.uSize,f=r.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?ka(f/128,r.upperSize/128,t.uSizeT):l}function Qo(e,t){var r=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,m=f?Re(ha.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=ka(e.minSize,e.maxSize,m):r=m}return{uSizeT:r,uSize:l}}In("Anchor",mo);var xs=Object.freeze({__proto__:null,getSizeData:Oa,evaluateSizeForFeature:ws,evaluateSizeForZoom:Qo,SIZE_PACK_FACTOR:128});function qo(e,t,r,l,f){if(t.segment===void 0)return!0;for(var m=t,A=t.segment+1,I=0;I>-r/2;){if(--A<0)return!1;I-=e[A].dist(m),m=e[A]}I+=e[A].dist(e[A+1]),A++;for(var G=[],te=0;I<r/2;){var pe=e[A],Ce=e[A+1];if(!Ce)return!1;var Me=e[A-1].angleTo(pe)-pe.angleTo(Ce);for(Me=Math.abs((Me+3*Math.PI)%(2*Math.PI)-Math.PI),G.push({distance:I,angleDelta:Me}),te+=Me;I-G[0].distance>l;)te-=G.shift().angleDelta;if(te>f)return!1;A++,I+=pe.dist(Ce)}return!0}function Zs(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function No(e,t,r){return e?.6*t*r:0}function ui(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Ws(e,t,r,l,f,m){for(var A=No(r,f,m),I=ui(r,l)*m,G=0,te=Zs(e)/2,pe=0;pe<e.length-1;pe++){var Ce=e[pe],Me=e[pe+1],ot=Ce.dist(Me);if(G+ot>te){var _t=(te-G)/ot,Ct=ka(Ce.x,Me.x,_t),Xt=ka(Ce.y,Me.y,_t),Zt=new mo(Ct,Xt,Me.angleTo(Ce),pe);return Zt._round(),!A||qo(e,Zt,I,A,t)?Zt:void 0}G+=ot}}function Ca(e,t,r,l,f,m,A,I,G){var te=No(l,m,A),pe=ui(l,f),Ce=pe*A,Me=e[0].x===0||e[0].x===G||e[0].y===0||e[0].y===G;return t-Ce<t/4&&(t=Ce+t/4),function ot(_t,Ct,Xt,Zt,ar,dr,br,Nr,Rr){for(var pn=dr/2,hn=Zs(_t),Ln=0,Jn=Ct-Xt,Kn=[],Nn=0;Nn<_t.length-1;Nn++){for(var Si=_t[Nn],li=_t[Nn+1],ei=Si.dist(li),$i=li.angleTo(Si);Jn+Xt<Ln+ei;){var Di=((Jn+=Xt)-Ln)/ei,Ga=ka(Si.x,li.x,Di),gi=ka(Si.y,li.y,Di);if(Ga>=0&&Ga<Rr&&gi>=0&&gi<Rr&&Jn-pn>=0&&Jn+pn<=hn){var aa=new mo(Ga,gi,$i,Nn);aa._round(),Zt&&!qo(_t,aa,dr,Zt,ar)||Kn.push(aa)}}Ln+=ei}return Nr||Kn.length||br||(Kn=ot(_t,Ln/2,Xt,Zt,ar,dr,br,!0,Rr)),Kn}(e,Me?t/2*I%t:(pe/2+2*m)*A*I%t,t,te,r,Ce,Me,!1,G)}function Sn(e,t,r,l,f){for(var m=[],A=0;A<e.length;A++)for(var I=e[A],G=void 0,te=0;te<I.length-1;te++){var pe=I[te],Ce=I[te+1];pe.x<t&&Ce.x<t||(pe.x<t?pe=new re(t,pe.y+(t-pe.x)/(Ce.x-pe.x)*(Ce.y-pe.y))._round():Ce.x<t&&(Ce=new re(t,pe.y+(t-pe.x)/(Ce.x-pe.x)*(Ce.y-pe.y))._round()),pe.y<r&&Ce.y<r||(pe.y<r?pe=new re(pe.x+(r-pe.y)/(Ce.y-pe.y)*(Ce.x-pe.x),r)._round():Ce.y<r&&(Ce=new re(pe.x+(r-pe.y)/(Ce.y-pe.y)*(Ce.x-pe.x),r)._round()),pe.x>=l&&Ce.x>=l||(pe.x>=l?pe=new re(l,pe.y+(l-pe.x)/(Ce.x-pe.x)*(Ce.y-pe.y))._round():Ce.x>=l&&(Ce=new re(l,pe.y+(l-pe.x)/(Ce.x-pe.x)*(Ce.y-pe.y))._round()),pe.y>=f&&Ce.y>=f||(pe.y>=f?pe=new re(pe.x+(f-pe.y)/(Ce.y-pe.y)*(Ce.x-pe.x),f)._round():Ce.y>=f&&(Ce=new re(pe.x+(f-pe.y)/(Ce.y-pe.y)*(Ce.x-pe.x),f)._round()),G&&pe.equals(G[G.length-1])||m.push(G=[pe]),G.push(Ce)))))}return m}function Ri(e,t,r,l){var f=[],m=e.image,A=m.pixelRatio,I=m.paddedRect.w-2,G=m.paddedRect.h-2,te=e.right-e.left,pe=e.bottom-e.top,Ce=m.stretchX||[[0,I]],Me=m.stretchY||[[0,G]],ot=function(gi,aa){return gi+aa[1]-aa[0]},_t=Ce.reduce(ot,0),Ct=Me.reduce(ot,0),Xt=I-_t,Zt=G-Ct,ar=0,dr=_t,br=0,Nr=Ct,Rr=0,pn=Xt,hn=0,Ln=Zt;if(m.content&&l){var Jn=m.content;ar=Vi(Ce,0,Jn[0]),br=Vi(Me,0,Jn[1]),dr=Vi(Ce,Jn[0],Jn[2]),Nr=Vi(Me,Jn[1],Jn[3]),Rr=Jn[0]-ar,hn=Jn[1]-br,pn=Jn[2]-Jn[0]-dr,Ln=Jn[3]-Jn[1]-Nr}var Kn=function(gi,aa,Zo,Sa){var Wo=au(gi.stretch-ar,dr,te,e.left),Xo=hc(gi.fixed-Rr,pn,gi.stretch,_t),cs=au(aa.stretch-br,Nr,pe,e.top),Eu=hc(aa.fixed-hn,Ln,aa.stretch,Ct),fs=au(Zo.stretch-ar,dr,te,e.left),el=hc(Zo.fixed-Rr,pn,Zo.stretch,_t),ou=au(Sa.stretch-br,Nr,pe,e.top),tl=hc(Sa.fixed-hn,Ln,Sa.stretch,Ct),su=new re(Wo,cs),Xs=new re(fs,cs),uu=new re(fs,ou),ga=new re(Wo,ou),oa=new re(Xo/A,Eu/A),ro=new re(el/A,tl/A),yo=t*Math.PI/180;if(yo){var Tu=Math.sin(yo),Ao=Math.cos(yo),Yo=[Ao,-Tu,Tu,Ao];su._matMult(Yo),Xs._matMult(Yo),ga._matMult(Yo),uu._matMult(Yo)}var ku=gi.stretch+gi.fixed,fa=aa.stretch+aa.fixed;return{tl:su,tr:Xs,bl:ga,br:uu,tex:{x:m.paddedRect.x+1+ku,y:m.paddedRect.y+1+fa,w:Zo.stretch+Zo.fixed-ku,h:Sa.stretch+Sa.fixed-fa},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:oa,pixelOffsetBR:ro,minFontScaleX:pn/A/te,minFontScaleY:Ln/A/pe,isSDF:r}};if(l&&(m.stretchX||m.stretchY))for(var Nn=es(Ce,Xt,_t),Si=es(Me,Zt,Ct),li=0;li<Nn.length-1;li++)for(var ei=Nn[li],$i=Nn[li+1],Di=0;Di<Si.length-1;Di++)f.push(Kn(ei,Si[Di],$i,Si[Di+1]));else f.push(Kn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:G+1}));return f}function Vi(e,t,r){for(var l=0,f=0,m=e;f<m.length;f+=1){var A=m[f];l+=Math.max(t,Math.min(r,A[1]))-Math.max(t,Math.min(r,A[0]))}return l}function es(e,t,r){for(var l=[{fixed:-1,stretch:0}],f=0,m=e;f<m.length;f+=1){var A=m[f],I=A[0],G=A[1],te=l[l.length-1];l.push({fixed:I-te.stretch,stretch:te.stretch}),l.push({fixed:I-te.stretch,stretch:te.stretch+(G-I)})}return l.push({fixed:t+1,stretch:r}),l}function au(e,t,r,l){return e/t*r+l}function hc(e,t,r,l){return e-t*r/l}var Lt=function(t,r,l,f,m,A,I,G,te,pe){if(this.boxStartIndex=t.length,te){var Ce=A.top,Me=A.bottom,ot=A.collisionPadding;ot&&(Ce-=ot[1],Me+=ot[3]);var _t=Me-Ce;_t>0&&(_t=Math.max(10,_t),this.circleDiameter=_t)}else{var Ct=A.top*I-G,Xt=A.bottom*I+G,Zt=A.left*I-G,ar=A.right*I+G,dr=A.collisionPadding;if(dr&&(Zt-=dr[0]*I,Ct-=dr[1]*I,ar+=dr[2]*I,Xt+=dr[3]*I),pe){var br=new re(Zt,Ct),Nr=new re(ar,Ct),Rr=new re(Zt,Xt),pn=new re(ar,Xt),hn=pe*Math.PI/180;br._rotate(hn),Nr._rotate(hn),Rr._rotate(hn),pn._rotate(hn),Zt=Math.min(br.x,Nr.x,Rr.x,pn.x),ar=Math.max(br.x,Nr.x,Rr.x,pn.x),Ct=Math.min(br.y,Nr.y,Rr.y,pn.y),Xt=Math.max(br.y,Nr.y,Rr.y,pn.y)}t.emplaceBack(r.x,r.y,Zt,Ct,ar,Xt,l,f,m)}this.boxEndIndex=t.length},Sr=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=mr),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var l=(this.length>>1)-1;l>=0;l--)this._down(l)};function mr(e,t){return e<t?-1:e>t?1:0}function Dn(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var l=1/0,f=1/0,m=-1/0,A=-1/0,I=e[0],G=0;G<I.length;G++){var te=I[G];(!G||te.x<l)&&(l=te.x),(!G||te.y<f)&&(f=te.y),(!G||te.x>m)&&(m=te.x),(!G||te.y>A)&&(A=te.y)}var pe=Math.min(m-l,A-f),Ce=pe/2,Me=new Sr([],P);if(pe===0)return new re(l,f);for(var ot=l;ot<m;ot+=pe)for(var _t=f;_t<A;_t+=pe)Me.push(new p(ot+Ce,_t+Ce,Ce,e));for(var Ct=function(ar){for(var dr=0,br=0,Nr=0,Rr=ar[0],pn=0,hn=Rr.length,Ln=hn-1;pn<hn;Ln=pn++){var Jn=Rr[pn],Kn=Rr[Ln],Nn=Jn.x*Kn.y-Kn.x*Jn.y;br+=(Jn.x+Kn.x)*Nn,Nr+=(Jn.y+Kn.y)*Nn,dr+=3*Nn}return new p(br/dr,Nr/dr,0,ar)}(e),Xt=Me.length;Me.length;){var Zt=Me.pop();(Zt.d>Ct.d||!Ct.d)&&(Ct=Zt,r&&console.log("found best %d after %d probes",Math.round(1e4*Zt.d)/1e4,Xt)),Zt.max-Ct.d<=t||(Me.push(new p(Zt.p.x-(Ce=Zt.h/2),Zt.p.y-Ce,Ce,e)),Me.push(new p(Zt.p.x+Ce,Zt.p.y-Ce,Ce,e)),Me.push(new p(Zt.p.x-Ce,Zt.p.y+Ce,Ce,e)),Me.push(new p(Zt.p.x+Ce,Zt.p.y+Ce,Ce,e)),Xt+=4)}return r&&(console.log("num probes: "+Xt),console.log("best distance: "+Ct.d)),Ct.p}function P(e,t){return t.max-e.max}function p(e,t,r,l){this.p=new re(e,t),this.h=r,this.d=function(f,m){for(var A=!1,I=1/0,G=0;G<m.length;G++)for(var te=m[G],pe=0,Ce=te.length,Me=Ce-1;pe<Ce;Me=pe++){var ot=te[pe],_t=te[Me];ot.y>f.y!=_t.y>f.y&&f.x<(_t.x-ot.x)*(f.y-ot.y)/(_t.y-ot.y)+ot.x&&(A=!A),I=Math.min(I,oc(f,ot,_t))}return(A?1:-1)*Math.sqrt(I)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}Sr.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},Sr.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},Sr.prototype.peek=function(){return this.data[0]},Sr.prototype._up=function(e){for(var t=this.data,r=this.compare,l=t[e];e>0;){var f=e-1>>1,m=t[f];if(r(l,m)>=0)break;t[e]=m,e=f}t[e]=l},Sr.prototype._down=function(e){for(var t=this.data,r=this.compare,l=this.length>>1,f=t[e];e<l;){var m=1+(e<<1),A=t[m],I=m+1;if(I<this.length&&r(t[I],A)<0&&(m=I,A=t[I]),r(A,f)>=0)break;t[e]=A,e=m}t[e]=f};var s=Number.POSITIVE_INFINITY;function d(e,t){return t[1]!==s?function(r,l,f){var m=0,A=0;switch(l=Math.abs(l),f=Math.abs(f),r){case"top-right":case"top-left":case"top":A=f-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-f}switch(r){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,A]}(e,t[0],t[1]):function(r,l){var f=0,m=0;l<0&&(l=0);var A=l/Math.sqrt(2);switch(r){case"top-right":case"top-left":m=A-7;break;case"bottom-right":case"bottom-left":m=7-A;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(r){case"top-right":case"bottom-right":f=-A;break;case"top-left":case"bottom-left":f=A;break;case"left":f=l;break;case"right":f=-l}return[f,m]}(e,t[0])}function g(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function L(e,t,r,l,f,m,A,I,G,te,pe,Ce,Me,ot,_t){var Ct=function(br,Nr,Rr,pn,hn,Ln,Jn,Kn){for(var Nn=pn.layout.get("text-rotate").evaluate(Ln,{})*Math.PI/180,Si=[],li=0,ei=Nr.positionedLines;li<ei.length;li+=1)for(var $i=ei[li],Di=0,Ga=$i.positionedGlyphs;Di<Ga.length;Di+=1){var gi=Ga[Di];if(gi.rect){var aa=gi.rect||{},Zo=4,Sa=!0,Wo=1,Xo=0,cs=(hn||Kn)&&gi.vertical,Eu=gi.metrics.advance*gi.scale/2;if(Kn&&Nr.verticalizable&&(Xo=$i.lineOffset/2-(gi.imageName?-(24-gi.metrics.width*gi.scale)/2:24*(gi.scale-1))),gi.imageName){var fs=Jn[gi.imageName];Sa=fs.sdf,Zo=1/(Wo=fs.pixelRatio)}var el=hn?[gi.x+Eu,gi.y]:[0,0],ou=hn?[0,0]:[gi.x+Eu+Rr[0],gi.y+Rr[1]-Xo],tl=[0,0];cs&&(tl=ou,ou=[0,0]);var su=(gi.metrics.left-Zo)*gi.scale-Eu+ou[0],Xs=(-gi.metrics.top-Zo)*gi.scale+ou[1],uu=su+aa.w*gi.scale/Wo,ga=Xs+aa.h*gi.scale/Wo,oa=new re(su,Xs),ro=new re(uu,Xs),yo=new re(su,ga),Tu=new re(uu,ga);if(cs){var Ao=new re(-Eu,Eu- -17),Yo=-Math.PI/2,ku=12-Eu,fa=new re(22-ku,-(gi.imageName?ku:0)),eh=new(Function.prototype.bind.apply(re,[null].concat(tl)));oa._rotateAround(Yo,Ao)._add(fa)._add(eh),ro._rotateAround(Yo,Ao)._add(fa)._add(eh),yo._rotateAround(Yo,Ao)._add(fa)._add(eh),Tu._rotateAround(Yo,Ao)._add(fa)._add(eh)}if(Nn){var Yc=Math.sin(Nn),pf=Math.cos(Nn),dc=[pf,-Yc,Yc,pf];oa._matMult(dc),ro._matMult(dc),yo._matMult(dc),Tu._matMult(dc)}var ju=new re(0,0),Bf=new re(0,0);Si.push({tl:oa,tr:ro,bl:yo,br:Tu,tex:aa,writingMode:Nr.writingMode,glyphOffset:el,sectionIndex:gi.sectionIndex,isSDF:Sa,pixelOffsetTL:ju,pixelOffsetBR:Bf,minFontScaleX:0,minFontScaleY:0})}}return Si}(0,r,I,f,m,A,l,e.allowVerticalPlacement),Xt=e.textSizeData,Zt=null;Xt.kind==="source"?(Zt=[128*f.layout.get("text-size").evaluate(A,{})])[0]>32640&&ze(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Xt.kind==="composite"&&((Zt=[128*ot.compositeTextSizes[0].evaluate(A,{},_t),128*ot.compositeTextSizes[1].evaluate(A,{},_t)])[0]>32640||Zt[1]>32640)&&ze(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Ct,Zt,I,m,A,te,t,G.lineStartIndex,G.lineLength,Me,_t);for(var ar=0,dr=pe;ar<dr.length;ar+=1)Ce[dr[ar]]=e.text.placedSymbolArray.length-1;return 4*Ct.length}function N(e){for(var t in e)return e[t];return null}function K(e,t,r,l){var f=e.compareText;if(t in f){for(var m=f[t],A=m.length-1;A>=0;A--)if(l.dist(m[A])<r)return!0}else f[t]=[];return f[t].push(l),!1}var ee=uo.VectorTileFeature.types,X=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function be(e,t,r,l,f,m,A,I,G,te,pe,Ce,Me){var ot=I?Math.min(32640,Math.round(I[0])):0,_t=I?Math.min(32640,Math.round(I[1])):0;e.emplaceBack(t,r,Math.round(32*l),Math.round(32*f),m,A,(ot<<1)+(G?1:0),_t,16*te,16*pe,256*Ce,256*Me)}function me(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function Be(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(Os(r[t].text))return!0;return!1}var pt=function(t){this.layoutVertexArray=new xf,this.indexArray=new Iu,this.programConfigurations=t,this.segments=new Je,this.dynamicLayoutVertexArray=new jl,this.opacityVertexArray=new jc,this.placedSymbolArray=new c};pt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},pt.prototype.upload=function(e,t,r,l){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Af.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,oh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,X,!0),this.opacityVertexBuffer.itemSize=1),(r||l)&&this.programConfigurations.upload(e))},pt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},In("SymbolBuffers",pt);var Kt=function(t,r,l){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new l,this.segments=new Je,this.collisionVertexArray=new Ul};Kt.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,$f.members,!0)},Kt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},In("CollisionBuffers",Kt);var kt=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(A){return A.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ro([]),this.placementViewportMatrix=Ro([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Oa(this.zoom,r["text-size"]),this.iconSizeData=Oa(this.zoom,r["icon-size"]);var l=this.layers[0].layout,f=l.get("symbol-sort-key"),m=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(function(A){return ti[A]})),this.stateDependentLayerIds=this.layers.filter(function(A){return A.isStateDependent()}).map(function(A){return A.id}),this.sourceID=t.sourceID};kt.prototype.createArrays=function(){this.text=new pt(new Li(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new pt(new Li(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new O,this.lineVertexArray=new k,this.symbolInstances=new _},kt.prototype.calculateGlyphDependencies=function(e,t,r,l,f){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(r||l)&&f){var A=zf[e.charAt(m)];A&&(t[A.charCodeAt(0)]=!0)}},kt.prototype.populate=function(e,t,r){var l=this.layers[0],f=l.layout,m=f.get("text-font"),A=f.get("text-field"),I=f.get("icon-image"),G=(A.value.kind!=="constant"||A.value.value instanceof $a&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),te=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,pe=f.get("symbol-sort-key");if(this.features=[],G||te){for(var Ce=t.iconDependencies,Me=t.glyphDependencies,ot=t.availableImages,_t=new Oi(this.zoom),Ct=0,Xt=e;Ct<Xt.length;Ct+=1){var Zt=Xt[Ct],ar=Zt.feature,dr=Zt.id,br=Zt.index,Nr=Zt.sourceLayerIndex,Rr=l._featureFilter.needGeometry,pn=Xa(ar,Rr);if(l._featureFilter.filter(_t,pn,r)){Rr||(pn.geometry=Ta(ar));var hn=void 0;if(G){var Ln=l.getValueAndResolveTokens("text-field",pn,r,ot),Jn=$a.factory(Ln);Be(Jn)&&(this.hasRTLText=!0),(!this.hasRTLText||Bl()==="unavailable"||this.hasRTLText&&ss.isParsed())&&(hn=Cf(Jn,l,pn))}var Kn=void 0;if(te){var Nn=l.getValueAndResolveTokens("icon-image",pn,r,ot);Kn=Nn instanceof Ko?Nn:Ko.fromString(Nn)}if(hn||Kn){var Si=this.sortFeaturesByKey?pe.evaluate(pn,{},r):void 0;if(this.features.push({id:dr,text:hn,icon:Kn,index:br,sourceLayerIndex:Nr,geometry:pn.geometry,properties:ar.properties,type:ee[ar.type],sortKey:Si}),Kn&&(Ce[Kn.name]=!0),hn){var li=m.evaluate(pn,{},r).join(","),ei=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ti.vertical)>=0;for(var $i=0,Di=hn.sections;$i<Di.length;$i+=1){var Ga=Di[$i];if(Ga.image)Ce[Ga.image.name]=!0;else{var gi=kc(hn.toString()),aa=Ga.fontStack||li,Zo=Me[aa]=Me[aa]||{};this.calculateGlyphDependencies(Ga.text,Zo,ei,this.allowVerticalPlacement,gi)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(Sa){var Wo={},Xo={},cs=[],Eu=0;function fs(Ao){cs.push(Sa[Ao]),Eu++}function el(Ao,Yo,ku){var fa=Xo[Ao];return delete Xo[Ao],Xo[Yo]=fa,cs[fa].geometry[0].pop(),cs[fa].geometry[0]=cs[fa].geometry[0].concat(ku[0]),fa}function ou(Ao,Yo,ku){var fa=Wo[Yo];return delete Wo[Yo],Wo[Ao]=fa,cs[fa].geometry[0].shift(),cs[fa].geometry[0]=ku[0].concat(cs[fa].geometry[0]),fa}function tl(Ao,Yo,ku){var fa=ku?Yo[0][Yo[0].length-1]:Yo[0][0];return Ao+":"+fa.x+":"+fa.y}for(var su=0;su<Sa.length;su++){var Xs=Sa[su],uu=Xs.geometry,ga=Xs.text?Xs.text.toString():null;if(ga){var oa=tl(ga,uu),ro=tl(ga,uu,!0);if(oa in Xo&&ro in Wo&&Xo[oa]!==Wo[ro]){var yo=ou(oa,ro,uu),Tu=el(oa,ro,cs[yo].geometry);delete Wo[oa],delete Xo[ro],Xo[tl(ga,cs[Tu].geometry,!0)]=Tu,cs[yo].geometry=null}else oa in Xo?el(oa,ro,uu):ro in Wo?ou(oa,ro,uu):(fs(su),Wo[oa]=Eu-1,Xo[ro]=Eu-1)}else fs(su)}return cs.filter(function(Ao){return Ao.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Sa,Wo){return Sa.sortKey-Wo.sortKey})}},kt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},kt.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},kt.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},kt.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},kt.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},kt.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},kt.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),m={},A=e.segment+1;A<t.length;A++)m[A]={x:t[A].x,y:t[A].y,tileUnitDistanceFromAnchor:l},A<t.length-1&&(l+=t[A+1].dist(t[A]));for(var I=e.segment||0;I>=0;I--)m[I]={x:t[I].x,y:t[I].y,tileUnitDistanceFromAnchor:f},I>0&&(f+=t[I-1].dist(t[I]));for(var G=0;G<t.length;G++){var te=m[G];this.lineVertexArray.emplaceBack(te.x,te.y,te.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},kt.prototype.addSymbols=function(e,t,r,l,f,m,A,I,G,te,pe,Ce){for(var Me=e.indexArray,ot=e.layoutVertexArray,_t=e.segments.prepareSegment(4*t.length,ot,Me,this.canOverlap?m.sortKey:void 0),Ct=this.glyphOffsetArray.length,Xt=_t.vertexLength,Zt=this.allowVerticalPlacement&&A===ti.vertical?Math.PI/2:0,ar=m.text&&m.text.sections,dr=0;dr<t.length;dr++){var br=t[dr],Nr=br.tl,Rr=br.tr,pn=br.bl,hn=br.br,Ln=br.tex,Jn=br.pixelOffsetTL,Kn=br.pixelOffsetBR,Nn=br.minFontScaleX,Si=br.minFontScaleY,li=br.glyphOffset,ei=br.isSDF,$i=br.sectionIndex,Di=_t.vertexLength,Ga=li[1];be(ot,I.x,I.y,Nr.x,Ga+Nr.y,Ln.x,Ln.y,r,ei,Jn.x,Jn.y,Nn,Si),be(ot,I.x,I.y,Rr.x,Ga+Rr.y,Ln.x+Ln.w,Ln.y,r,ei,Kn.x,Jn.y,Nn,Si),be(ot,I.x,I.y,pn.x,Ga+pn.y,Ln.x,Ln.y+Ln.h,r,ei,Jn.x,Kn.y,Nn,Si),be(ot,I.x,I.y,hn.x,Ga+hn.y,Ln.x+Ln.w,Ln.y+Ln.h,r,ei,Kn.x,Kn.y,Nn,Si),me(e.dynamicLayoutVertexArray,I,Zt),Me.emplaceBack(Di,Di+1,Di+2),Me.emplaceBack(Di+1,Di+2,Di+3),_t.vertexLength+=4,_t.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(li[0]),dr!==t.length-1&&$i===t[dr+1].sectionIndex||e.programConfigurations.populatePaintArrays(ot.length,m,m.index,{},Ce,ar&&ar[$i])}e.placedSymbolArray.emplaceBack(I.x,I.y,Ct,this.glyphOffsetArray.length-Ct,Xt,G,te,I.segment,r?r[0]:0,r?r[1]:0,l[0],l[1],A,0,!1,0,pe)},kt.prototype._addCollisionDebugVertex=function(e,t,r,l,f,m){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,l,f,Math.round(m.x),Math.round(m.y))},kt.prototype.addCollisionDebugVertices=function(e,t,r,l,f,m,A){var I=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),G=I.vertexLength,te=f.layoutVertexArray,pe=f.collisionVertexArray,Ce=A.anchorX,Me=A.anchorY;this._addCollisionDebugVertex(te,pe,m,Ce,Me,new re(e,t)),this._addCollisionDebugVertex(te,pe,m,Ce,Me,new re(r,t)),this._addCollisionDebugVertex(te,pe,m,Ce,Me,new re(r,l)),this._addCollisionDebugVertex(te,pe,m,Ce,Me,new re(e,l)),I.vertexLength+=4;var ot=f.indexArray;ot.emplaceBack(G,G+1),ot.emplaceBack(G+1,G+2),ot.emplaceBack(G+2,G+3),ot.emplaceBack(G+3,G),I.primitiveLength+=4},kt.prototype.addDebugCollisionBoxes=function(e,t,r,l){for(var f=e;f<t;f++){var m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,l?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,r)}},kt.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Kt(Vs,dh.members,rc),this.iconCollisionBox=new Kt(Vs,dh.members,rc);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},kt.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,l,f,m,A,I,G){for(var te={},pe=t;pe<r;pe++){var Ce=e.get(pe);te.textBox={x1:Ce.x1,y1:Ce.y1,x2:Ce.x2,y2:Ce.y2,anchorPointX:Ce.anchorPointX,anchorPointY:Ce.anchorPointY},te.textFeatureIndex=Ce.featureIndex;break}for(var Me=l;Me<f;Me++){var ot=e.get(Me);te.verticalTextBox={x1:ot.x1,y1:ot.y1,x2:ot.x2,y2:ot.y2,anchorPointX:ot.anchorPointX,anchorPointY:ot.anchorPointY},te.verticalTextFeatureIndex=ot.featureIndex;break}for(var _t=m;_t<A;_t++){var Ct=e.get(_t);te.iconBox={x1:Ct.x1,y1:Ct.y1,x2:Ct.x2,y2:Ct.y2,anchorPointX:Ct.anchorPointX,anchorPointY:Ct.anchorPointY},te.iconFeatureIndex=Ct.featureIndex;break}for(var Xt=I;Xt<G;Xt++){var Zt=e.get(Xt);te.verticalIconBox={x1:Zt.x1,y1:Zt.y1,x2:Zt.x2,y2:Zt.y2,anchorPointX:Zt.anchorPointX,anchorPointY:Zt.anchorPointY},te.verticalIconFeatureIndex=Zt.featureIndex;break}return te},kt.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},kt.prototype.hasTextData=function(){return this.text.segments.get().length>0},kt.prototype.hasIconData=function(){return this.icon.segments.get().length>0},kt.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},kt.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},kt.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},kt.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),l=r.vertexStartIndex+4*r.numGlyphs,f=r.vertexStartIndex;f<l;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},kt.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),l=[],f=[],m=[],A=0;A<this.symbolInstances.length;++A){m.push(A);var I=this.symbolInstances.get(A);l.push(0|Math.round(t*I.anchorX+r*I.anchorY)),f.push(I.featureIndex)}return m.sort(function(G,te){return l[G]-l[te]||f[te]-f[G]}),m},kt.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},kt.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,l=this.symbolInstanceIndexes;r<l.length;r+=1){var f=this.symbolInstances.get(l[r]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(m,A,I){m>=0&&I.indexOf(m)===A&&t.addIndicesForPlacedSymbol(t.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},In("SymbolBucket",kt,{omit:["layers","collisionBoxArray","features","compareText"]}),kt.MAX_GLYPHS=65535,kt.addDynamicAttributes=me;var Qt=new Io({"symbol-placement":new $n(Ne.layout_symbol["symbol-placement"]),"symbol-spacing":new $n(Ne.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new $n(Ne.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Fn(Ne.layout_symbol["symbol-sort-key"]),"symbol-z-order":new $n(Ne.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new $n(Ne.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new $n(Ne.layout_symbol["icon-ignore-placement"]),"icon-optional":new $n(Ne.layout_symbol["icon-optional"]),"icon-rotation-alignment":new $n(Ne.layout_symbol["icon-rotation-alignment"]),"icon-size":new Fn(Ne.layout_symbol["icon-size"]),"icon-text-fit":new $n(Ne.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new $n(Ne.layout_symbol["icon-text-fit-padding"]),"icon-image":new Fn(Ne.layout_symbol["icon-image"]),"icon-rotate":new Fn(Ne.layout_symbol["icon-rotate"]),"icon-padding":new $n(Ne.layout_symbol["icon-padding"]),"icon-keep-upright":new $n(Ne.layout_symbol["icon-keep-upright"]),"icon-offset":new Fn(Ne.layout_symbol["icon-offset"]),"icon-anchor":new Fn(Ne.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new $n(Ne.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new $n(Ne.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new $n(Ne.layout_symbol["text-rotation-alignment"]),"text-field":new Fn(Ne.layout_symbol["text-field"]),"text-font":new Fn(Ne.layout_symbol["text-font"]),"text-size":new Fn(Ne.layout_symbol["text-size"]),"text-max-width":new Fn(Ne.layout_symbol["text-max-width"]),"text-line-height":new $n(Ne.layout_symbol["text-line-height"]),"text-letter-spacing":new Fn(Ne.layout_symbol["text-letter-spacing"]),"text-justify":new Fn(Ne.layout_symbol["text-justify"]),"text-radial-offset":new Fn(Ne.layout_symbol["text-radial-offset"]),"text-variable-anchor":new $n(Ne.layout_symbol["text-variable-anchor"]),"text-anchor":new Fn(Ne.layout_symbol["text-anchor"]),"text-max-angle":new $n(Ne.layout_symbol["text-max-angle"]),"text-writing-mode":new $n(Ne.layout_symbol["text-writing-mode"]),"text-rotate":new Fn(Ne.layout_symbol["text-rotate"]),"text-padding":new $n(Ne.layout_symbol["text-padding"]),"text-keep-upright":new $n(Ne.layout_symbol["text-keep-upright"]),"text-transform":new Fn(Ne.layout_symbol["text-transform"]),"text-offset":new Fn(Ne.layout_symbol["text-offset"]),"text-allow-overlap":new $n(Ne.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new $n(Ne.layout_symbol["text-ignore-placement"]),"text-optional":new $n(Ne.layout_symbol["text-optional"])}),ur={paint:new Io({"icon-opacity":new Fn(Ne.paint_symbol["icon-opacity"]),"icon-color":new Fn(Ne.paint_symbol["icon-color"]),"icon-halo-color":new Fn(Ne.paint_symbol["icon-halo-color"]),"icon-halo-width":new Fn(Ne.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Fn(Ne.paint_symbol["icon-halo-blur"]),"icon-translate":new $n(Ne.paint_symbol["icon-translate"]),"icon-translate-anchor":new $n(Ne.paint_symbol["icon-translate-anchor"]),"text-opacity":new Fn(Ne.paint_symbol["text-opacity"]),"text-color":new Fn(Ne.paint_symbol["text-color"],{runtimeType:mn,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Fn(Ne.paint_symbol["text-halo-color"]),"text-halo-width":new Fn(Ne.paint_symbol["text-halo-width"]),"text-halo-blur":new Fn(Ne.paint_symbol["text-halo-blur"]),"text-translate":new $n(Ne.paint_symbol["text-translate"]),"text-translate-anchor":new $n(Ne.paint_symbol["text-translate-anchor"])}),layout:Qt},Ur=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:dn,this.defaultValue=t};Ur.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Ur.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Ur.prototype.outputDefined=function(){return!1},Ur.prototype.serialize=function(){return null},In("FormatSectionOverride",Ur,{omit:["defaultValue"]});var on=function(e){function t(r){e.call(this,r,ur)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,l){if(e.prototype.recalculate.call(this,r,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var m=[],A=0,I=f;A<I.length;A+=1){var G=I[A];m.indexOf(G)<0&&m.push(G)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,l,f,m){var A=this.layout.get(r).evaluate(l,{},f,m),I=this._unevaluatedLayout._values[r];return I.isDataDriven()||Bo(I.value)||!A?A:function(G,te){return te.replace(/{([^{}]+)}/g,function(pe,Ce){return Ce in G?String(G[Ce]):""})}(l.properties,A)},t.prototype.createBucket=function(r){return new kt(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,l=ur.paint.overridableProperties;r<l.length;r+=1){var f=l[r];if(t.hasPaintOverride(this.layout,f)){var m,A=this.paint.get(f),I=new Ur(A),G=new Ol(I,A.property.specification);m=A.value.kind==="constant"||A.value.kind==="source"?new Ll("source",G):new xl("composite",G,A.value.zoomStops,A.value._interpolationType),this.paint._values[f]=new Ts(A.property,m,A.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,l,f){return!(!this.layout||l.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,l){var f=r.get("text-field"),m=ur.paint.properties[l],A=!1,I=function(Ce){for(var Me=0,ot=Ce;Me<ot.length;Me+=1)if(m.overrides&&m.overrides.hasOverride(ot[Me]))return void(A=!0)};if(f.value.kind==="constant"&&f.value.value instanceof $a)I(f.value.value.sections);else if(f.value.kind==="source"){var G=function pe(Ce){A||(Ce instanceof na&&Pa(Ce.value)===Ki?I(Ce.value.sections):Ce instanceof lo?I(Ce.sections):Ce.eachChild(pe))},te=f.value;te._styleExpression&&G(te._styleExpression.expression)}return A},t}(nu),Hr={paint:new Io({"background-color":new $n(Ne.paint_background["background-color"]),"background-pattern":new ms(Ne.paint_background["background-pattern"]),"background-opacity":new $n(Ne.paint_background["background-opacity"])})},ln=function(e){function t(r){e.call(this,r,Hr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(nu),Pn={paint:new Io({"raster-opacity":new $n(Ne.paint_raster["raster-opacity"]),"raster-hue-rotate":new $n(Ne.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new $n(Ne.paint_raster["raster-brightness-min"]),"raster-brightness-max":new $n(Ne.paint_raster["raster-brightness-max"]),"raster-saturation":new $n(Ne.paint_raster["raster-saturation"]),"raster-contrast":new $n(Ne.paint_raster["raster-contrast"]),"raster-resampling":new $n(Ne.paint_raster["raster-resampling"]),"raster-fade-duration":new $n(Ne.paint_raster["raster-fade-duration"])})},Hn=function(e){function t(r){e.call(this,r,Pn)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(nu),ai=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(nu),Hi={circle:Pl,heatmap:of,hillshade:Rf,fill:Pr,"fill-extrusion":va,line:Th,symbol:on,background:ln,raster:Hn},ma=J.HTMLImageElement,La=J.HTMLCanvasElement,qu=J.HTMLVideoElement,ts=J.ImageData,ls=J.ImageBitmap,Su=function(t,r,l,f){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(r,f)};Su.prototype.update=function(e,t,r){var l=e.width,f=e.height,m=!(this.size&&this.size[0]===l&&this.size[1]===f||r),A=this.context,I=A.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[l,f],e instanceof ma||e instanceof La||e instanceof qu||e instanceof ts||ls&&e instanceof ls?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,e):I.texImage2D(I.TEXTURE_2D,0,this.format,l,f,0,this.format,I.UNSIGNED_BYTE,e.data);else{var G=r||{x:0,y:0},te=G.x,pe=G.y;e instanceof ma||e instanceof La||e instanceof qu||e instanceof ts||ls&&e instanceof ls?I.texSubImage2D(I.TEXTURE_2D,0,te,pe,I.RGBA,I.UNSIGNED_BYTE,e):I.texSubImage2D(I.TEXTURE_2D,0,te,pe,l,f,I.RGBA,I.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D)},Su.prototype.bind=function(e,t,r){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),r!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Su.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Su.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Nf=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};Nf.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},Nf.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ml=function(t,r,l){this.target=t,this.parent=r,this.mapId=l,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},or(["receive","process"],this),this.invoker=new Nf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=bt()?t:J};function Wc(e,t,r){var l=2*Math.PI*6378137/256/Math.pow(2,r);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}Ml.prototype.send=function(e,t,r,l,f){var m=this;f===void 0&&(f=!1);var A=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[A]=r);var I=z(this.globalScope)?void 0:[];return this.target.postMessage({id:A,type:e,hasCallback:!!r,targetMapId:l,mustQueue:f,sourceMapId:this.mapId,data:Pu(t,I)},I),{cancel:function(){r&&delete m.callbacks[A],m.target.postMessage({id:A,type:"<cancel>",targetMapId:l,sourceMapId:m.mapId})}}},Ml.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var l=this.cancelCallbacks[r];delete this.cancelCallbacks[r],l&&l()}else bt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},Ml.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Ml.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Us(t.error)):l(null,Us(t.data)))}else{var f=!1,m=z(this.globalScope)?void 0:[],A=t.hasCallback?function(pe,Ce){f=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:pe?Pu(pe):null,data:Pu(Ce,m)},m)}:function(pe){f=!0},I=null,G=Us(t.data);if(this.parent[t.type])I=this.parent[t.type](t.sourceMapId,G,A);else if(this.parent.getWorkerSource){var te=t.type.split(".");I=this.parent.getWorkerSource(t.sourceMapId,te[0],G.source)[te[1]](G,A)}else A(new Error("Could not find function "+t.type));!f&&I&&I.cancel&&(this.cancelCallbacks[e]=I.cancel)}},Ml.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var wa=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};wa.prototype.setNorthEast=function(e){return this._ne=e instanceof Fa?new Fa(e.lng,e.lat):Fa.convert(e),this},wa.prototype.setSouthWest=function(e){return this._sw=e instanceof Fa?new Fa(e.lng,e.lat):Fa.convert(e),this},wa.prototype.extend=function(e){var t,r,l=this._sw,f=this._ne;if(e instanceof Fa)t=e,r=e;else{if(!(e instanceof wa))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(wa.convert(e)):this.extend(Fa.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return l||f?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),f.lng=Math.max(r.lng,f.lng),f.lat=Math.max(r.lat,f.lat)):(this._sw=new Fa(t.lng,t.lat),this._ne=new Fa(r.lng,r.lat)),this},wa.prototype.getCenter=function(){return new Fa((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},wa.prototype.getSouthWest=function(){return this._sw},wa.prototype.getNorthEast=function(){return this._ne},wa.prototype.getNorthWest=function(){return new Fa(this.getWest(),this.getNorth())},wa.prototype.getSouthEast=function(){return new Fa(this.getEast(),this.getSouth())},wa.prototype.getWest=function(){return this._sw.lng},wa.prototype.getSouth=function(){return this._sw.lat},wa.prototype.getEast=function(){return this._ne.lng},wa.prototype.getNorth=function(){return this._ne.lat},wa.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},wa.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},wa.prototype.isEmpty=function(){return!(this._sw&&this._ne)},wa.prototype.contains=function(e){var t=Fa.convert(e),r=t.lng,l=t.lat,f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&f},wa.convert=function(e){return!e||e instanceof wa?e:new wa(e)};var Fa=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Fa.prototype.wrap=function(){return new Fa(at(this.lng,-180,180),this.lat)},Fa.prototype.toArray=function(){return[this.lng,this.lat]},Fa.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Fa.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,l=e.lat*t,f=Math.sin(r)*Math.sin(l)+Math.cos(r)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},Fa.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new wa(new Fa(this.lng-r,this.lat-t),new Fa(this.lng+r,this.lat+t))},Fa.convert=function(e){if(e instanceof Fa)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Fa(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Fa(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Pc=2*Math.PI*63710088e-1;function pl(e){return Pc*Math.cos(e*Math.PI/180)}function Xc(e){return(180+e)/360}function Jf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function go(e,t){return e/pl(t)}function vl(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var hf=function(t,r,l){l===void 0&&(l=0),this.x=+t,this.y=+r,this.z=+l};hf.fromLngLat=function(e,t){t===void 0&&(t=0);var r=Fa.convert(e);return new hf(Xc(r.lng),Jf(r.lat),go(t,r.lat))},hf.prototype.toLngLat=function(){return new Fa(360*this.x-180,vl(this.y))},hf.prototype.toAltitude=function(){return this.z*pl(vl(this.y))},hf.prototype.meterInMercatorCoordinateUnits=function(){return 1/Pc*(e=vl(this.y),1/Math.cos(e*Math.PI/180));var e};var df=function(t,r,l){this.z=t,this.x=r,this.y=l,this.key=wf(0,t,t,r,l)};df.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},df.prototype.url=function(e,t){var r,l,f,m,A,I=(l=this.y,f=this.z,m=Wc(256*(r=this.x),256*(l=Math.pow(2,f)-l-1),f),A=Wc(256*(r+1),256*(l+1),f),m[0]+","+m[1]+","+A[0]+","+A[1]),G=function(te,pe,Ce){for(var Me,ot="",_t=te;_t>0;_t--)ot+=(pe&(Me=1<<_t-1)?1:0)+(Ce&Me?2:0);return ot}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",G).replace("{bbox-epsg-3857}",I)},df.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new re(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},df.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Ch=function(t,r){this.wrap=t,this.canonical=r,this.key=wf(t,r.z,r.z,r.x,r.y)},Ya=function(t,r,l,f,m){this.overscaledZ=t,this.wrap=r,this.canonical=new df(l,+f,+m),this.key=wf(r,t,l,f,m)};function wf(e,t,r,l,f){(e*=2)<0&&(e=-1*e-1);var m=1<<r;return(m*m*e+m*f+l).toString(36)+r.toString(36)+t.toString(36)}Ya.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Ya.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Ya(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ya(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Ya.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?wf(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):wf(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Ya.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Ya.prototype.children=function(e){if(this.overscaledZ>=e)return[new Ya(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,l=2*this.canonical.y;return[new Ya(t,this.wrap,t,r,l),new Ya(t,this.wrap,t,r+1,l),new Ya(t,this.wrap,t,r,l+1),new Ya(t,this.wrap,t,r+1,l+1)]},Ya.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Ya.prototype.wrapped=function(){return new Ya(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ya.prototype.unwrapTo=function(e){return new Ya(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Ya.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ya.prototype.toUnwrapped=function(){return new Ch(this.wrap,this.canonical)},Ya.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ya.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new hf(e.x-this.wrap,e.y))},In("CanonicalTileID",df),In("OverscaledTileID",Ya,{omit:["posMatrix"]});var Ff=function(t,r,l){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return ze('"'+l+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var f=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=l||"mapbox";for(var m=0;m<f;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(f,m)]=this.data[this._idx(f-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,f)]=this.data[this._idx(m,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};Ff.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[l],r[l+1],r[l+2])},Ff.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ff.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Ff.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Ff.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Ff.prototype.getPixels=function(){return new Do({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ff.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,f=t*this.dim+this.dim,m=r*this.dim,A=r*this.dim+this.dim;switch(t){case-1:l=f-1;break;case 1:f=l+1}switch(r){case-1:m=A-1;break;case 1:A=m+1}for(var I=-t*this.dim,G=-r*this.dim,te=m;te<A;te++)for(var pe=l;pe<f;pe++)this.data[this._idx(pe,te)]=e.data[this._idx(pe+I,te+G)]},In("DEMData",Ff);var Hh=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var l=t[r];this._stringToNumber[l]=r,this._numberToString[r]=l}};Hh.prototype.encode=function(e){return this._stringToNumber[e]},Hh.prototype.decode=function(e){return this._numberToString[e]};var Zh=function(t,r,l,f,m){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=l,t._y=f,this.properties=t.properties,this.id=m},ed={geometry:{configurable:!0}};ed.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ed.geometry.set=function(e){this._geometry=e},Zh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Zh.prototype,ed);var wh=function(){this.state={},this.stateChanges={},this.deletedStates={}};wh.prototype.updateState=function(e,t,r){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},Oe(this.stateChanges[e][l],r),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==l&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var m in this.deletedStates[e][l]={},this.state[e][l])r[m]||(this.deletedStates[e][l][m]=null);else for(var A in r)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][A]===null&&delete this.deletedStates[e][l][A]},wh.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(r in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][r]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},wh.prototype.getState=function(e,t){var r=String(t),l=Oe({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var m in f)delete l[m]}return l},wh.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},wh.prototype.coalesceChanges=function(e,t){var r={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var f={};for(var m in this.stateChanges[l])this.state[l][m]||(this.state[l][m]={}),Oe(this.state[l][m],this.stateChanges[l][m]),f[m]=this.state[l][m];r[l]=f}for(var A in this.deletedStates){this.state[A]=this.state[A]||{};var I={};if(this.deletedStates[A]===null)for(var G in this.state[A])I[G]={},this.state[A][G]={};else for(var te in this.deletedStates[A]){if(this.deletedStates[A][te]===null)this.state[A][te]={};else for(var pe=0,Ce=Object.keys(this.deletedStates[A][te]);pe<Ce.length;pe+=1)delete this.state[A][te][Ce[pe]];I[te]=this.state[A][te]}r[A]=r[A]||{},Oe(r[A],I)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var Me in e)e[Me].setFeatureState(r,t)};var Qf=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Xu(8192,16,0),this.grid3D=new Xu(8192,16,0),this.featureIndexArray=new Ae,this.promoteId=r};function td(e,t,r,l,f){return Ht(e,function(m,A){var I=t instanceof Ec?t.get(A):null;return I&&I.evaluate?I.evaluate(r,l,f):I})}function rd(e){for(var t=1/0,r=1/0,l=-1/0,f=-1/0,m=0,A=e;m<A.length;m+=1){var I=A[m];t=Math.min(t,I.x),r=Math.min(r,I.y),l=Math.max(l,I.x),f=Math.max(f,I.y)}return{minX:t,minY:r,maxX:l,maxY:f}}function ld(e,t){return t-e}Qf.prototype.insert=function(e,t,r,l,f,m){var A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,l,f);for(var I=m?this.grid3D:this.grid,G=0;G<t.length;G++){for(var te=t[G],pe=[1/0,1/0,-1/0,-1/0],Ce=0;Ce<te.length;Ce++){var Me=te[Ce];pe[0]=Math.min(pe[0],Me.x),pe[1]=Math.min(pe[1],Me.y),pe[2]=Math.max(pe[2],Me.x),pe[3]=Math.max(pe[3],Me.y)}pe[0]<8192&&pe[1]<8192&&pe[2]>=0&&pe[3]>=0&&I.insert(A,pe[0],pe[1],pe[2],pe[3])}},Qf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new uo.VectorTile(new je(this.rawTileData)).layers,this.sourceLayerCoder=new Hh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Qf.prototype.query=function(e,t,r,l){var f=this;this.loadVTLayers();for(var m=e.params||{},A=8192/e.tileSize/e.scale,I=xc(m.filter),G=e.queryGeometry,te=e.queryPadding*A,pe=rd(G),Ce=this.grid.query(pe.minX-te,pe.minY-te,pe.maxX+te,pe.maxY+te),Me=rd(e.cameraQueryGeometry),ot=this.grid3D.query(Me.minX-te,Me.minY-te,Me.maxX+te,Me.maxY+te,function(br,Nr,Rr,pn){return function(hn,Ln,Jn,Kn,Nn){for(var Si=0,li=hn;Si<li.length;Si+=1){var ei=li[Si];if(Ln<=ei.x&&Jn<=ei.y&&Kn>=ei.x&&Nn>=ei.y)return!0}var $i=[new re(Ln,Jn),new re(Ln,Nn),new re(Kn,Nn),new re(Kn,Jn)];if(hn.length>2){for(var Di=0,Ga=$i;Di<Ga.length;Di+=1)if(Ru(hn,Ga[Di]))return!0}for(var gi=0;gi<hn.length-1;gi++)if(dl(hn[gi],hn[gi+1],$i))return!0;return!1}(e.cameraQueryGeometry,br-te,Nr-te,Rr+te,pn+te)}),_t=0,Ct=ot;_t<Ct.length;_t+=1)Ce.push(Ct[_t]);Ce.sort(ld);for(var Xt,Zt={},ar=function(Nr){var Rr=Ce[Nr];if(Rr!==Xt){Xt=Rr;var pn=f.featureIndexArray.get(Rr),hn=null;f.loadMatchingFeature(Zt,pn.bucketIndex,pn.sourceLayerIndex,pn.featureIndex,I,m.layers,m.availableImages,t,r,l,function(Ln,Jn,Kn){return hn||(hn=Ta(Ln)),Jn.queryIntersectsFeature(G,Ln,Kn,hn,f.z,e.transform,A,e.pixelPosMatrix)})}},dr=0;dr<Ce.length;dr++)ar(dr);return Zt},Qf.prototype.loadMatchingFeature=function(e,t,r,l,f,m,A,I,G,te,pe){var Ce=this.bucketLayerIDs[t];if(!m||function(hn,Ln){for(var Jn=0;Jn<hn.length;Jn++)if(Ln.indexOf(hn[Jn])>=0)return!0;return!1}(m,Ce)){var Me=this.sourceLayerCoder.decode(r),ot=this.vtLayers[Me].feature(l);if(f.needGeometry){var _t=Xa(ot,!0);if(!f.filter(new Oi(this.tileID.overscaledZ),_t,this.tileID.canonical))return}else if(!f.filter(new Oi(this.tileID.overscaledZ),ot))return;for(var Ct=this.getId(ot,Me),Xt=0;Xt<Ce.length;Xt++){var Zt=Ce[Xt];if(!(m&&m.indexOf(Zt)<0)){var ar=I[Zt];if(ar){var dr={};Ct!==void 0&&te&&(dr=te.getState(ar.sourceLayer||"_geojsonTileLayer",Ct));var br=Oe({},G[Zt]);br.paint=td(br.paint,ar.paint,ot,dr,A),br.layout=td(br.layout,ar.layout,ot,dr,A);var Nr=!pe||pe(ot,ar,dr);if(Nr){var Rr=new Zh(ot,this.z,this.x,this.y,Ct);Rr.layer=br;var pn=e[Zt];pn===void 0&&(pn=e[Zt]=[]),pn.push({featureIndex:l,feature:Rr,intersectionZ:Nr})}}}}}},Qf.prototype.lookupSymbolFeatures=function(e,t,r,l,f,m,A,I){var G={};this.loadVTLayers();for(var te=xc(f),pe=0,Ce=e;pe<Ce.length;pe+=1)this.loadMatchingFeature(G,r,l,Ce[pe],te,m,A,I,t);return G},Qf.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var l=0,f=r[t];l<f.length;l+=1)if(e===f[l])return!0;return!1},Qf.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},In("FeatureIndex",Qf,{omit:["rawTileData","sourceLayerCoder"]});var bs=function(t,r){this.tileID=t,this.uid=Mt(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};bs.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<le.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},bs.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},bs.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(te,pe){var Ce={};if(!pe)return Ce;for(var Me=function(){var Xt=_t[ot],Zt=Xt.layerIds.map(function(br){return pe.getLayer(br)}).filter(Boolean);if(Zt.length!==0){Xt.layers=Zt,Xt.stateDependentLayerIds&&(Xt.stateDependentLayers=Xt.stateDependentLayerIds.map(function(br){return Zt.filter(function(Nr){return Nr.id===br})[0]}));for(var ar=0,dr=Zt;ar<dr.length;ar+=1)Ce[dr[ar].id]=Xt}},ot=0,_t=te;ot<_t.length;ot+=1)Me();return Ce}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[l];if(f instanceof kt){if(this.hasSymbolBuckets=!0,!r)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var A=this.buckets[m];if(A instanceof kt&&A.hasRTLText){this.hasRTLText=!0,ss.isLoading()||ss.isLoaded()||Bl()!=="deferred"||Ls();break}}for(var I in this.queryPadding=0,this.buckets){var G=this.buckets[I];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(I).queryRadius(G))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new i},bs.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},bs.prototype.getBucket=function(e){return this.buckets[e.id]},bs.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Su(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Su(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},bs.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},bs.prototype.queryRenderedFeatures=function(e,t,r,l,f,m,A,I,G,te){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:f,scale:m,tileSize:this.tileSize,pixelPosMatrix:te,transform:I,params:A,queryPadding:this.queryPadding*G},e,t,r):{}},bs.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var l=r.loadVTLayers(),f=t?t.sourceLayer:"",m=l._geojsonTileLayer||l[f];if(m)for(var A=xc(t&&t.filter),I=this.tileID.canonical,G=I.z,te=I.x,pe=I.y,Ce={z:G,x:te,y:pe},Me=0;Me<m.length;Me++){var ot=m.feature(Me);if(A.needGeometry){var _t=Xa(ot,!0);if(!A.filter(new Oi(this.tileID.overscaledZ),_t,this.tileID.canonical))continue}else if(!A.filter(new Oi(this.tileID.overscaledZ),ot))continue;var Ct=r.getId(ot,f),Xt=new Zh(ot,G,te,pe,Ct);Xt.tile=Ce,e.push(Xt)}}},bs.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},bs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},bs.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=dt(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),f=!1;if(this.expirationTime>l)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var m=this.expirationTime-t;m?this.expirationTime=l+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},bs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},bs.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var f=this.buckets[l],m=f.layers[0].sourceLayer||"_geojsonTileLayer",A=r[m],I=e[m];if(A&&I&&Object.keys(I).length!==0){f.update(I,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});var G=t&&t.style&&t.style.getLayer(l);G&&(this.queryPadding=Math.max(this.queryPadding,G.queryRadius(f)))}}}},bs.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},bs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<le.now()},bs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},bs.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=le.now()+e},bs.prototype.setDependencies=function(e,t){for(var r={},l=0,f=t;l<f.length;l+=1)r[f[l]]=!0;this.dependencies[e]=r},bs.prototype.hasDependency=function(e,t){for(var r=0,l=e;r<l.length;r+=1){var f=this.dependencies[l[r]];if(f){for(var m=0,A=t;m<A.length;m+=1)if(f[A[m]])return!0}}return!1};var qf=J.performance,cd=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},qf.mark(this._marks.start)};cd.prototype.finish=function(){qf.mark(this._marks.end);var e=qf.getEntriesByName(this._marks.measure);return e.length===0&&(qf.measure(this._marks.measure,this._marks.start,this._marks.end),e=qf.getEntriesByName(this._marks.measure),qf.clearMarks(this._marks.start),qf.clearMarks(this._marks.end),qf.clearMeasures(this._marks.measure)),e},a.Actor=Ml,a.AlphaImage=Hs,a.CanonicalTileID=df,a.CollisionBoxArray=i,a.Color=ci,a.DEMData=Ff,a.DataConstantProperty=$n,a.DictionaryCoder=Hh,a.EXTENT=8192,a.ErrorEvent=et,a.EvaluationParameters=Oi,a.Event=Le,a.Evented=wt,a.FeatureIndex=Qf,a.FillBucket=Gt,a.FillExtrusionBucket=Fi,a.ImageAtlas=Yn,a.ImagePosition=Vr,a.LineBucket=Bu,a.LngLat=Fa,a.LngLatBounds=wa,a.MercatorCoordinate=hf,a.ONE_EM=24,a.OverscaledTileID=Ya,a.Point=re,a.Point$1=re,a.Properties=Io,a.Protobuf=je,a.RGBAImage=Do,a.RequestManager=R,a.RequestPerformance=cd,a.ResourceType=Zr,a.SegmentVector=Je,a.SourceFeatureState=wh,a.StructArrayLayout1ui2=nc,a.StructArrayLayout2f1f2i16=Cl,a.StructArrayLayout2i4=hl,a.StructArrayLayout3ui6=Iu,a.StructArrayLayout4i8=tc,a.SymbolBucket=kt,a.Texture=Su,a.Tile=bs,a.Transitionable=Mo,a.Uniform1f=an,a.Uniform1i=Cr,a.Uniform2f=Yr,a.Uniform3f=yn,a.Uniform4f=On,a.UniformColor=Qn,a.UniformMatrix4f=xi,a.UnwrappedTileID=Ch,a.ValidationError=gt,a.WritingMode=ti,a.ZoomHistory=ea,a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},a.addDynamicAttributes=me,a.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var l=e.length,f=new Array(e.length),m=null;e.forEach(function(A,I){t(A,function(G,te){G&&(m=G),f[I]=te,--l==0&&r(m,f)})})},a.bezier=Ge,a.bindAll=or,a.browser=le,a.cacheEntryPossiblyAdded=function(e){++Vt>vt&&(e.getActor().send("enforceCacheSizeLimit",Pt),Vt=0)},a.clamp=Re,a.clearTileCache=function(e){var t=J.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=Sn,a.clone=function(e){var t=new Lo(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=Xe,a.clone$2=function(e){var t=new Lo(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=Fh,a.config=ye,a.create=function(){var e=new Lo(16);return Lo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new Lo(9);return Lo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new Lo(4);return Lo!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=Y,a.createExpression=Jl,a.createLayout=Wa,a.createStyleLayer=function(e){return e.type==="custom"?new ai(e):new Hi[e.type](e)},a.cross=function(e,t,r){var l=t[0],f=t[1],m=t[2],A=r[0],I=r[1],G=r[2];return e[0]=f*G-m*I,e[1]=m*A-l*G,e[2]=l*I-f*A,e},a.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],r[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(var f in t)if(!e(t[f],r[f]))return!1;return!0}return t===r},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=_e,a.emitValidationErrors=pu,a.endsWith=$t,a.enforceCacheSizeLimit=function(e){Pe(),$e&&$e.then(function(t){t.keys().then(function(r){for(var l=0;l<r.length-e;l++)t.delete(r[l])})})},a.evaluateSizeForFeature=ws,a.evaluateSizeForZoom=Qo,a.evaluateVariableOffset=d,a.evented=af,a.extend=Oe,a.featureFilter=xc,a.filterObject=mt,a.fromRotation=function(e,t){var r=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=r,e[2]=0,e[3]=-r,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=Go,a.getAnchorJustification=g,a.getArrayBuffer=Zn,a.getImage=de,a.getJSON=function(e,t){return fi(Oe(e,{type:"json"}),t)},a.getRTLTextPluginStatus=Bl,a.getReferrer=jn,a.getVideo=function(e,t){var r,l,f=J.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var m=0;m<e.length;m++){var A=J.document.createElement("source");r=e[m],l=void 0,(l=J.document.createElement("a")).href=r,(l.protocol!==J.document.location.protocol||l.host!==J.document.location.host)&&(f.crossOrigin="Anonymous"),A.src=e[m],f.appendChild(A)}return{cancel:function(){}}},a.identity=Ro,a.invert=function(e,t){var r=t[0],l=t[1],f=t[2],m=t[3],A=t[4],I=t[5],G=t[6],te=t[7],pe=t[8],Ce=t[9],Me=t[10],ot=t[11],_t=t[12],Ct=t[13],Xt=t[14],Zt=t[15],ar=r*I-l*A,dr=r*G-f*A,br=r*te-m*A,Nr=l*G-f*I,Rr=l*te-m*I,pn=f*te-m*G,hn=pe*Ct-Ce*_t,Ln=pe*Xt-Me*_t,Jn=pe*Zt-ot*_t,Kn=Ce*Xt-Me*Ct,Nn=Ce*Zt-ot*Ct,Si=Me*Zt-ot*Xt,li=ar*Si-dr*Nn+br*Kn+Nr*Jn-Rr*Ln+pn*hn;return li?(e[0]=(I*Si-G*Nn+te*Kn)*(li=1/li),e[1]=(f*Nn-l*Si-m*Kn)*li,e[2]=(Ct*pn-Xt*Rr+Zt*Nr)*li,e[3]=(Me*Rr-Ce*pn-ot*Nr)*li,e[4]=(G*Jn-A*Si-te*Ln)*li,e[5]=(r*Si-f*Jn+m*Ln)*li,e[6]=(Xt*br-_t*pn-Zt*dr)*li,e[7]=(pe*pn-Me*br+ot*dr)*li,e[8]=(A*Nn-I*Jn+te*hn)*li,e[9]=(l*Jn-r*Nn-m*hn)*li,e[10]=(_t*Rr-Ct*br+Zt*ar)*li,e[11]=(Ce*br-pe*Rr-ot*ar)*li,e[12]=(I*Ln-A*Kn-G*hn)*li,e[13]=(r*Kn-l*Ln+f*hn)*li,e[14]=(Ct*dr-_t*Nr-Xt*ar)*li,e[15]=(pe*Nr-Ce*dr+Me*ar)*li,e):null},a.isChar=en,a.isMapboxURL=q,a.keysDifference=function(e,t){var r=[];for(var l in e)l in t||r.push(l);return r},a.makeRequest=fi,a.mapObject=Ht,a.mercatorXfromLng=Xc,a.mercatorYfromLat=Jf,a.mercatorZfromAltitude=go,a.mul=Vo,a.multiply=Jo,a.mvt=uo,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var r=t[0],l=t[1],f=t[2],m=r*r+l*l+f*f;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},a.number=ka,a.offscreenCanvasSupported=pr,a.ortho=function(e,t,r,l,f,m,A){var I=1/(t-r),G=1/(l-f),te=1/(m-A);return e[0]=-2*I,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*G,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*te,e[11]=0,e[12]=(t+r)*I,e[13]=(f+l)*G,e[14]=(A+m)*te,e[15]=1,e},a.parseGlyphPBF=function(e){return new je(e).readFields(Lr,[])},a.pbf=je,a.performSymbolLayout=function(e,t,r,l,f,m,A){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var I=e.layers[0].layout,G=e.layers[0]._unevaluatedLayout._values,te={};if(e.textSizeData.kind==="composite"){var pe=e.textSizeData,Ce=pe.maxZoom;te.compositeTextSizes=[G["text-size"].possiblyEvaluate(new Oi(pe.minZoom),A),G["text-size"].possiblyEvaluate(new Oi(Ce),A)]}if(e.iconSizeData.kind==="composite"){var Me=e.iconSizeData,ot=Me.maxZoom;te.compositeIconSizes=[G["icon-size"].possiblyEvaluate(new Oi(Me.minZoom),A),G["icon-size"].possiblyEvaluate(new Oi(ot),A)]}te.layoutTextSize=G["text-size"].possiblyEvaluate(new Oi(e.zoom+1),A),te.layoutIconSize=G["icon-size"].possiblyEvaluate(new Oi(e.zoom+1),A),te.textMaxSize=G["text-size"].possiblyEvaluate(new Oi(18));for(var _t=24*I.get("text-line-height"),Ct=I.get("text-rotation-alignment")==="map"&&I.get("symbol-placement")!=="point",Xt=I.get("text-keep-upright"),Zt=I.get("text-size"),ar=function(){var Rr=br[dr],pn=I.get("text-font").evaluate(Rr,{},A).join(","),hn=Zt.evaluate(Rr,{},A),Ln=te.layoutTextSize.evaluate(Rr,{},A),Jn=te.layoutIconSize.evaluate(Rr,{},A),Kn={horizontal:{},vertical:void 0},Nn=Rr.text,Si=[0,0];if(Nn){var li=Nn.toString(),ei=24*I.get("text-letter-spacing").evaluate(Rr,{},A),$i=function(ga){for(var oa=0,ro=ga;oa<ro.length;oa+=1)if(yo=ro[oa].charCodeAt(0),en.Arabic(yo)||en["Arabic Supplement"](yo)||en["Arabic Extended-A"](yo)||en["Arabic Presentation Forms-A"](yo)||en["Arabic Presentation Forms-B"](yo))return!1;var yo;return!0}(li)?ei:0,Di=I.get("text-anchor").evaluate(Rr,{},A),Ga=I.get("text-variable-anchor");if(!Ga){var gi=I.get("text-radial-offset").evaluate(Rr,{},A);Si=gi?d(Di,[24*gi,s]):I.get("text-offset").evaluate(Rr,{},A).map(function(ga){return 24*ga})}var aa=Ct?"center":I.get("text-justify").evaluate(Rr,{},A),Zo=I.get("symbol-placement"),Sa=Zo==="point"?24*I.get("text-max-width").evaluate(Rr,{},A):0,Wo=function(){e.allowVerticalPlacement&&kc(li)&&(Kn.vertical=Fr(Nn,t,r,f,pn,Sa,_t,Di,"left",$i,Si,ti.vertical,!0,Zo,Ln,hn))};if(!Ct&&Ga){for(var Xo=aa==="auto"?Ga.map(function(ga){return g(ga)}):[aa],cs=!1,Eu=0;Eu<Xo.length;Eu++){var fs=Xo[Eu];if(!Kn.horizontal[fs])if(cs)Kn.horizontal[fs]=Kn.horizontal[0];else{var el=Fr(Nn,t,r,f,pn,Sa,_t,"center",fs,$i,Si,ti.horizontal,!1,Zo,Ln,hn);el&&(Kn.horizontal[fs]=el,cs=el.positionedLines.length===1)}}Wo()}else{aa==="auto"&&(aa=g(Di));var ou=Fr(Nn,t,r,f,pn,Sa,_t,Di,aa,$i,Si,ti.horizontal,!1,Zo,Ln,hn);ou&&(Kn.horizontal[aa]=ou),Wo(),kc(li)&&Ct&&Xt&&(Kn.vertical=Fr(Nn,t,r,f,pn,Sa,_t,Di,aa,$i,Si,ti.vertical,!1,Zo,Ln,hn))}}var tl=void 0,su=!1;if(Rr.icon&&Rr.icon.name){var Xs=l[Rr.icon.name];Xs&&(tl=function(ga,oa,ro){var yo=Go(ro),Tu=oa[0]-ga.displaySize[0]*yo.horizontalAlign,Ao=oa[1]-ga.displaySize[1]*yo.verticalAlign;return{image:ga,top:Ao,bottom:Ao+ga.displaySize[1],left:Tu,right:Tu+ga.displaySize[0]}}(f[Rr.icon.name],I.get("icon-offset").evaluate(Rr,{},A),I.get("icon-anchor").evaluate(Rr,{},A)),su=Xs.sdf,e.sdfIcons===void 0?e.sdfIcons=Xs.sdf:e.sdfIcons!==Xs.sdf&&ze("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Xs.pixelRatio!==e.pixelRatio||I.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var uu=N(Kn.horizontal)||Kn.vertical;e.iconsInText=!!uu&&uu.iconsInText,(uu||tl)&&function(ga,oa,ro,yo,Tu,Ao,Yo,ku,fa,eh,Yc){var pf=Ao.textMaxSize.evaluate(oa,{});pf===void 0&&(pf=Yo);var dc,ju=ga.layers[0].layout,Bf=ju.get("icon-offset").evaluate(oa,{},Yc),kf=N(ro.horizontal),th=Yo/24,Ph=ga.tilePixelRatio*th,Pf=ga.tilePixelRatio*pf/24,_h=ga.tilePixelRatio*ku,rh=ga.tilePixelRatio*ju.get("symbol-spacing"),ph=ju.get("text-padding")*ga.tilePixelRatio,Wh=ju.get("icon-padding")*ga.tilePixelRatio,Bh=ju.get("text-max-angle")/180*Math.PI,Xh=ju.get("text-rotation-alignment")==="map"&&ju.get("symbol-placement")!=="point",vh=ju.get("icon-rotation-alignment")==="map"&&ju.get("symbol-placement")!=="point",Mh=ju.get("symbol-placement"),Yh=rh/2,mh=ju.get("icon-text-fit");yo&&mh!=="none"&&(ga.allowVerticalPlacement&&ro.vertical&&(dc=ta(yo,ro.vertical,mh,ju.get("icon-text-fit-padding"),Bf,th)),kf&&(yo=ta(yo,kf,mh,ju.get("icon-text-fit-padding"),Bf,th)));var nh=function(fd,zh){zh.x<0||zh.x>=8192||zh.y<0||zh.y>=8192||function(Ss,Kc,hd,ih,od,h,T,E,S,C,M,j,ae,ge,Ue,Dt,Jt,_r,Dr,xn,gn,Bn,Ei,Ai,Ba){var sa,ua,no,Ci,io,Co=Ss.addToLineVertexArray(Kc,hd),Ys=0,Yi=0,Ps=0,rs=0,vf=-1,Nh=-1,_c={},Sh=zt(""),uh=0,$c=0;if(E._unevaluatedLayout.getValue("text-radial-offset")===void 0?(uh=(sa=E.layout.get("text-offset").evaluate(gn,{},Ai).map(function(Td){return 24*Td}))[0],$c=sa[1]):(uh=24*E.layout.get("text-radial-offset").evaluate(gn,{},Ai),$c=s),Ss.allowVerticalPlacement&&ih.vertical){var dd=E.layout.get("text-rotate").evaluate(gn,{},Ai)+90;Ci=new Lt(S,Kc,C,M,j,ih.vertical,ae,ge,Ue,dd),T&&(io=new Lt(S,Kc,C,M,j,T,Jt,_r,Ue,dd))}if(od){var sd=E.layout.get("icon-rotate").evaluate(gn,{}),pd=E.layout.get("icon-text-fit")!=="none",vd=Ri(od,sd,Ei,pd),ud=T?Ri(T,sd,Ei,pd):void 0;no=new Lt(S,Kc,C,M,j,od,Jt,_r,!1,sd),Ys=4*vd.length;var md=Ss.iconSizeData,Gh=null;md.kind==="source"?(Gh=[128*E.layout.get("icon-size").evaluate(gn,{})])[0]>32640&&ze(Ss.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):md.kind==="composite"&&((Gh=[128*Bn.compositeIconSizes[0].evaluate(gn,{},Ai),128*Bn.compositeIconSizes[1].evaluate(gn,{},Ai)])[0]>32640||Gh[1]>32640)&&ze(Ss.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ss.addSymbols(Ss.icon,vd,Gh,xn,Dr,gn,!1,Kc,Co.lineStartIndex,Co.lineLength,-1,Ai),vf=Ss.icon.placedSymbolArray.length-1,ud&&(Yi=4*ud.length,Ss.addSymbols(Ss.icon,ud,Gh,xn,Dr,gn,ti.vertical,Kc,Co.lineStartIndex,Co.lineLength,-1,Ai),Nh=Ss.icon.placedSymbolArray.length-1)}for(var gd in ih.horizontal){var qh=ih.horizontal[gd];if(!ua){Sh=zt(qh.text);var ki=E.layout.get("text-rotate").evaluate(gn,{},Ai);ua=new Lt(S,Kc,C,M,j,qh,ae,ge,Ue,ki)}var Ha=qh.positionedLines.length===1;if(Ps+=L(Ss,Kc,qh,h,E,Ue,gn,Dt,Co,ih.vertical?ti.horizontal:ti.horizontalOnly,Ha?Object.keys(ih.horizontal):[gd],_c,vf,Bn,Ai),Ha)break}ih.vertical&&(rs+=L(Ss,Kc,ih.vertical,h,E,Ue,gn,Dt,Co,ti.vertical,["vertical"],_c,Nh,Bn,Ai));var la=ua?ua.boxStartIndex:Ss.collisionBoxArray.length,zn=ua?ua.boxEndIndex:Ss.collisionBoxArray.length,Mc=Ci?Ci.boxStartIndex:Ss.collisionBoxArray.length,Es=Ci?Ci.boxEndIndex:Ss.collisionBoxArray.length,Jc=no?no.boxStartIndex:Ss.collisionBoxArray.length,Qc=no?no.boxEndIndex:Ss.collisionBoxArray.length,Eh=io?io.boxStartIndex:Ss.collisionBoxArray.length,yd=io?io.boxEndIndex:Ss.collisionBoxArray.length,lh=-1,xd=function(bd,Ad){return bd&&bd.circleDiameter?Math.max(bd.circleDiameter,Ad):Ad};lh=xd(ua,lh),lh=xd(Ci,lh),lh=xd(no,lh);var Ed=(lh=xd(io,lh))>-1?1:0;Ed&&(lh*=Ba/24),Ss.glyphOffsetArray.length>=kt.MAX_GLYPHS&&ze("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),gn.sortKey!==void 0&&Ss.addToSortKeyRanges(Ss.symbolInstances.length,gn.sortKey),Ss.symbolInstances.emplaceBack(Kc.x,Kc.y,_c.right>=0?_c.right:-1,_c.center>=0?_c.center:-1,_c.left>=0?_c.left:-1,_c.vertical||-1,vf,Nh,Sh,la,zn,Mc,Es,Jc,Qc,Eh,yd,C,Ps,rs,Ys,Yi,Ed,0,ae,uh,$c,lh)}(ga,zh,fd,ro,yo,Tu,dc,ga.layers[0],ga.collisionBoxArray,oa.index,oa.sourceLayerIndex,ga.index,Ph,ph,Xh,fa,_h,Wh,vh,Bf,oa,Ao,eh,Yc,Yo)};if(Mh==="line")for(var sh=0,Kh=Sn(oa.geometry,0,0,8192,8192);sh<Kh.length;sh+=1)for(var kh=Kh[sh],gh=0,jh=Ca(kh,rh,Bh,ro.vertical||kf,yo,24,Pf,ga.overscaling,8192);gh<jh.length;gh+=1){var Ih=jh[gh];kf&&K(ga,kf.text,Yh,Ih)||nh(kh,Ih)}else if(Mh==="line-center")for(var yh=0,Uh=oa.geometry;yh<Uh.length;yh+=1){var Vh=Uh[yh];if(Vh.length>1){var Oh=Ws(Vh,Bh,ro.vertical||kf,yo,24,Pf);Oh&&nh(Vh,Oh)}}else if(oa.type==="Polygon")for(var Lh=0,xh=D(oa.geometry,0);Lh<xh.length;Lh+=1){var Rh=xh[Lh],bh=Dn(Rh,16);nh(Rh[0],new mo(bh.x,bh.y,0))}else if(oa.type==="LineString")for(var jf=0,Dh=oa.geometry;jf<Dh.length;jf+=1){var $h=Dh[jf];nh($h,new mo($h[0].x,$h[0].y,0))}else if(oa.type==="Point")for(var Jh=0,nd=oa.geometry;Jh<nd.length;Jh+=1)for(var id=0,ad=nd[Jh];id<ad.length;id+=1){var Qh=ad[id];nh([Qh],new mo(Qh.x,Qh.y,0))}}(e,Rr,Kn,tl,l,te,Ln,Jn,Si,su,A)},dr=0,br=e.features;dr<br.length;dr+=1)ar();m&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,r,l,f){var m,A=1/Math.tan(t/2);return e[0]=A/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=A,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+l)*(m=1/(l-f)),e[14]=2*f*l*m):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var r={},l=0;l<t.length;l++){var f=t[l];f in e&&(r[f]=e[f])}return r},a.plugin=ss,a.polygonIntersectsPolygon=yu,a.postMapLoadEvent=ht,a.postTurnstileEvent=lr,a.potpack=jr,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=In,a.registerForPluginStateChange=function(e){return e({pluginStatus:ko,pluginURL:cl}),af.on("pluginStateChange",e),e},a.renderColorRamp=ys,a.rotate=function(e,t,r){var l=t[0],f=t[1],m=t[2],A=t[3],I=Math.sin(r),G=Math.cos(r);return e[0]=l*G+m*I,e[1]=f*G+A*I,e[2]=l*-I+m*G,e[3]=f*-I+A*G,e},a.rotateX=function(e,t,r){var l=Math.sin(r),f=Math.cos(r),m=t[4],A=t[5],I=t[6],G=t[7],te=t[8],pe=t[9],Ce=t[10],Me=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*f+te*l,e[5]=A*f+pe*l,e[6]=I*f+Ce*l,e[7]=G*f+Me*l,e[8]=te*f-m*l,e[9]=pe*f-A*l,e[10]=Ce*f-I*l,e[11]=Me*f-G*l,e},a.rotateZ=function(e,t,r){var l=Math.sin(r),f=Math.cos(r),m=t[0],A=t[1],I=t[2],G=t[3],te=t[4],pe=t[5],Ce=t[6],Me=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*f+te*l,e[1]=A*f+pe*l,e[2]=I*f+Ce*l,e[3]=G*f+Me*l,e[4]=te*f-m*l,e[5]=pe*f-A*l,e[6]=Ce*f-I*l,e[7]=Me*f-G*l,e},a.scale=function(e,t,r){var l=r[0],f=r[1],m=r[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},a.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},a.setCacheLimits=function(e,t){Pt=e,vt=t},a.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),ko==="deferred"||ko==="loading"||ko==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");cl=le.resolveURL(e),ko="deferred",$o=t,Fl(),r||Ls()},a.sphericalToCartesian=function(e){var t=e[0],r=e[1],l=e[2];return r+=90,r*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(l),y:t*Math.sin(r)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},a.styleSpec=Ne,a.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},a.symbolSize=xs,a.transformMat3=function(e,t,r){var l=t[0],f=t[1],m=t[2];return e[0]=l*r[0]+f*r[3]+m*r[6],e[1]=l*r[1]+f*r[4]+m*r[7],e[2]=l*r[2]+f*r[5]+m*r[8],e},a.transformMat4=Gs,a.translate=function(e,t,r){var l,f,m,A,I,G,te,pe,Ce,Me,ot,_t,Ct=r[0],Xt=r[1],Zt=r[2];return t===e?(e[12]=t[0]*Ct+t[4]*Xt+t[8]*Zt+t[12],e[13]=t[1]*Ct+t[5]*Xt+t[9]*Zt+t[13],e[14]=t[2]*Ct+t[6]*Xt+t[10]*Zt+t[14],e[15]=t[3]*Ct+t[7]*Xt+t[11]*Zt+t[15]):(f=t[1],m=t[2],A=t[3],I=t[4],G=t[5],te=t[6],pe=t[7],Ce=t[8],Me=t[9],ot=t[10],_t=t[11],e[0]=l=t[0],e[1]=f,e[2]=m,e[3]=A,e[4]=I,e[5]=G,e[6]=te,e[7]=pe,e[8]=Ce,e[9]=Me,e[10]=ot,e[11]=_t,e[12]=l*Ct+I*Xt+Ce*Zt+t[12],e[13]=f*Ct+G*Xt+Me*Zt+t[13],e[14]=m*Ct+te*Xt+ot*Zt+t[14],e[15]=A*Ct+pe*Xt+_t*Zt+t[15]),e},a.triggerPluginCompletionEvent=Tl,a.uniqueId=Mt,a.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=yf,a.validateStyle=ql,a.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},a.vectorTile=uo,a.version="1.13.0",a.warnOnce=ze,a.webpSupported=He,a.window=J,a.wrap=at}),F(["./shared"],function(a){"use strict";function Y(Te){var de=typeof Te;if(de==="number"||de==="boolean"||de==="string"||Te==null)return JSON.stringify(Te);if(Array.isArray(Te)){for(var W="[",se=0,Le=Te;se<Le.length;se+=1)W+=Y(Le[se])+",";return W+"]"}for(var et=Object.keys(Te).sort(),wt="{",Ne=0;Ne<et.length;Ne++)wt+=JSON.stringify(et[Ne])+":"+Y(Te[et[Ne]])+",";return wt+"}"}function B(Te){for(var de="",W=0,se=a.refProperties;W<se.length;W+=1)de+="/"+Y(Te[se[W]]);return de}var Q=function(de){this.keyCache={},de&&this.replace(de)};Q.prototype.replace=function(Te){this._layerConfigs={},this._layers={},this.update(Te,[])},Q.prototype.update=function(Te,de){for(var W=this,se=0,Le=Te;se<Le.length;se+=1){var et=Le[se];this._layerConfigs[et.id]=et;var wt=this._layers[et.id]=a.createStyleLayer(et);wt._featureFilter=a.featureFilter(wt.filter),this.keyCache[et.id]&&delete this.keyCache[et.id]}for(var Ne=0,gt=de;Ne<gt.length;Ne+=1){var qt=gt[Ne];delete this.keyCache[qt],delete this._layerConfigs[qt],delete this._layers[qt]}this.familiesBySource={};for(var zr=0,Br=function(vn,mn){for(var Ar={},$r=0;$r<vn.length;$r++){var Mn=mn&&mn[vn[$r].id]||B(vn[$r]);mn&&(mn[vn[$r].id]=Mn);var Ki=Ar[Mn];Ki||(Ki=Ar[Mn]=[]),Ki.push(vn[$r])}var vi=[];for(var Mi in Ar)vi.push(Ar[Mi]);return vi}(a.values(this._layerConfigs),this.keyCache);zr<Br.length;zr+=1){var sr=Br[zr].map(function(vn){return W._layers[vn.id]}),kr=sr[0];if(kr.visibility!=="none"){var Cn=kr.source||"",dn=this.familiesBySource[Cn];dn||(dn=this.familiesBySource[Cn]={});var Er=kr.sourceLayer||"_geojsonTileLayer",Tn=dn[Er];Tn||(Tn=dn[Er]=[]),Tn.push(sr)}}};var re=function(de){var W={},se=[];for(var Le in de){var et=de[Le],wt=W[Le]={};for(var Ne in et){var gt=et[+Ne];if(gt&&gt.bitmap.width!==0&&gt.bitmap.height!==0){var qt={x:0,y:0,w:gt.bitmap.width+2,h:gt.bitmap.height+2};se.push(qt),wt[Ne]={rect:qt,metrics:gt.metrics}}}}var zr=a.potpack(se),Br=new a.AlphaImage({width:zr.w||1,height:zr.h||1});for(var sr in de){var kr=de[sr];for(var Cn in kr){var dn=kr[+Cn];if(dn&&dn.bitmap.width!==0&&dn.bitmap.height!==0){var Er=W[sr][Cn].rect;a.AlphaImage.copy(dn.bitmap,Br,{x:0,y:0},{x:Er.x+1,y:Er.y+1},dn.bitmap)}}}this.image=Br,this.positions=W};a.register("GlyphAtlas",re);var we=function(de){this.tileID=new a.OverscaledTileID(de.tileID.overscaledZ,de.tileID.wrap,de.tileID.canonical.z,de.tileID.canonical.x,de.tileID.canonical.y),this.uid=de.uid,this.zoom=de.zoom,this.pixelRatio=de.pixelRatio,this.tileSize=de.tileSize,this.source=de.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=de.showCollisionBoxes,this.collectResourceTiming=!!de.collectResourceTiming,this.returnDependencies=!!de.returnDependencies,this.promoteId=de.promoteId};function J(Te,de,W){for(var se=new a.EvaluationParameters(de),Le=0,et=Te;Le<et.length;Le+=1)et[Le].recalculate(se,W)}function Ke(Te,de){var W=a.getArrayBuffer(Te.request,function(se,Le,et,wt){se?de(se):Le&&de(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(Le)),rawData:Le,cacheControl:et,expires:wt})});return function(){W.cancel(),de()}}we.prototype.parse=function(Te,de,W,se,Le){var et=this;this.status="parsing",this.data=Te,this.collisionBoxArray=new a.CollisionBoxArray;var wt=new a.DictionaryCoder(Object.keys(Te.layers).sort()),Ne=new a.FeatureIndex(this.tileID,this.promoteId);Ne.bucketLayerIDs=[];var gt,qt,zr,Br,sr={},kr={featureIndex:Ne,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:W},Cn=de.familiesBySource[this.source];for(var dn in Cn){var Er=Te.layers[dn];if(Er){Er.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+dn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Tn=wt.encode(dn),vn=[],mn=0;mn<Er.length;mn++){var Ar=Er.feature(mn),$r=Ne.getId(Ar,dn);vn.push({feature:Ar,id:$r,index:mn,sourceLayerIndex:Tn})}for(var Mn=0,Ki=Cn[dn];Mn<Ki.length;Mn+=1){var vi=Ki[Mn],Mi=vi[0];Mi.minzoom&&this.zoom<Math.floor(Mi.minzoom)||Mi.maxzoom&&this.zoom>=Mi.maxzoom||Mi.visibility!=="none"&&(J(vi,this.zoom,W),(sr[Mi.id]=Mi.createBucket({index:Ne.bucketLayerIDs.length,layers:vi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Tn,sourceID:this.source})).populate(vn,kr,this.tileID.canonical),Ne.bucketLayerIDs.push(vi.map(function(Ii){return Ii.id})))}}}var zi=a.mapObject(kr.glyphDependencies,function(Ii){return Object.keys(Ii).map(Number)});Object.keys(zi).length?se.send("getGlyphs",{uid:this.uid,stacks:zi},function(Ii,yi){gt||(gt=Ii,qt=yi,ya.call(et))}):qt={};var Ka=Object.keys(kr.iconDependencies);Ka.length?se.send("getImages",{icons:Ka,source:this.source,tileID:this.tileID,type:"icons"},function(Ii,yi){gt||(gt=Ii,zr=yi,ya.call(et))}):zr={};var hi=Object.keys(kr.patternDependencies);function ya(){if(gt)return Le(gt);if(qt&&zr&&Br){var Ii=new re(qt),yi=new a.ImageAtlas(zr,Br);for(var ci in sr){var Ra=sr[ci];Ra instanceof a.SymbolBucket?(J(Ra.layers,this.zoom,W),a.performSymbolLayout(Ra,qt,Ii.positions,zr,yi.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ra.hasPattern&&(Ra instanceof a.LineBucket||Ra instanceof a.FillBucket||Ra instanceof a.FillExtrusionBucket)&&(J(Ra.layers,this.zoom,W),Ra.addFeatures(kr,this.tileID.canonical,yi.patternPositions))}this.status="done",Le(null,{buckets:a.values(sr).filter(function(xo){return!xo.isEmpty()}),featureIndex:Ne,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ii.image,imageAtlas:yi,glyphMap:this.returnDependencies?qt:null,iconMap:this.returnDependencies?zr:null,glyphPositions:this.returnDependencies?Ii.positions:null})}}hi.length?se.send("getImages",{icons:hi,source:this.source,tileID:this.tileID,type:"patterns"},function(Ii,yi){gt||(gt=Ii,Br=yi,ya.call(et))}):Br={},ya.call(this)};var Ge=function(de,W,se,Le){this.actor=de,this.layerIndex=W,this.availableImages=se,this.loadVectorData=Le||Ke,this.loading={},this.loaded={}};Ge.prototype.loadTile=function(Te,de){var W=this,se=Te.uid;this.loading||(this.loading={});var Le=!!(Te&&Te.request&&Te.request.collectResourceTiming)&&new a.RequestPerformance(Te.request),et=this.loading[se]=new we(Te);et.abort=this.loadVectorData(Te,function(wt,Ne){if(delete W.loading[se],wt||!Ne)return et.status="done",W.loaded[se]=et,de(wt);var gt=Ne.rawData,qt={};Ne.expires&&(qt.expires=Ne.expires),Ne.cacheControl&&(qt.cacheControl=Ne.cacheControl);var zr={};if(Le){var Br=Le.finish();Br&&(zr.resourceTiming=JSON.parse(JSON.stringify(Br)))}et.vectorTile=Ne.vectorTile,et.parse(Ne.vectorTile,W.layerIndex,W.availableImages,W.actor,function(sr,kr){if(sr||!kr)return de(sr);de(null,a.extend({rawTileData:gt.slice(0)},kr,qt,zr))}),W.loaded=W.loaded||{},W.loaded[se]=et})},Ge.prototype.reloadTile=function(Te,de){var W=this,se=this.loaded,Le=Te.uid,et=this;if(se&&se[Le]){var wt=se[Le];wt.showCollisionBoxes=Te.showCollisionBoxes;var Ne=function(qt,zr){var Br=wt.reloadCallback;Br&&(delete wt.reloadCallback,wt.parse(wt.vectorTile,et.layerIndex,W.availableImages,et.actor,Br)),de(qt,zr)};wt.status==="parsing"?wt.reloadCallback=Ne:wt.status==="done"&&(wt.vectorTile?wt.parse(wt.vectorTile,this.layerIndex,this.availableImages,this.actor,Ne):Ne())}},Ge.prototype.abortTile=function(Te,de){var W=this.loading,se=Te.uid;W&&W[se]&&W[se].abort&&(W[se].abort(),delete W[se]),de()},Ge.prototype.removeTile=function(Te,de){var W=this.loaded,se=Te.uid;W&&W[se]&&delete W[se],de()};var _e=a.window.ImageBitmap,Re=function(){this.loaded={}};function at(Te,de){if(Te.length!==0){Oe(Te[0],de);for(var W=1;W<Te.length;W++)Oe(Te[W],!de)}}function Oe(Te,de){for(var W=0,se=0,Le=Te.length,et=Le-1;se<Le;et=se++)W+=(Te[se][0]-Te[et][0])*(Te[et][1]+Te[se][1]);W>=0!=!!de&&Te.reverse()}Re.prototype.loadTile=function(Te,de){var W=Te.uid,se=Te.encoding,Le=Te.rawImageData,et=_e&&Le instanceof _e?this.getImageData(Le):Le,wt=new a.DEMData(W,et,se);this.loaded=this.loaded||{},this.loaded[W]=wt,de(null,wt)},Re.prototype.getImageData=function(Te){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Te.width,Te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Te.width,this.offscreenCanvas.height=Te.height,this.offscreenCanvasContext.drawImage(Te,0,0,Te.width,Te.height);var de=this.offscreenCanvasContext.getImageData(-1,-1,Te.width+2,Te.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:de.width,height:de.height},de.data)},Re.prototype.removeTile=function(Te){var de=this.loaded,W=Te.uid;de&&de[W]&&delete de[W]};var xt=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,Mt=function(de){this._feature=de,this.extent=a.EXTENT,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))};Mt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Te=[],de=0,W=this._feature.geometry;de<W.length;de+=1){var se=W[de];Te.push([new a.Point$1(se[0],se[1])])}return Te}for(var Le=[],et=0,wt=this._feature.geometry;et<wt.length;et+=1){for(var Ne=[],gt=0,qt=wt[et];gt<qt.length;gt+=1){var zr=qt[gt];Ne.push(new a.Point$1(zr[0],zr[1]))}Le.push(Ne)}return Le},Mt.prototype.toGeoJSON=function(Te,de,W){return xt.call(this,Te,de,W)};var Et=function(de){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=de.length,this._features=de};Et.prototype.feature=function(Te){return new Mt(this._features[Te])};var St=a.vectorTile.VectorTileFeature,or=$t;function $t(Te,de){this.options=de||{},this.features=Te,this.length=Te.length}function Ht(Te,de){this.id=typeof Te.id=="number"?Te.id:void 0,this.type=Te.type,this.rawGeometry=Te.type===1?[Te.geometry]:Te.geometry,this.properties=Te.tags,this.extent=de||4096}$t.prototype.feature=function(Te){return new Ht(this.features[Te],this.options.extent)},Ht.prototype.loadGeometry=function(){var Te=this.rawGeometry;this.geometry=[];for(var de=0;de<Te.length;de++){for(var W=Te[de],se=[],Le=0;Le<W.length;Le++)se.push(new a.Point$1(W[Le][0],W[Le][1]));this.geometry.push(se)}return this.geometry},Ht.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Te=this.geometry,de=1/0,W=-1/0,se=1/0,Le=-1/0,et=0;et<Te.length;et++)for(var wt=Te[et],Ne=0;Ne<wt.length;Ne++){var gt=wt[Ne];de=Math.min(de,gt.x),W=Math.max(W,gt.x),se=Math.min(se,gt.y),Le=Math.max(Le,gt.y)}return[de,se,W,Le]},Ht.prototype.toGeoJSON=St.prototype.toGeoJSON;var mt=Tt,Xe=or;function Tt(Te){var de=new a.pbf;return function(W,se){for(var Le in W.layers)se.writeMessage(3,ze,W.layers[Le])}(Te,de),de.finish()}function ze(Te,de){var W;de.writeVarintField(15,Te.version||1),de.writeStringField(1,Te.name||""),de.writeVarintField(5,Te.extent||4096);var se={keys:[],values:[],keycache:{},valuecache:{}};for(W=0;W<Te.length;W++)se.feature=Te.feature(W),de.writeMessage(2,st,se);var Le=se.keys;for(W=0;W<Le.length;W++)de.writeStringField(3,Le[W]);var et=se.values;for(W=0;W<et.length;W++)de.writeMessage(4,z,et[W])}function st(Te,de){var W=Te.feature;W.id!==void 0&&de.writeVarintField(1,W.id),de.writeMessage(2,Wt,Te),de.writeVarintField(3,W.type),de.writeMessage(4,H,W)}function Wt(Te,de){var W=Te.feature,se=Te.keys,Le=Te.values,et=Te.keycache,wt=Te.valuecache;for(var Ne in W.properties){var gt=et[Ne];gt===void 0&&(se.push(Ne),et[Ne]=gt=se.length-1),de.writeVarint(gt);var qt=W.properties[Ne],zr=typeof qt;zr!=="string"&&zr!=="boolean"&&zr!=="number"&&(qt=JSON.stringify(qt));var Br=zr+":"+qt,sr=wt[Br];sr===void 0&&(Le.push(qt),wt[Br]=sr=Le.length-1),de.writeVarint(sr)}}function bt(Te,de){return(de<<3)+(7&Te)}function dt(Te){return Te<<1^Te>>31}function H(Te,de){for(var W=Te.loadGeometry(),se=Te.type,Le=0,et=0,wt=W.length,Ne=0;Ne<wt;Ne++){var gt=W[Ne],qt=1;se===1&&(qt=gt.length),de.writeVarint(bt(1,qt));for(var zr=se===3?gt.length-1:gt.length,Br=0;Br<zr;Br++){Br===1&&se!==1&&de.writeVarint(bt(2,zr-1));var sr=gt[Br].x-Le,kr=gt[Br].y-et;de.writeVarint(dt(sr)),de.writeVarint(dt(kr)),Le+=sr,et+=kr}se===3&&de.writeVarint(bt(7,1))}}function z(Te,de){var W=typeof Te;W==="string"?de.writeStringField(1,Te):W==="boolean"?de.writeBooleanField(7,Te):W==="number"&&(Te%1!=0?de.writeDoubleField(3,Te):Te<0?de.writeSVarintField(6,Te):de.writeVarintField(5,Te))}function V(Te,de,W,se){Se(Te,W,se),Se(de,2*W,2*se),Se(de,2*W+1,2*se+1)}function Se(Te,de,W){var se=Te[de];Te[de]=Te[W],Te[W]=se}function ve(Te,de,W,se){var Le=Te-W,et=de-se;return Le*Le+et*et}mt.fromVectorTileJs=Tt,mt.fromGeojsonVt=function(Te,de){de=de||{};var W={};for(var se in Te)W[se]=new or(Te[se].features,de),W[se].name=se,W[se].version=de.version,W[se].extent=de.extent;return Tt({layers:W})},mt.GeoJSONWrapper=Xe;var ce=function(de){return de[0]},fe=function(de){return de[1]},ke=function(de,W,se,Le,et){W===void 0&&(W=ce),se===void 0&&(se=fe),Le===void 0&&(Le=64),et===void 0&&(et=Float64Array),this.nodeSize=Le,this.points=de;for(var wt=de.length<65536?Uint16Array:Uint32Array,Ne=this.ids=new wt(de.length),gt=this.coords=new et(2*de.length),qt=0;qt<de.length;qt++)Ne[qt]=qt,gt[2*qt]=W(de[qt]),gt[2*qt+1]=se(de[qt]);(function zr(Br,sr,kr,Cn,dn,Er){if(!(dn-Cn<=kr)){var Tn=Cn+dn>>1;(function vn(mn,Ar,$r,Mn,Ki,vi){for(;Ki>Mn;){if(Ki-Mn>600){var Mi=Ki-Mn+1,zi=$r-Mn+1,Ka=Math.log(Mi),hi=.5*Math.exp(2*Ka/3),ya=.5*Math.sqrt(Ka*hi*(Mi-hi)/Mi)*(zi-Mi/2<0?-1:1);vn(mn,Ar,$r,Math.max(Mn,Math.floor($r-zi*hi/Mi+ya)),Math.min(Ki,Math.floor($r+(Mi-zi)*hi/Mi+ya)),vi)}var Ii=Ar[2*$r+vi],yi=Mn,ci=Ki;for(V(mn,Ar,Mn,$r),Ar[2*Ki+vi]>Ii&&V(mn,Ar,Mn,Ki);yi<ci;){for(V(mn,Ar,yi,ci),yi++,ci--;Ar[2*yi+vi]<Ii;)yi++;for(;Ar[2*ci+vi]>Ii;)ci--}Ar[2*Mn+vi]===Ii?V(mn,Ar,Mn,ci):V(mn,Ar,++ci,Ki),ci<=$r&&(Mn=ci+1),$r<=ci&&(Ki=ci-1)}})(Br,sr,Tn,Cn,dn,Er%2),zr(Br,sr,kr,Cn,Tn-1,Er+1),zr(Br,sr,kr,Tn+1,dn,Er+1)}})(Ne,gt,Le,0,Ne.length-1,0)};ke.prototype.range=function(Te,de,W,se){return function(Le,et,wt,Ne,gt,qt,zr){for(var Br,sr,kr=[0,Le.length-1,0],Cn=[];kr.length;){var dn=kr.pop(),Er=kr.pop(),Tn=kr.pop();if(Er-Tn<=zr)for(var vn=Tn;vn<=Er;vn++)sr=et[2*vn+1],(Br=et[2*vn])>=wt&&Br<=gt&&sr>=Ne&&sr<=qt&&Cn.push(Le[vn]);else{var mn=Math.floor((Tn+Er)/2);sr=et[2*mn+1],(Br=et[2*mn])>=wt&&Br<=gt&&sr>=Ne&&sr<=qt&&Cn.push(Le[mn]);var Ar=(dn+1)%2;(dn===0?wt<=Br:Ne<=sr)&&(kr.push(Tn),kr.push(mn-1),kr.push(Ar)),(dn===0?gt>=Br:qt>=sr)&&(kr.push(mn+1),kr.push(Er),kr.push(Ar))}}return Cn}(this.ids,this.coords,Te,de,W,se,this.nodeSize)},ke.prototype.within=function(Te,de,W){return function(se,Le,et,wt,Ne,gt){for(var qt=[0,se.length-1,0],zr=[],Br=Ne*Ne;qt.length;){var sr=qt.pop(),kr=qt.pop(),Cn=qt.pop();if(kr-Cn<=gt)for(var dn=Cn;dn<=kr;dn++)ve(Le[2*dn],Le[2*dn+1],et,wt)<=Br&&zr.push(se[dn]);else{var Er=Math.floor((Cn+kr)/2),Tn=Le[2*Er],vn=Le[2*Er+1];ve(Tn,vn,et,wt)<=Br&&zr.push(se[Er]);var mn=(sr+1)%2;(sr===0?et-Ne<=Tn:wt-Ne<=vn)&&(qt.push(Cn),qt.push(Er-1),qt.push(mn)),(sr===0?et+Ne>=Tn:wt+Ne>=vn)&&(qt.push(Er+1),qt.push(kr),qt.push(mn))}}return zr}(this.ids,this.coords,Te,de,W,this.nodeSize)};var lt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(de){return de}},nt=function(de){this.options=w(Object.create(lt),de),this.trees=new Array(this.options.maxZoom+1)};function le(Te,de,W,se,Le){return{x:Te,y:de,zoom:1/0,id:W,parentId:-1,numPoints:se,properties:Le}}function ye(Te,de){var W=Te.geometry.coordinates,se=W[1];return{x:De(W[0]),y:Ze(se),zoom:1/0,index:de,parentId:-1}}function He(Te){return{type:"Feature",id:Te.id,properties:ft(Te),geometry:{type:"Point",coordinates:[(se=Te.x,360*(se-.5)),(de=Te.y,W=(180-360*de)*Math.PI/180,360*Math.atan(Math.exp(W))/Math.PI-90)]}};var de,W,se}function ft(Te){var de=Te.numPoints,W=de>=1e4?Math.round(de/1e3)+"k":de>=1e3?Math.round(de/100)/10+"k":de;return w(w({},Te.properties),{cluster:!0,cluster_id:Te.id,point_count:de,point_count_abbreviated:W})}function De(Te){return Te/360+.5}function Ze(Te){var de=Math.sin(Te*Math.PI/180),W=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return W<0?0:W>1?1:W}function w(Te,de){for(var W in de)Te[W]=de[W];return Te}function R(Te){return Te.x}function q(Te){return Te.y}function he(Te,de,W,se,Le,et){var wt=Le-W,Ne=et-se;if(wt!==0||Ne!==0){var gt=((Te-W)*wt+(de-se)*Ne)/(wt*wt+Ne*Ne);gt>1?(W=Le,se=et):gt>0&&(W+=wt*gt,se+=Ne*gt)}return(wt=Te-W)*wt+(Ne=de-se)*Ne}function Ve(Te,de,W,se){var Le={id:Te===void 0?null:Te,type:de,geometry:W,tags:se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(et){var wt=et.geometry,Ne=et.type;if(Ne==="Point"||Ne==="MultiPoint"||Ne==="LineString")Ye(et,wt);else if(Ne==="Polygon"||Ne==="MultiLineString")for(var gt=0;gt<wt.length;gt++)Ye(et,wt[gt]);else if(Ne==="MultiPolygon")for(gt=0;gt<wt.length;gt++)for(var qt=0;qt<wt[gt].length;qt++)Ye(et,wt[gt][qt])}(Le),Le}function Ye(Te,de){for(var W=0;W<de.length;W+=3)Te.minX=Math.min(Te.minX,de[W]),Te.minY=Math.min(Te.minY,de[W+1]),Te.maxX=Math.max(Te.maxX,de[W]),Te.maxY=Math.max(Te.maxY,de[W+1])}function yt(Te,de,W,se){if(de.geometry){var Le=de.geometry.coordinates,et=de.geometry.type,wt=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2),Ne=[],gt=de.id;if(W.promoteId?gt=de.properties[W.promoteId]:W.generateId&&(gt=se||0),et==="Point")it(Le,Ne);else if(et==="MultiPoint")for(var qt=0;qt<Le.length;qt++)it(Le[qt],Ne);else if(et==="LineString")Nt(Le,Ne,wt,!1);else if(et==="MultiLineString"){if(W.lineMetrics){for(qt=0;qt<Le.length;qt++)Nt(Le[qt],Ne=[],wt,!1),Te.push(Ve(gt,"LineString",Ne,de.properties));return}$(Le,Ne,wt,!1)}else if(et==="Polygon")$(Le,Ne,wt,!0);else{if(et!=="MultiPolygon"){if(et==="GeometryCollection"){for(qt=0;qt<de.geometry.geometries.length;qt++)yt(Te,{id:gt,geometry:de.geometry.geometries[qt],properties:de.properties},W,se);return}throw new Error("Input data is not a valid GeoJSON object.")}for(qt=0;qt<Le.length;qt++){var zr=[];$(Le[qt],zr,wt,!0),Ne.push(zr)}}Te.push(Ve(gt,et,Ne,de.properties))}}function it(Te,de){de.push($e(Te[0])),de.push(ie(Te[1])),de.push(0)}function Nt(Te,de,W,se){for(var Le,et,wt=0,Ne=0;Ne<Te.length;Ne++){var gt=$e(Te[Ne][0]),qt=ie(Te[Ne][1]);de.push(gt),de.push(qt),de.push(0),Ne>0&&(wt+=se?(Le*qt-gt*et)/2:Math.sqrt(Math.pow(gt-Le,2)+Math.pow(qt-et,2))),Le=gt,et=qt}var zr=de.length-3;de[2]=1,function Br(sr,kr,Cn,dn){for(var Er,Tn=dn,vn=Cn-kr>>1,mn=Cn-kr,Ar=sr[kr],$r=sr[kr+1],Mn=sr[Cn],Ki=sr[Cn+1],vi=kr+3;vi<Cn;vi+=3){var Mi=he(sr[vi],sr[vi+1],Ar,$r,Mn,Ki);if(Mi>Tn)Er=vi,Tn=Mi;else if(Mi===Tn){var zi=Math.abs(vi-vn);zi<mn&&(Er=vi,mn=zi)}}Tn>dn&&(Er-kr>3&&Br(sr,kr,Er,dn),sr[Er+2]=Tn,Cn-Er>3&&Br(sr,Er,Cn,dn))}(de,0,zr,W),de[zr+2]=1,de.size=Math.abs(wt),de.start=0,de.end=de.size}function $(Te,de,W,se){for(var Le=0;Le<Te.length;Le++){var et=[];Nt(Te[Le],et,W,se),de.push(et)}}function $e(Te){return Te/360+.5}function ie(Te){var de=Math.sin(Te*Math.PI/180),W=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return W<0?0:W>1?1:W}function qe(Te,de,W,se,Le,et,wt,Ne){if(se/=de,et>=(W/=de)&&wt<se)return Te;if(wt<W||et>=se)return null;for(var gt=[],qt=0;qt<Te.length;qt++){var zr=Te[qt],Br=zr.geometry,sr=zr.type,kr=Le===0?zr.minX:zr.minY,Cn=Le===0?zr.maxX:zr.maxY;if(kr>=W&&Cn<se)gt.push(zr);else if(!(Cn<W||kr>=se)){var dn=[];if(sr==="Point"||sr==="MultiPoint")jt(Br,dn,W,se,Le);else if(sr==="LineString")lr(Br,dn,W,se,Le,!1,Ne.lineMetrics);else if(sr==="MultiLineString")ht(Br,dn,W,se,Le,!1);else if(sr==="Polygon")ht(Br,dn,W,se,Le,!0);else if(sr==="MultiPolygon")for(var Er=0;Er<Br.length;Er++){var Tn=[];ht(Br[Er],Tn,W,se,Le,!0),Tn.length&&dn.push(Tn)}if(dn.length){if(Ne.lineMetrics&&sr==="LineString"){for(Er=0;Er<dn.length;Er++)gt.push(Ve(zr.id,sr,dn[Er],zr.tags));continue}sr!=="LineString"&&sr!=="MultiLineString"||(dn.length===1?(sr="LineString",dn=dn[0]):sr="MultiLineString"),sr!=="Point"&&sr!=="MultiPoint"||(sr=dn.length===3?"Point":"MultiPoint"),gt.push(Ve(zr.id,sr,dn,zr.tags))}}}return gt.length?gt:null}function jt(Te,de,W,se,Le){for(var et=0;et<Te.length;et+=3){var wt=Te[et+Le];wt>=W&&wt<=se&&(de.push(Te[et]),de.push(Te[et+1]),de.push(Te[et+2]))}}function lr(Te,de,W,se,Le,et,wt){for(var Ne,gt,qt=ct(Te),zr=Le===0?vt:Pe,Br=Te.start,sr=0;sr<Te.length-3;sr+=3){var kr=Te[sr],Cn=Te[sr+1],dn=Te[sr+2],Er=Te[sr+3],Tn=Te[sr+4],vn=Le===0?kr:Cn,mn=Le===0?Er:Tn,Ar=!1;wt&&(Ne=Math.sqrt(Math.pow(kr-Er,2)+Math.pow(Cn-Tn,2))),vn<W?mn>W&&(gt=zr(qt,kr,Cn,Er,Tn,W),wt&&(qt.start=Br+Ne*gt)):vn>se?mn<se&&(gt=zr(qt,kr,Cn,Er,Tn,se),wt&&(qt.start=Br+Ne*gt)):Pt(qt,kr,Cn,dn),mn<W&&vn>=W&&(gt=zr(qt,kr,Cn,Er,Tn,W),Ar=!0),mn>se&&vn<=se&&(gt=zr(qt,kr,Cn,Er,Tn,se),Ar=!0),!et&&Ar&&(wt&&(qt.end=Br+Ne*gt),de.push(qt),qt=ct(Te)),wt&&(Br+=Ne)}var $r=Te.length-3;kr=Te[$r],Cn=Te[$r+1],dn=Te[$r+2],(vn=Le===0?kr:Cn)>=W&&vn<=se&&Pt(qt,kr,Cn,dn),$r=qt.length-3,et&&$r>=3&&(qt[$r]!==qt[0]||qt[$r+1]!==qt[1])&&Pt(qt,qt[0],qt[1],qt[2]),qt.length&&de.push(qt)}function ct(Te){var de=[];return de.size=Te.size,de.start=Te.start,de.end=Te.end,de}function ht(Te,de,W,se,Le,et){for(var wt=0;wt<Te.length;wt++)lr(Te[wt],de,W,se,Le,et,!1)}function Pt(Te,de,W,se){Te.push(de),Te.push(W),Te.push(se)}function vt(Te,de,W,se,Le,et){var wt=(et-de)/(se-de);return Te.push(et),Te.push(W+(Le-W)*wt),Te.push(1),wt}function Pe(Te,de,W,se,Le,et){var wt=(et-W)/(Le-W);return Te.push(de+(se-de)*wt),Te.push(et),Te.push(1),wt}function ut(Te,de){for(var W=[],se=0;se<Te.length;se++){var Le,et=Te[se],wt=et.type;if(wt==="Point"||wt==="MultiPoint"||wt==="LineString")Le=Qe(et.geometry,de);else if(wt==="MultiLineString"||wt==="Polygon"){Le=[];for(var Ne=0;Ne<et.geometry.length;Ne++)Le.push(Qe(et.geometry[Ne],de))}else if(wt==="MultiPolygon")for(Le=[],Ne=0;Ne<et.geometry.length;Ne++){for(var gt=[],qt=0;qt<et.geometry[Ne].length;qt++)gt.push(Qe(et.geometry[Ne][qt],de));Le.push(gt)}W.push(Ve(et.id,wt,Le,et.tags))}return W}function Qe(Te,de){var W=[];W.size=Te.size,Te.start!==void 0&&(W.start=Te.start,W.end=Te.end);for(var se=0;se<Te.length;se+=3)W.push(Te[se]+de,Te[se+1],Te[se+2]);return W}function Vt(Te,de){if(Te.transformed)return Te;var W,se,Le,et=1<<Te.z,wt=Te.x,Ne=Te.y;for(W=0;W<Te.features.length;W++){var gt=Te.features[W],qt=gt.geometry,zr=gt.type;if(gt.geometry=[],zr===1)for(se=0;se<qt.length;se+=2)gt.geometry.push(pr(qt[se],qt[se+1],de,et,wt,Ne));else for(se=0;se<qt.length;se++){var Br=[];for(Le=0;Le<qt[se].length;Le+=2)Br.push(pr(qt[se][Le],qt[se][Le+1],de,et,wt,Ne));gt.geometry.push(Br)}}return Te.transformed=!0,Te}function pr(Te,de,W,se,Le,et){return[Math.round(W*(Te*se-Le)),Math.round(W*(de*se-et))]}function Zr(Te,de,W,se,Le){for(var et=de===Le.maxZoom?0:Le.tolerance/((1<<de)*Le.extent),wt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:W,y:se,z:de,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ne=0;Ne<Te.length;Ne++){wt.numFeatures++,cr(wt,Te[Ne],et,Le);var gt=Te[Ne].minX,qt=Te[Ne].minY,zr=Te[Ne].maxX,Br=Te[Ne].maxY;gt<wt.minX&&(wt.minX=gt),qt<wt.minY&&(wt.minY=qt),zr>wt.maxX&&(wt.maxX=zr),Br>wt.maxY&&(wt.maxY=Br)}return wt}function cr(Te,de,W,se){var Le=de.geometry,et=de.type,wt=[];if(et==="Point"||et==="MultiPoint")for(var Ne=0;Ne<Le.length;Ne+=3)wt.push(Le[Ne]),wt.push(Le[Ne+1]),Te.numPoints++,Te.numSimplified++;else if(et==="LineString")jn(wt,Le,Te,W,!1,!1);else if(et==="MultiLineString"||et==="Polygon")for(Ne=0;Ne<Le.length;Ne++)jn(wt,Le[Ne],Te,W,et==="Polygon",Ne===0);else if(et==="MultiPolygon")for(var gt=0;gt<Le.length;gt++){var qt=Le[gt];for(Ne=0;Ne<qt.length;Ne++)jn(wt,qt[Ne],Te,W,!0,Ne===0)}if(wt.length){var zr=de.tags||null;if(et==="LineString"&&se.lineMetrics){for(var Br in zr={},de.tags)zr[Br]=de.tags[Br];zr.mapbox_clip_start=Le.start/Le.size,zr.mapbox_clip_end=Le.end/Le.size}var sr={geometry:wt,type:et==="Polygon"||et==="MultiPolygon"?3:et==="LineString"||et==="MultiLineString"?2:1,tags:zr};de.id!==null&&(sr.id=de.id),Te.features.push(sr)}}function jn(Te,de,W,se,Le,et){var wt=se*se;if(se>0&&de.size<(Le?wt:se))W.numPoints+=de.length/3;else{for(var Ne=[],gt=0;gt<de.length;gt+=3)(se===0||de[gt+2]>wt)&&(W.numSimplified++,Ne.push(de[gt]),Ne.push(de[gt+1])),W.numPoints++;Le&&function(qt,zr){for(var Br=0,sr=0,kr=qt.length,Cn=kr-2;sr<kr;Cn=sr,sr+=2)Br+=(qt[sr]-qt[Cn])*(qt[sr+1]+qt[Cn+1]);if(Br>0===zr)for(sr=0,kr=qt.length;sr<kr/2;sr+=2){var dn=qt[sr],Er=qt[sr+1];qt[sr]=qt[kr-2-sr],qt[sr+1]=qt[kr-1-sr],qt[kr-2-sr]=dn,qt[kr-1-sr]=Er}}(Ne,et),Te.push(Ne)}}function En(Te,de){var W=(de=this.options=function(Le,et){for(var wt in et)Le[wt]=et[wt];return Le}(Object.create(this.options),de)).debug;if(W&&console.time("preprocess data"),de.maxZoom<0||de.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(de.promoteId&&de.generateId)throw new Error("promoteId and generateId cannot be used together.");var se=function(Le,et){var wt=[];if(Le.type==="FeatureCollection")for(var Ne=0;Ne<Le.features.length;Ne++)yt(wt,Le.features[Ne],et,Ne);else yt(wt,Le.type==="Feature"?Le:{geometry:Le},et);return wt}(Te,de);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",de.indexMaxZoom,de.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(se=function(Le,et){var wt=et.buffer/et.extent,Ne=Le,gt=qe(Le,1,-1-wt,wt,0,-1,2,et),qt=qe(Le,1,1-wt,2+wt,0,-1,2,et);return(gt||qt)&&(Ne=qe(Le,1,-wt,1+wt,0,-1,2,et)||[],gt&&(Ne=ut(gt,1).concat(Ne)),qt&&(Ne=Ne.concat(ut(qt,-1)))),Ne}(se,de)).length&&this.splitTile(se,0,0,0),W&&(se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ni(Te,de,W){return 32*((1<<Te)*W+de)+Te}function fi(Te,de){var W=Te.tileID.canonical;if(!this._geoJSONIndex)return de(null,null);var se=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!se)return de(null,null);var Le=new Et(se.features),et=mt(Le);et.byteOffset===0&&et.byteLength===et.buffer.byteLength||(et=new Uint8Array(et)),de(null,{vectorTile:Le,rawData:et.buffer})}nt.prototype.load=function(Te){var de=this.options,W=de.log,se=de.minZoom,Le=de.maxZoom,et=de.nodeSize;W&&console.time("total time");var wt="prepare "+Te.length+" points";W&&console.time(wt),this.points=Te;for(var Ne=[],gt=0;gt<Te.length;gt++)Te[gt].geometry&&Ne.push(ye(Te[gt],gt));this.trees[Le+1]=new ke(Ne,R,q,et,Float32Array),W&&console.timeEnd(wt);for(var qt=Le;qt>=se;qt--){var zr=+Date.now();Ne=this._cluster(Ne,qt),this.trees[qt]=new ke(Ne,R,q,et,Float32Array),W&&console.log("z%d: %d clusters in %dms",qt,Ne.length,+Date.now()-zr)}return W&&console.timeEnd("total time"),this},nt.prototype.getClusters=function(Te,de){var W=((Te[0]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,Te[1])),Le=Te[2]===180?180:((Te[2]+180)%360+360)%360-180,et=Math.max(-90,Math.min(90,Te[3]));if(Te[2]-Te[0]>=360)W=-180,Le=180;else if(W>Le){var wt=this.getClusters([W,se,180,et],de),Ne=this.getClusters([-180,se,Le,et],de);return wt.concat(Ne)}for(var gt=this.trees[this._limitZoom(de)],qt=[],zr=0,Br=gt.range(De(W),Ze(et),De(Le),Ze(se));zr<Br.length;zr+=1){var sr=gt.points[Br[zr]];qt.push(sr.numPoints?He(sr):this.points[sr.index])}return qt},nt.prototype.getChildren=function(Te){var de=this._getOriginId(Te),W=this._getOriginZoom(Te),se="No cluster with the specified id.",Le=this.trees[W];if(!Le)throw new Error(se);var et=Le.points[de];if(!et)throw new Error(se);for(var wt=this.options.radius/(this.options.extent*Math.pow(2,W-1)),Ne=[],gt=0,qt=Le.within(et.x,et.y,wt);gt<qt.length;gt+=1){var zr=Le.points[qt[gt]];zr.parentId===Te&&Ne.push(zr.numPoints?He(zr):this.points[zr.index])}if(Ne.length===0)throw new Error(se);return Ne},nt.prototype.getLeaves=function(Te,de,W){var se=[];return this._appendLeaves(se,Te,de=de||10,W=W||0,0),se},nt.prototype.getTile=function(Te,de,W){var se=this.trees[this._limitZoom(Te)],Le=Math.pow(2,Te),et=this.options,wt=et.radius/et.extent,Ne=(W-wt)/Le,gt=(W+1+wt)/Le,qt={features:[]};return this._addTileFeatures(se.range((de-wt)/Le,Ne,(de+1+wt)/Le,gt),se.points,de,W,Le,qt),de===0&&this._addTileFeatures(se.range(1-wt/Le,Ne,1,gt),se.points,Le,W,Le,qt),de===Le-1&&this._addTileFeatures(se.range(0,Ne,wt/Le,gt),se.points,-1,W,Le,qt),qt.features.length?qt:null},nt.prototype.getClusterExpansionZoom=function(Te){for(var de=this._getOriginZoom(Te)-1;de<=this.options.maxZoom;){var W=this.getChildren(Te);if(de++,W.length!==1)break;Te=W[0].properties.cluster_id}return de},nt.prototype._appendLeaves=function(Te,de,W,se,Le){for(var et=0,wt=this.getChildren(de);et<wt.length;et+=1){var Ne=wt[et],gt=Ne.properties;if(gt&&gt.cluster?Le+gt.point_count<=se?Le+=gt.point_count:Le=this._appendLeaves(Te,gt.cluster_id,W,se,Le):Le<se?Le++:Te.push(Ne),Te.length===W)break}return Le},nt.prototype._addTileFeatures=function(Te,de,W,se,Le,et){for(var wt=0,Ne=Te;wt<Ne.length;wt+=1){var gt=de[Ne[wt]],qt=gt.numPoints,zr={type:1,geometry:[[Math.round(this.options.extent*(gt.x*Le-W)),Math.round(this.options.extent*(gt.y*Le-se))]],tags:qt?ft(gt):this.points[gt.index].properties},Br=void 0;qt?Br=gt.id:this.options.generateId?Br=gt.index:this.points[gt.index].id&&(Br=this.points[gt.index].id),Br!==void 0&&(zr.id=Br),et.features.push(zr)}},nt.prototype._limitZoom=function(Te){return Math.max(this.options.minZoom,Math.min(+Te,this.options.maxZoom+1))},nt.prototype._cluster=function(Te,de){for(var W=[],se=this.options,Le=se.reduce,et=se.minPoints,wt=se.radius/(se.extent*Math.pow(2,de)),Ne=0;Ne<Te.length;Ne++){var gt=Te[Ne];if(!(gt.zoom<=de)){gt.zoom=de;for(var qt=this.trees[de+1],zr=qt.within(gt.x,gt.y,wt),Br=gt.numPoints||1,sr=Br,kr=0,Cn=zr;kr<Cn.length;kr+=1){var dn=qt.points[Cn[kr]];dn.zoom>de&&(sr+=dn.numPoints||1)}if(sr>=et){for(var Er=gt.x*Br,Tn=gt.y*Br,vn=Le&&Br>1?this._map(gt,!0):null,mn=(Ne<<5)+(de+1)+this.points.length,Ar=0,$r=zr;Ar<$r.length;Ar+=1){var Mn=qt.points[$r[Ar]];if(!(Mn.zoom<=de)){Mn.zoom=de;var Ki=Mn.numPoints||1;Er+=Mn.x*Ki,Tn+=Mn.y*Ki,Mn.parentId=mn,Le&&(vn||(vn=this._map(gt,!0)),Le(vn,this._map(Mn)))}}gt.parentId=mn,W.push(le(Er/sr,Tn/sr,mn,sr,vn))}else if(W.push(gt),sr>1)for(var vi=0,Mi=zr;vi<Mi.length;vi+=1){var zi=qt.points[Mi[vi]];zi.zoom<=de||(zi.zoom=de,W.push(zi))}}}return W},nt.prototype._getOriginId=function(Te){return Te-this.points.length>>5},nt.prototype._getOriginZoom=function(Te){return(Te-this.points.length)%32},nt.prototype._map=function(Te,de){if(Te.numPoints)return de?w({},Te.properties):Te.properties;var W=this.points[Te.index].properties,se=this.options.map(W);return de&&se===W?w({},se):se},En.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},En.prototype.splitTile=function(Te,de,W,se,Le,et,wt){for(var Ne=[Te,de,W,se],gt=this.options,qt=gt.debug;Ne.length;){se=Ne.pop(),W=Ne.pop(),de=Ne.pop(),Te=Ne.pop();var zr=1<<de,Br=ni(de,W,se),sr=this.tiles[Br];if(!sr&&(qt>1&&console.time("creation"),sr=this.tiles[Br]=Zr(Te,de,W,se,gt),this.tileCoords.push({z:de,x:W,y:se}),qt)){qt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",de,W,se,sr.numFeatures,sr.numPoints,sr.numSimplified),console.timeEnd("creation"));var kr="z"+de;this.stats[kr]=(this.stats[kr]||0)+1,this.total++}if(sr.source=Te,Le){if(de===gt.maxZoom||de===Le)continue;var Cn=1<<Le-de;if(W!==Math.floor(et/Cn)||se!==Math.floor(wt/Cn))continue}else if(de===gt.indexMaxZoom||sr.numPoints<=gt.indexMaxPoints)continue;if(sr.source=null,Te.length!==0){qt>1&&console.time("clipping");var dn,Er,Tn,vn,mn,Ar,$r=.5*gt.buffer/gt.extent,Mn=.5-$r,Ki=.5+$r,vi=1+$r;dn=Er=Tn=vn=null,mn=qe(Te,zr,W-$r,W+Ki,0,sr.minX,sr.maxX,gt),Ar=qe(Te,zr,W+Mn,W+vi,0,sr.minX,sr.maxX,gt),Te=null,mn&&(dn=qe(mn,zr,se-$r,se+Ki,1,sr.minY,sr.maxY,gt),Er=qe(mn,zr,se+Mn,se+vi,1,sr.minY,sr.maxY,gt),mn=null),Ar&&(Tn=qe(Ar,zr,se-$r,se+Ki,1,sr.minY,sr.maxY,gt),vn=qe(Ar,zr,se+Mn,se+vi,1,sr.minY,sr.maxY,gt),Ar=null),qt>1&&console.timeEnd("clipping"),Ne.push(dn||[],de+1,2*W,2*se),Ne.push(Er||[],de+1,2*W,2*se+1),Ne.push(Tn||[],de+1,2*W+1,2*se),Ne.push(vn||[],de+1,2*W+1,2*se+1)}}},En.prototype.getTile=function(Te,de,W){var se=this.options,Le=se.extent,et=se.debug;if(Te<0||Te>24)return null;var wt=1<<Te,Ne=ni(Te,de=(de%wt+wt)%wt,W);if(this.tiles[Ne])return Vt(this.tiles[Ne],Le);et>1&&console.log("drilling down to z%d-%d-%d",Te,de,W);for(var gt,qt=Te,zr=de,Br=W;!gt&&qt>0;)qt--,zr=Math.floor(zr/2),Br=Math.floor(Br/2),gt=this.tiles[ni(qt,zr,Br)];return gt&&gt.source?(et>1&&console.log("found parent tile z%d-%d-%d",qt,zr,Br),et>1&&console.time("drilling down"),this.splitTile(gt.source,qt,zr,Br,Te,de,W),et>1&&console.timeEnd("drilling down"),this.tiles[Ne]?Vt(this.tiles[Ne],Le):null):null};var Zn=function(Te){function de(W,se,Le,et){Te.call(this,W,se,Le,fi),et&&(this.loadGeoJSON=et)}return Te&&(de.__proto__=Te),(de.prototype=Object.create(Te&&Te.prototype)).constructor=de,de.prototype.loadData=function(W,se){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=se,this._pendingLoadDataParams=W,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},de.prototype._loadData=function(){var W=this;if(this._pendingCallback&&this._pendingLoadDataParams){var se=this._pendingCallback,Le=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var et=!!(Le&&Le.request&&Le.request.collectResourceTiming)&&new a.RequestPerformance(Le.request);this.loadGeoJSON(Le,function(wt,Ne){if(wt||!Ne)return se(wt);if(typeof Ne!="object")return se(new Error("Input data given to '"+Le.source+"' is not a valid GeoJSON object."));(function sr(kr,Cn){var dn,Er=kr&&kr.type;if(Er==="FeatureCollection")for(dn=0;dn<kr.features.length;dn++)sr(kr.features[dn],Cn);else if(Er==="GeometryCollection")for(dn=0;dn<kr.geometries.length;dn++)sr(kr.geometries[dn],Cn);else if(Er==="Feature")sr(kr.geometry,Cn);else if(Er==="Polygon")at(kr.coordinates,Cn);else if(Er==="MultiPolygon")for(dn=0;dn<kr.coordinates.length;dn++)at(kr.coordinates[dn],Cn);return kr})(Ne,!0);try{if(Le.filter){var gt=a.createExpression(Le.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(gt.result==="error")throw new Error(gt.value.map(function(sr){return sr.key+": "+sr.message}).join(", "));var qt=Ne.features.filter(function(sr){return gt.value.evaluate({zoom:0},sr)});Ne={type:"FeatureCollection",features:qt}}W._geoJSONIndex=Le.cluster?new nt(function(sr){var kr=sr.superclusterOptions,Cn=sr.clusterProperties;if(!Cn||!kr)return kr;for(var dn={},Er={},Tn={accumulated:null,zoom:0},vn={properties:null},mn=Object.keys(Cn),Ar=0,$r=mn;Ar<$r.length;Ar+=1){var Mn=$r[Ar],Ki=Cn[Mn],vi=Ki[0],Mi=a.createExpression(Ki[1]),zi=a.createExpression(typeof vi=="string"?[vi,["accumulated"],["get",Mn]]:vi);dn[Mn]=Mi.value,Er[Mn]=zi.value}return kr.map=function(Ka){vn.properties=Ka;for(var hi={},ya=0,Ii=mn;ya<Ii.length;ya+=1){var yi=Ii[ya];hi[yi]=dn[yi].evaluate(Tn,vn)}return hi},kr.reduce=function(Ka,hi){vn.properties=hi;for(var ya=0,Ii=mn;ya<Ii.length;ya+=1){var yi=Ii[ya];Tn.accumulated=Ka[yi],Ka[yi]=Er[yi].evaluate(Tn,vn)}},kr}(Le)).load(Ne.features):function(sr,kr){return new En(sr,kr)}(Ne,Le.geojsonVtOptions)}catch(sr){return se(sr)}W.loaded={};var zr={};if(et){var Br=et.finish();Br&&(zr.resourceTiming={},zr.resourceTiming[Le.source]=JSON.parse(JSON.stringify(Br)))}se(null,zr)})}},de.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},de.prototype.reloadTile=function(W,se){var Le=this.loaded;return Le&&Le[W.uid]?Te.prototype.reloadTile.call(this,W,se):this.loadTile(W,se)},de.prototype.loadGeoJSON=function(W,se){if(W.request)a.getJSON(W.request,se);else{if(typeof W.data!="string")return se(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."));try{return se(null,JSON.parse(W.data))}catch(Le){return se(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."))}}},de.prototype.removeSource=function(W,se){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),se()},de.prototype.getClusterExpansionZoom=function(W,se){try{se(null,this._geoJSONIndex.getClusterExpansionZoom(W.clusterId))}catch(Le){se(Le)}},de.prototype.getClusterChildren=function(W,se){try{se(null,this._geoJSONIndex.getChildren(W.clusterId))}catch(Le){se(Le)}},de.prototype.getClusterLeaves=function(W,se){try{se(null,this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset))}catch(Le){se(Le)}},de}(Ge),Vn=function(de){var W=this;this.self=de,this.actor=new a.Actor(de,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ge,geojson:Zn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(se,Le){if(W.workerSourceTypes[se])throw new Error('Worker source with name "'+se+'" already registered.');W.workerSourceTypes[se]=Le},this.self.registerRTLTextPlugin=function(se){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=se.applyArabicShaping,a.plugin.processBidirectionalText=se.processBidirectionalText,a.plugin.processStyledBidirectionalText=se.processStyledBidirectionalText}};return Vn.prototype.setReferrer=function(Te,de){this.referrer=de},Vn.prototype.setImages=function(Te,de,W){for(var se in this.availableImages[Te]=de,this.workerSources[Te]){var Le=this.workerSources[Te][se];for(var et in Le)Le[et].availableImages=de}W()},Vn.prototype.setLayers=function(Te,de,W){this.getLayerIndex(Te).replace(de),W()},Vn.prototype.updateLayers=function(Te,de,W){this.getLayerIndex(Te).update(de.layers,de.removedIds),W()},Vn.prototype.loadTile=function(Te,de,W){this.getWorkerSource(Te,de.type,de.source).loadTile(de,W)},Vn.prototype.loadDEMTile=function(Te,de,W){this.getDEMWorkerSource(Te,de.source).loadTile(de,W)},Vn.prototype.reloadTile=function(Te,de,W){this.getWorkerSource(Te,de.type,de.source).reloadTile(de,W)},Vn.prototype.abortTile=function(Te,de,W){this.getWorkerSource(Te,de.type,de.source).abortTile(de,W)},Vn.prototype.removeTile=function(Te,de,W){this.getWorkerSource(Te,de.type,de.source).removeTile(de,W)},Vn.prototype.removeDEMTile=function(Te,de){this.getDEMWorkerSource(Te,de.source).removeTile(de)},Vn.prototype.removeSource=function(Te,de,W){if(this.workerSources[Te]&&this.workerSources[Te][de.type]&&this.workerSources[Te][de.type][de.source]){var se=this.workerSources[Te][de.type][de.source];delete this.workerSources[Te][de.type][de.source],se.removeSource!==void 0?se.removeSource(de,W):W()}},Vn.prototype.loadWorkerSource=function(Te,de,W){try{this.self.importScripts(de.url),W()}catch(se){W(se.toString())}},Vn.prototype.syncRTLPluginState=function(Te,de,W){try{a.plugin.setState(de);var se=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&se!=null){this.self.importScripts(se);var Le=a.plugin.isParsed();W(Le?void 0:new Error("RTL Text Plugin failed to import scripts from "+se),Le)}}catch(et){W(et.toString())}},Vn.prototype.getAvailableImages=function(Te){var de=this.availableImages[Te];return de||(de=[]),de},Vn.prototype.getLayerIndex=function(Te){var de=this.layerIndexes[Te];return de||(de=this.layerIndexes[Te]=new Q),de},Vn.prototype.getWorkerSource=function(Te,de,W){var se=this;return this.workerSources[Te]||(this.workerSources[Te]={}),this.workerSources[Te][de]||(this.workerSources[Te][de]={}),this.workerSources[Te][de][W]||(this.workerSources[Te][de][W]=new this.workerSourceTypes[de]({send:function(et,wt,Ne){se.actor.send(et,wt,Ne,Te)}},this.getLayerIndex(Te),this.getAvailableImages(Te))),this.workerSources[Te][de][W]},Vn.prototype.getDEMWorkerSource=function(Te,de){return this.demWorkerSources[Te]||(this.demWorkerSources[Te]={}),this.demWorkerSources[Te][de]||(this.demWorkerSources[Te][de]=new Re),this.demWorkerSources[Te][de]},Vn.prototype.enforceCacheSizeLimit=function(Te,de){a.enforceCacheSizeLimit(de)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Vn(self)),Vn}),F(["./shared"],function(a){"use strict";var Y=a.createCommonjsModule(function(u){function i(y){return!n(y)}function n(y){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var O,k,ue=new Blob([""],{type:"text/javascript"}),Ae=URL.createObjectURL(ue);try{k=new Worker(Ae),O=!0}catch(We){O=!1}return k&&k.terminate(),URL.revokeObjectURL(Ae),O}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var O=document.createElement("canvas");O.width=O.height=1;var k=O.getContext("2d");if(!k)return!1;var ue=k.getImageData(0,0,1,1);return ue&&ue.width===O.width}()?(c[_=y&&y.failIfMajorPerformanceCaveat]===void 0&&(c[_]=function(O){var k=function(Ae){var We=document.createElement("canvas"),Je=Object.create(i.webGLContextAttributes);return Je.failIfMajorPerformanceCaveat=Ae,We.probablySupportsContext?We.probablySupportsContext("webgl",Je)||We.probablySupportsContext("experimental-webgl",Je):We.supportsContext?We.supportsContext("webgl",Je)||We.supportsContext("experimental-webgl",Je):We.getContext("webgl",Je)||We.getContext("experimental-webgl",Je)}(O);if(!k)return!1;var ue=k.createShader(k.VERTEX_SHADER);return!(!ue||k.isContextLost())&&(k.shaderSource(ue,"void main() {}"),k.compileShader(ue),k.getShaderParameter(ue,k.COMPILE_STATUS)===!0)}(_)),c[_]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var _}u.exports?u.exports=i:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=i,window.mapboxgl.notSupportedReason=n);var c={};i.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),B={create:function(i,n,c){var y=a.window.document.createElement(i);return n!==void 0&&(y.className=n),c&&c.appendChild(y),y},createNS:function(i,n){return a.window.document.createElementNS(i,n)}},Q=a.window.document&&a.window.document.documentElement.style;function re(u){if(!Q)return u[0];for(var i=0;i<u.length;i++)if(u[i]in Q)return u[i];return u[0]}var we,J=re(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);B.disableDrag=function(){Q&&J&&(we=Q[J],Q[J]="none")},B.enableDrag=function(){Q&&J&&(Q[J]=we)};var Ke=re(["transform","WebkitTransform"]);B.setTransform=function(u,i){u.style[Ke]=i};var Ge=!1;try{var _e=Object.defineProperty({},"passive",{get:function(){Ge=!0}});a.window.addEventListener("test",_e,_e),a.window.removeEventListener("test",_e,_e)}catch(u){Ge=!1}B.addEventListener=function(u,i,n,c){c===void 0&&(c={}),u.addEventListener(i,n,"passive"in c&&Ge?c:c.capture)},B.removeEventListener=function(u,i,n,c){c===void 0&&(c={}),u.removeEventListener(i,n,"passive"in c&&Ge?c:c.capture)};var Re=function u(i){i.preventDefault(),i.stopPropagation(),a.window.removeEventListener("click",u,!0)};function at(u){var i=u.userImage;return!!(i&&i.render&&i.render())&&(u.data.replace(new Uint8Array(i.data.buffer)),!0)}B.suppressClick=function(){a.window.addEventListener("click",Re,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",Re,!0)},0)},B.mousePos=function(u,i){var n=u.getBoundingClientRect();return new a.Point(i.clientX-n.left-u.clientLeft,i.clientY-n.top-u.clientTop)},B.touchPos=function(u,i){for(var n=u.getBoundingClientRect(),c=[],y=0;y<i.length;y++)c.push(new a.Point(i[y].clientX-n.left-u.clientLeft,i[y].clientY-n.top-u.clientTop));return c},B.mouseButton=function(u){return a.window.InstallTrigger!==void 0&&u.button===2&&u.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:u.button},B.remove=function(u){u.parentNode&&u.parentNode.removeChild(u)};var Oe=function(u){function i(){u.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.isLoaded=function(){return this.loaded},i.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var c=0,y=this.requestors;c<y.length;c+=1){var _=y[c];this._notify(_.ids,_.callback)}this.requestors=[]}},i.prototype.getImage=function(n){return this.images[n]},i.prototype.addImage=function(n,c){this._validate(n,c)&&(this.images[n]=c)},i.prototype._validate=function(n,c){var y=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),y=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),y=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),y=!1),y},i.prototype._validateStretch=function(n,c){if(!n)return!0;for(var y=0,_=0,O=n;_<O.length;_+=1){var k=O[_];if(k[0]<y||k[1]<k[0]||c<k[1])return!1;y=k[1]}return!0},i.prototype._validateContent=function(n,c){return!(n&&(n.length!==4||n[0]<0||c.data.width<n[0]||n[1]<0||c.data.height<n[1]||n[2]<0||c.data.width<n[2]||n[3]<0||c.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},i.prototype.updateImage=function(n,c){c.version=this.images[n].version+1,this.images[n]=c,this.updatedImages[n]=!0},i.prototype.removeImage=function(n){var c=this.images[n];delete this.images[n],delete this.patterns[n],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()},i.prototype.listImages=function(){return Object.keys(this.images)},i.prototype.getImages=function(n,c){var y=!0;if(!this.isLoaded())for(var _=0,O=n;_<O.length;_+=1)this.images[O[_]]||(y=!1);this.isLoaded()||y?this._notify(n,c):this.requestors.push({ids:n,callback:c})},i.prototype._notify=function(n,c){for(var y={},_=0,O=n;_<O.length;_+=1){var k=O[_];this.images[k]||this.fire(new a.Event("styleimagemissing",{id:k}));var ue=this.images[k];ue?y[k]={data:ue.data.clone(),pixelRatio:ue.pixelRatio,sdf:ue.sdf,version:ue.version,stretchX:ue.stretchX,stretchY:ue.stretchY,content:ue.content,hasRenderCallback:Boolean(ue.userImage&&ue.userImage.render)}:a.warnOnce('Image "'+k+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}c(null,y)},i.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},i.prototype.getPattern=function(n){var c=this.patterns[n],y=this.getImage(n);if(!y)return null;if(c&&c.position.version===y.version)return c.position;if(c)c.position.version=y.version;else{var _={w:y.data.width+2,h:y.data.height+2,x:0,y:0},O=new a.ImagePosition(_,y);this.patterns[n]={bin:_,position:O}}return this._updatePatternAtlas(),this.patterns[n].position},i.prototype.bind=function(n){var c=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(n,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)},i.prototype._updatePatternAtlas=function(){var n=[];for(var c in this.patterns)n.push(this.patterns[c].bin);var y=a.potpack(n),_=y.w,O=y.h,k=this.atlasImage;for(var ue in k.resize({width:_||1,height:O||1}),this.patterns){var Ae=this.patterns[ue].bin,We=Ae.x+1,Je=Ae.y+1,rt=this.images[ue].data,Ft=rt.width,Rt=rt.height;a.RGBAImage.copy(rt,k,{x:0,y:0},{x:We,y:Je},{width:Ft,height:Rt}),a.RGBAImage.copy(rt,k,{x:0,y:Rt-1},{x:We,y:Je-1},{width:Ft,height:1}),a.RGBAImage.copy(rt,k,{x:0,y:0},{x:We,y:Je+Rt},{width:Ft,height:1}),a.RGBAImage.copy(rt,k,{x:Ft-1,y:0},{x:We-1,y:Je},{width:1,height:Rt}),a.RGBAImage.copy(rt,k,{x:0,y:0},{x:We+Ft,y:Je},{width:1,height:Rt})}this.dirty=!0},i.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},i.prototype.dispatchRenderCallbacks=function(n){for(var c=0,y=n;c<y.length;c+=1){var _=y[c];if(!this.callbackDispatchedThisFrame[_]){this.callbackDispatchedThisFrame[_]=!0;var O=this.images[_];at(O)&&this.updateImage(_,O)}}},i}(a.Evented),xt=St,Mt=St,Et=1e20;function St(u,i,n,c,y,_){this.fontSize=u||24,this.buffer=i===void 0?3:i,this.cutoff=c||.25,this.fontFamily=y||"sans-serif",this.fontWeight=_||"normal",this.radius=n||8;var O=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=O,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(O*O),this.gridInner=new Float64Array(O*O),this.f=new Float64Array(O),this.d=new Float64Array(O),this.z=new Float64Array(O+1),this.v=new Int16Array(O),this.middle=Math.round(O/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function or(u,i,n,c,y,_,O){for(var k=0;k<i;k++){for(var ue=0;ue<n;ue++)c[ue]=u[ue*i+k];for($t(c,y,_,O,n),ue=0;ue<n;ue++)u[ue*i+k]=y[ue]}for(ue=0;ue<n;ue++){for(k=0;k<i;k++)c[k]=u[ue*i+k];for($t(c,y,_,O,i),k=0;k<i;k++)u[ue*i+k]=Math.sqrt(y[k])}}function $t(u,i,n,c,y){n[0]=0,c[0]=-Et,c[1]=+Et;for(var _=1,O=0;_<y;_++){for(var k=(u[_]+_*_-(u[n[O]]+n[O]*n[O]))/(2*_-2*n[O]);k<=c[O];)O--,k=(u[_]+_*_-(u[n[O]]+n[O]*n[O]))/(2*_-2*n[O]);n[++O]=_,c[O]=k,c[O+1]=+Et}for(_=0,O=0;_<y;_++){for(;c[O+1]<_;)O++;i[_]=(_-n[O])*(_-n[O])+u[n[O]]}}St.prototype.draw=function(u){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(u,this.buffer,this.middle);for(var i=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),c=0;c<this.size*this.size;c++){var y=i.data[4*c+3]/255;this.gridOuter[c]=y===1?0:y===0?Et:Math.pow(Math.max(0,.5-y),2),this.gridInner[c]=y===1?Et:y===0?0:Math.pow(Math.max(0,y-.5),2)}for(or(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),or(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),c=0;c<this.size*this.size;c++)n[c]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[c]-this.gridInner[c])/this.radius+this.cutoff))));return n},xt.default=Mt;var Ht=function(i,n){this.requestManager=i,this.localIdeographFontFamily=n,this.entries={}};Ht.prototype.setURL=function(u){this.url=u},Ht.prototype.getGlyphs=function(u,i){var n=this,c=[];for(var y in u)for(var _=0,O=u[y];_<O.length;_+=1)c.push({stack:y,id:O[_]});a.asyncAll(c,function(k,ue){var Ae=k.stack,We=k.id,Je=n.entries[Ae];Je||(Je=n.entries[Ae]={glyphs:{},requests:{},ranges:{}});var rt=Je.glyphs[We];if(rt===void 0){if(rt=n._tinySDF(Je,Ae,We))return Je.glyphs[We]=rt,void ue(null,{stack:Ae,id:We,glyph:rt});var Ft=Math.floor(We/256);if(256*Ft>65535)ue(new Error("glyphs > 65535 not supported"));else if(Je.ranges[Ft])ue(null,{stack:Ae,id:We,glyph:rt});else{var Rt=Je.requests[Ft];Rt||(Rt=Je.requests[Ft]=[],Ht.loadGlyphRange(Ae,Ft,n.url,n.requestManager,function(Yt,zt){if(zt){for(var Ut in zt)n._doesCharSupportLocalGlyph(+Ut)||(Je.glyphs[+Ut]=zt[+Ut]);Je.ranges[Ft]=!0}for(var nr=0,rr=Rt;nr<rr.length;nr+=1)(0,rr[nr])(Yt,zt);delete Je.requests[Ft]})),Rt.push(function(Yt,zt){Yt?ue(Yt):zt&&ue(null,{stack:Ae,id:We,glyph:zt[We]||null})})}}else ue(null,{stack:Ae,id:We,glyph:rt})},function(k,ue){if(k)i(k);else if(ue){for(var Ae={},We=0,Je=ue;We<Je.length;We+=1){var rt=Je[We],Ft=rt.stack,Rt=rt.id,Yt=rt.glyph;(Ae[Ft]||(Ae[Ft]={}))[Rt]=Yt&&{id:Yt.id,bitmap:Yt.bitmap.clone(),metrics:Yt.metrics}}i(null,Ae)}})},Ht.prototype._doesCharSupportLocalGlyph=function(u){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](u)||a.isChar["Hangul Syllables"](u)||a.isChar.Hiragana(u)||a.isChar.Katakana(u))},Ht.prototype._tinySDF=function(u,i,n){var c=this.localIdeographFontFamily;if(c&&this._doesCharSupportLocalGlyph(n)){var y=u.tinySDF;if(!y){var _="400";/bold/i.test(i)?_="900":/medium/i.test(i)?_="500":/light/i.test(i)&&(_="200"),y=u.tinySDF=new Ht.TinySDF(24,3,8,.25,c,_)}return{id:n,bitmap:new a.AlphaImage({width:30,height:30},y.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ht.loadGlyphRange=function(u,i,n,c,y){var _=256*i,O=_+255,k=c.transformRequest(c.normalizeGlyphsURL(n).replace("{fontstack}",u).replace("{range}",_+"-"+O),a.ResourceType.Glyphs);a.getArrayBuffer(k,function(ue,Ae){if(ue)y(ue);else if(Ae){for(var We={},Je=0,rt=a.parseGlyphPBF(Ae);Je<rt.length;Je+=1){var Ft=rt[Je];We[Ft.id]=Ft}y(null,We)}})},Ht.TinySDF=xt;var mt=function(){this.specification=a.styleSpec.light.position};mt.prototype.possiblyEvaluate=function(u,i){return a.sphericalToCartesian(u.expression.evaluate(i))},mt.prototype.interpolate=function(u,i,n){return{x:a.number(u.x,i.x,n),y:a.number(u.y,i.y,n),z:a.number(u.z,i.z,n)}};var Xe=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new mt,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),Tt=function(u){function i(n){u.call(this),this._transitionable=new a.Transitionable(Xe),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getLight=function(){return this._transitionable.serialize()},i.prototype.setLight=function(n,c){if(c===void 0&&(c={}),!this._validate(a.validateLight,n,c))for(var y in n){var _=n[y];a.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-"-transition".length),_):this._transitionable.setValue(y,_)}},i.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},i.prototype.hasTransition=function(){return this._transitioning.hasTransition()},i.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},i.prototype._validate=function(n,c,y){return(!y||y.validate!==!1)&&a.emitValidationErrors(this,n.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},i}(a.Evented),ze=function(i,n){this.width=i,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};ze.prototype.getDash=function(u,i){var n=u.join(",")+String(i);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(u,i)),this.dashEntry[n]},ze.prototype.getDashRanges=function(u,i,n){var c=[],y=u.length%2==1?-u[u.length-1]*n:0,_=u[0]*n,O=!0;c.push({left:y,right:_,isDash:O,zeroLength:u[0]===0});for(var k=u[0],ue=1;ue<u.length;ue++){var Ae=u[ue];c.push({left:y=k*n,right:_=(k+=Ae)*n,isDash:O=!O,zeroLength:Ae===0})}return c},ze.prototype.addRoundDash=function(u,i,n){for(var c=i/2,y=-n;y<=n;y++)for(var _=this.width*(this.nextRow+n+y),O=0,k=u[O],ue=0;ue<this.width;ue++){ue/k.right>1&&(k=u[++O]);var Ae=Math.abs(ue-k.left),We=Math.abs(ue-k.right),Je=Math.min(Ae,We),rt=void 0,Ft=y/n*(c+1);if(k.isDash){var Rt=c-Math.abs(Ft);rt=Math.sqrt(Je*Je+Rt*Rt)}else rt=c-Math.sqrt(Je*Je+Ft*Ft);this.data[_+ue]=Math.max(0,Math.min(255,rt+128))}},ze.prototype.addRegularDash=function(u){for(var i=u.length-1;i>=0;--i){var n=u[i],c=u[i+1];n.zeroLength?u.splice(i,1):c&&c.isDash===n.isDash&&(c.left=n.left,u.splice(i,1))}var y=u[0],_=u[u.length-1];y.isDash===_.isDash&&(y.left=_.left-this.width,_.right=y.right+this.width);for(var O=this.width*this.nextRow,k=0,ue=u[k],Ae=0;Ae<this.width;Ae++){Ae/ue.right>1&&(ue=u[++k]);var We=Math.abs(Ae-ue.left),Je=Math.abs(Ae-ue.right),rt=Math.min(We,Je);this.data[O+Ae]=Math.max(0,Math.min(255,(ue.isDash?rt:-rt)+128))}},ze.prototype.addDash=function(u,i){var n=i?7:0,c=2*n+1;if(this.nextRow+c>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var y=0,_=0;_<u.length;_++)y+=u[_];if(y!==0){var O=this.width/y,k=this.getDashRanges(u,this.width,O);i?this.addRoundDash(k,O,n):this.addRegularDash(k)}var ue={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:y};return this.nextRow+=c,this.dirty=!0,ue},ze.prototype.bind=function(u){var i=u.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))};var st=function u(i,n){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var c=this.workerPool.acquire(this.id),y=0;y<c.length;y++){var _=new u.Actor(c[y],n,this.id);_.name="Worker "+y,this.actors.push(_)}};function Wt(u,i,n){var c=function(_,O){if(_)return n(_);if(O){var k=a.pick(a.extend(O,u),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(k.vectorLayers=O.vector_layers,k.vectorLayerIds=k.vectorLayers.map(function(ue){return ue.id})),k.tiles=i.canonicalizeTileset(k,u.url),n(null,k)}};return u.url?a.getJSON(i.transformRequest(i.normalizeSourceURL(u.url),a.ResourceType.Source),c):a.browser.frame(function(){return c(null,u)})}st.prototype.broadcast=function(u,i,n){a.asyncAll(this.actors,function(c,y){c.send(u,i,y)},n=n||function(){})},st.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},st.prototype.remove=function(){this.actors.forEach(function(u){u.remove()}),this.actors=[],this.workerPool.release(this.id)},st.Actor=a.Actor;var bt=function(i,n,c){this.bounds=a.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=n||0,this.maxzoom=c||24};bt.prototype.validateBounds=function(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]},bt.prototype.contains=function(u){var i=Math.pow(2,u.z),n=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*i),c=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*i),y=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*i),_=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*i);return u.x>=n&&u.x<y&&u.y>=c&&u.y<_};var dt=function(u){function i(n,c,y,_){if(u.call(this),this.id=n,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(c,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,function(c,y){n._tileJSONRequest=null,n._loaded=!0,c?n.fire(new a.ErrorEvent(c)):y&&(a.extend(n,y),y.bounds&&(n.tileBounds=new bt(y.bounds,n.minzoom,n.maxzoom)),a.postTurnstileEvent(y.tiles,n.map._requestManager._customAccessToken),a.postMapLoadEvent(y.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},i.prototype.loaded=function(){return this._loaded},i.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},i.prototype.setTiles=function(n){var c=this;return this.setSourceProperty(function(){c._options.tiles=n}),this},i.prototype.setUrl=function(n){var c=this;return this.setSourceProperty(function(){c.url=n,c._options.url=n}),this},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return a.extend({},this._options)},i.prototype.loadTile=function(n,c){var y=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(y,a.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function O(k,ue){return delete n.request,n.aborted?c(null):k&&k.status!==404?c(k):(ue&&ue.resourceTiming&&(n.resourceTiming=ue.resourceTiming),this.map._refreshExpiredTiles&&ue&&n.setExpiryData(ue),n.loadVectorData(ue,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=c:n.request=n.actor.send("reloadTile",_,O.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",_,O.bind(this)))},i.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},i.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},i.prototype.hasTransition=function(){return!1},i}(a.Evented),H=function(u){function i(n,c,y,_){u.call(this),this.id=n,this.dispatcher=y,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,function(c,y){n._tileJSONRequest=null,n._loaded=!0,c?n.fire(new a.ErrorEvent(c)):y&&(a.extend(n,y),y.bounds&&(n.tileBounds=new bt(y.bounds,n.minzoom,n.maxzoom)),a.postTurnstileEvent(y.tiles),a.postMapLoadEvent(y.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},i.prototype.loaded=function(){return this._loaded},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return a.extend({},this._options)},i.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},i.prototype.loadTile=function(n,c){var y=this,_=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=a.getImage(this.map._requestManager.transformRequest(_,a.ResourceType.Tile),function(O,k){if(delete n.request,n.aborted)n.state="unloaded",c(null);else if(O)n.state="errored",c(O);else if(k){y.map._refreshExpiredTiles&&n.setExpiryData(k),delete k.cacheControl,delete k.expires;var ue=y.map.painter.context,Ae=ue.gl;n.texture=y.map.painter.getTileTexture(k.width),n.texture?n.texture.update(k,{useMipmap:!0}):(n.texture=new a.Texture(ue,k,Ae.RGBA,{useMipmap:!0}),n.texture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE,Ae.LINEAR_MIPMAP_NEAREST),ue.extTextureFilterAnisotropic&&Ae.texParameterf(Ae.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax)),n.state="loaded",a.cacheEntryPossiblyAdded(y.dispatcher),c(null)}})},i.prototype.abortTile=function(n,c){n.request&&(n.request.cancel(),delete n.request),c()},i.prototype.unloadTile=function(n,c){n.texture&&this.map.painter.saveTileTexture(n.texture),c()},i.prototype.hasTransition=function(){return!1},i}(a.Evented),z=function(u){function i(n,c,y,_){u.call(this,n,c,y,_),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},i.prototype.loadTile=function(n,c){var y=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function _(O,k){O&&(n.state="errored",c(O)),k&&(n.dem=k,n.needsHillshadePrepare=!0,n.state="loaded",c(null))}n.request=a.getImage(this.map._requestManager.transformRequest(y,a.ResourceType.Tile),function(O,k){if(delete n.request,n.aborted)n.state="unloaded",c(null);else if(O)n.state="errored",c(O);else if(k){this.map._refreshExpiredTiles&&n.setExpiryData(k),delete k.cacheControl,delete k.expires;var ue=a.window.ImageBitmap&&k instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?k:a.browser.getImageData(k,1),Ae={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:ue,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Ae,_.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},i.prototype._getNeighboringTiles=function(n){var c=n.canonical,y=Math.pow(2,c.z),_=(c.x-1+y)%y,O=c.x===0?n.wrap-1:n.wrap,k=(c.x+1+y)%y,ue=c.x+1===y?n.wrap+1:n.wrap,Ae={};return Ae[new a.OverscaledTileID(n.overscaledZ,O,c.z,_,c.y).key]={backfilled:!1},Ae[new a.OverscaledTileID(n.overscaledZ,ue,c.z,k,c.y).key]={backfilled:!1},c.y>0&&(Ae[new a.OverscaledTileID(n.overscaledZ,O,c.z,_,c.y-1).key]={backfilled:!1},Ae[new a.OverscaledTileID(n.overscaledZ,n.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},Ae[new a.OverscaledTileID(n.overscaledZ,ue,c.z,k,c.y-1).key]={backfilled:!1}),c.y+1<y&&(Ae[new a.OverscaledTileID(n.overscaledZ,O,c.z,_,c.y+1).key]={backfilled:!1},Ae[new a.OverscaledTileID(n.overscaledZ,n.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},Ae[new a.OverscaledTileID(n.overscaledZ,ue,c.z,k,c.y+1).key]={backfilled:!1}),Ae},i.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},i}(H),V=function(u){function i(n,c,y,_){u.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=y.getActor(),this.setEventedParent(_),this._data=c.data,this._options=a.extend({},c),this._collectResourceTiming=c.collectResourceTiming,this._resourceTiming=[],c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;var O=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*O,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*O,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?Math.min(c.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:a.EXTENT,radius:(c.clusterRadius||50)*O,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(){var n=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c)n.fire(new a.ErrorEvent(c));else{var y={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(y.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new a.Event("data",y))}})},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.setData=function(n){var c=this;return this._data=n,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(y){if(y)c.fire(new a.ErrorEvent(y));else{var _={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(_.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",_))}}),this},i.prototype.getClusterExpansionZoom=function(n,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},c),this},i.prototype.getClusterChildren=function(n,c){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},c),this},i.prototype.getClusterLeaves=function(n,c,y,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:c,offset:y},_),this},i.prototype._updateWorkerData=function(n){var c=this;this._loaded=!1;var y=a.extend({},this.workerOptions),_=this._data;typeof _=="string"?(y.request=this.map._requestManager.transformRequest(a.browser.resolveURL(_),a.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(_),this.actor.send(this.type+".loadData",y,function(O,k){c._removed||k&&k.abandoned||(c._loaded=!0,k&&k.resourceTiming&&k.resourceTiming[c.id]&&(c._resourceTiming=k.resourceTiming[c.id].slice(0)),c.actor.send(c.type+".coalesce",{source:y.source},null),n(O))})},i.prototype.loaded=function(){return this._loaded},i.prototype.loadTile=function(n,c){var y=this,_=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(_,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(O,k){return delete n.request,n.unloadVectorData(),n.aborted?c(null):O?c(O):(n.loadVectorData(k,y.map.painter,_==="reloadTile"),c(null))})},i.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},i.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},i.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},i.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},i.prototype.hasTransition=function(){return!1},i}(a.Evented),Se=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ve=function(u){function i(n,c,y,_){u.call(this),this.id=n,this.dispatcher=y,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=c}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(n,c){var y=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(_,O){y._loaded=!0,_?y.fire(new a.ErrorEvent(_)):O&&(y.image=O,n&&(y.coordinates=n),c&&c(),y._finishLoading())})},i.prototype.loaded=function(){return this._loaded},i.prototype.updateImage=function(n){var c=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){c.texture=null}),this):this},i.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.setCoordinates=function(n){var c=this;this.coordinates=n;var y=n.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(O){for(var k=1/0,ue=1/0,Ae=-1/0,We=-1/0,Je=0,rt=O;Je<rt.length;Je+=1){var Ft=rt[Je];k=Math.min(k,Ft.x),ue=Math.min(ue,Ft.y),Ae=Math.max(Ae,Ft.x),We=Math.max(We,Ft.y)}var Rt=Math.max(Ae-k,We-ue),Yt=Math.max(0,Math.floor(-Math.log(Rt)/Math.LN2)),zt=Math.pow(2,Yt);return new a.CanonicalTileID(Yt,Math.floor((k+Ae)/2*zt),Math.floor((ue+We)/2*zt))}(y),this.minzoom=this.maxzoom=this.tileID.z;var _=y.map(function(O){return c.tileID.getTilePoint(O)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(_[0].x,_[0].y,0,0),this._boundsArray.emplaceBack(_[1].x,_[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(_[3].x,_[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(_[2].x,_[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},i.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,c=n.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(n,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var _=this.tiles[y];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}},i.prototype.loadTile=function(n,c){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},c(null)):(n.state="errored",c(null))},i.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return!1},i}(a.Evented),ce=function(u){function i(n,c,y,_){u.call(this,n,c,y,_),this.roundZoom=!0,this.type="video",this.options=c}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1;var c=this.options;this.urls=[];for(var y=0,_=c.urls;y<_.length;y+=1)this.urls.push(this.map._requestManager.transformRequest(_[y],a.ResourceType.Source).url);a.getVideo(this.urls,function(O,k){n._loaded=!0,O?n.fire(new a.ErrorEvent(O)):k&&(n.video=k,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},i.prototype.pause=function(){this.video&&this.video.pause()},i.prototype.play=function(){this.video&&this.video.play()},i.prototype.seek=function(n){if(this.video){var c=this.video.seekable;n<c.start(0)||n>c.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+c.start(0)+" and "+c.end(0)+"-second mark."))):this.video.currentTime=n}},i.prototype.getVideo=function(){return this.video},i.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},i.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,c=n.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(n,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var _=this.tiles[y];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this.video&&!this.video.paused},i}(ve),fe=function(u){function i(n,c,y,_){u.call(this,n,c,y,_),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(function(O){return!Array.isArray(O)||O.length!==2||O.some(function(k){return typeof k!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+n,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},i.prototype.getCanvas=function(){return this.canvas},i.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},i.prototype.onRemove=function(){this.pause()},i.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var c=this.map.painter.context,y=c.gl;for(var _ in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Se.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,y.RGBA,{premultiply:!0}),this.tiles){var O=this.tiles[_];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this._playing},i.prototype._hasInvalidDimensions=function(){for(var n=0,c=[this.canvas.width,this.canvas.height];n<c.length;n+=1){var y=c[n];if(isNaN(y)||y<=0)return!0}return!1},i}(ve),ke={vector:dt,raster:H,"raster-dem":z,geojson:V,video:ce,image:ve,canvas:fe};function lt(u,i){var n=a.identity([]);return a.translate(n,n,[1,1,0]),a.scale(n,n,[.5*u.width,.5*u.height,1]),a.multiply(n,n,u.calculatePosMatrix(i.toUnwrapped()))}function nt(u,i,n,c,y,_){var O=function(Yt,zt,Ut){if(Yt)for(var nr=0,rr=Yt;nr<rr.length;nr+=1){var Or=zt[rr[nr]];if(Or&&Or.source===Ut&&Or.type==="fill-extrusion")return!0}else for(var hr in zt){var Tr=zt[hr];if(Tr.source===Ut&&Tr.type==="fill-extrusion")return!0}return!1}(y&&y.layers,i,u.id),k=_.maxPitchScaleFactor(),ue=u.tilesIn(c,k,O);ue.sort(le);for(var Ae=[],We=0,Je=ue;We<Je.length;We+=1){var rt=Je[We];Ae.push({wrappedTileID:rt.tileID.wrapped().key,queryResults:rt.tile.queryRenderedFeatures(i,n,u._state,rt.queryGeometry,rt.cameraQueryGeometry,rt.scale,y,_,k,lt(u.transform,rt.tileID))})}var Ft=function(Yt){for(var zt={},Ut={},nr=0,rr=Yt;nr<rr.length;nr+=1){var Or=rr[nr],hr=Or.queryResults,Tr=Or.wrappedTileID,Cr=Ut[Tr]=Ut[Tr]||{};for(var an in hr)for(var Yr=hr[an],yn=Cr[an]=Cr[an]||{},On=zt[an]=zt[an]||[],Qn=0,oi=Yr;Qn<oi.length;Qn+=1){var xi=oi[Qn];yn[xi.featureIndex]||(yn[xi.featureIndex]=!0,On.push(xi))}}return zt}(Ae);for(var Rt in Ft)Ft[Rt].forEach(function(Yt){var zt=Yt.feature,Ut=u.getFeatureState(zt.layer["source-layer"],zt.id);zt.source=zt.layer.source,zt.layer["source-layer"]&&(zt.sourceLayer=zt.layer["source-layer"]),zt.state=Ut});return Ft}function le(u,i){var n=u.tileID,c=i.tileID;return n.overscaledZ-c.overscaledZ||n.canonical.y-c.canonical.y||n.wrap-c.wrap||n.canonical.x-c.canonical.x}var ye=function(i,n){this.max=i,this.onRemove=n,this.reset()};ye.prototype.reset=function(){for(var u in this.data)for(var i=0,n=this.data[u];i<n.length;i+=1){var c=n[i];c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value)}return this.data={},this.order=[],this},ye.prototype.add=function(u,i,n){var c=this,y=u.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);var _={value:i,timeout:void 0};if(n!==void 0&&(_.timeout=setTimeout(function(){c.remove(u,_)},n)),this.data[y].push(_),this.order.push(y),this.order.length>this.max){var O=this._getAndRemoveByKey(this.order[0]);O&&this.onRemove(O)}return this},ye.prototype.has=function(u){return u.wrapped().key in this.data},ye.prototype.getAndRemove=function(u){return this.has(u)?this._getAndRemoveByKey(u.wrapped().key):null},ye.prototype._getAndRemoveByKey=function(u){var i=this.data[u].shift();return i.timeout&&clearTimeout(i.timeout),this.data[u].length===0&&delete this.data[u],this.order.splice(this.order.indexOf(u),1),i.value},ye.prototype.getByKey=function(u){var i=this.data[u];return i?i[0].value:null},ye.prototype.get=function(u){return this.has(u)?this.data[u.wrapped().key][0].value:null},ye.prototype.remove=function(u,i){if(!this.has(u))return this;var n=u.wrapped().key,c=i===void 0?0:this.data[n].indexOf(i),y=this.data[n][c];return this.data[n].splice(c,1),y.timeout&&clearTimeout(y.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(y.value),this.order.splice(this.order.indexOf(n),1),this},ye.prototype.setMaxSize=function(u){for(this.max=u;this.order.length>this.max;){var i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this},ye.prototype.filter=function(u){var i=[];for(var n in this.data)for(var c=0,y=this.data[n];c<y.length;c+=1){var _=y[c];u(_.value)||i.push(_)}for(var O=0,k=i;O<k.length;O+=1){var ue=k[O];this.remove(ue.value.tileID,ue)}};var He=function(i,n,c){this.context=i;var y=i.gl;this.buffer=y.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};He.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},He.prototype.updateData=function(u){var i=this.context.gl;this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)},He.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ft={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},De=function(i,n,c,y){this.length=n.length,this.attributes=c,this.itemSize=n.bytesPerElement,this.dynamicDraw=y,this.context=i;var _=i.gl;this.buffer=_.createBuffer(),i.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};De.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},De.prototype.updateData=function(u){var i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,u.arrayBuffer)},De.prototype.enableAttributes=function(u,i){for(var n=0;n<this.attributes.length;n++){var c=i.attributes[this.attributes[n].name];c!==void 0&&u.enableVertexAttribArray(c)}},De.prototype.setVertexAttribPointers=function(u,i,n){for(var c=0;c<this.attributes.length;c++){var y=this.attributes[c],_=i.attributes[y.name];_!==void 0&&u.vertexAttribPointer(_,y.components,u[ft[y.type]],!1,this.itemSize,y.offset+this.itemSize*(n||0))}},De.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Ze=function(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Ze.prototype.get=function(){return this.current},Ze.prototype.set=function(u){},Ze.prototype.getDefault=function(){return this.default},Ze.prototype.setDefault=function(){this.set(this.default)};var w=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return a.Color.transparent},i.prototype.set=function(n){var c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},i}(Ze),R=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return 1},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},i}(Ze),q=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return 0},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},i}(Ze),he=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return[!0,!0,!0,!0]},i.prototype.set=function(n){var c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},i}(Ze),Ve=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!0},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},i}(Ze),Ye=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return 255},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},i}(Ze),yt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},i.prototype.set=function(n){var c=this.current;(n.func!==c.func||n.ref!==c.ref||n.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},i}(Ze),it=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},i.prototype.set=function(n){var c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},i}(Ze),Nt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;n?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=n,this.dirty=!1}},i}(Ze),$=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return[0,1]},i.prototype.set=function(n){var c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},i}(Ze),$e=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;n?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=n,this.dirty=!1}},i}(Ze),ie=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.LESS},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},i}(Ze),qe=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;n?c.enable(c.BLEND):c.disable(c.BLEND),this.current=n,this.dirty=!1}},i}(Ze),jt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},i.prototype.set=function(n){var c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},i}(Ze),lr=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return a.Color.transparent},i.prototype.set=function(n){var c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},i}(Ze),ct=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.FUNC_ADD},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},i}(Ze),ht=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;n?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=n,this.dirty=!1}},i}(Ze),Pt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.BACK},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},i}(Ze),vt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.CCW},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},i}(Ze),Pe=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},i}(Ze),ut=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.TEXTURE0},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},i}(Ze),Qe=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},i.prototype.set=function(n){var c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},i}(Ze),Vt=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},i}(Ze),pr=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,n),this.current=n,this.dirty=!1}},i}(Ze),Zr=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.bindTexture(c.TEXTURE_2D,n),this.current=n,this.dirty=!1}},i}(Ze),cr=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},i}(Ze),jn=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){var c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},i}(Ze),En=function(u){function i(n){u.call(this,n),this.vao=n.extVertexArrayObject}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},i}(Ze),ni=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return 4},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},i}(Ze),fi=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},i}(Ze),Zn=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},i}(Ze),Vn=function(u){function i(n,c){u.call(this,n),this.context=n,this.parent=c}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i}(Ze),Te=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.setDirty=function(){this.dirty=!0},i.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},i}(Vn),de=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,n),this.current=n,this.dirty=!1}},i}(Vn),W=function(i,n,c,y){this.context=i,this.width=n,this.height=c;var _=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new Te(i,_),y&&(this.depthAttachment=new de(i,_))};W.prototype.destroy=function(){var u=this.context.gl,i=this.colorAttachment.get();if(i&&u.deleteTexture(i),this.depthAttachment){var n=this.depthAttachment.get();n&&u.deleteRenderbuffer(n)}u.deleteFramebuffer(this.framebuffer)};var se=function(i,n,c){this.func=i,this.mask=n,this.range=c};se.ReadOnly=!1,se.ReadWrite=!0,se.disabled=new se(519,se.ReadOnly,[0,1]);var Le=function(i,n,c,y,_,O){this.test=i,this.ref=n,this.mask=c,this.fail=y,this.depthFail=_,this.pass=O};Le.disabled=new Le({func:519,mask:0},0,0,7680,7680,7680);var et=function(i,n,c){this.blendFunction=i,this.blendColor=n,this.mask=c};et.disabled=new et(et.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),et.unblended=new et(et.Replace,a.Color.transparent,[!0,!0,!0,!0]),et.alphaBlended=new et([1,771],a.Color.transparent,[!0,!0,!0,!0]);var wt=function(i,n,c){this.enable=i,this.mode=n,this.frontFace=c};wt.disabled=new wt(!1,1029,2305),wt.backCCW=new wt(!0,1029,2305);var Ne=function(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new w(this),this.clearDepth=new R(this),this.clearStencil=new q(this),this.colorMask=new he(this),this.depthMask=new Ve(this),this.stencilMask=new Ye(this),this.stencilFunc=new yt(this),this.stencilOp=new it(this),this.stencilTest=new Nt(this),this.depthRange=new $(this),this.depthTest=new $e(this),this.depthFunc=new ie(this),this.blend=new qe(this),this.blendFunc=new jt(this),this.blendColor=new lr(this),this.blendEquation=new ct(this),this.cullFace=new ht(this),this.cullFaceSide=new Pt(this),this.frontFace=new vt(this),this.program=new Pe(this),this.activeTexture=new ut(this),this.viewport=new Qe(this),this.bindFramebuffer=new Vt(this),this.bindRenderbuffer=new pr(this),this.bindTexture=new Zr(this),this.bindVertexBuffer=new cr(this),this.bindElementBuffer=new jn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new En(this),this.pixelStoreUnpack=new ni(this),this.pixelStoreUnpackPremultiplyAlpha=new fi(this),this.pixelStoreUnpackFlipY=new Zn(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)};Ne.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ne.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ne.prototype.createIndexBuffer=function(u,i){return new He(this,u,i)},Ne.prototype.createVertexBuffer=function(u,i,n){return new De(this,u,i,n)},Ne.prototype.createRenderbuffer=function(u,i,n){var c=this.gl,y=c.createRenderbuffer();return this.bindRenderbuffer.set(y),c.renderbufferStorage(c.RENDERBUFFER,u,i,n),this.bindRenderbuffer.set(null),y},Ne.prototype.createFramebuffer=function(u,i,n){return new W(this,u,i,n)},Ne.prototype.clear=function(u){var i=u.color,n=u.depth,c=this.gl,y=0;i&&(y|=c.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(y|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),c.clear(y)},Ne.prototype.setCullFace=function(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))},Ne.prototype.setDepthMode=function(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)},Ne.prototype.setStencilMode=function(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)},Ne.prototype.setColorMode=function(u){a.deepEqual(u.blendFunction,et.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)},Ne.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var gt=function(u){function i(n,c,y){var _=this;u.call(this),this.id=n,this.dispatcher=y,this.on("data",function(O){O.dataType==="source"&&O.sourceDataType==="metadata"&&(_._sourceLoaded=!0),_._sourceLoaded&&!_._paused&&O.dataType==="source"&&O.sourceDataType==="content"&&(_.reload(),_.transform&&_.update(_.transform))}),this.on("error",function(){_._sourceErrored=!0}),this._source=function(O,k,ue,Ae){var We=new ke[k.type](O,k,ue,Ae);if(We.id!==O)throw new Error("Expected Source id to be "+O+" instead of "+We.id);return a.bindAll(["load","abort","unload","serialize","prepare"],We),We}(n,c,y,this),this._tiles={},this._cache=new ye(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},i.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},i.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var n in this._tiles){var c=this._tiles[n];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0},i.prototype.getSource=function(){return this._source},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},i.prototype._loadTile=function(n,c){return this._source.loadTile(n,c)},i.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},i.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},i.prototype.serialize=function(){return this._source.serialize()},i.prototype.prepare=function(n){for(var c in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var y=this._tiles[c];y.upload(n),y.prepare(this.map.style.imageManager)}},i.prototype.getIds=function(){return a.values(this._tiles).map(function(n){return n.tileID}).sort(qt).map(function(n){return n.key})},i.prototype.getRenderableIds=function(n){var c=this,y=[];for(var _ in this._tiles)this._isIdRenderable(_,n)&&y.push(this._tiles[_]);return n?y.sort(function(O,k){var ue=O.tileID,Ae=k.tileID,We=new a.Point(ue.canonical.x,ue.canonical.y)._rotate(c.transform.angle),Je=new a.Point(Ae.canonical.x,Ae.canonical.y)._rotate(c.transform.angle);return ue.overscaledZ-Ae.overscaledZ||Je.y-We.y||Je.x-We.x}).map(function(O){return O.tileID.key}):y.map(function(O){return O.tileID}).sort(qt).map(function(O){return O.key})},i.prototype.hasRenderableParent=function(n){var c=this.findLoadedParent(n,0);return!!c&&this._isIdRenderable(c.tileID.key)},i.prototype._isIdRenderable=function(n,c){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(c||!this._tiles[n].holdingForFade())},i.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},i.prototype._reloadTile=function(n,c){var y=this._tiles[n];y&&(y.state!=="loading"&&(y.state=c),this._loadTile(y,this._tileLoaded.bind(this,y,n,c)))},i.prototype._tileLoaded=function(n,c,y,_){if(_)return n.state="errored",void(_.status!==404?this._source.fire(new a.ErrorEvent(_,{tile:n})):this.update(this.transform));n.timeAdded=a.browser.now(),y==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(c,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},i.prototype._backfillDEM=function(n){for(var c=this.getRenderableIds(),y=0;y<c.length;y++){var _=c[y];if(n.neighboringTiles&&n.neighboringTiles[_]){var O=this.getTileByID(_);k(n,O),k(O,n)}}function k(ue,Ae){ue.needsHillshadePrepare=!0;var We=Ae.tileID.canonical.x-ue.tileID.canonical.x,Je=Ae.tileID.canonical.y-ue.tileID.canonical.y,rt=Math.pow(2,ue.tileID.canonical.z),Ft=Ae.tileID.key;We===0&&Je===0||Math.abs(Je)>1||(Math.abs(We)>1&&(Math.abs(We+rt)===1?We+=rt:Math.abs(We-rt)===1&&(We-=rt)),Ae.dem&&ue.dem&&(ue.dem.backfillBorder(Ae.dem,We,Je),ue.neighboringTiles&&ue.neighboringTiles[Ft]&&(ue.neighboringTiles[Ft].backfilled=!0)))}},i.prototype.getTile=function(n){return this.getTileByID(n.key)},i.prototype.getTileByID=function(n){return this._tiles[n]},i.prototype._retainLoadedChildren=function(n,c,y,_){for(var O in this._tiles){var k=this._tiles[O];if(!(_[O]||!k.hasData()||k.tileID.overscaledZ<=c||k.tileID.overscaledZ>y)){for(var ue=k.tileID;k&&k.tileID.overscaledZ>c+1;){var Ae=k.tileID.scaledTo(k.tileID.overscaledZ-1);(k=this._tiles[Ae.key])&&k.hasData()&&(ue=Ae)}for(var We=ue;We.overscaledZ>c;)if(n[(We=We.scaledTo(We.overscaledZ-1)).key]){_[ue.key]=ue;break}}}},i.prototype.findLoadedParent=function(n,c){if(n.key in this._loadedParentTiles){var y=this._loadedParentTiles[n.key];return y&&y.tileID.overscaledZ>=c?y:null}for(var _=n.overscaledZ-1;_>=c;_--){var O=n.scaledTo(_),k=this._getLoadedTile(O);if(k)return k}},i.prototype._getLoadedTile=function(n){var c=this._tiles[n.key];return c&&c.hasData()?c:this._cache.getByKey(n.wrapped().key)},i.prototype.updateCacheSize=function(n){var c=Math.ceil(n.width/this._source.tileSize)+1,y=Math.ceil(n.height/this._source.tileSize)+1,_=Math.floor(c*y*5),O=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(O)},i.prototype.handleWrapJump=function(n){var c=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,c){var y={};for(var _ in this._tiles){var O=this._tiles[_];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+c),y[O.tileID.key]=O}for(var k in this._tiles=y,this._timers)clearTimeout(this._timers[k]),delete this._timers[k];for(var ue in this._tiles)this._setTileReloadTimer(ue,this._tiles[ue])}},i.prototype.update=function(n){var c=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var y;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?y=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Cr){return new a.OverscaledTileID(Cr.canonical.z,Cr.wrap,Cr.canonical.z,Cr.canonical.x,Cr.canonical.y)}):(y=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(y=y.filter(function(Cr){return c._source.hasTile(Cr)}))):y=[];var _=n.coveringZoomLevel(this._source),O=Math.max(_-i.maxOverzooming,this._source.minzoom),k=Math.max(_+i.maxUnderzooming,this._source.minzoom),ue=this._updateRetainedTiles(y,_);if(zr(this._source.type)){for(var Ae={},We={},Je=0,rt=Object.keys(ue);Je<rt.length;Je+=1){var Ft=rt[Je],Rt=ue[Ft],Yt=this._tiles[Ft];if(Yt&&!(Yt.fadeEndTime&&Yt.fadeEndTime<=a.browser.now())){var zt=this.findLoadedParent(Rt,O);zt&&(this._addTile(zt.tileID),Ae[zt.tileID.key]=zt.tileID),We[Ft]=Rt}}for(var Ut in this._retainLoadedChildren(We,_,k,ue),Ae)ue[Ut]||(this._coveredTiles[Ut]=!0,ue[Ut]=Ae[Ut])}for(var nr in ue)this._tiles[nr].clearFadeHold();for(var rr=0,Or=a.keysDifference(this._tiles,ue);rr<Or.length;rr+=1){var hr=Or[rr],Tr=this._tiles[hr];Tr.hasSymbolBuckets&&!Tr.holdingForFade()?Tr.setHoldDuration(this.map._fadeDuration):Tr.hasSymbolBuckets&&!Tr.symbolFadeFinished()||this._removeTile(hr)}this._updateLoadedParentTileCache()}},i.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},i.prototype._updateRetainedTiles=function(n,c){for(var y={},_={},O=Math.max(c-i.maxOverzooming,this._source.minzoom),k=Math.max(c+i.maxUnderzooming,this._source.minzoom),ue={},Ae=0,We=n;Ae<We.length;Ae+=1){var Je=We[Ae],rt=this._addTile(Je);y[Je.key]=Je,rt.hasData()||c<this._source.maxzoom&&(ue[Je.key]=Je)}this._retainLoadedChildren(ue,c,k,y);for(var Ft=0,Rt=n;Ft<Rt.length;Ft+=1){var Yt=Rt[Ft],zt=this._tiles[Yt.key];if(!zt.hasData()){if(c+1>this._source.maxzoom){var Ut=Yt.children(this._source.maxzoom)[0],nr=this.getTile(Ut);if(nr&&nr.hasData()){y[Ut.key]=Ut;continue}}else{var rr=Yt.children(this._source.maxzoom);if(y[rr[0].key]&&y[rr[1].key]&&y[rr[2].key]&&y[rr[3].key])continue}for(var Or=zt.wasRequested(),hr=Yt.overscaledZ-1;hr>=O;--hr){var Tr=Yt.scaledTo(hr);if(_[Tr.key]||(_[Tr.key]=!0,!(zt=this.getTile(Tr))&&Or&&(zt=this._addTile(Tr)),zt&&(y[Tr.key]=Tr,Or=zt.wasRequested(),zt.hasData())))break}}}return y},i.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var c=[],y=void 0,_=this._tiles[n].tileID;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){y=this._loadedParentTiles[_.key];break}c.push(_.key);var O=_.scaledTo(_.overscaledZ-1);if(y=this._getLoadedTile(O))break;_=O}for(var k=0,ue=c;k<ue.length;k+=1)this._loadedParentTiles[ue[k]]=y}},i.prototype._addTile=function(n){var c=this._tiles[n.key];if(c)return c;(c=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,c),c.tileID=n,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,c)));var y=Boolean(c);return y||(c=new a.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,n.key,c.state))),c?(c.uses++,this._tiles[n.key]=c,y||this._source.fire(new a.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null},i.prototype._setTileReloadTimer=function(n,c){var y=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var _=c.getExpiryTimeout();_&&(this._timers[n]=setTimeout(function(){y._reloadTile(n,"expired"),delete y._timers[n]},_))},i.prototype._removeTile=function(n){var c=this._tiles[n];c&&(c.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))},i.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},i.prototype.tilesIn=function(n,c,y){var _=this,O=[],k=this.transform;if(!k)return O;for(var ue=y?k.getCameraQueryGeometry(n):n,Ae=n.map(function(hr){return k.pointCoordinate(hr)}),We=ue.map(function(hr){return k.pointCoordinate(hr)}),Je=this.getIds(),rt=1/0,Ft=1/0,Rt=-1/0,Yt=-1/0,zt=0,Ut=We;zt<Ut.length;zt+=1){var nr=Ut[zt];rt=Math.min(rt,nr.x),Ft=Math.min(Ft,nr.y),Rt=Math.max(Rt,nr.x),Yt=Math.max(Yt,nr.y)}for(var rr=function(Tr){var Cr=_._tiles[Je[Tr]];if(!Cr.holdingForFade()){var an=Cr.tileID,Yr=Math.pow(2,k.zoom-Cr.tileID.overscaledZ),yn=c*Cr.queryPadding*a.EXTENT/Cr.tileSize/Yr,On=[an.getTilePoint(new a.MercatorCoordinate(rt,Ft)),an.getTilePoint(new a.MercatorCoordinate(Rt,Yt))];if(On[0].x-yn<a.EXTENT&&On[0].y-yn<a.EXTENT&&On[1].x+yn>=0&&On[1].y+yn>=0){var Qn=Ae.map(function(xi){return an.getTilePoint(xi)}),oi=We.map(function(xi){return an.getTilePoint(xi)});O.push({tile:Cr,tileID:an,queryGeometry:Qn,cameraQueryGeometry:oi,scale:Yr})}}},Or=0;Or<Je.length;Or++)rr(Or);return O},i.prototype.getVisibleCoordinates=function(n){for(var c=this,y=this.getRenderableIds(n).map(function(ue){return c._tiles[ue].tileID}),_=0,O=y;_<O.length;_+=1){var k=O[_];k.posMatrix=this.transform.calculatePosMatrix(k.toUnwrapped())}return y},i.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(zr(this._source.type))for(var n in this._tiles){var c=this._tiles[n];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=a.browser.now())return!0}return!1},i.prototype.setFeatureState=function(n,c,y){this._state.updateState(n=n||"_geojsonTileLayer",c,y)},i.prototype.removeFeatureState=function(n,c,y){this._state.removeFeatureState(n=n||"_geojsonTileLayer",c,y)},i.prototype.getFeatureState=function(n,c){return this._state.getState(n=n||"_geojsonTileLayer",c)},i.prototype.setDependencies=function(n,c,y){var _=this._tiles[n];_&&_.setDependencies(c,y)},i.prototype.reloadTilesForDependencies=function(n,c){for(var y in this._tiles)this._tiles[y].hasDependency(n,c)&&this._reloadTile(y,"reloading");this._cache.filter(function(_){return!_.hasDependency(n,c)})},i}(a.Evented);function qt(u,i){var n=Math.abs(2*u.wrap)-+(u.wrap<0),c=Math.abs(2*i.wrap)-+(i.wrap<0);return u.overscaledZ-i.overscaledZ||c-n||i.canonical.y-u.canonical.y||i.canonical.x-u.canonical.x}function zr(u){return u==="raster"||u==="image"||u==="video"}function Br(){return new a.window.Worker(ic.workerUrl)}gt.maxOverzooming=10,gt.maxUnderzooming=3;var sr="mapboxgl_preloaded_worker_pool",kr=function(){this.active={}};kr.prototype.acquire=function(u){if(!this.workers)for(this.workers=[];this.workers.length<kr.workerCount;)this.workers.push(new Br);return this.active[u]=!0,this.workers.slice()},kr.prototype.release=function(u){delete this.active[u],this.numActive()===0&&(this.workers.forEach(function(i){i.terminate()}),this.workers=null)},kr.prototype.isPreloaded=function(){return!!this.active[sr]},kr.prototype.numActive=function(){return Object.keys(this.active).length};var Cn,dn=Math.floor(a.browser.hardwareConcurrency/2);function Er(){return Cn||(Cn=new kr),Cn}function Tn(u,i){var n={};for(var c in u)c!=="ref"&&(n[c]=u[c]);return a.refProperties.forEach(function(y){y in i&&(n[y]=i[y])}),n}function vn(u){u=u.slice();for(var i=Object.create(null),n=0;n<u.length;n++)i[u[n].id]=u[n];for(var c=0;c<u.length;c++)"ref"in u[c]&&(u[c]=Tn(u[c],i[u[c].ref]));return u}kr.workerCount=Math.max(Math.min(dn,6),1);var mn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ar(u,i,n){n.push({command:mn.addSource,args:[u,i[u]]})}function $r(u,i,n){i.push({command:mn.removeSource,args:[u]}),n[u]=!0}function Mn(u,i,n,c){$r(u,n,c),Ar(u,i,n)}function Ki(u,i,n){var c;for(c in u[n])if(u[n].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(u[n][c],i[n][c]))return!1;for(c in i[n])if(i[n].hasOwnProperty(c)&&c!=="data"&&!a.deepEqual(u[n][c],i[n][c]))return!1;return!0}function vi(u,i,n,c,y,_){var O;for(O in i=i||{},u=u||{})u.hasOwnProperty(O)&&(a.deepEqual(u[O],i[O])||n.push({command:_,args:[c,O,i[O],y]}));for(O in i)i.hasOwnProperty(O)&&!u.hasOwnProperty(O)&&(a.deepEqual(u[O],i[O])||n.push({command:_,args:[c,O,i[O],y]}))}function Mi(u){return u.id}function zi(u,i){return u[i.id]=i,u}var Ka=function(i,n){this.reset(i,n)};Ka.prototype.reset=function(u,i){this.points=u||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ka.prototype.lerp=function(u){if(this.points.length===1)return this.points[0];u=a.clamp(u,0,1);for(var i=1,n=this._distances[i],c=u*this.paddedLength+this.padding;n<c&&i<this._distances.length;)n=this._distances[++i];var y=i-1,_=this._distances[y],O=n-_,k=O>0?(c-_)/O:0;return this.points[y].mult(1-k).add(this.points[i].mult(k))};var hi=function(i,n,c){var y=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(i/c),this.yCellCount=Math.ceil(n/c);for(var O=0;O<this.xCellCount*this.yCellCount;O++)y.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=n,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function ya(u,i,n,c,y){var _=a.create();return i?(a.scale(_,_,[1/y,1/y,1]),n||a.rotateZ(_,_,c.angle)):a.multiply(_,c.labelPlaneMatrix,u),_}function Ii(u,i,n,c,y){if(i){var _=a.clone(u);return a.scale(_,_,[y,y,1]),n||a.rotateZ(_,_,-c.angle),_}return c.glCoordMatrix}function yi(u,i){var n=[u.x,u.y,0,1];Ja(n,n,i);var c=n[3];return{point:new a.Point(n[0]/c,n[1]/c),signedDistanceFromCamera:c}}function ci(u,i){return .5+u/i*.5}function Ra(u,i){var n=u[0]/u[3],c=u[1]/u[3];return n>=-i[0]&&n<=i[0]&&c>=-i[1]&&c<=i[1]}function xo(u,i,n,c,y,_,O,k){var ue=c?u.textSizeData:u.iconSizeData,Ae=a.evaluateSizeForZoom(ue,n.transform.zoom),We=[256/n.width*2+1,256/n.height*2+1],Je=c?u.text.dynamicLayoutVertexArray:u.icon.dynamicLayoutVertexArray;Je.clear();for(var rt=u.lineVertexArray,Ft=c?u.text.placedSymbolArray:u.icon.placedSymbolArray,Rt=n.transform.width/n.transform.height,Yt=!1,zt=0;zt<Ft.length;zt++){var Ut=Ft.get(zt);if(Ut.hidden||Ut.writingMode===a.WritingMode.vertical&&!Yt)na(Ut.numGlyphs,Je);else{Yt=!1;var nr=[Ut.anchorX,Ut.anchorY,0,1];if(a.transformMat4(nr,nr,i),Ra(nr,We)){var rr=ci(n.transform.cameraToCenterDistance,nr[3]),Or=a.evaluateSizeForFeature(ue,Ae,Ut),hr=O?Or/rr:Or*rr,Tr=new a.Point(Ut.anchorX,Ut.anchorY),Cr=yi(Tr,y).point,an={},Yr=Uu(Ut,hr,!1,k,i,y,_,u.glyphOffsetArray,rt,Je,Cr,Tr,an,Rt);Yt=Yr.useVertical,(Yr.notEnoughRoom||Yt||Yr.needsFlipping&&Uu(Ut,hr,!0,k,i,y,_,u.glyphOffsetArray,rt,Je,Cr,Tr,an,Rt).notEnoughRoom)&&na(Ut.numGlyphs,Je)}else na(Ut.numGlyphs,Je)}}c?u.text.dynamicLayoutVertexBuffer.updateData(Je):u.icon.dynamicLayoutVertexBuffer.updateData(Je)}function $a(u,i,n,c,y,_,O,k,ue,Ae,We){var Je=k.glyphStartIndex+k.numGlyphs,rt=k.lineStartIndex,Ft=k.lineStartIndex+k.lineLength,Rt=i.getoffsetX(k.glyphStartIndex),Yt=i.getoffsetX(Je-1),zt=Pa(u*Rt,n,c,y,_,O,k.segment,rt,Ft,ue,Ae,We);if(!zt)return null;var Ut=Pa(u*Yt,n,c,y,_,O,k.segment,rt,Ft,ue,Ae,We);return Ut?{first:zt,last:Ut}:null}function Ko(u,i,n,c){return u===a.WritingMode.horizontal&&Math.abs(n.y-i.y)>Math.abs(n.x-i.x)*c?{useVertical:!0}:(u===a.WritingMode.vertical?i.y<n.y:i.x>n.x)?{needsFlipping:!0}:null}function Uu(u,i,n,c,y,_,O,k,ue,Ae,We,Je,rt,Ft){var Rt,Yt=i/24,zt=u.lineOffsetX*Yt,Ut=u.lineOffsetY*Yt;if(u.numGlyphs>1){var nr=u.glyphStartIndex+u.numGlyphs,rr=u.lineStartIndex,Or=u.lineStartIndex+u.lineLength,hr=$a(Yt,k,zt,Ut,n,We,Je,u,ue,_,rt);if(!hr)return{notEnoughRoom:!0};var Tr=yi(hr.first.point,O).point,Cr=yi(hr.last.point,O).point;if(c&&!n){var an=Ko(u.writingMode,Tr,Cr,Ft);if(an)return an}Rt=[hr.first];for(var Yr=u.glyphStartIndex+1;Yr<nr-1;Yr++)Rt.push(Pa(Yt*k.getoffsetX(Yr),zt,Ut,n,We,Je,u.segment,rr,Or,ue,_,rt));Rt.push(hr.last)}else{if(c&&!n){var yn=yi(Je,y).point,On=u.lineStartIndex+u.segment+1,Qn=new a.Point(ue.getx(On),ue.gety(On)),oi=yi(Qn,y),xi=oi.signedDistanceFromCamera>0?oi.point:Gi(Je,Qn,yn,1,y),Xi=Ko(u.writingMode,yn,xi,Ft);if(Xi)return Xi}var An=Pa(Yt*k.getoffsetX(u.glyphStartIndex),zt,Ut,n,We,Je,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,ue,_,rt);if(!An)return{notEnoughRoom:!0};Rt=[An]}for(var si=0,bi=Rt;si<bi.length;si+=1){var Wn=bi[si];a.addDynamicAttributes(Ae,Wn.point,Wn.angle)}return{}}function Gi(u,i,n,c,y){var _=yi(u.add(u.sub(i)._unit()),y).point,O=n.sub(_);return n.add(O._mult(c/O.mag()))}function Pa(u,i,n,c,y,_,O,k,ue,Ae,We,Je){var rt=c?u-i:u+i,Ft=rt>0?1:-1,Rt=0;c&&(Ft*=-1,Rt=Math.PI),Ft<0&&(Rt+=Math.PI);for(var Yt=Ft>0?k+O:k+O+1,zt=y,Ut=y,nr=0,rr=0,Or=Math.abs(rt),hr=[];nr+rr<=Or;){if((Yt+=Ft)<k||Yt>=ue)return null;if(Ut=zt,hr.push(zt),(zt=Je[Yt])===void 0){var Tr=new a.Point(Ae.getx(Yt),Ae.gety(Yt)),Cr=yi(Tr,We);if(Cr.signedDistanceFromCamera>0)zt=Je[Yt]=Cr.point;else{var an=Yt-Ft;zt=Gi(nr===0?_:new a.Point(Ae.getx(an),Ae.gety(an)),Tr,Ut,Or-nr+1,We)}}nr+=rr,rr=Ut.dist(zt)}var Yr=(Or-nr)/rr,yn=zt.sub(Ut),On=yn.mult(Yr)._add(Ut);On._add(yn._unit()._perp()._mult(n*Ft));var Qn=Rt+Math.atan2(zt.y-Ut.y,zt.x-Ut.x);return hr.push(On),{point:On,angle:Qn,path:hr}}hi.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},hi.prototype.insert=function(u,i,n,c,y){this._forEachCell(i,n,c,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(c),this.bboxes.push(y)},hi.prototype.insertCircle=function(u,i,n,c){this._forEachCell(i-c,n-c,i+c,n+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(i),this.circles.push(n),this.circles.push(c)},hi.prototype._insertBoxCell=function(u,i,n,c,y,_){this.boxCells[y].push(_)},hi.prototype._insertCircleCell=function(u,i,n,c,y,_){this.circleCells[y].push(_)},hi.prototype._query=function(u,i,n,c,y,_){if(n<0||u>this.width||c<0||i>this.height)return!y&&[];var O=[];if(u<=0&&i<=0&&this.width<=n&&this.height<=c){if(y)return!0;for(var k=0;k<this.boxKeys.length;k++)O.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(var ue=0;ue<this.circleKeys.length;ue++){var Ae=this.circles[3*ue],We=this.circles[3*ue+1],Je=this.circles[3*ue+2];O.push({key:this.circleKeys[ue],x1:Ae-Je,y1:We-Je,x2:Ae+Je,y2:We+Je})}return _?O.filter(_):O}return this._forEachCell(u,i,n,c,this._queryCell,O,{hitTest:y,seenUids:{box:{},circle:{}}},_),y?O.length>0:O},hi.prototype._queryCircle=function(u,i,n,c,y){var _=u-n,O=u+n,k=i-n,ue=i+n;if(O<0||_>this.width||ue<0||k>this.height)return!c&&[];var Ae=[];return this._forEachCell(_,k,O,ue,this._queryCellCircle,Ae,{hitTest:c,circle:{x:u,y:i,radius:n},seenUids:{box:{},circle:{}}},y),c?Ae.length>0:Ae},hi.prototype.query=function(u,i,n,c,y){return this._query(u,i,n,c,!1,y)},hi.prototype.hitTest=function(u,i,n,c,y){return this._query(u,i,n,c,!0,y)},hi.prototype.hitTestCircle=function(u,i,n,c){return this._queryCircle(u,i,n,!0,c)},hi.prototype._queryCell=function(u,i,n,c,y,_,O,k){var ue=O.seenUids,Ae=this.boxCells[y];if(Ae!==null)for(var We=this.bboxes,Je=0,rt=Ae;Je<rt.length;Je+=1){var Ft=rt[Je];if(!ue.box[Ft]){ue.box[Ft]=!0;var Rt=4*Ft;if(u<=We[Rt+2]&&i<=We[Rt+3]&&n>=We[Rt+0]&&c>=We[Rt+1]&&(!k||k(this.boxKeys[Ft]))){if(O.hitTest)return _.push(!0),!0;_.push({key:this.boxKeys[Ft],x1:We[Rt],y1:We[Rt+1],x2:We[Rt+2],y2:We[Rt+3]})}}}var Yt=this.circleCells[y];if(Yt!==null)for(var zt=this.circles,Ut=0,nr=Yt;Ut<nr.length;Ut+=1){var rr=nr[Ut];if(!ue.circle[rr]){ue.circle[rr]=!0;var Or=3*rr;if(this._circleAndRectCollide(zt[Or],zt[Or+1],zt[Or+2],u,i,n,c)&&(!k||k(this.circleKeys[rr]))){if(O.hitTest)return _.push(!0),!0;var hr=zt[Or],Tr=zt[Or+1],Cr=zt[Or+2];_.push({key:this.circleKeys[rr],x1:hr-Cr,y1:Tr-Cr,x2:hr+Cr,y2:Tr+Cr})}}}},hi.prototype._queryCellCircle=function(u,i,n,c,y,_,O,k){var ue=O.circle,Ae=O.seenUids,We=this.boxCells[y];if(We!==null)for(var Je=this.bboxes,rt=0,Ft=We;rt<Ft.length;rt+=1){var Rt=Ft[rt];if(!Ae.box[Rt]){Ae.box[Rt]=!0;var Yt=4*Rt;if(this._circleAndRectCollide(ue.x,ue.y,ue.radius,Je[Yt+0],Je[Yt+1],Je[Yt+2],Je[Yt+3])&&(!k||k(this.boxKeys[Rt])))return _.push(!0),!0}}var zt=this.circleCells[y];if(zt!==null)for(var Ut=this.circles,nr=0,rr=zt;nr<rr.length;nr+=1){var Or=rr[nr];if(!Ae.circle[Or]){Ae.circle[Or]=!0;var hr=3*Or;if(this._circlesCollide(Ut[hr],Ut[hr+1],Ut[hr+2],ue.x,ue.y,ue.radius)&&(!k||k(this.circleKeys[Or])))return _.push(!0),!0}}},hi.prototype._forEachCell=function(u,i,n,c,y,_,O,k){for(var ue=this._convertToXCellCoord(u),Ae=this._convertToYCellCoord(i),We=this._convertToXCellCoord(n),Je=this._convertToYCellCoord(c),rt=ue;rt<=We;rt++)for(var Ft=Ae;Ft<=Je;Ft++)if(y.call(this,u,i,n,c,this.xCellCount*Ft+rt,_,O,k))return},hi.prototype._convertToXCellCoord=function(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))},hi.prototype._convertToYCellCoord=function(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))},hi.prototype._circlesCollide=function(u,i,n,c,y,_){var O=c-u,k=y-i,ue=n+_;return ue*ue>O*O+k*k},hi.prototype._circleAndRectCollide=function(u,i,n,c,y,_,O){var k=(_-c)/2,ue=Math.abs(u-(c+k));if(ue>k+n)return!1;var Ae=(O-y)/2,We=Math.abs(i-(y+Ae));if(We>Ae+n)return!1;if(ue<=k||We<=Ae)return!0;var Je=ue-k,rt=We-Ae;return Je*Je+rt*rt<=n*n};var ns=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function na(u,i){for(var n=0;n<u;n++){var c=i.length;i.resize(c+4),i.float32.set(ns,3*c)}}function Ja(u,i,n){var c=i[0],y=i[1];return u[0]=n[0]*c+n[4]*y+n[12],u[1]=n[1]*c+n[5]*y+n[13],u[3]=n[3]*c+n[7]*y+n[15],u}var is=function(i,n,c){n===void 0&&(n=new hi(i.width+200,i.height+200,25)),c===void 0&&(c=new hi(i.width+200,i.height+200,25)),this.transform=i,this.grid=n,this.ignoredGrid=c,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+100,this.screenBottomBoundary=i.height+100,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200};function Ji(u,i,n){return i*(a.EXTENT/(u.tileSize*Math.pow(2,n-u.tileID.overscaledZ)))}is.prototype.placeCollisionBox=function(u,i,n,c,y){var _=this.projectAndGetPerspectiveRatio(c,u.anchorPointX,u.anchorPointY),O=n*_.perspectiveRatio,k=u.x1*O+_.point.x,ue=u.y1*O+_.point.y,Ae=u.x2*O+_.point.x,We=u.y2*O+_.point.y;return!this.isInsideGrid(k,ue,Ae,We)||!i&&this.grid.hitTest(k,ue,Ae,We,y)?{box:[],offscreen:!1}:{box:[k,ue,Ae,We],offscreen:this.isOffscreen(k,ue,Ae,We)}},is.prototype.placeCollisionCircles=function(u,i,n,c,y,_,O,k,ue,Ae,We,Je,rt){var Ft=[],Rt=new a.Point(i.anchorX,i.anchorY),Yt=yi(Rt,_),zt=ci(this.transform.cameraToCenterDistance,Yt.signedDistanceFromCamera),Ut=(Ae?y/zt:y*zt)/a.ONE_EM,nr=yi(Rt,O).point,rr=$a(Ut,c,i.lineOffsetX*Ut,i.lineOffsetY*Ut,!1,nr,Rt,i,n,O,{}),Or=!1,hr=!1,Tr=!0;if(rr){for(var Cr=.5*Je*zt+rt,an=new a.Point(-100,-100),Yr=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),yn=new Ka,On=rr.first,Qn=rr.last,oi=[],xi=On.path.length-1;xi>=1;xi--)oi.push(On.path[xi]);for(var Xi=1;Xi<Qn.path.length;Xi++)oi.push(Qn.path[Xi]);var An=2.5*Cr;if(k){var si=oi.map(function(As){return yi(As,k)});oi=si.some(function(As){return As.signedDistanceFromCamera<=0})?[]:si.map(function(As){return As.point})}var bi=[];if(oi.length>0){for(var Wn=oi[0].clone(),Ti=oi[0].clone(),ii=1;ii<oi.length;ii++)Wn.x=Math.min(Wn.x,oi[ii].x),Wn.y=Math.min(Wn.y,oi[ii].y),Ti.x=Math.max(Ti.x,oi[ii].x),Ti.y=Math.max(Ti.y,oi[ii].y);bi=Wn.x>=an.x&&Ti.x<=Yr.x&&Wn.y>=an.y&&Ti.y<=Yr.y?[oi]:Ti.x<an.x||Wn.x>Yr.x||Ti.y<an.y||Wn.y>Yr.y?[]:a.clipLine([oi],an.x,an.y,Yr.x,Yr.y)}for(var Li=0,ji=bi;Li<ji.length;Li+=1){var qa;yn.reset(ji[Li],.25*Cr),qa=yn.length<=.5*Cr?1:Math.ceil(yn.paddedLength/An)+1;for(var Ma=0;Ma<qa;Ma++){var So=Ma/Math.max(qa-1,1),Ta=yn.lerp(So),Xa=Ta.x+100,zs=Ta.y+100;Ft.push(Xa,zs,Cr,0);var Eo=Xa-Cr,yu=zs-Cr,xu=Xa+Cr,Uo=zs+Cr;if(Tr=Tr&&this.isOffscreen(Eo,yu,xu,Uo),hr=hr||this.isInsideGrid(Eo,yu,xu,Uo),!u&&this.grid.hitTestCircle(Xa,zs,Cr,We)&&(Or=!0,!ue))return{circles:[],offscreen:!1,collisionDetected:Or}}}}return{circles:!ue&&Or||!hr?[]:Ft,offscreen:Tr,collisionDetected:Or}},is.prototype.queryRenderedSymbols=function(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var i=[],n=1/0,c=1/0,y=-1/0,_=-1/0,O=0,k=u;O<k.length;O+=1){var ue=k[O],Ae=new a.Point(ue.x+100,ue.y+100);n=Math.min(n,Ae.x),c=Math.min(c,Ae.y),y=Math.max(y,Ae.x),_=Math.max(_,Ae.y),i.push(Ae)}for(var We={},Je={},rt=0,Ft=this.grid.query(n,c,y,_).concat(this.ignoredGrid.query(n,c,y,_));rt<Ft.length;rt+=1){var Rt=Ft[rt],Yt=Rt.key;if(We[Yt.bucketInstanceId]===void 0&&(We[Yt.bucketInstanceId]={}),!We[Yt.bucketInstanceId][Yt.featureIndex]){var zt=[new a.Point(Rt.x1,Rt.y1),new a.Point(Rt.x2,Rt.y1),new a.Point(Rt.x2,Rt.y2),new a.Point(Rt.x1,Rt.y2)];a.polygonIntersectsPolygon(i,zt)&&(We[Yt.bucketInstanceId][Yt.featureIndex]=!0,Je[Yt.bucketInstanceId]===void 0&&(Je[Yt.bucketInstanceId]=[]),Je[Yt.bucketInstanceId].push(Yt.featureIndex))}}return Je},is.prototype.insertCollisionBox=function(u,i,n,c,y){(i?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:c,collisionGroupID:y},u[0],u[1],u[2],u[3])},is.prototype.insertCollisionCircles=function(u,i,n,c,y){for(var _=i?this.ignoredGrid:this.grid,O={bucketInstanceId:n,featureIndex:c,collisionGroupID:y},k=0;k<u.length;k+=4)_.insertCircle(O,u[k],u[k+1],u[k+2])},is.prototype.projectAndGetPerspectiveRatio=function(u,i,n){var c=[i,n,0,1];return Ja(c,c,u),{point:new a.Point((c[0]/c[3]+1)/2*this.transform.width+100,(-c[1]/c[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/c[3]*.5}},is.prototype.isOffscreen=function(u,i,n,c){return n<100||u>=this.screenRightBoundary||c<100||i>this.screenBottomBoundary},is.prototype.isInsideGrid=function(u,i,n,c){return n>=0&&u<this.gridRightBoundary&&c>=0&&i<this.gridBottomBoundary},is.prototype.getViewportMatrix=function(){var u=a.identity([]);return a.translate(u,u,[-100,-100,0]),u};var lo=function(i,n,c,y){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?n:-n))):y&&c?1:0,this.placed=c};lo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var co=function(i,n,c,y,_){this.text=new lo(i?i.text:null,n,c,_),this.icon=new lo(i?i.icon:null,n,y,_)};co.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ks=function(i,n,c){this.text=i,this.icon=n,this.skipFade=c},wo=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},Zl=function(i,n,c,y,_){this.bucketInstanceId=i,this.featureIndex=n,this.sourceLayerIndex=c,this.bucketIndex=y,this.tileID=_},$s=function(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}};function Po(u,i,n,c,y){var _=a.getAnchorAlignment(u),O=-(_.horizontalAlign-.5)*i,k=-(_.verticalAlign-.5)*n,ue=a.evaluateVariableOffset(u,c);return new a.Point(O+ue[0]*y,k+ue[1]*y)}function Bt(u,i,n,c,y,_){var O=u.x1,k=u.x2,ue=u.y1,Ae=u.y2,We=u.anchorPointX,Je=u.anchorPointY,rt=new a.Point(i,n);return c&&rt._rotate(y?_:-_),{x1:O+rt.x,y1:ue+rt.y,x2:k+rt.x,y2:Ae+rt.y,anchorPointX:We,anchorPointY:Je}}$s.prototype.get=function(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){var i=++this.maxGroupID;this.collisionGroups[u]={ID:i,predicate:function(c){return c.collisionGroupID===i}}}return this.collisionGroups[u]};var Fe=function(i,n,c,y){this.transform=i.clone(),this.collisionIndex=new is(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new $s(c),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}};function Ot(u,i,n,c,y){u.emplaceBack(i?1:0,n?1:0,c||0,y||0),u.emplaceBack(i?1:0,n?1:0,c||0,y||0),u.emplaceBack(i?1:0,n?1:0,c||0,y||0),u.emplaceBack(i?1:0,n?1:0,c||0,y||0)}Fe.prototype.getBucketParts=function(u,i,n,c){var y=n.getBucket(i),_=n.latestFeatureIndex;if(y&&_&&i.id===y.layerIds[0]){var O=n.collisionBoxArray,k=y.layers[0].layout,ue=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),Ae=n.tileSize/a.EXTENT,We=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),Je=k.get("text-pitch-alignment")==="map",rt=k.get("text-rotation-alignment")==="map",Ft=Ji(n,1,this.transform.zoom),Rt=ya(We,Je,rt,this.transform,Ft),Yt=null;if(Je){var zt=Ii(We,Je,rt,this.transform,Ft);Yt=a.multiply([],this.transform.labelPlaneMatrix,zt)}this.retainedQueryData[y.bucketInstanceId]=new Zl(y.bucketInstanceId,_,y.sourceLayerIndex,y.index,n.tileID);var Ut={bucket:y,layout:k,posMatrix:We,textLabelPlaneMatrix:Rt,labelToScreenMatrix:Yt,scale:ue,textPixelRatio:Ae,holdingForFade:n.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(c)for(var nr=0,rr=y.sortKeyRanges;nr<rr.length;nr+=1){var Or=rr[nr];u.push({sortKey:Or.sortKey,symbolInstanceStart:Or.symbolInstanceStart,symbolInstanceEnd:Or.symbolInstanceEnd,parameters:Ut})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:Ut})}},Fe.prototype.attemptAnchorPlacement=function(u,i,n,c,y,_,O,k,ue,Ae,We,Je,rt,Ft,Rt){var Yt,zt=[Je.textOffset0,Je.textOffset1],Ut=Po(u,n,c,zt,y),nr=this.collisionIndex.placeCollisionBox(Bt(i,Ut.x,Ut.y,_,O,this.transform.angle),We,k,ue,Ae.predicate);if(!Rt||this.collisionIndex.placeCollisionBox(Bt(Rt,Ut.x,Ut.y,_,O,this.transform.angle),We,k,ue,Ae.predicate).box.length!==0)return nr.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Je.crossTileID]&&this.prevPlacement.placements[Je.crossTileID]&&this.prevPlacement.placements[Je.crossTileID].text&&(Yt=this.prevPlacement.variableOffsets[Je.crossTileID].anchor),this.variableOffsets[Je.crossTileID]={textOffset:zt,width:n,height:c,anchor:u,textBoxScale:y,prevAnchor:Yt},this.markUsedJustification(rt,u,Je,Ft),rt.allowVerticalPlacement&&(this.markUsedOrientation(rt,Ft,Je),this.placedOrientations[Je.crossTileID]=Ft),{shift:Ut,placedGlyphBoxes:nr}):void 0},Fe.prototype.placeLayerBucketPart=function(u,i,n){var c=this,y=u.parameters,_=y.bucket,O=y.layout,k=y.posMatrix,ue=y.textLabelPlaneMatrix,Ae=y.labelToScreenMatrix,We=y.textPixelRatio,Je=y.holdingForFade,rt=y.collisionBoxArray,Ft=y.partiallyEvaluatedTextSize,Rt=y.collisionGroup,Yt=O.get("text-optional"),zt=O.get("icon-optional"),Ut=O.get("text-allow-overlap"),nr=O.get("icon-allow-overlap"),rr=O.get("text-rotation-alignment")==="map",Or=O.get("text-pitch-alignment")==="map",hr=O.get("icon-text-fit")!=="none",Tr=O.get("symbol-z-order")==="viewport-y",Cr=Ut&&(nr||!_.hasIconData()||zt),an=nr&&(Ut||!_.hasTextData()||Yt);!_.collisionArrays&&rt&&_.deserializeCollisionBoxes(rt);var Yr=function(An,si){if(!i[An.crossTileID])if(Je)c.placements[An.crossTileID]=new Ks(!1,!1,!1);else{var bi,Wn=!1,Ti=!1,ii=!0,Li=null,ji={box:null,offscreen:null},qa={box:null,offscreen:null},Ma=null,So=null,Ta=0,Xa=0,zs=0;si.textFeatureIndex?Ta=si.textFeatureIndex:An.useRuntimeCollisionCircles&&(Ta=An.featureIndex),si.verticalTextFeatureIndex&&(Xa=si.verticalTextFeatureIndex);var Eo=si.textBox;if(Eo){var yu=function(Jo){var To=a.WritingMode.horizontal;if(_.allowVerticalPlacement&&!Jo&&c.prevPlacement){var Vo=c.prevPlacement.placedOrientations[An.crossTileID];Vo&&(c.placedOrientations[An.crossTileID]=Vo,c.markUsedOrientation(_,To=Vo,An))}return To},xu=function(Jo,To){if(_.allowVerticalPlacement&&An.numVerticalGlyphVertices>0&&si.verticalTextBox)for(var Vo=0,Gs=_.writingModes;Vo<Gs.length&&(Gs[Vo]===a.WritingMode.vertical?(ji=To(),qa=ji):ji=Jo(),!(ji&&ji.box&&ji.box.length));Vo+=1);else ji=Jo()};if(O.get("text-variable-anchor")){var Uo=O.get("text-variable-anchor");if(c.prevPlacement&&c.prevPlacement.variableOffsets[An.crossTileID]){var As=c.prevPlacement.variableOffsets[An.crossTileID];Uo.indexOf(As.anchor)>0&&(Uo=Uo.filter(function(Ro){return Ro!==As.anchor})).unshift(As.anchor)}var Lu=function(Jo,To,Vo){for(var Gs=Jo.x2-Jo.x1,Pl=Jo.y2-Jo.y1,Uc=An.textBoxScale,Vl=hr&&!nr?To:null,Ju={box:[],offscreen:!1},zu=Ut?2*Uo.length:Uo.length,Nu=0;Nu<zu;++Nu){var Hs=c.attemptAnchorPlacement(Uo[Nu%Uo.length],Jo,Gs,Pl,Uc,rr,Or,We,k,Rt,Nu>=Uo.length,An,_,Vo,Vl);if(Hs&&(Ju=Hs.placedGlyphBoxes)&&Ju.box&&Ju.box.length){Wn=!0,Li=Hs.shift;break}}return Ju};xu(function(){return Lu(Eo,si.iconBox,a.WritingMode.horizontal)},function(){var Ro=si.verticalTextBox;return _.allowVerticalPlacement&&!(ji&&ji.box&&ji.box.length)&&An.numVerticalGlyphVertices>0&&Ro?Lu(Ro,si.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),ji&&(Wn=ji.box,ii=ji.offscreen);var ac=yu(ji&&ji.box);if(!Wn&&c.prevPlacement){var $u=c.prevPlacement.variableOffsets[An.crossTileID];$u&&(c.variableOffsets[An.crossTileID]=$u,c.markUsedJustification(_,$u.anchor,An,ac))}}else{var oc=function(Jo,To){var Vo=c.collisionIndex.placeCollisionBox(Jo,Ut,We,k,Rt.predicate);return Vo&&Vo.box&&Vo.box.length&&(c.markUsedOrientation(_,To,An),c.placedOrientations[An.crossTileID]=To),Vo};xu(function(){return oc(Eo,a.WritingMode.horizontal)},function(){var Ro=si.verticalTextBox;return _.allowVerticalPlacement&&An.numVerticalGlyphVertices>0&&Ro?oc(Ro,a.WritingMode.vertical):{box:null,offscreen:null}}),yu(ji&&ji.box&&ji.box.length)}}if(Wn=(bi=ji)&&bi.box&&bi.box.length>0,ii=bi&&bi.offscreen,An.useRuntimeCollisionCircles){var sc=_.text.placedSymbolArray.get(An.centerJustifiedTextSymbolIndex),Ru=a.evaluateSizeForFeature(_.textSizeData,Ft,sc),dl=O.get("text-padding");Ma=c.collisionIndex.placeCollisionCircles(Ut,sc,_.lineVertexArray,_.glyphOffsetArray,Ru,k,ue,Ae,n,Or,Rt.predicate,An.collisionCircleDiameter,dl),Wn=Ut||Ma.circles.length>0&&!Ma.collisionDetected,ii=ii&&Ma.offscreen}if(si.iconFeatureIndex&&(zs=si.iconFeatureIndex),si.iconBox){var Cs=function(Jo){var To=hr&&Li?Bt(Jo,Li.x,Li.y,rr,Or,c.transform.angle):Jo;return c.collisionIndex.placeCollisionBox(To,nr,We,k,Rt.predicate)};Ti=qa&&qa.box&&qa.box.length&&si.verticalIconBox?(So=Cs(si.verticalIconBox)).box.length>0:(So=Cs(si.iconBox)).box.length>0,ii=ii&&So.offscreen}var po=Yt||An.numHorizontalGlyphVertices===0&&An.numVerticalGlyphVertices===0,Du=zt||An.numIconVertices===0;if(po||Du?Du?po||(Ti=Ti&&Wn):Wn=Ti&&Wn:Ti=Wn=Ti&&Wn,Wn&&bi&&bi.box&&c.collisionIndex.insertCollisionBox(bi.box,O.get("text-ignore-placement"),_.bucketInstanceId,qa&&qa.box&&Xa?Xa:Ta,Rt.ID),Ti&&So&&c.collisionIndex.insertCollisionBox(So.box,O.get("icon-ignore-placement"),_.bucketInstanceId,zs,Rt.ID),Ma&&(Wn&&c.collisionIndex.insertCollisionCircles(Ma.circles,O.get("text-ignore-placement"),_.bucketInstanceId,Ta,Rt.ID),n)){var bu=_.bucketInstanceId,Oo=c.collisionCircleArrays[bu];Oo===void 0&&(Oo=c.collisionCircleArrays[bu]=new wo);for(var Lo=0;Lo<Ma.circles.length;Lo+=4)Oo.circles.push(Ma.circles[Lo+0]),Oo.circles.push(Ma.circles[Lo+1]),Oo.circles.push(Ma.circles[Lo+2]),Oo.circles.push(Ma.collisionDetected?1:0)}c.placements[An.crossTileID]=new Ks(Wn||Cr,Ti||an,ii||_.justReloaded),i[An.crossTileID]=!0}};if(Tr)for(var yn=_.getSortedSymbolIndexes(this.transform.angle),On=yn.length-1;On>=0;--On){var Qn=yn[On];Yr(_.symbolInstances.get(Qn),_.collisionArrays[Qn])}else for(var oi=u.symbolInstanceStart;oi<u.symbolInstanceEnd;oi++)Yr(_.symbolInstances.get(oi),_.collisionArrays[oi]);if(n&&_.bucketInstanceId in this.collisionCircleArrays){var xi=this.collisionCircleArrays[_.bucketInstanceId];a.invert(xi.invProjMatrix,k),xi.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1},Fe.prototype.markUsedJustification=function(u,i,n,c){var y;y=c===a.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(i)];for(var _=0,O=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];_<O.length;_+=1){var k=O[_];k>=0&&(u.text.placedSymbolArray.get(k).crossTileID=y>=0&&k!==y?0:n.crossTileID)}},Fe.prototype.markUsedOrientation=function(u,i,n){for(var c=i===a.WritingMode.horizontal||i===a.WritingMode.horizontalOnly?i:0,y=i===a.WritingMode.vertical?i:0,_=0,O=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];_<O.length;_+=1)u.text.placedSymbolArray.get(O[_]).placedOrientation=c;n.verticalPlacedTextSymbolIndex&&(u.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=y)},Fe.prototype.commit=function(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;var i=this.prevPlacement,n=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;var c=i?i.symbolFadeChange(u):1,y=i?i.opacities:{},_=i?i.variableOffsets:{},O=i?i.placedOrientations:{};for(var k in this.placements){var ue=this.placements[k],Ae=y[k];Ae?(this.opacities[k]=new co(Ae,c,ue.text,ue.icon),n=n||ue.text!==Ae.text.placed||ue.icon!==Ae.icon.placed):(this.opacities[k]=new co(null,c,ue.text,ue.icon,ue.skipFade),n=n||ue.text||ue.icon)}for(var We in y){var Je=y[We];if(!this.opacities[We]){var rt=new co(Je,c,!1,!1);rt.isHidden()||(this.opacities[We]=rt,n=n||Je.text.placed||Je.icon.placed)}}for(var Ft in _)this.variableOffsets[Ft]||!this.opacities[Ft]||this.opacities[Ft].isHidden()||(this.variableOffsets[Ft]=_[Ft]);for(var Rt in O)this.placedOrientations[Rt]||!this.opacities[Rt]||this.opacities[Rt].isHidden()||(this.placedOrientations[Rt]=O[Rt]);n?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:u)},Fe.prototype.updateLayerOpacities=function(u,i){for(var n={},c=0,y=i;c<y.length;c+=1){var _=y[c],O=_.getBucket(u);O&&_.latestFeatureIndex&&u.id===O.layerIds[0]&&this.updateBucketOpacities(O,n,_.collisionBoxArray)}},Fe.prototype.updateBucketOpacities=function(u,i,n){var c=this;u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();var y=u.layers[0].layout,_=new co(null,0,!1,!1,!0),O=y.get("text-allow-overlap"),k=y.get("icon-allow-overlap"),ue=y.get("text-variable-anchor"),Ae=y.get("text-rotation-alignment")==="map",We=y.get("text-pitch-alignment")==="map",Je=y.get("icon-text-fit")!=="none",rt=new co(null,0,O&&(k||!u.hasIconData()||y.get("icon-optional")),k&&(O||!u.hasTextData()||y.get("text-optional")),!0);!u.collisionArrays&&n&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(n);for(var Ft=function(nr,rr,Or){for(var hr=0;hr<rr/4;hr++)nr.opacityVertexArray.emplaceBack(Or)},Rt=function(nr){var rr=u.symbolInstances.get(nr),Or=rr.numHorizontalGlyphVertices,hr=rr.numVerticalGlyphVertices,Tr=rr.crossTileID,Cr=c.opacities[Tr];i[Tr]?Cr=_:Cr||(c.opacities[Tr]=Cr=rt),i[Tr]=!0;var an=rr.numIconVertices>0,Yr=c.placedOrientations[rr.crossTileID],yn=Yr===a.WritingMode.vertical,On=Yr===a.WritingMode.horizontal||Yr===a.WritingMode.horizontalOnly;if(Or>0||hr>0){var Qn=Fo(Cr.text);Ft(u.text,Or,yn?Vu:Qn),Ft(u.text,hr,On?Vu:Qn);var oi=Cr.text.isHidden();[rr.rightJustifiedTextSymbolIndex,rr.centerJustifiedTextSymbolIndex,rr.leftJustifiedTextSymbolIndex].forEach(function(ji){ji>=0&&(u.text.placedSymbolArray.get(ji).hidden=oi||yn?1:0)}),rr.verticalPlacedTextSymbolIndex>=0&&(u.text.placedSymbolArray.get(rr.verticalPlacedTextSymbolIndex).hidden=oi||On?1:0);var xi=c.variableOffsets[rr.crossTileID];xi&&c.markUsedJustification(u,xi.anchor,rr,Yr);var Xi=c.placedOrientations[rr.crossTileID];Xi&&(c.markUsedJustification(u,"left",rr,Xi),c.markUsedOrientation(u,Xi,rr))}if(an){var An=Fo(Cr.icon),si=!(Je&&rr.verticalPlacedIconSymbolIndex&&yn);rr.placedIconSymbolIndex>=0&&(Ft(u.icon,rr.numIconVertices,si?An:Vu),u.icon.placedSymbolArray.get(rr.placedIconSymbolIndex).hidden=Cr.icon.isHidden()),rr.verticalPlacedIconSymbolIndex>=0&&(Ft(u.icon,rr.numVerticalIconVertices,si?Vu:An),u.icon.placedSymbolArray.get(rr.verticalPlacedIconSymbolIndex).hidden=Cr.icon.isHidden())}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){var bi=u.collisionArrays[nr];if(bi){var Wn=new a.Point(0,0);if(bi.textBox||bi.verticalTextBox){var Ti=!0;if(ue){var ii=c.variableOffsets[Tr];ii?(Wn=Po(ii.anchor,ii.width,ii.height,ii.textOffset,ii.textBoxScale),Ae&&Wn._rotate(We?c.transform.angle:-c.transform.angle)):Ti=!1}bi.textBox&&Ot(u.textCollisionBox.collisionVertexArray,Cr.text.placed,!Ti||yn,Wn.x,Wn.y),bi.verticalTextBox&&Ot(u.textCollisionBox.collisionVertexArray,Cr.text.placed,!Ti||On,Wn.x,Wn.y)}var Li=Boolean(!On&&bi.verticalIconBox);bi.iconBox&&Ot(u.iconCollisionBox.collisionVertexArray,Cr.icon.placed,Li,Je?Wn.x:0,Je?Wn.y:0),bi.verticalIconBox&&Ot(u.iconCollisionBox.collisionVertexArray,Cr.icon.placed,!Li,Je?Wn.x:0,Je?Wn.y:0)}}},Yt=0;Yt<u.symbolInstances.length;Yt++)Rt(Yt);if(u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){var zt=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=zt.invProjMatrix,u.placementViewportMatrix=zt.viewportMatrix,u.collisionCircleArray=zt.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}},Fe.prototype.symbolFadeChange=function(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Fe.prototype.zoomAdjustment=function(u){return Math.max(0,(this.transform.zoom-u)/1.5)},Fe.prototype.hasTransitions=function(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration},Fe.prototype.stillRecent=function(u,i){var n=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*n>u},Fe.prototype.setStale=function(){this.stale=!0};var fr=Math.pow(2,25),rn=Math.pow(2,24),bn=Math.pow(2,17),Un=Math.pow(2,16),Da=Math.pow(2,9),ao=Math.pow(2,8),bo=Math.pow(2,1);function Fo(u){if(u.opacity===0&&!u.placed)return 0;if(u.opacity===1&&u.placed)return 4294967295;var i=u.placed?1:0,n=Math.floor(127*u.opacity);return n*fr+i*rn+n*bn+i*Un+n*Da+i*ao+n*bo+i}var Vu=0,Wl=function(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&i.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Wl.prototype.continuePlacement=function(u,i,n,c,y){for(var _=this._bucketParts;this._currentTileIndex<u.length;)if(i.getBucketParts(_,c,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort(function(O,k){return O.sortKey-k.sortKey}));this._currentPartIndex<_.length;)if(i.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,y())return!0;return!1};var Js=function(i,n,c,y,_,O,k){this.placement=new Fe(i,_,O,k),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=y,this._done=!1};Js.prototype.isDone=function(){return this._done},Js.prototype.continuePlacement=function(u,i,n){for(var c=this,y=a.browser.now(),_=function(){var Ae=a.browser.now()-y;return!c._forceFullPlacement&&Ae>2};this._currentPlacementIndex>=0;){var O=i[u[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(O.type==="symbol"&&(!O.minzoom||O.minzoom<=k)&&(!O.maxzoom||O.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new Wl(O)),this._inProgressLayer.continuePlacement(n[O.source],this.placement,this._showCollisionBoxes,O,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Js.prototype.commit=function(u){return this.placement.commit(u),this.placement};var Ic=512/a.EXTENT/2,Il=function(i,n,c){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(var y=0;y<n.length;y++){var _=n.get(y),O=_.key;this.indexedSymbolInstances[O]||(this.indexedSymbolInstances[O]=[]),this.indexedSymbolInstances[O].push({crossTileID:_.crossTileID,coord:this.getScaledCoordinates(_,i)})}};Il.prototype.getScaledCoordinates=function(u,i){var n=Ic/Math.pow(2,i.canonical.z-this.tileID.canonical.z);return{x:Math.floor((i.canonical.x*a.EXTENT+u.anchorX)*n),y:Math.floor((i.canonical.y*a.EXTENT+u.anchorY)*n)}},Il.prototype.findMatches=function(u,i,n){for(var c=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z),y=0;y<u.length;y++){var _=u.get(y);if(!_.crossTileID){var O=this.indexedSymbolInstances[_.key];if(O)for(var k=this.getScaledCoordinates(_,i),ue=0,Ae=O;ue<Ae.length;ue+=1){var We=Ae[ue];if(Math.abs(We.coord.x-k.x)<=c&&Math.abs(We.coord.y-k.y)<=c&&!n[We.crossTileID]){n[We.crossTileID]=!0,_.crossTileID=We.crossTileID;break}}}}};var hs=function(){this.maxCrossTileID=0};hs.prototype.generate=function(){return++this.maxCrossTileID};var Ns=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Ns.prototype.handleWrapJump=function(u){var i=Math.round((u-this.lng)/360);if(i!==0)for(var n in this.indexes){var c=this.indexes[n],y={};for(var _ in c){var O=c[_];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+i),y[O.tileID.key]=O}this.indexes[n]=y}this.lng=u},Ns.prototype.addBucket=function(u,i,n){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(var c=0;c<i.symbolInstances.length;c++)i.symbolInstances.get(c).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]={});var y=this.usedCrossTileIDs[u.overscaledZ];for(var _ in this.indexes){var O=this.indexes[_];if(Number(_)>u.overscaledZ)for(var k in O){var ue=O[k];ue.tileID.isChildOf(u)&&ue.findMatches(i.symbolInstances,u,y)}else{var Ae=O[u.scaledTo(Number(_)).key];Ae&&Ae.findMatches(i.symbolInstances,u,y)}}for(var We=0;We<i.symbolInstances.length;We++){var Je=i.symbolInstances.get(We);Je.crossTileID||(Je.crossTileID=n.generate(),y[Je.crossTileID]=!0)}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new Il(u,i.symbolInstances,i.bucketInstanceId),!0},Ns.prototype.removeBucketCrossTileIDs=function(u,i){for(var n in i.indexedSymbolInstances)for(var c=0,y=i.indexedSymbolInstances[n];c<y.length;c+=1)delete this.usedCrossTileIDs[u][y[c].crossTileID]},Ns.prototype.removeStaleBuckets=function(u){var i=!1;for(var n in this.indexes){var c=this.indexes[n];for(var y in c)u[c[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,c[y]),delete c[y],i=!0)}return i};var fo=function(){this.layerIndexes={},this.crossTileIDs=new hs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};fo.prototype.addLayer=function(u,i,n){var c=this.layerIndexes[u.id];c===void 0&&(c=this.layerIndexes[u.id]=new Ns);var y=!1,_={};c.handleWrapJump(n);for(var O=0,k=i;O<k.length;O+=1){var ue=k[O],Ae=ue.getBucket(u);Ae&&u.id===Ae.layerIds[0]&&(Ae.bucketInstanceId||(Ae.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(ue.tileID,Ae,this.crossTileIDs)&&(y=!0),_[Ae.bucketInstanceId]=!0)}return c.removeStaleBuckets(_)&&(y=!0),y},fo.prototype.pruneUnusedLayers=function(u){var i={};for(var n in u.forEach(function(c){i[c]=!0}),this.layerIndexes)i[n]||delete this.layerIndexes[n]};var ds=function(i,n){return a.emitValidationErrors(i,n&&n.filter(function(c){return c.identifier!=="source.canvas"}))},Qs=a.pick(mn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),lu=a.pick(mn,["setCenter","setZoom","setBearing","setPitch"]),Xl=function(){var u={},i=a.styleSpec.$version;for(var n in a.styleSpec.$root){var c,y=a.styleSpec.$root[n];y.required&&(c=n==="version"?i:y.type==="array"?[]:{})!=null&&(u[n]=c)}return u}(),xa=function(u){function i(n,c){var y=this;c===void 0&&(c={}),u.call(this),this.map=n,this.dispatcher=new st(Er(),this),this.imageManager=new Oe,this.imageManager.setEventedParent(this),this.glyphManager=new Ht(n._requestManager,c.localIdeographFontFamily),this.lineAtlas=new ze(256,512),this.crossTileSymbolIndex=new fo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var _=this;this._rtlTextPluginCallback=i.registerForPluginStateChange(function(O){_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:O.pluginStatus,pluginURL:O.pluginURL},function(k,ue){if(a.triggerPluginCompletionEvent(k),ue&&ue.every(function(We){return We}))for(var Ae in _.sourceCaches)_.sourceCaches[Ae].reload()})}),this.on("data",function(O){if(O.dataType==="source"&&O.sourceDataType==="metadata"){var k=y.sourceCaches[O.sourceId];if(k){var ue=k.getSource();if(ue&&ue.vectorLayerIds)for(var Ae in y._layers){var We=y._layers[Ae];We.source===ue.id&&y._validateLayer(We)}}}})}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.loadURL=function(n,c){var y=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var _=typeof c.validate=="boolean"?c.validate:!a.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,c.accessToken);var O=this.map._requestManager.transformRequest(n,a.ResourceType.Style);this._request=a.getJSON(O,function(k,ue){y._request=null,k?y.fire(new a.ErrorEvent(k)):ue&&y._load(ue,_)})},i.prototype.loadJSON=function(n,c){var y=this;c===void 0&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){y._request=null,y._load(n,c.validate!==!1)})},i.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Xl,!1)},i.prototype._load=function(n,c){if(!c||!ds(this,a.validateStyle(n))){for(var y in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(y,n.sources[y],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var _=vn(this.stylesheet.layers);this._order=_.map(function(Ae){return Ae.id}),this._layers={},this._serializedLayers={};for(var O=0,k=_;O<k.length;O+=1){var ue=k[O];(ue=a.createStyleLayer(ue)).setEventedParent(this,{layer:{id:ue.id}}),this._layers[ue.id]=ue,this._serializedLayers[ue.id]=ue.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Tt(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},i.prototype._loadSprite=function(n){var c=this;this._spriteRequest=function(y,_,O){var k,ue,Ae,We=a.browser.devicePixelRatio>1?"@2x":"",Je=a.getJSON(_.transformRequest(_.normalizeSpriteURL(y,We,".json"),a.ResourceType.SpriteJSON),function(Rt,Yt){Je=null,Ae||(Ae=Rt,k=Yt,Ft())}),rt=a.getImage(_.transformRequest(_.normalizeSpriteURL(y,We,".png"),a.ResourceType.SpriteImage),function(Rt,Yt){rt=null,Ae||(Ae=Rt,ue=Yt,Ft())});function Ft(){if(Ae)O(Ae);else if(k&&ue){var Rt=a.browser.getImageData(ue),Yt={};for(var zt in k){var Ut=k[zt],nr=Ut.width,rr=Ut.height,Or=Ut.x,hr=Ut.y,Tr=Ut.sdf,Cr=Ut.pixelRatio,an=Ut.stretchX,Yr=Ut.stretchY,yn=Ut.content,On=new a.RGBAImage({width:nr,height:rr});a.RGBAImage.copy(Rt,On,{x:Or,y:hr},{x:0,y:0},{width:nr,height:rr}),Yt[zt]={data:On,pixelRatio:Cr,sdf:Tr,stretchX:an,stretchY:Yr,content:yn}}O(null,Yt)}}return{cancel:function(){Je&&(Je.cancel(),Je=null),rt&&(rt.cancel(),rt=null)}}}(n,this.map._requestManager,function(y,_){if(c._spriteRequest=null,y)c.fire(new a.ErrorEvent(y));else if(_)for(var O in _)c.imageManager.addImage(O,_[O]);c.imageManager.setLoaded(!0),c._availableImages=c.imageManager.listImages(),c.dispatcher.broadcast("setImages",c._availableImages),c.fire(new a.Event("data",{dataType:"style"}))})},i.prototype._validateLayer=function(n){var c=this.sourceCaches[n.source];if(c){var y=n.sourceLayer;if(y){var _=c.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(y)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+y+'" does not exist on source "'+_.id+'" as specified by style layer "'+n.id+'"')))}}},i.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},i.prototype._serializeLayers=function(n){for(var c=[],y=0,_=n;y<_.length;y+=1){var O=this._layers[_[y]];O.type!=="custom"&&c.push(O.serialize())}return c},i.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var c in this._layers)if(this._layers[c].hasTransition())return!0;return!1},i.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},i.prototype.update=function(n){if(this._loaded){var c=this._changed;if(this._changed){var y=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);for(var O in(y.length||_.length)&&this._updateWorkerLayers(y,_),this._updatedSources){var k=this._updatedSources[O];k==="reload"?this._reloadSource(O):k==="clear"&&this._clearSource(O)}for(var ue in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ue].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var Ae={};for(var We in this.sourceCaches){var Je=this.sourceCaches[We];Ae[We]=Je.used,Je.used=!1}for(var rt=0,Ft=this._order;rt<Ft.length;rt+=1){var Rt=this._layers[Ft[rt]];Rt.recalculate(n,this._availableImages),!Rt.isHidden(n.zoom)&&Rt.source&&(this.sourceCaches[Rt.source].used=!0)}for(var Yt in Ae){var zt=this.sourceCaches[Yt];Ae[Yt]!==zt.used&&zt.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Yt}))}this.light.recalculate(n),this.z=n.zoom,c&&this.fire(new a.Event("data",{dataType:"style"}))}},i.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},i.prototype._updateWorkerLayers=function(n,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:c})},i.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},i.prototype.setState=function(n){var c=this;if(this._checkLoaded(),ds(this,a.validateStyle(n)))return!1;(n=a.clone$1(n)).layers=vn(n.layers);var y=function(O,k){if(!O)return[{command:mn.setStyle,args:[k]}];var ue=[];try{if(!a.deepEqual(O.version,k.version))return[{command:mn.setStyle,args:[k]}];a.deepEqual(O.center,k.center)||ue.push({command:mn.setCenter,args:[k.center]}),a.deepEqual(O.zoom,k.zoom)||ue.push({command:mn.setZoom,args:[k.zoom]}),a.deepEqual(O.bearing,k.bearing)||ue.push({command:mn.setBearing,args:[k.bearing]}),a.deepEqual(O.pitch,k.pitch)||ue.push({command:mn.setPitch,args:[k.pitch]}),a.deepEqual(O.sprite,k.sprite)||ue.push({command:mn.setSprite,args:[k.sprite]}),a.deepEqual(O.glyphs,k.glyphs)||ue.push({command:mn.setGlyphs,args:[k.glyphs]}),a.deepEqual(O.transition,k.transition)||ue.push({command:mn.setTransition,args:[k.transition]}),a.deepEqual(O.light,k.light)||ue.push({command:mn.setLight,args:[k.light]});var Ae={},We=[];(function(rt,Ft,Rt,Yt){var zt;for(zt in Ft=Ft||{},rt=rt||{})rt.hasOwnProperty(zt)&&(Ft.hasOwnProperty(zt)||$r(zt,Rt,Yt));for(zt in Ft)Ft.hasOwnProperty(zt)&&(rt.hasOwnProperty(zt)?a.deepEqual(rt[zt],Ft[zt])||(rt[zt].type==="geojson"&&Ft[zt].type==="geojson"&&Ki(rt,Ft,zt)?Rt.push({command:mn.setGeoJSONSourceData,args:[zt,Ft[zt].data]}):Mn(zt,Ft,Rt,Yt)):Ar(zt,Ft,Rt))})(O.sources,k.sources,We,Ae);var Je=[];O.layers&&O.layers.forEach(function(rt){Ae[rt.source]?ue.push({command:mn.removeLayer,args:[rt.id]}):Je.push(rt)}),ue=ue.concat(We),function(rt,Ft,Rt){Ft=Ft||[];var Yt,zt,Ut,nr,rr,Or,hr,Tr=(rt=rt||[]).map(Mi),Cr=Ft.map(Mi),an=rt.reduce(zi,{}),Yr=Ft.reduce(zi,{}),yn=Tr.slice(),On=Object.create(null);for(Yt=0,zt=0;Yt<Tr.length;Yt++)Yr.hasOwnProperty(Ut=Tr[Yt])?zt++:(Rt.push({command:mn.removeLayer,args:[Ut]}),yn.splice(yn.indexOf(Ut,zt),1));for(Yt=0,zt=0;Yt<Cr.length;Yt++)yn[yn.length-1-Yt]!==(Ut=Cr[Cr.length-1-Yt])&&(an.hasOwnProperty(Ut)?(Rt.push({command:mn.removeLayer,args:[Ut]}),yn.splice(yn.lastIndexOf(Ut,yn.length-zt),1)):zt++,Rt.push({command:mn.addLayer,args:[Yr[Ut],Or=yn[yn.length-Yt]]}),yn.splice(yn.length-Yt,0,Ut),On[Ut]=!0);for(Yt=0;Yt<Cr.length;Yt++)if(nr=an[Ut=Cr[Yt]],rr=Yr[Ut],!On[Ut]&&!a.deepEqual(nr,rr))if(a.deepEqual(nr.source,rr.source)&&a.deepEqual(nr["source-layer"],rr["source-layer"])&&a.deepEqual(nr.type,rr.type)){for(hr in vi(nr.layout,rr.layout,Rt,Ut,null,mn.setLayoutProperty),vi(nr.paint,rr.paint,Rt,Ut,null,mn.setPaintProperty),a.deepEqual(nr.filter,rr.filter)||Rt.push({command:mn.setFilter,args:[Ut,rr.filter]}),a.deepEqual(nr.minzoom,rr.minzoom)&&a.deepEqual(nr.maxzoom,rr.maxzoom)||Rt.push({command:mn.setLayerZoomRange,args:[Ut,rr.minzoom,rr.maxzoom]}),nr)nr.hasOwnProperty(hr)&&hr!=="layout"&&hr!=="paint"&&hr!=="filter"&&hr!=="metadata"&&hr!=="minzoom"&&hr!=="maxzoom"&&(hr.indexOf("paint.")===0?vi(nr[hr],rr[hr],Rt,Ut,hr.slice(6),mn.setPaintProperty):a.deepEqual(nr[hr],rr[hr])||Rt.push({command:mn.setLayerProperty,args:[Ut,hr,rr[hr]]}));for(hr in rr)rr.hasOwnProperty(hr)&&!nr.hasOwnProperty(hr)&&hr!=="layout"&&hr!=="paint"&&hr!=="filter"&&hr!=="metadata"&&hr!=="minzoom"&&hr!=="maxzoom"&&(hr.indexOf("paint.")===0?vi(nr[hr],rr[hr],Rt,Ut,hr.slice(6),mn.setPaintProperty):a.deepEqual(nr[hr],rr[hr])||Rt.push({command:mn.setLayerProperty,args:[Ut,hr,rr[hr]]}))}else Rt.push({command:mn.removeLayer,args:[Ut]}),Or=yn[yn.lastIndexOf(Ut)+1],Rt.push({command:mn.addLayer,args:[rr,Or]})}(Je,k.layers,ue)}catch(rt){console.warn("Unable to compute style diff:",rt),ue=[{command:mn.setStyle,args:[k]}]}return ue}(this.serialize(),n).filter(function(O){return!(O.command in lu)});if(y.length===0)return!1;var _=y.filter(function(O){return!(O.command in Qs)});if(_.length>0)throw new Error("Unimplemented: "+_.map(function(O){return O.command}).join(", ")+".");return y.forEach(function(O){O.command!=="setTransition"&&c[O.command].apply(c,O.args)}),this.stylesheet=n,!0},i.prototype.addImage=function(n,c){if(this.getImage(n))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,c),this._afterImageUpdated(n)},i.prototype.updateImage=function(n,c){this.imageManager.updateImage(n,c)},i.prototype.getImage=function(n){return this.imageManager.getImage(n)},i.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},i.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},i.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},i.prototype.addSource=function(n,c,y){var _=this;if(y===void 0&&(y={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!c.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(c).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateStyle.source,"sources."+n,c,null,y))){this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);var O=this.sourceCaches[n]=new gt(n,c,this.dispatcher);O.style=this,O.setEventedParent(this,function(){return{isSourceLoaded:_.loaded(),source:O.serialize(),sourceId:n}}),O.onAdd(this.map),this._changed=!0}},i.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var c in this._layers)if(this._layers[c].source===n)return this.fire(new a.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+c+'" is using it.')));var y=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],y.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),y.setEventedParent(null),y.clearTiles(),y.onRemove&&y.onRemove(this.map),this._changed=!0},i.prototype.setGeoJSONSourceData=function(n,c){this._checkLoaded(),this.sourceCaches[n].getSource().setData(c),this._changed=!0},i.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},i.prototype.addLayer=function(n,c,y){y===void 0&&(y={}),this._checkLoaded();var _=n.id;if(this.getLayer(_))this.fire(new a.ErrorEvent(new Error('Layer with id "'+_+'" already exists on this map')));else{var O;if(n.type==="custom"){if(ds(this,a.validateCustomStyleLayer(n)))return;O=a.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(_,n.source),n=a.clone$1(n),n=a.extend(n,{source:_})),this._validate(a.validateStyle.layer,"layers."+_,n,{arrayIndex:-1},y))return;O=a.createStyleLayer(n),this._validateLayer(O),O.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[O.id]=O.serialize()}var k=c?this._order.indexOf(c):this._order.length;if(c&&k===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));else{if(this._order.splice(k,0,_),this._layerOrderChanged=!0,this._layers[_]=O,this._removedLayers[_]&&O.source&&O.type!=="custom"){var ue=this._removedLayers[_];delete this._removedLayers[_],ue.type!==O.type?this._updatedSources[O.source]="clear":(this._updatedSources[O.source]="reload",this.sourceCaches[O.source].pause())}this._updateLayer(O),O.onAdd&&O.onAdd(this.map)}}},i.prototype.moveLayer=function(n,c){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==c){var y=this._order.indexOf(n);this._order.splice(y,1);var _=c?this._order.indexOf(c):this._order.length;c&&_===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.'))):(this._order.splice(_,0,n),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},i.prototype.removeLayer=function(n){this._checkLoaded();var c=this._layers[n];if(c){c.setEventedParent(null);var y=this._order.indexOf(n);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=c,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],c.onRemove&&c.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},i.prototype.getLayer=function(n){return this._layers[n]},i.prototype.hasLayer=function(n){return n in this._layers},i.prototype.setLayerZoomRange=function(n,c,y){this._checkLoaded();var _=this.getLayer(n);_?_.minzoom===c&&_.maxzoom===y||(c!=null&&(_.minzoom=c),y!=null&&(_.maxzoom=y),this._updateLayer(_)):this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},i.prototype.setFilter=function(n,c,y){y===void 0&&(y={}),this._checkLoaded();var _=this.getLayer(n);if(_){if(!a.deepEqual(_.filter,c))return c==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(a.validateStyle.filter,"layers."+_.id+".filter",c,null,y)||(_.filter=a.clone$1(c),this._updateLayer(_)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},i.prototype.getFilter=function(n){return a.clone$1(this.getLayer(n).filter)},i.prototype.setLayoutProperty=function(n,c,y,_){_===void 0&&(_={}),this._checkLoaded();var O=this.getLayer(n);O?a.deepEqual(O.getLayoutProperty(c),y)||(O.setLayoutProperty(c,y,_),this._updateLayer(O)):this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getLayoutProperty=function(n,c){var y=this.getLayer(n);if(y)return y.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},i.prototype.setPaintProperty=function(n,c,y,_){_===void 0&&(_={}),this._checkLoaded();var O=this.getLayer(n);O?a.deepEqual(O.getPaintProperty(c),y)||(O.setPaintProperty(c,y,_)&&this._updateLayer(O),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getPaintProperty=function(n,c){return this.getLayer(n).getPaintProperty(c)},i.prototype.setFeatureState=function(n,c){this._checkLoaded();var y=n.source,_=n.sourceLayer,O=this.sourceCaches[y];if(O!==void 0){var k=O.getSource().type;k==="geojson"&&_?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):k!=="vector"||_?(n.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),O.setFeatureState(_,n.id,c)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},i.prototype.removeFeatureState=function(n,c){this._checkLoaded();var y=n.source,_=this.sourceCaches[y];if(_!==void 0){var O=_.getSource().type,k=O==="vector"?n.sourceLayer:void 0;O!=="vector"||k?c&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(k,n.id,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},i.prototype.getFeatureState=function(n){this._checkLoaded();var c=n.source,y=n.sourceLayer,_=this.sourceCaches[c];if(_!==void 0){if(_.getSource().type!=="vector"||y)return n.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(y,n.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+c+"' does not exist in the map's style.")))},i.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},i.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},i.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},i.prototype._flattenAndSortRenderedFeatures=function(n){for(var c=this,y=function(Yr){return c._layers[Yr].type==="fill-extrusion"},_={},O=[],k=this._order.length-1;k>=0;k--){var ue=this._order[k];if(y(ue)){_[ue]=k;for(var Ae=0,We=n;Ae<We.length;Ae+=1){var Je=We[Ae][ue];if(Je)for(var rt=0,Ft=Je;rt<Ft.length;rt+=1)O.push(Ft[rt])}}}O.sort(function(an,Yr){return Yr.intersectionZ-an.intersectionZ});for(var Rt=[],Yt=this._order.length-1;Yt>=0;Yt--){var zt=this._order[Yt];if(y(zt))for(var Ut=O.length-1;Ut>=0;Ut--){var nr=O[Ut].feature;if(_[nr.layer.id]<Yt)break;Rt.push(nr),O.pop()}else for(var rr=0,Or=n;rr<Or.length;rr+=1){var hr=Or[rr][zt];if(hr)for(var Tr=0,Cr=hr;Tr<Cr.length;Tr+=1)Rt.push(Cr[Tr].feature)}}return Rt},i.prototype.queryRenderedFeatures=function(n,c,y){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);var _={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var O=0,k=c.layers;O<k.length;O+=1){var ue=k[O],Ae=this._layers[ue];if(!Ae)return this.fire(new a.ErrorEvent(new Error("The layer '"+ue+"' does not exist in the map's style and cannot be queried for features."))),[];_[Ae.source]=!0}}var We=[];for(var Je in c.availableImages=this._availableImages,this.sourceCaches)c.layers&&!_[Je]||We.push(nt(this.sourceCaches[Je],this._layers,this._serializedLayers,n,c,y));return this.placement&&We.push(function(rt,Ft,Rt,Yt,zt,Ut,nr){for(var rr={},Or=Ut.queryRenderedSymbols(Yt),hr=[],Tr=0,Cr=Object.keys(Or).map(Number);Tr<Cr.length;Tr+=1)hr.push(nr[Cr[Tr]]);hr.sort(le);for(var an=function(){var xi=yn[Yr],Xi=xi.featureIndex.lookupSymbolFeatures(Or[xi.bucketInstanceId],Ft,xi.bucketIndex,xi.sourceLayerIndex,zt.filter,zt.layers,zt.availableImages,rt);for(var An in Xi){var si=rr[An]=rr[An]||[],bi=Xi[An];bi.sort(function(ii,Li){var ji=xi.featureSortOrder;if(ji){var qa=ji.indexOf(ii.featureIndex);return ji.indexOf(Li.featureIndex)-qa}return Li.featureIndex-ii.featureIndex});for(var Wn=0,Ti=bi;Wn<Ti.length;Wn+=1)si.push(Ti[Wn])}},Yr=0,yn=hr;Yr<yn.length;Yr+=1)an();var On=function(xi){rr[xi].forEach(function(Xi){var An=Xi.feature,si=Rt[rt[xi].source].getFeatureState(An.layer["source-layer"],An.id);An.source=An.layer.source,An.layer["source-layer"]&&(An.sourceLayer=An.layer["source-layer"]),An.state=si})};for(var Qn in rr)On(Qn);return rr}(this._layers,this._serializedLayers,this.sourceCaches,n,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(We)},i.prototype.querySourceFeatures=function(n,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);var y=this.sourceCaches[n];return y?function(_,O){for(var k=_.getRenderableIds().map(function(Ft){return _.getTileByID(Ft)}),ue=[],Ae={},We=0;We<k.length;We++){var Je=k[We],rt=Je.tileID.canonical.key;Ae[rt]||(Ae[rt]=!0,Je.querySourceFeatures(ue,O))}return ue}(y,c):[]},i.prototype.addSourceType=function(n,c,y){return i.getSourceType(n)?y(new Error('A source type called "'+n+'" already exists.')):(i.setSourceType(n,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:c.workerSourceURL},y):y(null,null))},i.prototype.getLight=function(){return this.light.getLight()},i.prototype.setLight=function(n,c){c===void 0&&(c={}),this._checkLoaded();var y=this.light.getLight(),_=!1;for(var O in n)if(!a.deepEqual(n[O],y[O])){_=!0;break}if(_){var k={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,c),this.light.updateTransitions(k)}},i.prototype._validate=function(n,c,y,_,O){return O===void 0&&(O={}),(!O||O.validate!==!1)&&ds(this,n.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:y,styleSpec:a.styleSpec},_)))},i.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var c in this.sourceCaches)this.sourceCaches[c].clearTiles(),this.sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},i.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},i.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},i.prototype._updateSources=function(n){for(var c in this.sourceCaches)this.sourceCaches[c].update(n)},i.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},i.prototype._updatePlacement=function(n,c,y,_,O){O===void 0&&(O=!1);for(var k=!1,ue=!1,Ae={},We=0,Je=this._order;We<Je.length;We+=1){var rt=this._layers[Je[We]];if(rt.type==="symbol"){if(!Ae[rt.source]){var Ft=this.sourceCaches[rt.source];Ae[rt.source]=Ft.getRenderableIds(!0).map(function(nr){return Ft.getTileByID(nr)}).sort(function(nr,rr){return rr.tileID.overscaledZ-nr.tileID.overscaledZ||(nr.tileID.isLessThan(rr.tileID)?-1:1)})}var Rt=this.crossTileSymbolIndex.addLayer(rt,Ae[rt.source],n.center.lng);k=k||Rt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((O=O||this._layerOrderChanged||y===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),n.zoom))&&(this.pauseablePlacement=new Js(n,this._order,O,c,y,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ae),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),ue=!0),k&&this.pauseablePlacement.placement.setStale()),ue||k)for(var Yt=0,zt=this._order;Yt<zt.length;Yt+=1){var Ut=this._layers[zt[Yt]];Ut.type==="symbol"&&this.placement.updateLayerOpacities(Ut,Ae[Ut.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},i.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},i.prototype.getImages=function(n,c,y){this.imageManager.getImages(c.icons,y),this._updateTilesForChangedImages();var _=this.sourceCaches[c.source];_&&_.setDependencies(c.tileID.key,c.type,c.icons)},i.prototype.getGlyphs=function(n,c,y){this.glyphManager.getGlyphs(c.stacks,y)},i.prototype.getResource=function(n,c,y){return a.makeRequest(c,y)},i}(a.Evented);xa.getSourceType=function(u){return ke[u]},xa.setSourceType=function(u,i){ke[u]=i},xa.registerForPluginStateChange=a.registerForPluginStateChange;var ka=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),ml=da(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Fs=da(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ps=da(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),It=da(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),ir=da("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Mr=da(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Gn=da(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Qi=da("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),za=da("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Za=da("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),qi=da(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),ba=da(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),_o=da(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Bs=da(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),ha=da(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Yl=da(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),cu=da(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),_s=da(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),gl=da(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),fu=da(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Gu=da(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),qs=da(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),rl=da(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),hu=da(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),pc=da(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),_f=da(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function da(u,i){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=i.match(/attribute ([\w]+) ([\w]+)/g),y=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=_?_.concat(y):y,k={};return{fragmentSource:u=u.replace(n,function(ue,Ae,We,Je,rt){return k[rt]=!0,Ae==="define"?`
#ifndef HAS_UNIFORM_u_`+rt+`
varying `+We+" "+Je+" "+rt+`;
#else
uniform `+We+" "+Je+" u_"+rt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+rt+`
    `+We+" "+Je+" "+rt+" = u_"+rt+`;
#endif
`}),vertexSource:i=i.replace(n,function(ue,Ae,We,Je,rt){var Ft=Je==="float"?"vec2":"vec4",Rt=rt.match(/color/)?"color":Ft;return k[rt]?Ae==="define"?`
#ifndef HAS_UNIFORM_u_`+rt+`
uniform lowp float u_`+rt+`_t;
attribute `+We+" "+Ft+" a_"+rt+`;
varying `+We+" "+Je+" "+rt+`;
#else
uniform `+We+" "+Je+" u_"+rt+`;
#endif
`:Rt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+rt+`
    `+rt+" = a_"+rt+`;
#else
    `+We+" "+Je+" "+rt+" = u_"+rt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+rt+`
    `+rt+" = unpack_mix_"+Rt+"(a_"+rt+", u_"+rt+`_t);
#else
    `+We+" "+Je+" "+rt+" = u_"+rt+`;
#endif
`:Ae==="define"?`
#ifndef HAS_UNIFORM_u_`+rt+`
uniform lowp float u_`+rt+`_t;
attribute `+We+" "+Ft+" a_"+rt+`;
#else
uniform `+We+" "+Je+" u_"+rt+`;
#endif
`:Rt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+rt+`
    `+We+" "+Je+" "+rt+" = a_"+rt+`;
#else
    `+We+" "+Je+" "+rt+" = u_"+rt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+rt+`
    `+We+" "+Je+" "+rt+" = unpack_mix_"+Rt+"(a_"+rt+", u_"+rt+`_t);
#else
    `+We+" "+Je+" "+rt+" = u_"+rt+`;
#endif
`}),staticAttributes:c,staticUniforms:O}}var Oc=Object.freeze({__proto__:null,prelude:ml,background:Fs,backgroundPattern:ps,circle:It,clippingMask:ir,heatmap:Mr,heatmapTexture:Gn,collisionBox:Qi,collisionCircle:za,debug:Za,fill:qi,fillOutline:ba,fillOutlinePattern:_o,fillPattern:Bs,fillExtrusion:ha,fillExtrusionPattern:Yl,hillshadePrepare:cu,hillshade:_s,line:gl,lineGradient:fu,linePattern:Gu,lineSDF:qs,raster:rl,symbolIcon:hu,symbolSDF:pc,symbolTextAndIcon:_f}),vc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function qc(u){for(var i=[],n=0;n<u.length;n++)if(u[n]!==null){var c=u[n].split(" ");i.push(c.pop())}return i}vc.prototype.bind=function(u,i,n,c,y,_,O,k){this.context=u;for(var ue=this.boundPaintVertexBuffers.length!==c.length,Ae=0;!ue&&Ae<c.length;Ae++)this.boundPaintVertexBuffers[Ae]!==c[Ae]&&(ue=!0);u.extVertexArrayObject&&this.vao&&this.boundProgram===i&&this.boundLayoutVertexBuffer===n&&!ue&&this.boundIndexBuffer===y&&this.boundVertexOffset===_&&this.boundDynamicVertexBuffer===O&&this.boundDynamicVertexBuffer2===k?(u.bindVertexArrayOES.set(this.vao),O&&O.bind(),y&&y.dynamicDraw&&y.bind(),k&&k.bind()):this.freshBind(i,n,c,y,_,O,k)},vc.prototype.freshBind=function(u,i,n,c,y,_,O){var k,ue=u.numAttributes,Ae=this.context,We=Ae.gl;if(Ae.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ae.extVertexArrayObject.createVertexArrayOES(),Ae.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=u,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=c,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=O;else{k=Ae.currentNumAttributes||0;for(var Je=ue;Je<k;Je++)We.disableVertexAttribArray(Je)}i.enableAttributes(We,u);for(var rt=0,Ft=n;rt<Ft.length;rt+=1)Ft[rt].enableAttributes(We,u);_&&_.enableAttributes(We,u),O&&O.enableAttributes(We,u),i.bind(),i.setVertexAttribPointers(We,u,y);for(var Rt=0,Yt=n;Rt<Yt.length;Rt+=1){var zt=Yt[Rt];zt.bind(),zt.setVertexAttribPointers(We,u,y)}_&&(_.bind(),_.setVertexAttribPointers(We,u,y)),c&&c.bind(),O&&(O.bind(),O.setVertexAttribPointers(We,u,y)),Ae.currentNumAttributes=ue},vc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ef=function(i,n,c,y,_,O){var k=i.gl;this.program=k.createProgram();for(var ue=qc(c.staticAttributes),Ae=y?y.getBinderAttributes():[],We=ue.concat(Ae),Je=c.staticUniforms?qc(c.staticUniforms):[],rt=y?y.getBinderUniforms():[],Ft=[],Rt=0,Yt=Je.concat(rt);Rt<Yt.length;Rt+=1){var zt=Yt[Rt];Ft.indexOf(zt)<0&&Ft.push(zt)}var Ut=y?y.defines():[];O&&Ut.push("#define OVERDRAW_INSPECTOR;");var nr=Ut.concat(ml.fragmentSource,c.fragmentSource).join(`
`),rr=Ut.concat(ml.vertexSource,c.vertexSource).join(`
`),Or=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(Or,nr),k.compileShader(Or),k.attachShader(this.program,Or);var hr=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(hr,rr),k.compileShader(hr),k.attachShader(this.program,hr),this.attributes={};var Tr={};this.numAttributes=We.length;for(var Cr=0;Cr<this.numAttributes;Cr++)We[Cr]&&(k.bindAttribLocation(this.program,Cr,We[Cr]),this.attributes[We[Cr]]=Cr);k.linkProgram(this.program),k.deleteShader(hr),k.deleteShader(Or);for(var an=0;an<Ft.length;an++){var Yr=Ft[an];if(Yr&&!Tr[Yr]){var yn=k.getUniformLocation(this.program,Yr);yn&&(Tr[Yr]=yn)}}this.fixedUniforms=_(i,Tr),this.binderUniforms=y?y.getUniforms(i,Tr):[]}}};function tf(u,i,n){var c=1/Ji(n,1,i.transform.tileZoom),y=Math.pow(2,n.tileID.overscaledZ),_=n.tileSize*Math.pow(2,i.transform.tileZoom)/y,O=_*(n.tileID.canonical.x+n.tileID.wrap*y),k=_*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[c,u.fromScale,u.toScale],u_fade:u.t,u_pixel_coord_upper:[O>>16,k>>16],u_pixel_coord_lower:[65535&O,65535&k]}}ef.prototype.draw=function(u,i,n,c,y,_,O,k,ue,Ae,We,Je,rt,Ft,Rt,Yt){var zt,Ut=u.gl;if(!this.failedToCreate){for(var nr in u.program.set(this.program),u.setDepthMode(n),u.setStencilMode(c),u.setColorMode(y),u.setCullFace(_),this.fixedUniforms)this.fixedUniforms[nr].set(O[nr]);Ft&&Ft.setUniforms(u,this.binderUniforms,Je,{zoom:rt});for(var rr=(zt={},zt[Ut.LINES]=2,zt[Ut.TRIANGLES]=3,zt[Ut.LINE_STRIP]=1,zt)[i],Or=0,hr=We.get();Or<hr.length;Or+=1){var Tr=hr[Or],Cr=Tr.vaos||(Tr.vaos={});(Cr[k]||(Cr[k]=new vc)).bind(u,this,ue,Ft?Ft.getPaintVertexBuffers():[],Ae,Tr.vertexOffset,Rt,Yt),Ut.drawElements(i,Tr.primitiveLength*rr,Ut.UNSIGNED_SHORT,Tr.primitiveOffset*rr*2)}}};var Qa=function(i,n,c,y){var _=n.style.light,O=_.properties.get("position"),k=[O.x,O.y,O.z],ue=a.create$1();_.properties.get("anchor")==="viewport"&&a.fromRotation(ue,-n.transform.angle),a.transformMat3(k,k,ue);var Ae=_.properties.get("color");return{u_matrix:i,u_lightpos:k,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[Ae.r,Ae.g,Ae.b],u_vertical_gradient:+c,u_opacity:y}},Au=function(i,n,c,y,_,O,k){return a.extend(Qa(i,n,c,y),tf(O,n,k),{u_height_factor:-Math.pow(2,_.overscaledZ)/k.tileSize/8})},eu=function(i){return{u_matrix:i}},vs=function(i,n,c,y){return a.extend(eu(i),tf(c,n,y))},Lc=function(i,n){return{u_matrix:i,u_world:n}},mc=function(i,n,c,y,_){return a.extend(vs(i,n,c,y),{u_world:_})},yl=function(i,n,c,y){var _,O,k=i.transform;if(y.paint.get("circle-pitch-alignment")==="map"){var ue=Ji(c,1,k.zoom);_=!0,O=[ue,ue]}else _=!1,O=k.pixelsToGLUnits;return{u_camera_to_center_distance:k.cameraToCenterDistance,u_scale_with_map:+(y.paint.get("circle-pitch-scale")==="map"),u_matrix:i.translatePosMatrix(n.posMatrix,c,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:O}},nl=function(i,n,c){var y=Ji(c,1,n.zoom),_=Math.pow(2,n.zoom-c.tileID.overscaledZ),O=c.tileID.overscaleFactor();return{u_matrix:i,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:y,u_extrude_scale:[n.pixelsToGLUnits[0]/(y*_),n.pixelsToGLUnits[1]/(y*_)],u_overscale_factor:O}},gc=function(i,n,c){return{u_matrix:i,u_inv_matrix:n,u_camera_to_center_distance:c.cameraToCenterDistance,u_viewport_size:[c.width,c.height]}},tu=function(i,n,c){return c===void 0&&(c=1),{u_matrix:i,u_color:n,u_overlay:0,u_overlay_scale:c}},Hu=function(i){return{u_matrix:i}},Rc=function(i,n,c,y){return{u_matrix:i,u_extrude_scale:Ji(n,1,c),u_intensity:y}},Kl=function(i,n,c){var y=i.transform;return{u_matrix:zc(i,n,c),u_ratio:1/Ji(n,1,y.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},_a=function(i,n,c,y){return a.extend(Kl(i,n,c),{u_image:0,u_image_height:y})},Dc=function(i,n,c,y){var _=i.transform,O=yc(n,_);return{u_matrix:zc(i,n,c),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Ji(n,1,_.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[O,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Mf=function(i,n,c,y,_){var O=i.lineAtlas,k=yc(n,i.transform),ue=c.layout.get("line-cap")==="round",Ae=O.getDash(y.from,ue),We=O.getDash(y.to,ue),Je=Ae.width*_.fromScale,rt=We.width*_.toScale;return a.extend(Kl(i,n,c),{u_patternscale_a:[k/Je,-Ae.height/2],u_patternscale_b:[k/rt,-We.height/2],u_sdfgamma:O.width/(256*Math.min(Je,rt)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ae.y,u_tex_y_b:We.y,u_mix:_.t})};function yc(u,i){return 1/Ji(u,1,i.tileZoom)}function zc(u,i,n){return u.translatePosMatrix(i.tileID.posMatrix,i,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var $l=function(i,n,c,y,_){return{u_matrix:i,u_tl_parent:n,u_scale_parent:c,u_buffer_scale:1,u_fade_t:y.mix,u_opacity:y.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(k=_.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(O=_.paint.get("raster-contrast"),O>0?1/(1-O):1+O),u_spin_weights:Zu(_.paint.get("raster-hue-rotate"))};var O,k};function Zu(u){u*=Math.PI/180;var i=Math.sin(u),n=Math.cos(u);return[(2*n+1)/3,(-Math.sqrt(3)*i-n+1)/3,(Math.sqrt(3)*i-n+1)/3]}var Cu,Ol=function(i,n,c,y,_,O,k,ue,Ae,We){var Je=_.transform;return{u_is_size_zoom_constant:+(i==="constant"||i==="source"),u_is_size_feature_constant:+(i==="constant"||i==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:Je.cameraToCenterDistance,u_pitch:Je.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:Je.width/Je.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:O,u_label_plane_matrix:k,u_coord_matrix:ue,u_is_text:+Ae,u_pitch_with_map:+y,u_texsize:We,u_texture:0}},Bo=function(i,n,c,y,_,O,k,ue,Ae,We,Je){var rt=_.transform;return a.extend(Ol(i,n,c,y,_,O,k,ue,Ae,We),{u_gamma_scale:y?Math.cos(rt._pitch)*rt.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+Je})},Jl=function(i,n,c,y,_,O,k,ue,Ae,We){return a.extend(Bo(i,n,c,y,_,O,k,ue,!0,Ae,!0),{u_texsize_icon:We,u_texture_icon:1})},Ll=function(i,n,c){return{u_matrix:i,u_opacity:n,u_color:c}},xl=function(i,n,c,y,_,O){return a.extend(function(k,ue,Ae,We){var Je=Ae.imageManager.getPattern(k.from.toString()),rt=Ae.imageManager.getPattern(k.to.toString()),Ft=Ae.imageManager.getPixelSize(),Rt=Ft.width,Yt=Ft.height,zt=Math.pow(2,We.tileID.overscaledZ),Ut=We.tileSize*Math.pow(2,Ae.transform.tileZoom)/zt,nr=Ut*(We.tileID.canonical.x+We.tileID.wrap*zt),rr=Ut*We.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Je.tl,u_pattern_br_a:Je.br,u_pattern_tl_b:rt.tl,u_pattern_br_b:rt.br,u_texsize:[Rt,Yt],u_mix:ue.t,u_pattern_size_a:Je.displaySize,u_pattern_size_b:rt.displaySize,u_scale_a:ue.fromScale,u_scale_b:ue.toScale,u_tile_units_to_pixels:1/Ji(We,1,Ae.transform.tileZoom),u_pixel_coord_upper:[nr>>16,rr>>16],u_pixel_coord_lower:[65535&nr,65535&rr]}}(y,O,c,_),{u_matrix:i,u_opacity:n})},Nc={fillExtrusion:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_lightpos:new a.Uniform3f(i,n.u_lightpos),u_lightintensity:new a.Uniform1f(i,n.u_lightintensity),u_lightcolor:new a.Uniform3f(i,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(i,n.u_vertical_gradient),u_opacity:new a.Uniform1f(i,n.u_opacity)}},fillExtrusionPattern:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_lightpos:new a.Uniform3f(i,n.u_lightpos),u_lightintensity:new a.Uniform1f(i,n.u_lightintensity),u_lightcolor:new a.Uniform3f(i,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(i,n.u_vertical_gradient),u_height_factor:new a.Uniform1f(i,n.u_height_factor),u_image:new a.Uniform1i(i,n.u_image),u_texsize:new a.Uniform2f(i,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(i,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(i,n.u_scale),u_fade:new a.Uniform1f(i,n.u_fade),u_opacity:new a.Uniform1f(i,n.u_opacity)}},fill:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix)}},fillPattern:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_image:new a.Uniform1i(i,n.u_image),u_texsize:new a.Uniform2f(i,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(i,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(i,n.u_scale),u_fade:new a.Uniform1f(i,n.u_fade)}},fillOutline:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_world:new a.Uniform2f(i,n.u_world)}},fillOutlinePattern:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_world:new a.Uniform2f(i,n.u_world),u_image:new a.Uniform1i(i,n.u_image),u_texsize:new a.Uniform2f(i,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(i,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(i,n.u_scale),u_fade:new a.Uniform1f(i,n.u_fade)}},circle:function(i,n){return{u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(i,n.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(i,n.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(i,n.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(i,n.u_matrix)}},collisionBox:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(i,n.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(i,n.u_extrude_scale),u_overscale_factor:new a.Uniform1f(i,n.u_overscale_factor)}},collisionCircle:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_inv_matrix:new a.UniformMatrix4f(i,n.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(i,n.u_viewport_size)}},debug:function(i,n){return{u_color:new a.UniformColor(i,n.u_color),u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_overlay:new a.Uniform1i(i,n.u_overlay),u_overlay_scale:new a.Uniform1f(i,n.u_overlay_scale)}},clippingMask:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix)}},heatmap:function(i,n){return{u_extrude_scale:new a.Uniform1f(i,n.u_extrude_scale),u_intensity:new a.Uniform1f(i,n.u_intensity),u_matrix:new a.UniformMatrix4f(i,n.u_matrix)}},heatmapTexture:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_world:new a.Uniform2f(i,n.u_world),u_image:new a.Uniform1i(i,n.u_image),u_color_ramp:new a.Uniform1i(i,n.u_color_ramp),u_opacity:new a.Uniform1f(i,n.u_opacity)}},hillshade:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_image:new a.Uniform1i(i,n.u_image),u_latrange:new a.Uniform2f(i,n.u_latrange),u_light:new a.Uniform2f(i,n.u_light),u_shadow:new a.UniformColor(i,n.u_shadow),u_highlight:new a.UniformColor(i,n.u_highlight),u_accent:new a.UniformColor(i,n.u_accent)}},hillshadePrepare:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_image:new a.Uniform1i(i,n.u_image),u_dimension:new a.Uniform2f(i,n.u_dimension),u_zoom:new a.Uniform1f(i,n.u_zoom),u_unpack:new a.Uniform4f(i,n.u_unpack)}},line:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_ratio:new a.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(i,n.u_units_to_pixels)}},lineGradient:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_ratio:new a.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(i,n.u_units_to_pixels),u_image:new a.Uniform1i(i,n.u_image),u_image_height:new a.Uniform1f(i,n.u_image_height)}},linePattern:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_texsize:new a.Uniform2f(i,n.u_texsize),u_ratio:new a.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_image:new a.Uniform1i(i,n.u_image),u_units_to_pixels:new a.Uniform2f(i,n.u_units_to_pixels),u_scale:new a.Uniform3f(i,n.u_scale),u_fade:new a.Uniform1f(i,n.u_fade)}},lineSDF:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_ratio:new a.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(i,n.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(i,n.u_patternscale_a),u_patternscale_b:new a.Uniform2f(i,n.u_patternscale_b),u_sdfgamma:new a.Uniform1f(i,n.u_sdfgamma),u_image:new a.Uniform1i(i,n.u_image),u_tex_y_a:new a.Uniform1f(i,n.u_tex_y_a),u_tex_y_b:new a.Uniform1f(i,n.u_tex_y_b),u_mix:new a.Uniform1f(i,n.u_mix)}},raster:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_tl_parent:new a.Uniform2f(i,n.u_tl_parent),u_scale_parent:new a.Uniform1f(i,n.u_scale_parent),u_buffer_scale:new a.Uniform1f(i,n.u_buffer_scale),u_fade_t:new a.Uniform1f(i,n.u_fade_t),u_opacity:new a.Uniform1f(i,n.u_opacity),u_image0:new a.Uniform1i(i,n.u_image0),u_image1:new a.Uniform1i(i,n.u_image1),u_brightness_low:new a.Uniform1f(i,n.u_brightness_low),u_brightness_high:new a.Uniform1f(i,n.u_brightness_high),u_saturation_factor:new a.Uniform1f(i,n.u_saturation_factor),u_contrast_factor:new a.Uniform1f(i,n.u_contrast_factor),u_spin_weights:new a.Uniform3f(i,n.u_spin_weights)}},symbolIcon:function(i,n){return{u_is_size_zoom_constant:new a.Uniform1i(i,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(i,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(i,n.u_size_t),u_size:new a.Uniform1f(i,n.u_size),u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(i,n.u_pitch),u_rotate_symbol:new a.Uniform1i(i,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(i,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(i,n.u_fade_change),u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(i,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(i,n.u_coord_matrix),u_is_text:new a.Uniform1i(i,n.u_is_text),u_pitch_with_map:new a.Uniform1i(i,n.u_pitch_with_map),u_texsize:new a.Uniform2f(i,n.u_texsize),u_texture:new a.Uniform1i(i,n.u_texture)}},symbolSDF:function(i,n){return{u_is_size_zoom_constant:new a.Uniform1i(i,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(i,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(i,n.u_size_t),u_size:new a.Uniform1f(i,n.u_size),u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(i,n.u_pitch),u_rotate_symbol:new a.Uniform1i(i,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(i,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(i,n.u_fade_change),u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(i,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(i,n.u_coord_matrix),u_is_text:new a.Uniform1i(i,n.u_is_text),u_pitch_with_map:new a.Uniform1i(i,n.u_pitch_with_map),u_texsize:new a.Uniform2f(i,n.u_texsize),u_texture:new a.Uniform1i(i,n.u_texture),u_gamma_scale:new a.Uniform1f(i,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(i,n.u_is_halo)}},symbolTextAndIcon:function(i,n){return{u_is_size_zoom_constant:new a.Uniform1i(i,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(i,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(i,n.u_size_t),u_size:new a.Uniform1f(i,n.u_size),u_camera_to_center_distance:new a.Uniform1f(i,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(i,n.u_pitch),u_rotate_symbol:new a.Uniform1i(i,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(i,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(i,n.u_fade_change),u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(i,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(i,n.u_coord_matrix),u_is_text:new a.Uniform1i(i,n.u_is_text),u_pitch_with_map:new a.Uniform1i(i,n.u_pitch_with_map),u_texsize:new a.Uniform2f(i,n.u_texsize),u_texsize_icon:new a.Uniform2f(i,n.u_texsize_icon),u_texture:new a.Uniform1i(i,n.u_texture),u_texture_icon:new a.Uniform1i(i,n.u_texture_icon),u_gamma_scale:new a.Uniform1f(i,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(i,n.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(i,n.u_is_halo)}},background:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_opacity:new a.Uniform1f(i,n.u_opacity),u_color:new a.UniformColor(i,n.u_color)}},backgroundPattern:function(i,n){return{u_matrix:new a.UniformMatrix4f(i,n.u_matrix),u_opacity:new a.Uniform1f(i,n.u_opacity),u_image:new a.Uniform1i(i,n.u_image),u_pattern_tl_a:new a.Uniform2f(i,n.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(i,n.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(i,n.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(i,n.u_pattern_br_b),u_texsize:new a.Uniform2f(i,n.u_texsize),u_mix:new a.Uniform1f(i,n.u_mix),u_pattern_size_a:new a.Uniform2f(i,n.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(i,n.u_pattern_size_b),u_scale_a:new a.Uniform1f(i,n.u_scale_a),u_scale_b:new a.Uniform1f(i,n.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(i,n.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(i,n.u_tile_units_to_pixels)}}};function Rl(u,i,n,c,y,_,O){for(var k=u.context,ue=k.gl,Ae=u.useProgram("collisionBox"),We=[],Je=0,rt=0,Ft=0;Ft<c.length;Ft++){var Rt=c[Ft],Yt=i.getTile(Rt),zt=Yt.getBucket(n);if(zt){var Ut=Rt.posMatrix;y[0]===0&&y[1]===0||(Ut=u.translatePosMatrix(Rt.posMatrix,Yt,y,_));var nr=O?zt.textCollisionBox:zt.iconCollisionBox,rr=zt.collisionCircleArray;if(rr.length>0){var Or=a.create(),hr=Ut;a.mul(Or,zt.placementInvProjMatrix,u.transform.glCoordMatrix),a.mul(Or,Or,zt.placementViewportMatrix),We.push({circleArray:rr,circleOffset:rt,transform:hr,invTransform:Or}),rt=Je+=rr.length/4}nr&&Ae.draw(k,ue.LINES,se.disabled,Le.disabled,u.colorModeForRenderPass(),wt.disabled,nl(Ut,u.transform,Yt),n.id,nr.layoutVertexBuffer,nr.indexBuffer,nr.segments,null,u.transform.zoom,null,null,nr.collisionVertexBuffer)}}if(O&&We.length){var Tr=u.useProgram("collisionCircle"),Cr=new a.StructArrayLayout2f1f2i16;Cr.resize(4*Je),Cr._trim();for(var an=0,Yr=0,yn=We;Yr<yn.length;Yr+=1)for(var On=yn[Yr],Qn=0;Qn<On.circleArray.length/4;Qn++){var oi=4*Qn,xi=On.circleArray[oi+0],Xi=On.circleArray[oi+1],An=On.circleArray[oi+2],si=On.circleArray[oi+3];Cr.emplace(an++,xi,Xi,An,si,0),Cr.emplace(an++,xi,Xi,An,si,1),Cr.emplace(an++,xi,Xi,An,si,2),Cr.emplace(an++,xi,Xi,An,si,3)}(!Cu||Cu.length<2*Je)&&(Cu=function(qa){var Ma=2*qa,So=new a.StructArrayLayout3ui6;So.resize(Ma),So._trim();for(var Ta=0;Ta<Ma;Ta++){var Xa=6*Ta;So.uint16[Xa+0]=4*Ta+0,So.uint16[Xa+1]=4*Ta+1,So.uint16[Xa+2]=4*Ta+2,So.uint16[Xa+3]=4*Ta+2,So.uint16[Xa+4]=4*Ta+3,So.uint16[Xa+5]=4*Ta+0}return So}(Je));for(var bi=k.createIndexBuffer(Cu,!0),Wn=k.createVertexBuffer(Cr,a.collisionCircleLayout.members,!0),Ti=0,ii=We;Ti<ii.length;Ti+=1){var Li=ii[Ti],ji=gc(Li.transform,Li.invTransform,u.transform);Tr.draw(k,ue.TRIANGLES,se.disabled,Le.disabled,u.colorModeForRenderPass(),wt.disabled,ji,n.id,Wn,bi,a.SegmentVector.simpleSegment(0,2*Li.circleOffset,Li.circleArray.length,Li.circleArray.length/2),null,u.transform.zoom,null,null,null)}Wn.destroy(),bi.destroy()}}var ru=a.identity(new Float32Array(16));function mf(u,i,n,c,y,_){var O=a.getAnchorAlignment(u),k=-(O.horizontalAlign-.5)*i,ue=-(O.verticalAlign-.5)*n,Ae=a.evaluateVariableOffset(u,c);return new a.Point((k/y+Ae[0])*_,(ue/y+Ae[1])*_)}function gf(u,i,n,c,y,_,O,k,ue,Ae,We){var Je=u.text.placedSymbolArray,rt=u.text.dynamicLayoutVertexArray,Ft=u.icon.dynamicLayoutVertexArray,Rt={};rt.clear();for(var Yt=0;Yt<Je.length;Yt++){var zt=Je.get(Yt),Ut=zt.hidden||!zt.crossTileID||u.allowVerticalPlacement&&!zt.placedOrientation?null:c[zt.crossTileID];if(Ut){var nr=new a.Point(zt.anchorX,zt.anchorY),rr=yi(nr,n?k:O),Or=ci(_.cameraToCenterDistance,rr.signedDistanceFromCamera),hr=y.evaluateSizeForFeature(u.textSizeData,Ae,zt)*Or/a.ONE_EM;n&&(hr*=u.tilePixelRatio/ue);for(var Tr=mf(Ut.anchor,Ut.width,Ut.height,Ut.textOffset,Ut.textBoxScale,hr),Cr=n?yi(nr.add(Tr),O).point:rr.point.add(i?Tr.rotate(-_.angle):Tr),an=u.allowVerticalPlacement&&zt.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,Yr=0;Yr<zt.numGlyphs;Yr++)a.addDynamicAttributes(rt,Cr,an);We&&zt.associatedIconIndex>=0&&(Rt[zt.associatedIconIndex]={shiftedAnchor:Cr,angle:an})}else na(zt.numGlyphs,rt)}if(We){Ft.clear();for(var yn=u.icon.placedSymbolArray,On=0;On<yn.length;On++){var Qn=yn.get(On);if(Qn.hidden)na(Qn.numGlyphs,Ft);else{var oi=Rt[On];if(oi)for(var xi=0;xi<Qn.numGlyphs;xi++)a.addDynamicAttributes(Ft,oi.shiftedAnchor,oi.angle);else na(Qn.numGlyphs,Ft)}}u.icon.dynamicLayoutVertexBuffer.updateData(Ft)}u.text.dynamicLayoutVertexBuffer.updateData(rt)}function rf(u,i,n){return n.iconsInText&&i?"symbolTextAndIcon":u?"symbolSDF":"symbolIcon"}function bl(u,i,n,c,y,_,O,k,ue,Ae,We,Je){for(var rt=u.context,Ft=rt.gl,Rt=u.transform,Yt=k==="map",zt=ue==="map",Ut=Yt&&n.layout.get("symbol-placement")!=="point",nr=Yt&&!zt&&!Ut,rr=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,Or=!1,hr=u.depthModeForSublayer(0,se.ReadOnly),Tr=n.layout.get("text-variable-anchor"),Cr=[],an=0,Yr=c;an<Yr.length;an+=1){var yn=Yr[an],On=i.getTile(yn),Qn=On.getBucket(n);if(Qn){var oi=y?Qn.text:Qn.icon;if(oi&&oi.segments.get().length){var xi=oi.programConfigurations.get(n.id),Xi=y||Qn.sdfIcons,An=y?Qn.textSizeData:Qn.iconSizeData,si=zt||Rt.pitch!==0,bi=u.useProgram(rf(Xi,y,Qn),xi),Wn=a.evaluateSizeForZoom(An,Rt.zoom),Ti=void 0,ii=[0,0],Li=void 0,ji=void 0,qa=null,Ma=void 0;if(y)Li=On.glyphAtlasTexture,ji=Ft.LINEAR,Ti=On.glyphAtlasTexture.size,Qn.iconsInText&&(ii=On.imageAtlasTexture.size,qa=On.imageAtlasTexture,Ma=si||u.options.rotating||u.options.zooming||An.kind==="composite"||An.kind==="camera"?Ft.LINEAR:Ft.NEAREST);else{var So=n.layout.get("icon-size").constantOr(0)!==1||Qn.iconsNeedLinear;Li=On.imageAtlasTexture,ji=Xi||u.options.rotating||u.options.zooming||So||si?Ft.LINEAR:Ft.NEAREST,Ti=On.imageAtlasTexture.size}var Ta=Ji(On,1,u.transform.zoom),Xa=ya(yn.posMatrix,zt,Yt,u.transform,Ta),zs=Ii(yn.posMatrix,zt,Yt,u.transform,Ta),Eo=Tr&&Qn.hasTextData(),yu=n.layout.get("icon-text-fit")!=="none"&&Eo&&Qn.hasIconData();Ut&&xo(Qn,yn.posMatrix,u,y,Xa,zs,zt,Ae);var xu=u.translatePosMatrix(yn.posMatrix,On,_,O),Uo=Ut||y&&Tr||yu?ru:Xa,As=u.translatePosMatrix(zs,On,_,O,!0),Lu=Xi&&n.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ac={program:bi,buffers:oi,uniformValues:Xi?Qn.iconsInText?Jl(An.kind,Wn,nr,zt,u,xu,Uo,As,Ti,ii):Bo(An.kind,Wn,nr,zt,u,xu,Uo,As,y,Ti,!0):Ol(An.kind,Wn,nr,zt,u,xu,Uo,As,y,Ti),atlasTexture:Li,atlasTextureIcon:qa,atlasInterpolation:ji,atlasInterpolationIcon:Ma,isSDF:Xi,hasHalo:Lu};if(rr&&Qn.canOverlap){Or=!0;for(var $u=0,oc=oi.segments.get();$u<oc.length;$u+=1){var sc=oc[$u];Cr.push({segments:new a.SegmentVector([sc]),sortKey:sc.sortKey,state:ac})}}else Cr.push({segments:oi.segments,sortKey:0,state:ac})}}}Or&&Cr.sort(function(bu,Oo){return bu.sortKey-Oo.sortKey});for(var Ru=0,dl=Cr;Ru<dl.length;Ru+=1){var Cs=dl[Ru],po=Cs.state;if(rt.activeTexture.set(Ft.TEXTURE0),po.atlasTexture.bind(po.atlasInterpolation,Ft.CLAMP_TO_EDGE),po.atlasTextureIcon&&(rt.activeTexture.set(Ft.TEXTURE1),po.atlasTextureIcon&&po.atlasTextureIcon.bind(po.atlasInterpolationIcon,Ft.CLAMP_TO_EDGE)),po.isSDF){var Du=po.uniformValues;po.hasHalo&&(Du.u_is_halo=1,ja(po.buffers,Cs.segments,n,u,po.program,hr,We,Je,Du)),Du.u_is_halo=0}ja(po.buffers,Cs.segments,n,u,po.program,hr,We,Je,po.uniformValues)}}function ja(u,i,n,c,y,_,O,k,ue){var Ae=c.context;y.draw(Ae,Ae.gl.TRIANGLES,_,O,k,wt.disabled,ue,n.id,u.layoutVertexBuffer,u.indexBuffer,i,n.paint,c.transform.zoom,u.programConfigurations.get(n.id),u.dynamicLayoutVertexBuffer,u.opacityVertexBuffer)}function il(u,i,n,c,y,_,O){var k,ue,Ae,We,Je,rt=u.context.gl,Ft=n.paint.get("fill-pattern"),Rt=Ft&&Ft.constantOr(1),Yt=n.getCrossfadeParameters();O?(ue=Rt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",k=rt.LINES):(ue=Rt?"fillPattern":"fill",k=rt.TRIANGLES);for(var zt=0,Ut=c;zt<Ut.length;zt+=1){var nr=Ut[zt],rr=i.getTile(nr);if(!Rt||rr.patternsLoaded()){var Or=rr.getBucket(n);if(Or){var hr=Or.programConfigurations.get(n.id),Tr=u.useProgram(ue,hr);Rt&&(u.context.activeTexture.set(rt.TEXTURE0),rr.imageAtlasTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE),hr.updatePaintBuffers(Yt));var Cr=Ft.constantOr(null);if(Cr&&rr.imageAtlas){var an=rr.imageAtlas,Yr=an.patternPositions[Cr.to.toString()],yn=an.patternPositions[Cr.from.toString()];Yr&&yn&&hr.setConstantPatternPositions(Yr,yn)}var On=u.translatePosMatrix(nr.posMatrix,rr,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(O){We=Or.indexBuffer2,Je=Or.segments2;var Qn=[rt.drawingBufferWidth,rt.drawingBufferHeight];Ae=ue==="fillOutlinePattern"&&Rt?mc(On,u,Yt,rr,Qn):Lc(On,Qn)}else We=Or.indexBuffer,Je=Or.segments,Ae=Rt?vs(On,u,Yt,rr):eu(On);Tr.draw(u.context,k,y,u.stencilModeForClipping(nr),_,wt.disabled,Ae,n.id,Or.layoutVertexBuffer,We,Je,n.paint,u.transform.zoom,hr)}}}}function Dl(u,i,n,c,y,_,O){for(var k=u.context,ue=k.gl,Ae=n.paint.get("fill-extrusion-pattern"),We=Ae.constantOr(1),Je=n.getCrossfadeParameters(),rt=n.paint.get("fill-extrusion-opacity"),Ft=0,Rt=c;Ft<Rt.length;Ft+=1){var Yt=Rt[Ft],zt=i.getTile(Yt),Ut=zt.getBucket(n);if(Ut){var nr=Ut.programConfigurations.get(n.id),rr=u.useProgram(We?"fillExtrusionPattern":"fillExtrusion",nr);We&&(u.context.activeTexture.set(ue.TEXTURE0),zt.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),nr.updatePaintBuffers(Je));var Or=Ae.constantOr(null);if(Or&&zt.imageAtlas){var hr=zt.imageAtlas,Tr=hr.patternPositions[Or.to.toString()],Cr=hr.patternPositions[Or.from.toString()];Tr&&Cr&&nr.setConstantPatternPositions(Tr,Cr)}var an=u.translatePosMatrix(Yt.posMatrix,zt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Yr=n.paint.get("fill-extrusion-vertical-gradient"),yn=We?Au(an,u,Yr,rt,Yt,Je,zt):Qa(an,u,Yr,rt);rr.draw(k,k.gl.TRIANGLES,y,_,O,wt.backCCW,yn,n.id,Ut.layoutVertexBuffer,Ut.indexBuffer,Ut.segments,n.paint,u.transform.zoom,nr)}}}function xc(u,i,n,c,y,_){var O=u.context,k=O.gl,ue=i.fbo;if(ue){var Ae=u.useProgram("hillshade");O.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,ue.colorAttachment.get());var We=function(Je,rt,Ft){var Rt=Ft.paint.get("hillshade-shadow-color"),Yt=Ft.paint.get("hillshade-highlight-color"),zt=Ft.paint.get("hillshade-accent-color"),Ut=Ft.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ft.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ut-=Je.transform.angle);var nr,rr,Or,hr=!Je.options.moving;return{u_matrix:Je.transform.calculatePosMatrix(rt.tileID.toUnwrapped(),hr),u_image:0,u_latrange:(nr=rt.tileID,rr=Math.pow(2,nr.canonical.z),Or=nr.canonical.y,[new a.MercatorCoordinate(0,Or/rr).toLngLat().lat,new a.MercatorCoordinate(0,(Or+1)/rr).toLngLat().lat]),u_light:[Ft.paint.get("hillshade-exaggeration"),Ut],u_shadow:Rt,u_highlight:Yt,u_accent:zt}}(u,i,n);Ae.draw(O,k.TRIANGLES,c,y,_,wt.disabled,We,n.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments)}}function Fc(u,i,n,c,y,_){var O=u.context,k=O.gl,ue=i.dem;if(ue&&ue.data){var Ae=ue.dim,We=ue.stride,Je=ue.getPixels();if(O.activeTexture.set(k.TEXTURE1),O.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||u.getTileTexture(We),i.demTexture){var rt=i.demTexture;rt.update(Je,{premultiply:!1}),rt.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else i.demTexture=new a.Texture(O,Je,k.RGBA,{premultiply:!1}),i.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);O.activeTexture.set(k.TEXTURE0);var Ft=i.fbo;if(!Ft){var Rt=new a.Texture(O,{width:Ae,height:Ae,data:null},k.RGBA);Rt.bind(k.LINEAR,k.CLAMP_TO_EDGE),(Ft=i.fbo=O.createFramebuffer(Ae,Ae,!0)).colorAttachment.set(Rt.texture)}O.bindFramebuffer.set(Ft.framebuffer),O.viewport.set([0,0,Ae,Ae]),u.useProgram("hillshadePrepare").draw(O,k.TRIANGLES,c,y,_,wt.disabled,function(Yt,zt){var Ut=zt.stride,nr=a.create();return a.ortho(nr,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(nr,nr,[0,-a.EXTENT,0]),{u_matrix:nr,u_image:1,u_dimension:[Ut,Ut],u_zoom:Yt.overscaledZ,u_unpack:zt.getUnpackVector()}}(i.tileID,ue),n.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function zl(u,i,n,c,y){var _=c.paint.get("raster-fade-duration");if(_>0){var O=a.browser.now(),k=(O-u.timeAdded)/_,ue=i?(O-i.timeAdded)/_:-1,Ae=n.getSource(),We=y.coveringZoomLevel({tileSize:Ae.tileSize,roundZoom:Ae.roundZoom}),Je=!i||Math.abs(i.tileID.overscaledZ-We)>Math.abs(u.tileID.overscaledZ-We),rt=Je&&u.refreshedUponExpiration?1:a.clamp(Je?k:1-ue,0,1);return u.refreshedUponExpiration&&k>=1&&(u.refreshedUponExpiration=!1),i?{opacity:1,mix:1-rt}:{opacity:rt,mix:0}}return{opacity:1,mix:0}}var If=new a.Color(1,0,0,1),Of=new a.Color(0,1,0,1),nf=new a.Color(0,0,1,1),Sl=new a.Color(1,0,1,1),Ql=new a.Color(0,1,1,1);function wu(u,i,n,c){al(u,0,i+n/2,u.transform.width,n,c)}function ks(u,i,n,c){al(u,i-n/2,0,n,u.transform.height,c)}function al(u,i,n,c,y,_){var O=u.context,k=O.gl;k.enable(k.SCISSOR_TEST),k.scissor(i*a.browser.devicePixelRatio,n*a.browser.devicePixelRatio,c*a.browser.devicePixelRatio,y*a.browser.devicePixelRatio),O.clear({color:_}),k.disable(k.SCISSOR_TEST)}function Bc(u,i,n){var c=u.context,y=c.gl,_=n.posMatrix,O=u.useProgram("debug"),k=se.disabled,ue=Le.disabled,Ae=u.colorModeForRenderPass();c.activeTexture.set(y.TEXTURE0),u.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),O.draw(c,y.LINE_STRIP,k,ue,Ae,wt.disabled,tu(_,a.Color.red),"$debug",u.debugBuffer,u.tileBorderIndexBuffer,u.debugSegments);var We=i.getTileByID(n.key).latestRawTileData,Je=Math.floor((We&&We.byteLength||0)/1024),rt=i.getTile(n).tileSize,Ft=512/Math.min(rt,512)*(n.overscaledZ/u.transform.zoom)*.5,Rt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Rt+=" => "+n.overscaledZ),function(Yt,zt){Yt.initDebugOverlayCanvas();var Ut=Yt.debugOverlayCanvas,nr=Yt.context.gl,rr=Yt.debugOverlayCanvas.getContext("2d");rr.clearRect(0,0,Ut.width,Ut.height),rr.shadowColor="white",rr.shadowBlur=2,rr.lineWidth=1.5,rr.strokeStyle="white",rr.textBaseline="top",rr.font="bold 36px Open Sans, sans-serif",rr.fillText(zt,5,5),rr.strokeText(zt,5,5),Yt.debugOverlayTexture.update(Ut),Yt.debugOverlayTexture.bind(nr.LINEAR,nr.CLAMP_TO_EDGE)}(u,Rt+" "+Je+"kb"),O.draw(c,y.TRIANGLES,k,ue,et.alphaBlended,wt.disabled,tu(_,a.Color.transparent,Ft),"$debug",u.debugBuffer,u.quadTriangleIndexBuffer,u.debugSegments)}var Wu={symbol:function(i,n,c,y,_){if(i.renderPass==="translucent"){var O=Le.disabled,k=i.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(ue,Ae,We,Je,rt,Ft,Rt){for(var Yt=Ae.transform,zt=rt==="map",Ut=Ft==="map",nr=0,rr=ue;nr<rr.length;nr+=1){var Or=rr[nr],hr=Je.getTile(Or),Tr=hr.getBucket(We);if(Tr&&Tr.text&&Tr.text.segments.get().length){var Cr=a.evaluateSizeForZoom(Tr.textSizeData,Yt.zoom),an=Ji(hr,1,Ae.transform.zoom),Yr=ya(Or.posMatrix,Ut,zt,Ae.transform,an),yn=We.layout.get("icon-text-fit")!=="none"&&Tr.hasIconData();if(Cr){var On=Math.pow(2,Yt.zoom-hr.tileID.overscaledZ);gf(Tr,zt,Ut,Rt,a.symbolSize,Yt,Yr,Or.posMatrix,On,Cr,yn)}}}}(y,i,c,n,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),_),c.paint.get("icon-opacity").constantOr(1)!==0&&bl(i,n,c,y,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),O,k),c.paint.get("text-opacity").constantOr(1)!==0&&bl(i,n,c,y,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),O,k),n.map.showCollisionBoxes&&(Rl(i,n,c,y,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Rl(i,n,c,y,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))}},circle:function(i,n,c,y){if(i.renderPass==="translucent"){var _=c.paint.get("circle-opacity"),O=c.paint.get("circle-stroke-width"),k=c.paint.get("circle-stroke-opacity"),ue=c.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)!==0||O.constantOr(1)!==0&&k.constantOr(1)!==0){for(var Ae=i.context,We=Ae.gl,Je=i.depthModeForSublayer(0,se.ReadOnly),rt=Le.disabled,Ft=i.colorModeForRenderPass(),Rt=[],Yt=0;Yt<y.length;Yt++){var zt=y[Yt],Ut=n.getTile(zt),nr=Ut.getBucket(c);if(nr){var rr=nr.programConfigurations.get(c.id),Or={programConfiguration:rr,program:i.useProgram("circle",rr),layoutVertexBuffer:nr.layoutVertexBuffer,indexBuffer:nr.indexBuffer,uniformValues:yl(i,zt,Ut,c)};if(ue)for(var hr=0,Tr=nr.segments.get();hr<Tr.length;hr+=1){var Cr=Tr[hr];Rt.push({segments:new a.SegmentVector([Cr]),sortKey:Cr.sortKey,state:Or})}else Rt.push({segments:nr.segments,sortKey:0,state:Or})}}ue&&Rt.sort(function(Qn,oi){return Qn.sortKey-oi.sortKey});for(var an=0,Yr=Rt;an<Yr.length;an+=1){var yn=Yr[an],On=yn.state;On.program.draw(Ae,We.TRIANGLES,Je,rt,Ft,wt.disabled,On.uniformValues,c.id,On.layoutVertexBuffer,On.indexBuffer,yn.segments,c.paint,i.transform.zoom,On.programConfiguration)}}}},heatmap:function(i,n,c,y){if(c.paint.get("heatmap-opacity")!==0)if(i.renderPass==="offscreen"){var _=i.context,O=_.gl,k=Le.disabled,ue=new et([O.ONE,O.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(Rt,Yt,zt){var Ut=Rt.gl;Rt.activeTexture.set(Ut.TEXTURE1),Rt.viewport.set([0,0,Yt.width/4,Yt.height/4]);var nr=zt.heatmapFbo;if(nr)Ut.bindTexture(Ut.TEXTURE_2D,nr.colorAttachment.get()),Rt.bindFramebuffer.set(nr.framebuffer);else{var rr=Ut.createTexture();Ut.bindTexture(Ut.TEXTURE_2D,rr),Ut.texParameteri(Ut.TEXTURE_2D,Ut.TEXTURE_WRAP_S,Ut.CLAMP_TO_EDGE),Ut.texParameteri(Ut.TEXTURE_2D,Ut.TEXTURE_WRAP_T,Ut.CLAMP_TO_EDGE),Ut.texParameteri(Ut.TEXTURE_2D,Ut.TEXTURE_MIN_FILTER,Ut.LINEAR),Ut.texParameteri(Ut.TEXTURE_2D,Ut.TEXTURE_MAG_FILTER,Ut.LINEAR),nr=zt.heatmapFbo=Rt.createFramebuffer(Yt.width/4,Yt.height/4,!1),function(Or,hr,Tr,Cr){var an=Or.gl;an.texImage2D(an.TEXTURE_2D,0,an.RGBA,hr.width/4,hr.height/4,0,an.RGBA,Or.extRenderToTextureHalfFloat?Or.extTextureHalfFloat.HALF_FLOAT_OES:an.UNSIGNED_BYTE,null),Cr.colorAttachment.set(Tr)}(Rt,Yt,rr,nr)}})(_,i,c),_.clear({color:a.Color.transparent});for(var Ae=0;Ae<y.length;Ae++){var We=y[Ae];if(!n.hasRenderableParent(We)){var Je=n.getTile(We),rt=Je.getBucket(c);if(rt){var Ft=rt.programConfigurations.get(c.id);i.useProgram("heatmap",Ft).draw(_,O.TRIANGLES,se.disabled,k,ue,wt.disabled,Rc(We.posMatrix,Je,i.transform.zoom,c.paint.get("heatmap-intensity")),c.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,c.paint,i.transform.zoom,Ft)}}}_.viewport.set([0,0,i.width,i.height])}else i.renderPass==="translucent"&&(i.context.setColorMode(i.colorModeForRenderPass()),function(Rt,Yt){var zt=Rt.context,Ut=zt.gl,nr=Yt.heatmapFbo;if(nr){zt.activeTexture.set(Ut.TEXTURE0),Ut.bindTexture(Ut.TEXTURE_2D,nr.colorAttachment.get()),zt.activeTexture.set(Ut.TEXTURE1);var rr=Yt.colorRampTexture;rr||(rr=Yt.colorRampTexture=new a.Texture(zt,Yt.colorRamp,Ut.RGBA)),rr.bind(Ut.LINEAR,Ut.CLAMP_TO_EDGE),Rt.useProgram("heatmapTexture").draw(zt,Ut.TRIANGLES,se.disabled,Le.disabled,Rt.colorModeForRenderPass(),wt.disabled,function(Or,hr,Tr,Cr){var an=a.create();a.ortho(an,0,Or.width,Or.height,0,0,1);var Yr=Or.context.gl;return{u_matrix:an,u_world:[Yr.drawingBufferWidth,Yr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:hr.paint.get("heatmap-opacity")}}(Rt,Yt),Yt.id,Rt.viewportBuffer,Rt.quadTriangleIndexBuffer,Rt.viewportSegments,Yt.paint,Rt.transform.zoom)}}(i,c))},line:function(i,n,c,y){if(i.renderPass==="translucent"){var _=c.paint.get("line-opacity"),O=c.paint.get("line-width");if(_.constantOr(1)!==0&&O.constantOr(1)!==0)for(var k=i.depthModeForSublayer(0,se.ReadOnly),ue=i.colorModeForRenderPass(),Ae=c.paint.get("line-dasharray"),We=c.paint.get("line-pattern"),Je=We.constantOr(1),rt=c.paint.get("line-gradient"),Ft=c.getCrossfadeParameters(),Rt=Je?"linePattern":Ae?"lineSDF":rt?"lineGradient":"line",Yt=i.context,zt=Yt.gl,Ut=!0,nr=0,rr=y;nr<rr.length;nr+=1){var Or=rr[nr],hr=n.getTile(Or);if(!Je||hr.patternsLoaded()){var Tr=hr.getBucket(c);if(Tr){var Cr=Tr.programConfigurations.get(c.id),an=i.context.program.get(),Yr=i.useProgram(Rt,Cr),yn=Ut||Yr.program!==an,On=We.constantOr(null);if(On&&hr.imageAtlas){var Qn=hr.imageAtlas,oi=Qn.patternPositions[On.to.toString()],xi=Qn.patternPositions[On.from.toString()];oi&&xi&&Cr.setConstantPatternPositions(oi,xi)}var Xi=Je?Dc(i,hr,c,Ft):Ae?Mf(i,hr,c,Ae,Ft):rt?_a(i,hr,c,Tr.lineClipsArray.length):Kl(i,hr,c);if(Je)Yt.activeTexture.set(zt.TEXTURE0),hr.imageAtlasTexture.bind(zt.LINEAR,zt.CLAMP_TO_EDGE),Cr.updatePaintBuffers(Ft);else if(Ae&&(yn||i.lineAtlas.dirty))Yt.activeTexture.set(zt.TEXTURE0),i.lineAtlas.bind(Yt);else if(rt){var An=Tr.gradients[c.id],si=An.texture;if(c.gradientVersion!==An.version){var bi=256;if(c.stepInterpolant){var Wn=n.getSource().maxzoom,Ti=Or.canonical.z===Wn?Math.ceil(1<<i.transform.maxZoom-Or.canonical.z):1;bi=a.clamp(a.nextPowerOfTwo(Tr.maxLineLength/a.EXTENT*1024*Ti),256,Yt.maxTextureSize)}An.gradient=a.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:bi,image:An.gradient||void 0,clips:Tr.lineClipsArray}),An.texture?An.texture.update(An.gradient):An.texture=new a.Texture(Yt,An.gradient,zt.RGBA),An.version=c.gradientVersion,si=An.texture}Yt.activeTexture.set(zt.TEXTURE0),si.bind(c.stepInterpolant?zt.NEAREST:zt.LINEAR,zt.CLAMP_TO_EDGE)}Yr.draw(Yt,zt.TRIANGLES,k,i.stencilModeForClipping(Or),ue,wt.disabled,Xi,c.id,Tr.layoutVertexBuffer,Tr.indexBuffer,Tr.segments,c.paint,i.transform.zoom,Cr,Tr.layoutVertexBuffer2),Ut=!1}}}}},fill:function(i,n,c,y){var _=c.paint.get("fill-color"),O=c.paint.get("fill-opacity");if(O.constantOr(1)!==0){var k=i.colorModeForRenderPass(),ue=c.paint.get("fill-pattern"),Ae=i.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&_.constantOr(a.Color.transparent).a===1&&O.constantOr(0)===1?"opaque":"translucent";if(i.renderPass===Ae){var We=i.depthModeForSublayer(1,i.renderPass==="opaque"?se.ReadWrite:se.ReadOnly);il(i,n,c,y,We,k,!1)}if(i.renderPass==="translucent"&&c.paint.get("fill-antialias")){var Je=i.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,se.ReadOnly);il(i,n,c,y,Je,k,!0)}}},"fill-extrusion":function(i,n,c,y){var _=c.paint.get("fill-extrusion-opacity");if(_!==0&&i.renderPass==="translucent"){var O=new se(i.context.gl.LEQUAL,se.ReadWrite,i.depthRangeFor3D);if(_!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))Dl(i,n,c,y,O,Le.disabled,et.disabled),Dl(i,n,c,y,O,i.stencilModeFor3D(),i.colorModeForRenderPass());else{var k=i.colorModeForRenderPass();Dl(i,n,c,y,O,Le.disabled,k)}}},hillshade:function(i,n,c,y){if(i.renderPass==="offscreen"||i.renderPass==="translucent"){for(var _=i.context,O=i.depthModeForSublayer(0,se.ReadOnly),k=i.colorModeForRenderPass(),ue=i.renderPass==="translucent"?i.stencilConfigForOverlap(y):[{},y],Ae=ue[0],We=0,Je=ue[1];We<Je.length;We+=1){var rt=Je[We],Ft=n.getTile(rt);Ft.needsHillshadePrepare&&i.renderPass==="offscreen"?Fc(i,Ft,c,O,Le.disabled,k):i.renderPass==="translucent"&&xc(i,Ft,c,O,Ae[rt.overscaledZ],k)}_.viewport.set([0,0,i.width,i.height])}},raster:function(i,n,c,y){if(i.renderPass==="translucent"&&c.paint.get("raster-opacity")!==0&&y.length)for(var _=i.context,O=_.gl,k=n.getSource(),ue=i.useProgram("raster"),Ae=i.colorModeForRenderPass(),We=k instanceof ve?[{},y]:i.stencilConfigForOverlap(y),Je=We[0],rt=We[1],Ft=rt[rt.length-1].overscaledZ,Rt=!i.options.moving,Yt=0,zt=rt;Yt<zt.length;Yt+=1){var Ut=zt[Yt],nr=i.depthModeForSublayer(Ut.overscaledZ-Ft,c.paint.get("raster-opacity")===1?se.ReadWrite:se.ReadOnly,O.LESS),rr=n.getTile(Ut),Or=i.transform.calculatePosMatrix(Ut.toUnwrapped(),Rt);rr.registerFadeDuration(c.paint.get("raster-fade-duration"));var hr=n.findLoadedParent(Ut,0),Tr=zl(rr,hr,n,c,i.transform),Cr=void 0,an=void 0,Yr=c.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;_.activeTexture.set(O.TEXTURE0),rr.texture.bind(Yr,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(O.TEXTURE1),hr?(hr.texture.bind(Yr,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),Cr=Math.pow(2,hr.tileID.overscaledZ-rr.tileID.overscaledZ),an=[rr.tileID.canonical.x*Cr%1,rr.tileID.canonical.y*Cr%1]):rr.texture.bind(Yr,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);var yn=$l(Or,an||[0,0],Cr||1,Tr,c);k instanceof ve?ue.draw(_,O.TRIANGLES,nr,Le.disabled,Ae,wt.disabled,yn,c.id,k.boundsBuffer,i.quadTriangleIndexBuffer,k.boundsSegments):ue.draw(_,O.TRIANGLES,nr,Je[Ut.overscaledZ],Ae,wt.disabled,yn,c.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}},background:function(i,n,c){var y=c.paint.get("background-color"),_=c.paint.get("background-opacity");if(_!==0){var O=i.context,k=O.gl,ue=i.transform,Ae=ue.tileSize,We=c.paint.get("background-pattern");if(!i.isPatternMissing(We)){var Je=!We&&y.a===1&&_===1&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass===Je){var rt=Le.disabled,Ft=i.depthModeForSublayer(0,Je==="opaque"?se.ReadWrite:se.ReadOnly),Rt=i.colorModeForRenderPass(),Yt=i.useProgram(We?"backgroundPattern":"background"),zt=ue.coveringTiles({tileSize:Ae});We&&(O.activeTexture.set(k.TEXTURE0),i.imageManager.bind(i.context));for(var Ut=c.getCrossfadeParameters(),nr=0,rr=zt;nr<rr.length;nr+=1){var Or=rr[nr],hr=i.transform.calculatePosMatrix(Or.toUnwrapped()),Tr=We?xl(hr,_,i,We,{tileID:Or,tileSize:Ae},Ut):Ll(hr,_,y);Yt.draw(O,k.TRIANGLES,Ft,rt,Rt,wt.disabled,Tr,c.id,i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}}}},debug:function(i,n,c){for(var y=0;y<c.length;y++)Bc(i,n,c[y])},custom:function(i,n,c){var y=i.context,_=c.implementation;if(i.renderPass==="offscreen"){var O=_.prerender;O&&(i.setCustomLayerDefaults(),y.setColorMode(i.colorModeForRenderPass()),O.call(_,y.gl,i.transform.customLayerMatrix()),y.setDirty(),i.setBaseState())}else if(i.renderPass==="translucent"){i.setCustomLayerDefaults(),y.setColorMode(i.colorModeForRenderPass()),y.setStencilMode(Le.disabled);var k=_.renderingMode==="3d"?new se(i.context.gl.LEQUAL,se.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,se.ReadOnly);y.setDepthMode(k),_.render(y.gl,i.transform.customLayerMatrix()),y.setDirty(),i.setBaseState(),y.bindFramebuffer.set(null)}}},Ua=function(i,n){this.context=new Ne(i),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=gt.maxUnderzooming+gt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fo,this.gpuTimers={}};Ua.prototype.resize=function(u,i){if(this.width=u*a.browser.devicePixelRatio,this.height=i*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,c=this.style._order;n<c.length;n+=1)this.style._layers[c[n]].resize()},Ua.prototype.setup=function(){var u=this.context,i=new a.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(a.EXTENT,0),i.emplaceBack(0,a.EXTENT),i.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(i,ka.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var n=new a.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(a.EXTENT,0),n.emplaceBack(0,a.EXTENT),n.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=u.createVertexBuffer(n,ka.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var c=new a.StructArrayLayout4i8;c.emplaceBack(0,0,0,0),c.emplaceBack(a.EXTENT,0,a.EXTENT,0),c.emplaceBack(0,a.EXTENT,0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=u.createVertexBuffer(c,Se.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var y=new a.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(y,ka.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var _=new a.StructArrayLayout1ui2;_.emplaceBack(0),_.emplaceBack(1),_.emplaceBack(3),_.emplaceBack(2),_.emplaceBack(0),this.tileBorderIndexBuffer=u.createIndexBuffer(_);var O=new a.StructArrayLayout3ui6;O.emplaceBack(0,1,2),O.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(O),this.emptyTexture=new a.Texture(u,{width:1,height:1,data:new Uint8Array([0,0,0,0])},u.gl.RGBA);var k=this.context.gl;this.stencilClearMode=new Le({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)},Ua.prototype.clearStencil=function(){var u=this.context,i=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=a.create();a.ortho(n,0,this.width,this.height,0,0,1),a.scale(n,n,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(u,i.TRIANGLES,se.disabled,this.stencilClearMode,et.disabled,wt.disabled,Hu(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Ua.prototype._renderTileClippingMasks=function(u,i){if(this.currentStencilSource!==u.source&&u.isTileClipped()&&i&&i.length){this.currentStencilSource=u.source;var n=this.context,c=n.gl;this.nextStencilID+i.length>256&&this.clearStencil(),n.setColorMode(et.disabled),n.setDepthMode(se.disabled);var y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var _=0,O=i;_<O.length;_+=1){var k=O[_],ue=this._tileClippingMaskIDs[k.key]=this.nextStencilID++;y.draw(n,c.TRIANGLES,se.disabled,new Le({func:c.ALWAYS,mask:0},ue,255,c.KEEP,c.KEEP,c.REPLACE),et.disabled,wt.disabled,Hu(k.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Ua.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var u=this.nextStencilID++,i=this.context.gl;return new Le({func:i.NOTEQUAL,mask:255},u,255,i.KEEP,i.KEEP,i.REPLACE)},Ua.prototype.stencilModeForClipping=function(u){var i=this.context.gl;return new Le({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,i.KEEP,i.KEEP,i.REPLACE)},Ua.prototype.stencilConfigForOverlap=function(u){var i,n=this.context.gl,c=u.sort(function(ue,Ae){return Ae.overscaledZ-ue.overscaledZ}),y=c[c.length-1].overscaledZ,_=c[0].overscaledZ-y+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();for(var O={},k=0;k<_;k++)O[k+y]=new Le({func:n.GEQUAL,mask:255},k+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=_,[O,c]}return[(i={},i[y]=Le.disabled,i),c]},Ua.prototype.colorModeForRenderPass=function(){var u=this.context.gl;return this._showOverdrawInspector?new et([u.CONSTANT_COLOR,u.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?et.unblended:et.alphaBlended},Ua.prototype.depthModeForSublayer=function(u,i,n){if(!this.opaquePassEnabledForLayer())return se.disabled;var c=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new se(n||this.context.gl.LEQUAL,i,[c,c])},Ua.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Ua.prototype.render=function(u,i){var n=this;this.style=u,this.options=i,this.lineAtlas=u.lineAtlas,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var c=this.style._order,y=this.style.sourceCaches;for(var _ in y){var O=y[_];O.used&&O.prepare(this.context)}var k,ue,Ae={},We={},Je={};for(var rt in y){var Ft=y[rt];Ae[rt]=Ft.getVisibleCoordinates(),We[rt]=Ae[rt].slice().reverse(),Je[rt]=Ft.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Rt=0;Rt<c.length;Rt++)if(this.style._layers[c[Rt]].is3D()){this.opaquePassCutoff=Rt;break}this.renderPass="offscreen";for(var Yt=0,zt=c;Yt<zt.length;Yt+=1){var Ut=this.style._layers[zt[Yt]];if(Ut.hasOffscreenPass()&&!Ut.isHidden(this.transform.zoom)){var nr=We[Ut.source];(Ut.type==="custom"||nr.length)&&this.renderLayer(this,y[Ut.source],Ut,nr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(u._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){var rr=this.style._layers[c[this.currentLayer]],Or=y[rr.source],hr=Ae[rr.source];this._renderTileClippingMasks(rr,hr),this.renderLayer(this,Or,rr,hr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){var Tr=this.style._layers[c[this.currentLayer]],Cr=y[Tr.source],an=(Tr.type==="symbol"?Je:We)[Tr.source];this._renderTileClippingMasks(Tr,Ae[Tr.source]),this.renderLayer(this,Cr,Tr,an)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(Yr){Yr.source&&!Yr.isHidden(n.transform.zoom)&&(Yr.source!==(ue&&ue.id)&&(ue=n.style.sourceCaches[Yr.source]),(!k||k.getSource().maxzoom<ue.getSource().maxzoom)&&(k=ue))}),k&&Wu.debug(this,k,k.getVisibleCoordinates())),this.options.showPadding&&function(Yr){var yn=Yr.transform.padding;wu(Yr,Yr.transform.height-(yn.top||0),3,If),wu(Yr,yn.bottom||0,3,Of),ks(Yr,yn.left||0,3,nf),ks(Yr,Yr.transform.width-(yn.right||0),3,Sl);var On=Yr.transform.centerPoint;(function(Qn,oi,xi,Xi){al(Qn,oi-1,xi-10,2,20,Xi),al(Qn,oi-10,xi-1,20,2,Xi)})(Yr,On.x,Yr.transform.height-On.y,Ql)}(this),this.context.setDefault()},Ua.prototype.renderLayer=function(u,i,n,c){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||c.length)&&(this.id=n.id,this.gpuTimingStart(n),Wu[n.type](u,i,n,c,this.style.placement.variableOffsets),this.gpuTimingEnd())},Ua.prototype.gpuTimingStart=function(u){if(this.options.gpuTiming){var i=this.context.extTimerQuery,n=this.gpuTimers[u.id];n||(n=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:i.createQueryEXT()}),n.calls++,i.beginQueryEXT(i.TIME_ELAPSED_EXT,n.query)}},Ua.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}},Ua.prototype.collectGpuTimers=function(){var u=this.gpuTimers;return this.gpuTimers={},u},Ua.prototype.queryGpuTimers=function(u){var i={};for(var n in u){var c=u[n],y=this.context.extTimerQuery,_=y.getQueryObjectEXT(c.query,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(c.query),i[n]=_}return i},Ua.prototype.translatePosMatrix=function(u,i,n,c,y){if(!n[0]&&!n[1])return u;var _=y?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(_){var O=Math.sin(_),k=Math.cos(_);n=[n[0]*k-n[1]*O,n[0]*O+n[1]*k]}var ue=[y?n[0]:Ji(i,n[0],this.transform.zoom),y?n[1]:Ji(i,n[1],this.transform.zoom),0],Ae=new Float32Array(16);return a.translate(Ae,u,ue),Ae},Ua.prototype.saveTileTexture=function(u){var i=this._tileTextures[u.size[0]];i?i.push(u):this._tileTextures[u.size[0]]=[u]},Ua.prototype.getTileTexture=function(u){var i=this._tileTextures[u];return i&&i.length>0?i.pop():null},Ua.prototype.isPatternMissing=function(u){if(!u)return!1;if(!u.from||!u.to)return!0;var i=this.imageManager.getPattern(u.from.toString()),n=this.imageManager.getPattern(u.to.toString());return!i||!n},Ua.prototype.useProgram=function(u,i){this.cache=this.cache||{};var n=""+u+(i?i.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new ef(this.context,u,Oc[u],i,Nc[u],this._showOverdrawInspector)),this.cache[n]},Ua.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Ua.prototype.setBaseState=function(){var u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)},Ua.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Ua.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var du=function(i,n){this.points=i,this.planes=n};du.fromInvProjectionMatrix=function(u,i,n){var c=Math.pow(2,n),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(O){return a.transformMat4([],O,u)}).map(function(O){return a.scale$1([],O,1/O[3]/i*c)}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(O){var k=a.sub([],y[O[0]],y[O[1]]),ue=a.sub([],y[O[2]],y[O[1]]),Ae=a.normalize([],a.cross([],k,ue)),We=-a.dot(Ae,y[O[1]]);return Ae.concat(We)});return new du(y,_)};var ol=function(i,n){this.min=i,this.max=n,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};ol.prototype.quadrant=function(u){for(var i=[u%2==0,u<2],n=a.clone$2(this.min),c=a.clone$2(this.max),y=0;y<i.length;y++)n[y]=i[y]?this.min[y]:this.center[y],c[y]=i[y]?this.center[y]:this.max[y];return c[2]=this.max[2],new ol(n,c)},ol.prototype.distanceX=function(u){return Math.max(Math.min(this.max[0],u[0]),this.min[0])-u[0]},ol.prototype.distanceY=function(u){return Math.max(Math.min(this.max[1],u[1]),this.min[1])-u[1]},ol.prototype.intersects=function(u){for(var i=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,c=0;c<u.planes.length;c++){for(var y=u.planes[c],_=0,O=0;O<i.length;O++)_+=a.dot$1(y,i[O])>=0;if(_===0)return 0;_!==i.length&&(n=!1)}if(n)return 2;for(var k=0;k<3;k++){for(var ue=Number.MAX_VALUE,Ae=-Number.MAX_VALUE,We=0;We<u.points.length;We++){var Je=u.points[We][k]-this.min[k];ue=Math.min(ue,Je),Ae=Math.max(Ae,Je)}if(Ae<0||ue>this.max[k]-this.min[k])return 0}return 1};var sl=function(i,n,c,y){if(i===void 0&&(i=0),n===void 0&&(n=0),c===void 0&&(c=0),y===void 0&&(y=0),isNaN(i)||i<0||isNaN(n)||n<0||isNaN(c)||c<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=n,this.left=c,this.right=y};sl.prototype.interpolate=function(u,i,n){return i.top!=null&&u.top!=null&&(this.top=a.number(u.top,i.top,n)),i.bottom!=null&&u.bottom!=null&&(this.bottom=a.number(u.bottom,i.bottom,n)),i.left!=null&&u.left!=null&&(this.left=a.number(u.left,i.left,n)),i.right!=null&&u.right!=null&&(this.right=a.number(u.right,i.right,n)),this},sl.prototype.getCenter=function(u,i){var n=a.clamp((this.left+u-this.right)/2,0,u),c=a.clamp((this.top+i-this.bottom)/2,0,i);return new a.Point(n,c)},sl.prototype.equals=function(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right},sl.prototype.clone=function(){return new sl(this.top,this.bottom,this.left,this.right)},sl.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ni=function(i,n,c,y,_){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0||_,this._minZoom=i||0,this._maxZoom=n||22,this._minPitch=c==null?0:c,this._maxPitch=y==null?60:y,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new sl,this._posMatrixCache={},this._alignedPosMatrixCache={}},pa={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ni.prototype.clone=function(){var u=new Ni(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return u.tileSize=this.tileSize,u.latRange=this.latRange,u.width=this.width,u.height=this.height,u._center=this._center,u.zoom=this.zoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._calcMatrices(),u},pa.minZoom.get=function(){return this._minZoom},pa.minZoom.set=function(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))},pa.maxZoom.get=function(){return this._maxZoom},pa.maxZoom.set=function(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))},pa.minPitch.get=function(){return this._minPitch},pa.minPitch.set=function(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))},pa.maxPitch.get=function(){return this._maxPitch},pa.maxPitch.set=function(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))},pa.renderWorldCopies.get=function(){return this._renderWorldCopies},pa.renderWorldCopies.set=function(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u},pa.worldSize.get=function(){return this.tileSize*this.scale},pa.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},pa.size.get=function(){return new a.Point(this.width,this.height)},pa.bearing.get=function(){return-this.angle/Math.PI*180},pa.bearing.set=function(u){var i=-a.wrap(u,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},pa.pitch.get=function(){return this._pitch/Math.PI*180},pa.pitch.set=function(u){var i=a.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())},pa.fov.get=function(){return this._fov/Math.PI*180},pa.fov.set=function(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=u/180*Math.PI,this._calcMatrices())},pa.zoom.get=function(){return this._zoom},pa.zoom.set=function(u){var i=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom,this._constrain(),this._calcMatrices())},pa.center.get=function(){return this._center},pa.center.set=function(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._constrain(),this._calcMatrices())},pa.padding.get=function(){return this._edgeInsets.toJSON()},pa.padding.set=function(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())},pa.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ni.prototype.isPaddingEqual=function(u){return this._edgeInsets.equals(u)},Ni.prototype.interpolatePadding=function(u,i,n){this._unmodified=!1,this._edgeInsets.interpolate(u,i,n),this._constrain(),this._calcMatrices()},Ni.prototype.coveringZoomLevel=function(u){var i=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,i)},Ni.prototype.getVisibleUnwrappedCoordinates=function(u){var i=[new a.UnwrappedTileID(0,u)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new a.Point(0,0)),c=this.pointCoordinate(new a.Point(this.width,0)),y=this.pointCoordinate(new a.Point(this.width,this.height)),_=this.pointCoordinate(new a.Point(0,this.height)),O=Math.floor(Math.min(n.x,c.x,y.x,_.x)),k=Math.floor(Math.max(n.x,c.x,y.x,_.x)),ue=O-1;ue<=k+1;ue++)ue!==0&&i.push(new a.UnwrappedTileID(ue,u));return i},Ni.prototype.coveringTiles=function(u){var i=this.coveringZoomLevel(u),n=i;if(u.minzoom!==void 0&&i<u.minzoom)return[];u.maxzoom!==void 0&&i>u.maxzoom&&(i=u.maxzoom);var c=a.MercatorCoordinate.fromLngLat(this.center),y=Math.pow(2,i),_=[y*c.x,y*c.y,0],O=du.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i),k=u.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(k=i);var ue=function(yn){return{aabb:new ol([yn*y,0,0],[(yn+1)*y,y,0]),zoom:0,x:0,y:0,wrap:yn,fullyVisible:!1}},Ae=[],We=[],Je=i,rt=u.reparseOverscaled?n:i;if(this._renderWorldCopies)for(var Ft=1;Ft<=3;Ft++)Ae.push(ue(-Ft)),Ae.push(ue(Ft));for(Ae.push(ue(0));Ae.length>0;){var Rt=Ae.pop(),Yt=Rt.x,zt=Rt.y,Ut=Rt.fullyVisible;if(!Ut){var nr=Rt.aabb.intersects(O);if(nr===0)continue;Ut=nr===2}var rr=Rt.aabb.distanceX(_),Or=Rt.aabb.distanceY(_),hr=Math.max(Math.abs(rr),Math.abs(Or));if(Rt.zoom===Je||hr>3+(1<<Je-Rt.zoom)-2&&Rt.zoom>=k)We.push({tileID:new a.OverscaledTileID(Rt.zoom===Je?rt:Rt.zoom,Rt.wrap,Rt.zoom,Yt,zt),distanceSq:a.sqrLen([_[0]-.5-Yt,_[1]-.5-zt])});else for(var Tr=0;Tr<4;Tr++){var Cr=(Yt<<1)+Tr%2,an=(zt<<1)+(Tr>>1);Ae.push({aabb:Rt.aabb.quadrant(Tr),zoom:Rt.zoom+1,x:Cr,y:an,wrap:Rt.wrap,fullyVisible:Ut})}}return We.sort(function(Yr,yn){return Yr.distanceSq-yn.distanceSq}).map(function(Yr){return Yr.tileID})},Ni.prototype.resize=function(u,i){this.width=u,this.height=i,this.pixelsToGLUnits=[2/u,-2/i],this._constrain(),this._calcMatrices()},pa.unmodified.get=function(){return this._unmodified},Ni.prototype.zoomScale=function(u){return Math.pow(2,u)},Ni.prototype.scaleZoom=function(u){return Math.log(u)/Math.LN2},Ni.prototype.project=function(u){var i=a.clamp(u.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(u.lng)*this.worldSize,a.mercatorYfromLat(i)*this.worldSize)},Ni.prototype.unproject=function(u){return new a.MercatorCoordinate(u.x/this.worldSize,u.y/this.worldSize).toLngLat()},pa.point.get=function(){return this.project(this.center)},Ni.prototype.setLocationAtPoint=function(u,i){var n=this.pointCoordinate(i),c=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(u),_=new a.MercatorCoordinate(y.x-(n.x-c.x),y.y-(n.y-c.y));this.center=this.coordinateLocation(_),this._renderWorldCopies&&(this.center=this.center.wrap())},Ni.prototype.locationPoint=function(u){return this.coordinatePoint(this.locationCoordinate(u))},Ni.prototype.pointLocation=function(u){return this.coordinateLocation(this.pointCoordinate(u))},Ni.prototype.locationCoordinate=function(u){return a.MercatorCoordinate.fromLngLat(u)},Ni.prototype.coordinateLocation=function(u){return u.toLngLat()},Ni.prototype.pointCoordinate=function(u){var i=[u.x,u.y,0,1],n=[u.x,u.y,1,1];a.transformMat4(i,i,this.pixelMatrixInverse),a.transformMat4(n,n,this.pixelMatrixInverse);var c=i[3],y=n[3],_=i[1]/c,O=n[1]/y,k=i[2]/c,ue=n[2]/y,Ae=k===ue?0:(0-k)/(ue-k);return new a.MercatorCoordinate(a.number(i[0]/c,n[0]/y,Ae)/this.worldSize,a.number(_,O,Ae)/this.worldSize)},Ni.prototype.coordinatePoint=function(u){var i=[u.x*this.worldSize,u.y*this.worldSize,0,1];return a.transformMat4(i,i,this.pixelMatrix),new a.Point(i[0]/i[3],i[1]/i[3])},Ni.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},Ni.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ni.prototype.setMaxBounds=function(u){u?(this.lngRange=[u.getWest(),u.getEast()],this.latRange=[u.getSouth(),u.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ni.prototype.calculatePosMatrix=function(u,i){i===void 0&&(i=!1);var n=u.key,c=i?this._alignedPosMatrixCache:this._posMatrixCache;if(c[n])return c[n];var y=u.canonical,_=this.worldSize/this.zoomScale(y.z),O=y.x+Math.pow(2,y.z)*u.wrap,k=a.identity(new Float64Array(16));return a.translate(k,k,[O*_,y.y*_,0]),a.scale(k,k,[_/a.EXTENT,_/a.EXTENT,1]),a.multiply(k,i?this.alignedProjMatrix:this.projMatrix,k),c[n]=new Float32Array(k),c[n]},Ni.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ni.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var u,i,n,c,y=-90,_=90,O=-180,k=180,ue=this.size,Ae=this._unmodified;if(this.latRange){var We=this.latRange;y=a.mercatorYfromLat(We[1])*this.worldSize,u=(_=a.mercatorYfromLat(We[0])*this.worldSize)-y<ue.y?ue.y/(_-y):0}if(this.lngRange){var Je=this.lngRange;O=a.mercatorXfromLng(Je[0])*this.worldSize,i=(k=a.mercatorXfromLng(Je[1])*this.worldSize)-O<ue.x?ue.x/(k-O):0}var rt=this.point,Ft=Math.max(i||0,u||0);if(Ft)return this.center=this.unproject(new a.Point(i?(k+O)/2:rt.x,u?(_+y)/2:rt.y)),this.zoom+=this.scaleZoom(Ft),this._unmodified=Ae,void(this._constraining=!1);if(this.latRange){var Rt=rt.y,Yt=ue.y/2;Rt-Yt<y&&(c=y+Yt),Rt+Yt>_&&(c=_-Yt)}if(this.lngRange){var zt=rt.x,Ut=ue.x/2;zt-Ut<O&&(n=O+Ut),zt+Ut>k&&(n=k-Ut)}n===void 0&&c===void 0||(this.center=this.unproject(new a.Point(n!==void 0?n:rt.x,c!==void 0?c:rt.y))),this._unmodified=Ae,this._constraining=!1}},Ni.prototype._calcMatrices=function(){if(this.height){var u=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var i=Math.PI/2+this._pitch,n=this._fov*(.5+u.y/this.height),c=Math.sin(n)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-i-n,.01,Math.PI-.01)),y=this.point,_=y.x,O=y.y,k=1.01*(Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance),ue=this.height/50,Ae=new Float64Array(16);a.perspective(Ae,this._fov,this.width/this.height,ue,k),Ae[8]=2*-u.x/this.width,Ae[9]=2*u.y/this.height,a.scale(Ae,Ae,[1,-1,1]),a.translate(Ae,Ae,[0,0,-this.cameraToCenterDistance]),a.rotateX(Ae,Ae,this._pitch),a.rotateZ(Ae,Ae,this.angle),a.translate(Ae,Ae,[-_,-O,0]),this.mercatorMatrix=a.scale([],Ae,[this.worldSize,this.worldSize,this.worldSize]),a.scale(Ae,Ae,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ae,this.invProjMatrix=a.invert([],this.projMatrix);var We=this.width%2/2,Je=this.height%2/2,rt=Math.cos(this.angle),Ft=Math.sin(this.angle),Rt=_-Math.round(_)+rt*We+Ft*Je,Yt=O-Math.round(O)+rt*Je+Ft*We,zt=new Float64Array(Ae);if(a.translate(zt,zt,[Rt>.5?Rt-1:Rt,Yt>.5?Yt-1:Yt,0]),this.alignedProjMatrix=zt,Ae=a.create(),a.scale(Ae,Ae,[this.width/2,-this.height/2,1]),a.translate(Ae,Ae,[1,-1,0]),this.labelPlaneMatrix=Ae,Ae=a.create(),a.scale(Ae,Ae,[1,-1,1]),a.translate(Ae,Ae,[-1,-1,0]),a.scale(Ae,Ae,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ae,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ae=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ae,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ni.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var u=this.pointCoordinate(new a.Point(0,0)),i=[u.x*this.worldSize,u.y*this.worldSize,0,1];return a.transformMat4(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ni.prototype.getCameraPoint=function(){var u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,u))},Ni.prototype.getCameraQueryGeometry=function(u){var i=this.getCameraPoint();if(u.length===1)return[u[0],i];for(var n=i.x,c=i.y,y=i.x,_=i.y,O=0,k=u;O<k.length;O+=1){var ue=k[O];n=Math.min(n,ue.x),c=Math.min(c,ue.y),y=Math.max(y,ue.x),_=Math.max(_,ue.y)}return[new a.Point(n,c),new a.Point(y,c),new a.Point(y,_),new a.Point(n,_),new a.Point(n,c)]},Object.defineProperties(Ni.prototype,pa);var Ms=function(i){var n,c,y,_;this._hashName=i&&encodeURIComponent(i),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),c=!1,y=null,_=function(){y=null,c&&(n(),y=setTimeout(_,300),c=!1)},function(){return c=!0,y||_(),y})};Ms.prototype.addTo=function(u){return this._map=u,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ms.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ms.prototype.getHashString=function(u){var i=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,c=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,c),_=Math.round(i.lng*y)/y,O=Math.round(i.lat*y)/y,k=this._map.getBearing(),ue=this._map.getPitch(),Ae="";if(Ae+=u?"/"+_+"/"+O+"/"+n:n+"/"+O+"/"+_,(k||ue)&&(Ae+="/"+Math.round(10*k)/10),ue&&(Ae+="/"+Math.round(ue)),this._hashName){var We=this._hashName,Je=!1,rt=a.window.location.hash.slice(1).split("&").map(function(Ft){var Rt=Ft.split("=")[0];return Rt===We?(Je=!0,Rt+"="+Ae):Ft}).filter(function(Ft){return Ft});return Je||rt.push(We+"="+Ae),"#"+rt.join("&")}return"#"+Ae},Ms.prototype._getCurrentHash=function(){var u,i=this,n=a.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(c){return c.split("=")}).forEach(function(c){c[0]===i._hashName&&(u=c)}),(u&&u[1]||"").split("/")):n.split("/")},Ms.prototype._onHashChange=function(){var u=this._getCurrentHash();if(u.length>=3&&!u.some(function(n){return isNaN(n)})){var i=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:i,pitch:+(u[4]||0)}),!0}return!1},Ms.prototype._updateHashUnthrottled=function(){var u=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,u)}catch(i){}};var Ea={linearity:.3,easing:a.bezier(0,0,.3,1)},Zi=a.extend({deceleration:2500,maxSpeed:1400},Ea),ql=a.extend({deceleration:20,maxSpeed:1400},Ea),yf=a.extend({deceleration:1e3,maxSpeed:360},Ea),as=a.extend({deceleration:1e3,maxSpeed:90},Ea),ul=function(i){this._map=i,this.clear()};function pu(u,i){(!u.duration||u.duration<i.duration)&&(u.duration=i.duration,u.easing=i.easing)}function Xu(u,i,n){var c=n.maxSpeed,y=n.linearity,_=n.deceleration,O=a.clamp(u*y/(i/1e3),-c,c),k=Math.abs(O)/(_*y);return{easing:n.easing,duration:1e3*k,amount:O*(k/2)}}ul.prototype.clear=function(){this._inertiaBuffer=[]},ul.prototype.record=function(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:u})},ul.prototype._drainInertiaBuffer=function(){for(var u=this._inertiaBuffer,i=a.browser.now();u.length>0&&i-u[0].time>160;)u.shift()},ul.prototype._onMoveEnd=function(u){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var i={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},n=0,c=this._inertiaBuffer;n<c.length;n+=1){var y=c[n].settings;i.zoom+=y.zoomDelta||0,i.bearing+=y.bearingDelta||0,i.pitch+=y.pitchDelta||0,y.panDelta&&i.pan._add(y.panDelta),y.around&&(i.around=y.around),y.pinchAround&&(i.pinchAround=y.pinchAround)}var _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,O={};if(i.pan.mag()){var k=Xu(i.pan.mag(),_,a.extend({},Zi,u||{}));O.offset=i.pan.mult(k.amount/i.pan.mag()),O.center=this._map.transform.center,pu(O,k)}if(i.zoom){var ue=Xu(i.zoom,_,ql);O.zoom=this._map.transform.zoom+ue.amount,pu(O,ue)}if(i.bearing){var Ae=Xu(i.bearing,_,yf);O.bearing=this._map.transform.bearing+a.clamp(Ae.amount,-179,179),pu(O,Ae)}if(i.pitch){var We=Xu(i.pitch,_,as);O.pitch=this._map.transform.pitch+We.amount,pu(O,We)}if(O.zoom||O.bearing){var Je=i.pinchAround===void 0?i.around:i.pinchAround;O.around=Je?this._map.unproject(Je):this._map.getCenter()}return this.clear(),a.extend(O,{noMoveStart:!0})}};var oo=function(u){function i(c,y,_,O){O===void 0&&(O={});var k=B.mousePos(y.getCanvasContainer(),_),ue=y.unproject(k);u.call(this,c,a.extend({point:k,lngLat:ue,originalEvent:_},O)),this._defaultPrevented=!1,this.target=y}u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i;var n={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(a.Event),os=function(u){function i(c,y,_){var O=c==="touchend"?_.changedTouches:_.touches,k=B.touchPos(y.getCanvasContainer(),O),ue=k.map(function(Je){return y.unproject(Je)}),Ae=k.reduce(function(Je,rt,Ft,Rt){return Je.add(rt.div(Rt.length))},new a.Point(0,0)),We=y.unproject(Ae);u.call(this,c,{points:k,point:Ae,lngLats:ue,lngLat:We,originalEvent:_}),this._defaultPrevented=!1}u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i;var n={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(a.Event),Nl=function(u){function i(c,y,_){u.call(this,c,{originalEvent:_}),this._defaultPrevented=!1}u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i;var n={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(a.Event),ho=function(i,n){this._map=i,this._clickTolerance=n.clickTolerance};ho.prototype.reset=function(){delete this._mousedownPos},ho.prototype.wheel=function(u){return this._firePreventable(new Nl(u.type,this._map,u))},ho.prototype.mousedown=function(u,i){return this._mousedownPos=i,this._firePreventable(new oo(u.type,this._map,u))},ho.prototype.mouseup=function(u){this._map.fire(new oo(u.type,this._map,u))},ho.prototype.click=function(u,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new oo(u.type,this._map,u))},ho.prototype.dblclick=function(u){return this._firePreventable(new oo(u.type,this._map,u))},ho.prototype.mouseover=function(u){this._map.fire(new oo(u.type,this._map,u))},ho.prototype.mouseout=function(u){this._map.fire(new oo(u.type,this._map,u))},ho.prototype.touchstart=function(u){return this._firePreventable(new os(u.type,this._map,u))},ho.prototype.touchmove=function(u){this._map.fire(new os(u.type,this._map,u))},ho.prototype.touchend=function(u){this._map.fire(new os(u.type,this._map,u))},ho.prototype.touchcancel=function(u){this._map.fire(new os(u.type,this._map,u))},ho.prototype._firePreventable=function(u){if(this._map.fire(u),u.defaultPrevented)return{}},ho.prototype.isEnabled=function(){return!0},ho.prototype.isActive=function(){return!1},ho.prototype.enable=function(){},ho.prototype.disable=function(){};var In=function(i){this._map=i};In.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},In.prototype.mousemove=function(u){this._map.fire(new oo(u.type,this._map,u))},In.prototype.mousedown=function(){this._delayContextMenu=!0},In.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new oo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},In.prototype.contextmenu=function(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new oo(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()},In.prototype.isEnabled=function(){return!0},In.prototype.isActive=function(){return!1},In.prototype.enable=function(){},In.prototype.disable=function(){};var js=function(i,n){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=n.clickTolerance||1};function bc(u,i){for(var n={},c=0;c<u.length;c++)n[u[c].identifier]=i[c];return n}js.prototype.isEnabled=function(){return!!this._enabled},js.prototype.isActive=function(){return!!this._active},js.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},js.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},js.prototype.mousedown=function(u,i){this.isEnabled()&&u.shiftKey&&u.button===0&&(B.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)},js.prototype.mousemoveWindow=function(u,i){if(this._active){var n=i;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var c=this._startPos;this._lastPos=n,this._box||(this._box=B.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));var y=Math.min(c.x,n.x),_=Math.max(c.x,n.x),O=Math.min(c.y,n.y),k=Math.max(c.y,n.y);B.setTransform(this._box,"translate("+y+"px,"+O+"px)"),this._box.style.width=_-y+"px",this._box.style.height=k-O+"px"}}},js.prototype.mouseupWindow=function(u,i){var n=this;if(this._active&&u.button===0){var c=this._startPos,y=i;if(this.reset(),B.suppressClick(),c.x!==y.x||c.y!==y.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:function(O){return O.fitScreenCoordinates(c,y,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",u)}},js.prototype.keydown=function(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))},js.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(B.remove(this._box),this._box=null),B.enableDrag(),delete this._startPos,delete this._lastPos},js.prototype._fireEvent=function(u,i){return this._map.fire(new a.Event(u,{originalEvent:i}))};var El=function(i){this.reset(),this.numTouches=i.numTouches};El.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},El.prototype.touchstart=function(u,i,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=u.timeStamp),n.length===this.numTouches&&(this.centroid=function(c){for(var y=new a.Point(0,0),_=0,O=c;_<O.length;_+=1)y._add(O[_]);return y.div(c.length)}(i),this.touches=bc(n,i)))},El.prototype.touchmove=function(u,i,n){if(!this.aborted&&this.centroid){var c=bc(n,i);for(var y in this.touches){var _=c[y];(!_||_.dist(this.touches[y])>30)&&(this.aborted=!0)}}},El.prototype.touchend=function(u,i,n){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var c=!this.aborted&&this.centroid;if(this.reset(),c)return c}};var Pu=function(i){this.singleTap=new El(i),this.numTaps=i.numTaps,this.reset()};Pu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Pu.prototype.touchstart=function(u,i,n){this.singleTap.touchstart(u,i,n)},Pu.prototype.touchmove=function(u,i,n){this.singleTap.touchmove(u,i,n)},Pu.prototype.touchend=function(u,i,n){var c=this.singleTap.touchend(u,i,n);if(c){var y=u.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(c)<30;if(y&&_||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}};var Us=function(){this._zoomIn=new Pu({numTouches:1,numTaps:2}),this._zoomOut=new Pu({numTouches:2,numTaps:1}),this.reset()};Us.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Us.prototype.touchstart=function(u,i,n){this._zoomIn.touchstart(u,i,n),this._zoomOut.touchstart(u,i,n)},Us.prototype.touchmove=function(u,i,n){this._zoomIn.touchmove(u,i,n),this._zoomOut.touchmove(u,i,n)},Us.prototype.touchend=function(u,i,n){var c=this,y=this._zoomIn.touchend(u,i,n),_=this._zoomOut.touchend(u,i,n);return y?(this._active=!0,u.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(y)},{originalEvent:u})}}):_?(this._active=!0,u.preventDefault(),setTimeout(function(){return c.reset()},0),{cameraAnimation:function(k){return k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(_)},{originalEvent:u})}}):void 0},Us.prototype.touchcancel=function(){this.reset()},Us.prototype.enable=function(){this._enabled=!0},Us.prototype.disable=function(){this._enabled=!1,this.reset()},Us.prototype.isEnabled=function(){return this._enabled},Us.prototype.isActive=function(){return this._active};var ea={0:1,2:2},en=function(i){this.reset(),this._clickTolerance=i.clickTolerance||1};en.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},en.prototype._correctButton=function(u,i){return!1},en.prototype._move=function(u,i){return{}},en.prototype.mousedown=function(u,i){if(!this._lastPoint){var n=B.mouseButton(u);this._correctButton(u,n)&&(this._lastPoint=i,this._eventButton=n)}},en.prototype.mousemoveWindow=function(u,i){var n=this._lastPoint;if(n){if(u.preventDefault(),function(c,y){var _=ea[y];return c.buttons===void 0||(c.buttons&_)!==_}(u,this._eventButton))this.reset();else if(this._moved||!(i.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=i,this._move(n,i)}},en.prototype.mouseupWindow=function(u){this._lastPoint&&B.mouseButton(u)===this._eventButton&&(this._moved&&B.suppressClick(),this.reset())},en.prototype.enable=function(){this._enabled=!0},en.prototype.disable=function(){this._enabled=!1,this.reset()},en.prototype.isEnabled=function(){return this._enabled},en.prototype.isActive=function(){return this._active};var kc=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.mousedown=function(n,c){u.prototype.mousedown.call(this,n,c),this._lastPoint&&(this._active=!0)},i.prototype._correctButton=function(n,c){return c===0&&!n.ctrlKey},i.prototype._move=function(n,c){return{around:c,panDelta:c.sub(n)}},i}(en),Sc=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype._correctButton=function(n,c){return c===0&&n.ctrlKey||c===2},i.prototype._move=function(n,c){var y=.8*(c.x-n.x);if(y)return this._active=!0,{bearingDelta:y}},i.prototype.contextmenu=function(n){n.preventDefault()},i}(en),ll=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype._correctButton=function(n,c){return c===0&&n.ctrlKey||c===2},i.prototype._move=function(n,c){var y=-.5*(c.y-n.y);if(y)return this._active=!0,{pitchDelta:y}},i.prototype.contextmenu=function(n){n.preventDefault()},i}(en),vu=function(i){this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset()};vu.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},vu.prototype.touchstart=function(u,i,n){return this._calculateTransform(u,i,n)},vu.prototype.touchmove=function(u,i,n){if(this._active&&!(n.length<this._minTouches))return u.preventDefault(),this._calculateTransform(u,i,n)},vu.prototype.touchend=function(u,i,n){this._calculateTransform(u,i,n),this._active&&n.length<this._minTouches&&this.reset()},vu.prototype.touchcancel=function(){this.reset()},vu.prototype._calculateTransform=function(u,i,n){n.length>0&&(this._active=!0);var c=bc(n,i),y=new a.Point(0,0),_=new a.Point(0,0),O=0;for(var k in c){var ue=c[k],Ae=this._touches[k];Ae&&(y._add(ue),_._add(ue.sub(Ae)),O++,c[k]=ue)}if(this._touches=c,!(O<this._minTouches)&&_.mag()){var We=_.div(O);if(this._sum._add(We),!(this._sum.mag()<this._clickTolerance))return{around:y.div(O),panDelta:We}}},vu.prototype.enable=function(){this._enabled=!0},vu.prototype.disable=function(){this._enabled=!1,this.reset()},vu.prototype.isEnabled=function(){return this._enabled},vu.prototype.isActive=function(){return this._active};var Is=function(){this.reset()};function Os(u,i,n){for(var c=0;c<u.length;c++)if(u[c].identifier===n)return i[c]}function $o(u,i){return Math.log(u/i)/Math.LN2}Is.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Is.prototype._start=function(u){},Is.prototype._move=function(u,i,n){return{}},Is.prototype.touchstart=function(u,i,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([i[0],i[1]]))},Is.prototype.touchmove=function(u,i,n){if(this._firstTwoTouches){u.preventDefault();var c=this._firstTwoTouches,y=c[1],_=Os(n,i,c[0]),O=Os(n,i,y);if(_&&O){var k=this._aroundCenter?null:_.add(O).div(2);return this._move([_,O],k,u)}}},Is.prototype.touchend=function(u,i,n){if(this._firstTwoTouches){var c=this._firstTwoTouches,y=c[1],_=Os(n,i,c[0]),O=Os(n,i,y);_&&O||(this._active&&B.suppressClick(),this.reset())}},Is.prototype.touchcancel=function(){this.reset()},Is.prototype.enable=function(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"},Is.prototype.disable=function(){this._enabled=!1,this.reset()},Is.prototype.isEnabled=function(){return this._enabled},Is.prototype.isActive=function(){return this._active};var ko=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.reset=function(){u.prototype.reset.call(this),delete this._distance,delete this._startDistance},i.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},i.prototype._move=function(n,c){var y=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs($o(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$o(this._distance,y),pinchAround:c}},i}(Is);function cl(u,i){return 180*u.angleWith(i)/Math.PI}var Tl=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.reset=function(){u.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},i.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},i.prototype._move=function(n,c){var y=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:cl(this._vector,y),pinchAround:c}},i.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var c=25/(Math.PI*this._minDiameter)*360,y=cl(n,this._startVector);return Math.abs(y)<c},i}(Is);function Fl(u){return Math.abs(u.y)>Math.abs(u.x)}var af=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.reset=function(){u.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},i.prototype._start=function(n){this._lastPoints=n,Fl(n[0].sub(n[1]))&&(this._valid=!1)},i.prototype._move=function(n,c,y){var _=n[0].sub(this._lastPoints[0]),O=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(_,O,y.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(_.y+O.y)/2*-.5}},i.prototype.gestureBeginsVertically=function(n,c,y){if(this._valid!==void 0)return this._valid;var _=n.mag()>=2,O=c.mag()>=2;if(_||O){if(!_||!O)return this._firstMove===void 0&&(this._firstMove=y),y-this._firstMove<100&&void 0;var k=n.y>0==c.y>0;return Fl(n)&&Fl(c)&&k}},i}(Is),Bl={panStep:100,bearingStep:15,pitchStep:10},Ls=function(){var i=Bl;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1};function ss(u){return u*(2-u)}Ls.prototype.reset=function(){this._active=!1},Ls.prototype.keydown=function(u){var i=this;if(!(u.altKey||u.ctrlKey||u.metaKey)){var n=0,c=0,y=0,_=0,O=0;switch(u.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:u.shiftKey?c=-1:(u.preventDefault(),_=-1);break;case 39:u.shiftKey?c=1:(u.preventDefault(),_=1);break;case 38:u.shiftKey?y=1:(u.preventDefault(),O=-1);break;case 40:u.shiftKey?y=-1:(u.preventDefault(),O=1);break;default:return}return this._rotationDisabled&&(c=0,y=0),{cameraAnimation:function(ue){var Ae=ue.getZoom();ue.easeTo({duration:300,easeId:"keyboardHandler",easing:ss,zoom:n?Math.round(Ae)+n*(u.shiftKey?2:1):Ae,bearing:ue.getBearing()+c*i._bearingStep,pitch:ue.getPitch()+y*i._pitchStep,offset:[-_*i._panStep,-O*i._panStep],center:ue.getCenter()},{originalEvent:u})}}}},Ls.prototype.enable=function(){this._enabled=!0},Ls.prototype.disable=function(){this._enabled=!1,this.reset()},Ls.prototype.isEnabled=function(){return this._enabled},Ls.prototype.isActive=function(){return this._active},Ls.prototype.disableRotation=function(){this._rotationDisabled=!0},Ls.prototype.enableRotation=function(){this._rotationDisabled=!1};var Oi=function(i,n){this._map=i,this._el=i.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};Oi.prototype.setZoomRate=function(u){this._defaultZoomRate=u},Oi.prototype.setWheelZoomRate=function(u){this._wheelZoomRate=u},Oi.prototype.isEnabled=function(){return!!this._enabled},Oi.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Oi.prototype.isZooming=function(){return!!this._zooming},Oi.prototype.enable=function(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=u&&u.around==="center")},Oi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Oi.prototype.wheel=function(u){if(this.isEnabled()){var i=u.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY,n=a.browser.now(),c=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,i!==0&&i%4.000244140625==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(c*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),u.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=u,this._delta-=i,this._active||this._start(u)),u.preventDefault()}},Oi.prototype._onTimeout=function(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},Oi.prototype._start=function(u){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var i=B.mousePos(this._el,u);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(i)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Oi.prototype.renderFrame=function(){var u=this;if(this._frameId&&(this._frameId=null,this.isActive())){var i=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,c=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&c!==0&&(c=1/c);var y=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(y*c))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var _,O=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,k=this._startZoom,ue=this._easing,Ae=!1;if(this._type==="wheel"&&k&&ue){var We=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),Je=ue(We);_=a.number(k,O,Je),We<1?this._frameId||(this._frameId=!0):Ae=!0}else _=O,Ae=!0;return this._active=!0,Ae&&(this._active=!1,this._finishTimeout=setTimeout(function(){u._zooming=!1,u._handler._triggerRenderFrame(),delete u._targetZoom,delete u._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ae,zoomDelta:_-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Oi.prototype._smoothOutEasing=function(u){var i=a.ease;if(this._prevEase){var n=this._prevEase,c=(a.browser.now()-n.start)/n.duration,y=n.easing(c+.01)-n.easing(c),_=.27/Math.sqrt(y*y+1e-4)*.01,O=Math.sqrt(.0729-_*_);i=a.bezier(_,O,.25,1)}return this._prevEase={start:a.browser.now(),duration:u,easing:i},i},Oi.prototype.reset=function(){this._active=!1};var Yu=function(i,n){this._clickZoom=i,this._tapZoom=n};Yu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Yu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Yu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Yu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Va=function(){this.reset()};Va.prototype.reset=function(){this._active=!1},Va.prototype.dblclick=function(u,i){return u.preventDefault(),{cameraAnimation:function(c){c.easeTo({duration:300,zoom:c.getZoom()+(u.shiftKey?-1:1),around:c.unproject(i)},{originalEvent:u})}}},Va.prototype.enable=function(){this._enabled=!0},Va.prototype.disable=function(){this._enabled=!1,this.reset()},Va.prototype.isEnabled=function(){return this._enabled},Va.prototype.isActive=function(){return this._active};var Mo=function(){this._tap=new Pu({numTouches:1,numTaps:1}),this.reset()};Mo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Mo.prototype.touchstart=function(u,i,n){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=i[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(u,i,n))},Mo.prototype.touchmove=function(u,i,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var c=i[0],y=c.y-this._swipePoint.y;return this._swipePoint=c,u.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(u,i,n)},Mo.prototype.touchend=function(u,i,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(u,i,n)&&(this._tapTime=u.timeStamp)},Mo.prototype.touchcancel=function(){this.reset()},Mo.prototype.enable=function(){this._enabled=!0},Mo.prototype.disable=function(){this._enabled=!1,this.reset()},Mo.prototype.isEnabled=function(){return this._enabled},Mo.prototype.isActive=function(){return this._active};var Al=function(i,n,c){this._el=i,this._mousePan=n,this._touchPan=c};Al.prototype.enable=function(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Al.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Al.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Al.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var mu=function(i,n,c){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=n,this._mousePitch=c};mu.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},mu.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},mu.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},mu.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var gu=function(i,n,c,y){this._el=i,this._touchZoom=n,this._touchRotate=c,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0};gu.prototype.enable=function(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},gu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},gu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},gu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},gu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},gu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Ts=function(i){return i.zoom||i.drag||i.pitch||i.rotate},Ec=function(u){function i(){u.apply(this,arguments)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i}(a.Event);function $n(u){return u.panDelta&&u.panDelta.mag()||u.zoomDelta||u.bearingDelta||u.pitchDelta}var Fn=function(i,n){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ul(i),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),a.bindAll(["handleEvent","handleWindowEvent"],this);var c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[a.window,"blur",void 0]];for(var y=0,_=this._listeners;y<_.length;y+=1){var O=_[y],k=O[0];B.addEventListener(k,O[1],k===a.window.document?this.handleWindowEvent:this.handleEvent,O[2])}};Fn.prototype.destroy=function(){for(var u=0,i=this._listeners;u<i.length;u+=1){var n=i[u],c=n[0];B.removeEventListener(c,n[1],c===a.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},Fn.prototype._addDefaultHandlers=function(u){var i=this._map,n=i.getCanvasContainer();this._add("mapEvent",new ho(i,u));var c=i.boxZoom=new js(i,u);this._add("boxZoom",c);var y=new Us,_=new Va;i.doubleClickZoom=new Yu(_,y),this._add("tapZoom",y),this._add("clickZoom",_);var O=new Mo;this._add("tapDragZoom",O);var k=i.touchPitch=new af;this._add("touchPitch",k);var ue=new Sc(u),Ae=new ll(u);i.dragRotate=new mu(u,ue,Ae),this._add("mouseRotate",ue,["mousePitch"]),this._add("mousePitch",Ae,["mouseRotate"]);var We=new kc(u),Je=new vu(u);i.dragPan=new Al(n,We,Je),this._add("mousePan",We),this._add("touchPan",Je,["touchZoom","touchRotate"]);var rt=new Tl,Ft=new ko;i.touchZoomRotate=new gu(n,Ft,rt,O),this._add("touchRotate",rt,["touchPan","touchZoom"]),this._add("touchZoom",Ft,["touchPan","touchRotate"]);var Rt=i.scrollZoom=new Oi(i,this);this._add("scrollZoom",Rt,["mousePan"]);var Yt=i.keyboard=new Ls;this._add("keyboard",Yt),this._add("blockableMapEvent",new In(i));for(var zt=0,Ut=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];zt<Ut.length;zt+=1){var nr=Ut[zt];u.interactive&&u[nr]&&i[nr].enable(u[nr])}},Fn.prototype._add=function(u,i,n){this._handlers.push({handlerName:u,handler:i,allowed:n}),this._handlersById[u]=i},Fn.prototype.stop=function(u){if(!this._updatingCamera){for(var i=0,n=this._handlers;i<n.length;i+=1)n[i].handler.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}},Fn.prototype.isActive=function(){for(var u=0,i=this._handlers;u<i.length;u+=1)if(i[u].handler.isActive())return!0;return!1},Fn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Fn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Fn.prototype.isMoving=function(){return Boolean(Ts(this._eventsInProgress))||this.isZooming()},Fn.prototype._blockedByActive=function(u,i,n){for(var c in u)if(c!==n&&(!i||i.indexOf(c)<0))return!0;return!1},Fn.prototype.handleWindowEvent=function(u){this.handleEvent(u,u.type+"Window")},Fn.prototype._getMapTouches=function(u){for(var i=[],n=0,c=u;n<c.length;n+=1){var y=c[n];this._el.contains(y.target)&&i.push(y)}return i},Fn.prototype.handleEvent=function(u,i){if(u.type!=="blur"){this._updatingCamera=!0;for(var n=u.type==="renderFrame"?void 0:u,c={needsRenderFrame:!1},y={},_={},O=u.touches?this._getMapTouches(u.touches):void 0,k=O?B.touchPos(this._el,O):B.mousePos(this._el,u),ue=0,Ae=this._handlers;ue<Ae.length;ue+=1){var We=Ae[ue],Je=We.handlerName,rt=We.handler,Ft=We.allowed;if(rt.isEnabled()){var Rt=void 0;this._blockedByActive(_,Ft,Je)?rt.reset():rt[i||u.type]&&(Rt=rt[i||u.type](u,k,O),this.mergeHandlerResult(c,y,Rt,Je,n),Rt&&Rt.needsRenderFrame&&this._triggerRenderFrame()),(Rt||rt.isActive())&&(_[Je]=rt)}}var Yt={};for(var zt in this._previousActiveHandlers)_[zt]||(Yt[zt]=n);this._previousActiveHandlers=_,(Object.keys(Yt).length||$n(c))&&(this._changes.push([c,y,Yt]),this._triggerRenderFrame()),(Object.keys(_).length||$n(c))&&this._map._stop(!0),this._updatingCamera=!1;var Ut=c.cameraAnimation;Ut&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ut(this._map))}else this.stop(!0)},Fn.prototype.mergeHandlerResult=function(u,i,n,c,y){if(n){a.extend(u,n);var _={handlerName:c,originalEvent:n.originalEvent||y};n.zoomDelta!==void 0&&(i.zoom=_),n.panDelta!==void 0&&(i.drag=_),n.pitchDelta!==void 0&&(i.pitch=_),n.bearingDelta!==void 0&&(i.rotate=_)}},Fn.prototype._applyChanges=function(){for(var u={},i={},n={},c=0,y=this._changes;c<y.length;c+=1){var _=y[c],O=_[0],k=_[1],ue=_[2];O.panDelta&&(u.panDelta=(u.panDelta||new a.Point(0,0))._add(O.panDelta)),O.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+O.zoomDelta),O.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+O.bearingDelta),O.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+O.pitchDelta),O.around!==void 0&&(u.around=O.around),O.pinchAround!==void 0&&(u.pinchAround=O.pinchAround),O.noInertia&&(u.noInertia=O.noInertia),a.extend(i,k),a.extend(n,ue)}this._updateMapTransform(u,i,n),this._changes=[]},Fn.prototype._updateMapTransform=function(u,i,n){var c=this._map,y=c.transform;if(!$n(u))return this._fireEvents(i,n,!0);var _=u.panDelta,O=u.zoomDelta,k=u.bearingDelta,ue=u.pitchDelta,Ae=u.around,We=u.pinchAround;We!==void 0&&(Ae=We),c._stop(!0),Ae=Ae||c.transform.centerPoint;var Je=y.pointLocation(_?Ae.sub(_):Ae);k&&(y.bearing+=k),ue&&(y.pitch+=ue),O&&(y.zoom+=O),y.setLocationAtPoint(Je,Ae),this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(i,n,!0)},Fn.prototype._fireEvents=function(u,i,n){var c=this,y=Ts(this._eventsInProgress),_=Ts(u),O={};for(var k in u)this._eventsInProgress[k]||(O[k+"start"]=u[k].originalEvent),this._eventsInProgress[k]=u[k];for(var ue in!y&&_&&this._fireEvent("movestart",_.originalEvent),O)this._fireEvent(ue,O[ue]);for(var Ae in _&&this._fireEvent("move",_.originalEvent),u)this._fireEvent(Ae,u[Ae].originalEvent);var We,Je={};for(var rt in this._eventsInProgress){var Ft=this._eventsInProgress[rt],Rt=Ft.handlerName,Yt=Ft.originalEvent;this._handlersById[Rt].isActive()||(delete this._eventsInProgress[rt],Je[rt+"end"]=We=i[Rt]||Yt)}for(var zt in Je)this._fireEvent(zt,Je[zt]);var Ut=Ts(this._eventsInProgress);if(n&&(y||_)&&!Ut){this._updatingCamera=!0;var nr=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),rr=function(hr){return hr!==0&&-c._bearingSnap<hr&&hr<c._bearingSnap};nr?(rr(nr.bearing||this._map.getBearing())&&(nr.bearing=0),this._map.easeTo(nr,{originalEvent:We})):(this._map.fire(new a.Event("moveend",{originalEvent:We})),rr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Fn.prototype._fireEvent=function(u,i){this._map.fire(new a.Event(u,i?{originalEvent:i}:{}))},Fn.prototype._requestFrame=function(){var u=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(i){delete u._frameId,u.handleEvent(new Ec("renderFrame",{timeStamp:i})),u._applyChanges()})},Fn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Tc=function(u){function i(n,c){u.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},i.prototype.setCenter=function(n,c){return this.jumpTo({center:n},c)},i.prototype.panBy=function(n,c,y){return n=a.Point.convert(n).mult(-1),this.panTo(this.transform.center,a.extend({offset:n},c),y)},i.prototype.panTo=function(n,c,y){return this.easeTo(a.extend({center:n},c),y)},i.prototype.getZoom=function(){return this.transform.zoom},i.prototype.setZoom=function(n,c){return this.jumpTo({zoom:n},c),this},i.prototype.zoomTo=function(n,c,y){return this.easeTo(a.extend({zoom:n},c),y)},i.prototype.zoomIn=function(n,c){return this.zoomTo(this.getZoom()+1,n,c),this},i.prototype.zoomOut=function(n,c){return this.zoomTo(this.getZoom()-1,n,c),this},i.prototype.getBearing=function(){return this.transform.bearing},i.prototype.setBearing=function(n,c){return this.jumpTo({bearing:n},c),this},i.prototype.getPadding=function(){return this.transform.padding},i.prototype.setPadding=function(n,c){return this.jumpTo({padding:n},c),this},i.prototype.rotateTo=function(n,c,y){return this.easeTo(a.extend({bearing:n},c),y)},i.prototype.resetNorth=function(n,c){return this.rotateTo(0,a.extend({duration:1e3},n),c),this},i.prototype.resetNorthPitch=function(n,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},n),c),this},i.prototype.snapToNorth=function(n,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,c):this},i.prototype.getPitch=function(){return this.transform.pitch},i.prototype.setPitch=function(n,c){return this.jumpTo({pitch:n},c),this},i.prototype.cameraForBounds=function(n,c){n=a.LngLatBounds.convert(n);var y=c&&c.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),y,c)},i.prototype._cameraForBoxAndBearing=function(n,c,y,_){var O={top:0,bottom:0,right:0,left:0};if(typeof(_=a.extend({padding:O,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){var k=_.padding;_.padding={top:k,bottom:k,right:k,left:k}}_.padding=a.extend(O,_.padding);var ue=this.transform,Ae=ue.padding,We=ue.project(a.LngLat.convert(n)),Je=ue.project(a.LngLat.convert(c)),rt=We.rotate(-y*Math.PI/180),Ft=Je.rotate(-y*Math.PI/180),Rt=new a.Point(Math.max(rt.x,Ft.x),Math.max(rt.y,Ft.y)),Yt=new a.Point(Math.min(rt.x,Ft.x),Math.min(rt.y,Ft.y)),zt=Rt.sub(Yt),Ut=(ue.width-(Ae.left+Ae.right+_.padding.left+_.padding.right))/zt.x,nr=(ue.height-(Ae.top+Ae.bottom+_.padding.top+_.padding.bottom))/zt.y;if(!(nr<0||Ut<0)){var rr=Math.min(ue.scaleZoom(ue.scale*Math.min(Ut,nr)),_.maxZoom),Or=typeof _.offset.x=="number"?new a.Point(_.offset.x,_.offset.y):a.Point.convert(_.offset),hr=new a.Point((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(y*Math.PI/180),Tr=Or.add(hr).mult(ue.scale/ue.zoomScale(rr));return{center:ue.unproject(We.add(Je).div(2).sub(Tr)),zoom:rr,bearing:y}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},i.prototype.fitBounds=function(n,c,y){return this._fitInternal(this.cameraForBounds(n,c),c,y)},i.prototype.fitScreenCoordinates=function(n,c,y,_,O){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(n)),this.transform.pointLocation(a.Point.convert(c)),y,_),_,O)},i.prototype._fitInternal=function(n,c,y){return n?(delete(c=a.extend(n,c)).padding,c.linear?this.easeTo(c,y):this.flyTo(c,y)):this},i.prototype.jumpTo=function(n,c){this.stop();var y=this.transform,_=!1,O=!1,k=!1;return"zoom"in n&&y.zoom!==+n.zoom&&(_=!0,y.zoom=+n.zoom),n.center!==void 0&&(y.center=a.LngLat.convert(n.center)),"bearing"in n&&y.bearing!==+n.bearing&&(O=!0,y.bearing=+n.bearing),"pitch"in n&&y.pitch!==+n.pitch&&(k=!0,y.pitch=+n.pitch),n.padding==null||y.isPaddingEqual(n.padding)||(y.padding=n.padding),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),_&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),O&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),k&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},i.prototype.easeTo=function(n,c){var y=this;this._stop(!1,n.easeId),((n=a.extend({offset:[0,0],duration:500,easing:a.ease},n)).animate===!1||!n.essential&&a.browser.prefersReducedMotion)&&(n.duration=0);var _=this.transform,O=this.getZoom(),k=this.getBearing(),ue=this.getPitch(),Ae=this.getPadding(),We="zoom"in n?+n.zoom:O,Je="bearing"in n?this._normalizeBearing(n.bearing,k):k,rt="pitch"in n?+n.pitch:ue,Ft="padding"in n?n.padding:_.padding,Rt=a.Point.convert(n.offset),Yt=_.centerPoint.add(Rt),zt=_.pointLocation(Yt),Ut=a.LngLat.convert(n.center||zt);this._normalizeCenter(Ut);var nr,rr,Or=_.project(zt),hr=_.project(Ut).sub(Or),Tr=_.zoomScale(We-O);n.around&&(nr=a.LngLat.convert(n.around),rr=_.locationPoint(nr));var Cr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||We!==O,this._rotating=this._rotating||k!==Je,this._pitching=this._pitching||rt!==ue,this._padding=!_.isPaddingEqual(Ft),this._easeId=n.easeId,this._prepareEase(c,n.noMoveStart,Cr),this._ease(function(an){if(y._zooming&&(_.zoom=a.number(O,We,an)),y._rotating&&(_.bearing=a.number(k,Je,an)),y._pitching&&(_.pitch=a.number(ue,rt,an)),y._padding&&(_.interpolatePadding(Ae,Ft,an),Yt=_.centerPoint.add(Rt)),nr)_.setLocationAtPoint(nr,rr);else{var Yr=_.zoomScale(_.zoom-O),yn=We>O?Math.min(2,Tr):Math.max(.5,Tr),On=Math.pow(yn,1-an),Qn=_.unproject(Or.add(hr.mult(an*On)).mult(Yr));_.setLocationAtPoint(_.renderWorldCopies?Qn.wrap():Qn,Yt)}y._fireMoveEvents(c)},function(an){y._afterEase(c,an)},n),this},i.prototype._prepareEase=function(n,c,y){y===void 0&&(y={}),this._moving=!0,c||y.moving||this.fire(new a.Event("movestart",n)),this._zooming&&!y.zooming&&this.fire(new a.Event("zoomstart",n)),this._rotating&&!y.rotating&&this.fire(new a.Event("rotatestart",n)),this._pitching&&!y.pitching&&this.fire(new a.Event("pitchstart",n))},i.prototype._fireMoveEvents=function(n){this.fire(new a.Event("move",n)),this._zooming&&this.fire(new a.Event("zoom",n)),this._rotating&&this.fire(new a.Event("rotate",n)),this._pitching&&this.fire(new a.Event("pitch",n))},i.prototype._afterEase=function(n,c){if(!this._easeId||!c||this._easeId!==c){delete this._easeId;var y=this._zooming,_=this._rotating,O=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new a.Event("zoomend",n)),_&&this.fire(new a.Event("rotateend",n)),O&&this.fire(new a.Event("pitchend",n)),this.fire(new a.Event("moveend",n))}},i.prototype.flyTo=function(n,c){var y=this;if(!n.essential&&a.browser.prefersReducedMotion){var _=a.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(_,c)}this.stop(),n=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},n);var O=this.transform,k=this.getZoom(),ue=this.getBearing(),Ae=this.getPitch(),We=this.getPadding(),Je="zoom"in n?a.clamp(+n.zoom,O.minZoom,O.maxZoom):k,rt="bearing"in n?this._normalizeBearing(n.bearing,ue):ue,Ft="pitch"in n?+n.pitch:Ae,Rt="padding"in n?n.padding:O.padding,Yt=O.zoomScale(Je-k),zt=a.Point.convert(n.offset),Ut=O.centerPoint.add(zt),nr=O.pointLocation(Ut),rr=a.LngLat.convert(n.center||nr);this._normalizeCenter(rr);var Or=O.project(nr),hr=O.project(rr).sub(Or),Tr=n.curve,Cr=Math.max(O.width,O.height),an=Cr/Yt,Yr=hr.mag();if("minZoom"in n){var yn=a.clamp(Math.min(n.minZoom,k,Je),O.minZoom,O.maxZoom),On=Cr/O.zoomScale(yn-k);Tr=Math.sqrt(On/Yr*2)}var Qn=Tr*Tr;function oi(ii){var Li=(an*an-Cr*Cr+(ii?-1:1)*Qn*Qn*Yr*Yr)/(2*(ii?an:Cr)*Qn*Yr);return Math.log(Math.sqrt(Li*Li+1)-Li)}function xi(ii){return(Math.exp(ii)-Math.exp(-ii))/2}function Xi(ii){return(Math.exp(ii)+Math.exp(-ii))/2}var An=oi(0),si=function(Li){return Xi(An)/Xi(An+Tr*Li)},bi=function(Li){return Cr*((Xi(An)*(xi(ji=An+Tr*Li)/Xi(ji))-xi(An))/Qn)/Yr;var ji},Wn=(oi(1)-An)/Tr;if(Math.abs(Yr)<1e-6||!isFinite(Wn)){if(Math.abs(Cr-an)<1e-6)return this.easeTo(n,c);var Ti=an<Cr?-1:1;Wn=Math.abs(Math.log(an/Cr))/Tr,bi=function(){return 0},si=function(Li){return Math.exp(Ti*Tr*Li)}}return n.duration="duration"in n?+n.duration:1e3*Wn/("screenSpeed"in n?+n.screenSpeed/Tr:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=ue!==rt,this._pitching=Ft!==Ae,this._padding=!O.isPaddingEqual(Rt),this._prepareEase(c,!1),this._ease(function(ii){var Li=ii*Wn,ji=1/si(Li);O.zoom=ii===1?Je:k+O.scaleZoom(ji),y._rotating&&(O.bearing=a.number(ue,rt,ii)),y._pitching&&(O.pitch=a.number(Ae,Ft,ii)),y._padding&&(O.interpolatePadding(We,Rt,ii),Ut=O.centerPoint.add(zt));var qa=ii===1?rr:O.unproject(Or.add(hr.mult(bi(Li))).mult(ji));O.setLocationAtPoint(O.renderWorldCopies?qa.wrap():qa,Ut),y._fireMoveEvents(c)},function(){return y._afterEase(c)},n),this},i.prototype.isEasing=function(){return!!this._easeFrameId},i.prototype.stop=function(){return this._stop()},i.prototype._stop=function(n,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,c)}if(!n){var _=this.handlers;_&&_.stop(!1)}return this},i.prototype._ease=function(n,c,y){y.animate===!1||y.duration===0?(n(1),c()):(this._easeStart=a.browser.now(),this._easeOptions=y,this._onEaseFrame=n,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},i.prototype._renderFrameCallback=function(){var n=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},i.prototype._normalizeBearing=function(n,c){n=a.wrap(n,-180,180);var y=Math.abs(n-c);return Math.abs(n-360-c)<y&&(n-=360),Math.abs(n+360-c)<y&&(n+=360),n},i.prototype._normalizeCenter=function(n){var c=this.transform;if(c.renderWorldCopies&&!c.lngRange){var y=n.lng-c.center.lng;n.lng+=y>180?-360:y<-180?360:0}},i}(a.Evented),ms=function(i){i===void 0&&(i={}),this.options=i,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};ms.prototype.getDefaultPosition=function(){return"bottom-right"},ms.prototype.onAdd=function(u){var i=this.options&&this.options.compact;return this._map=u,this._container=B.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=B.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=B.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),i&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),i===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ms.prototype.onRemove=function(){B.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ms.prototype._setElementTitle=function(u,i){var n=this._map._getUIString("AttributionControl."+i);u.title=n,u.setAttribute("aria-label",n)},ms.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},ms.prototype._updateEditLink=function(){var u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));var i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(u){var n=i.reduce(function(c,y,_){return y.value&&(c+=y.key+"="+y.value+(_<i.length-1?"&":"")),c},"?");u.href=a.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}},ms.prototype._updateData=function(u){!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ms.prototype._updateAttributions=function(){if(this._map.style){var u=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=u.concat(this.options.customAttribution.map(function(k){return typeof k!="string"?"":k})):typeof this.options.customAttribution=="string"&&u.push(this.options.customAttribution)),this._map.style.stylesheet){var i=this._map.style.stylesheet;this.styleOwner=i.owner,this.styleId=i.id}var n=this._map.style.sourceCaches;for(var c in n){var y=n[c];if(y.used){var _=y.getSource();_.attribution&&u.indexOf(_.attribution)<0&&u.push(_.attribution)}}u.sort(function(k,ue){return k.length-ue.length});var O=(u=u.filter(function(k,ue){for(var Ae=ue+1;Ae<u.length;Ae++)if(u[Ae].indexOf(k)>=0)return!1;return!0})).join(" | ");O!==this._attribHTML&&(this._attribHTML=O,u.length?(this._innerContainer.innerHTML=O,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ms.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var jo=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};jo.prototype.onAdd=function(u){this._map=u,this._container=B.create("div","mapboxgl-ctrl");var i=B.create("a","mapboxgl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://www.mapbox.com/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},jo.prototype.onRemove=function(){B.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},jo.prototype.getDefaultPosition=function(){return"bottom-left"},jo.prototype._updateLogo=function(u){u&&u.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},jo.prototype._logoRequired=function(){if(this._map.style){var u=this._map.style.sourceCaches;for(var i in u)if(u[i].getSource().mapbox_logo)return!0;return!1}},jo.prototype._updateCompact=function(){var u=this._container.children;if(u.length){var i=u[0];this._map.getCanvasContainer().offsetWidth<250?i.classList.add("mapboxgl-compact"):i.classList.remove("mapboxgl-compact")}};var Io=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Io.prototype.add=function(u){var i=++this._id;return this._queue.push({callback:u,id:i,cancelled:!1}),i},Io.prototype.remove=function(u){for(var i=this._currentlyRunning,n=0,c=i?this._queue.concat(i):this._queue;n<c.length;n+=1){var y=c[n];if(y.id===u)return void(y.cancelled=!0)}},Io.prototype.run=function(u){u===void 0&&(u=0);var i=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,c=i;n<c.length;n+=1){var y=c[n];if(!y.cancelled&&(y.callback(u),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Io.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var nu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},_u=a.window.HTMLImageElement,ec=a.window.HTMLElement,Wi=a.window.ImageBitmap,Wa={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},fl=function(u){function i(c){var y=this;if((c=a.extend({},Wa,c)).minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var _=new Ni(c.minZoom,c.maxZoom,c.minPitch,c.maxPitch,c.renderWorldCopies);if(u.call(this,_,c),this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=c.preserveDrawingBuffer,this._antialias=c.antialias,this._trackResize=c.trackResize,this._bearingSnap=c.bearingSnap,this._refreshExpiredTiles=c.refreshExpiredTiles,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=c.collectResourceTiming,this._renderTaskQueue=new Io,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},nu,c.locale),this._clickTolerance=c.clickTolerance,this._requestManager=new a.RequestManager(c.transformRequest,c.accessToken),typeof c.container=="string"){if(this._container=a.window.document.getElementById(c.container),!this._container)throw new Error("Container '"+c.container+"' not found.")}else{if(!(c.container instanceof ec))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return y._update(!1)}),this.on("moveend",function(){return y._update(!1)}),this.on("zoom",function(){return y._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Fn(this,c),this._hash=c.hash&&new Ms(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,a.extend({},c.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=c.localIdeographFontFamily,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new ms({customAttribution:c.customAttribution})),this.addControl(new jo,c.logoPosition),this.on("style.load",function(){y.transform.unmodified&&y.jumpTo(y.style.stylesheet)}),this.on("data",function(O){y._update(O.dataType==="style"),y.fire(new a.Event(O.dataType+"data",O))}),this.on("dataloading",function(O){y.fire(new a.Event(O.dataType+"dataloading",O))})}u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return i.prototype._getMapId=function(){return this._mapId},i.prototype.addControl=function(c,y){if(y===void 0&&(y=c.getDefaultPosition?c.getDefaultPosition():"top-right"),!c||!c.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var _=c.onAdd(this);this._controls.push(c);var O=this._controlPositions[y];return y.indexOf("bottom")!==-1?O.insertBefore(_,O.firstChild):O.appendChild(_),this},i.prototype.removeControl=function(c){if(!c||!c.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var y=this._controls.indexOf(c);return y>-1&&this._controls.splice(y,1),c.onRemove(this),this},i.prototype.hasControl=function(c){return this._controls.indexOf(c)>-1},i.prototype.resize=function(c){var y=this._containerDimensions(),_=y[0],O=y[1];this._resizeCanvas(_,O),this.transform.resize(_,O),this.painter.resize(_,O);var k=!this._moving;return k&&(this.stop(),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c))),this.fire(new a.Event("resize",c)),k&&this.fire(new a.Event("moveend",c)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(c){return this.transform.setMaxBounds(a.LngLatBounds.convert(c)),this._update()},i.prototype.setMinZoom=function(c){if((c=c==null?-2:c)>=-2&&c<=this.transform.maxZoom)return this.transform.minZoom=c,this._update(),this.getZoom()<c&&this.setZoom(c),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(c){if((c=c==null?22:c)>=this.transform.minZoom)return this.transform.maxZoom=c,this._update(),this.getZoom()>c&&this.setZoom(c),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.setMinPitch=function(c){if((c=c==null?0:c)<0)throw new Error("minPitch must be greater than or equal to 0");if(c>=0&&c<=this.transform.maxPitch)return this.transform.minPitch=c,this._update(),this.getPitch()<c&&this.setPitch(c),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},i.prototype.getMinPitch=function(){return this.transform.minPitch},i.prototype.setMaxPitch=function(c){if((c=c==null?60:c)>60)throw new Error("maxPitch must be less than or equal to 60");if(c>=this.transform.minPitch)return this.transform.maxPitch=c,this._update(),this.getPitch()>c&&this.setPitch(c),this;throw new Error("maxPitch must be greater than the current minPitch")},i.prototype.getMaxPitch=function(){return this.transform.maxPitch},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(c){return this.transform.renderWorldCopies=c,this._update()},i.prototype.project=function(c){return this.transform.locationPoint(a.LngLat.convert(c))},i.prototype.unproject=function(c){return this.transform.pointLocation(a.Point.convert(c))},i.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},i.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},i.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},i.prototype._createDelegatedListener=function(c,y,_){var O,k=this;if(c==="mouseenter"||c==="mouseover"){var ue=!1;return{layer:y,listener:_,delegates:{mousemove:function(Je){var rt=k.getLayer(y)?k.queryRenderedFeatures(Je.point,{layers:[y]}):[];rt.length?ue||(ue=!0,_.call(k,new oo(c,k,Je.originalEvent,{features:rt}))):ue=!1},mouseout:function(){ue=!1}}}}if(c==="mouseleave"||c==="mouseout"){var Ae=!1;return{layer:y,listener:_,delegates:{mousemove:function(Je){(k.getLayer(y)?k.queryRenderedFeatures(Je.point,{layers:[y]}):[]).length?Ae=!0:Ae&&(Ae=!1,_.call(k,new oo(c,k,Je.originalEvent)))},mouseout:function(Je){Ae&&(Ae=!1,_.call(k,new oo(c,k,Je.originalEvent)))}}}}return{layer:y,listener:_,delegates:(O={},O[c]=function(We){var Je=k.getLayer(y)?k.queryRenderedFeatures(We.point,{layers:[y]}):[];Je.length&&(We.features=Je,_.call(k,We),delete We.features)},O)}},i.prototype.on=function(c,y,_){if(_===void 0)return u.prototype.on.call(this,c,y);var O=this._createDelegatedListener(c,y,_);for(var k in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[c]=this._delegatedListeners[c]||[],this._delegatedListeners[c].push(O),O.delegates)this.on(k,O.delegates[k]);return this},i.prototype.once=function(c,y,_){if(_===void 0)return u.prototype.once.call(this,c,y);var O=this._createDelegatedListener(c,y,_);for(var k in O.delegates)this.once(k,O.delegates[k]);return this},i.prototype.off=function(c,y,_){var O=this;return _===void 0?u.prototype.off.call(this,c,y):(this._delegatedListeners&&this._delegatedListeners[c]&&function(k){for(var ue=k[c],Ae=0;Ae<ue.length;Ae++){var We=ue[Ae];if(We.layer===y&&We.listener===_){for(var Je in We.delegates)O.off(Je,We.delegates[Je]);return ue.splice(Ae,1),O}}}(this._delegatedListeners),this)},i.prototype.queryRenderedFeatures=function(c,y){if(!this.style)return[];var _;if(y!==void 0||c===void 0||c instanceof a.Point||Array.isArray(c)||(y=c,c=void 0),y=y||{},(c=c||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof c[0]=="number")_=[a.Point.convert(c)];else{var O=a.Point.convert(c[0]),k=a.Point.convert(c[1]);_=[O,new a.Point(k.x,O.y),k,new a.Point(O.x,k.y),O]}return this.style.queryRenderedFeatures(_,y,this.transform)},i.prototype.querySourceFeatures=function(c,y){return this.style.querySourceFeatures(c,y)},i.prototype.setStyle=function(c,y){return(y=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},y)).diff!==!1&&y.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&c?(this._diffStyle(c,y),this):(this._localIdeographFontFamily=y.localIdeographFontFamily,this._updateStyle(c,y))},i.prototype._getUIString=function(c){var y=this._locale[c];if(y==null)throw new Error("Missing UI string '"+c+"'");return y},i.prototype._updateStyle=function(c,y){return this.style&&(this.style.setEventedParent(null),this.style._remove()),c?(this.style=new xa(this,y||{}),this.style.setEventedParent(this,{style:this.style}),typeof c=="string"?this.style.loadURL(c):this.style.loadJSON(c),this):(delete this.style,this)},i.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new xa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},i.prototype._diffStyle=function(c,y){var _=this;if(typeof c=="string"){var O=this._requestManager.normalizeStyleURL(c),k=this._requestManager.transformRequest(O,a.ResourceType.Style);a.getJSON(k,function(ue,Ae){ue?_.fire(new a.ErrorEvent(ue)):Ae&&_._updateDiff(Ae,y)})}else typeof c=="object"&&this._updateDiff(c,y)},i.prototype._updateDiff=function(c,y){try{this.style.setState(c)&&this._update(!0)}catch(_){a.warnOnce("Unable to perform style diff: "+(_.message||_.error||_)+".  Rebuilding the style from scratch."),this._updateStyle(c,y)}},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(c,y){return this._lazyInitEmptyStyle(),this.style.addSource(c,y),this._update(!0)},i.prototype.isSourceLoaded=function(c){var y=this.style&&this.style.sourceCaches[c];if(y!==void 0)return y.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+c+"'")))},i.prototype.areTilesLoaded=function(){var c=this.style&&this.style.sourceCaches;for(var y in c){var _=c[y]._tiles;for(var O in _){var k=_[O];if(k.state!=="loaded"&&k.state!=="errored")return!1}}return!0},i.prototype.addSourceType=function(c,y,_){return this._lazyInitEmptyStyle(),this.style.addSourceType(c,y,_)},i.prototype.removeSource=function(c){return this.style.removeSource(c),this._update(!0)},i.prototype.getSource=function(c){return this.style.getSource(c)},i.prototype.addImage=function(c,y,_){_===void 0&&(_={});var O=_.pixelRatio;O===void 0&&(O=1);var k=_.sdf;k===void 0&&(k=!1);var ue=_.stretchX,Ae=_.stretchY,We=_.content;if(this._lazyInitEmptyStyle(),y instanceof _u||Wi&&y instanceof Wi){var Je=a.browser.getImageData(y);this.style.addImage(c,{data:new a.RGBAImage({width:Je.width,height:Je.height},Je.data),pixelRatio:O,stretchX:ue,stretchY:Ae,content:We,sdf:k,version:0})}else{if(y.width===void 0||y.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var rt=y;this.style.addImage(c,{data:new a.RGBAImage({width:y.width,height:y.height},new Uint8Array(y.data)),pixelRatio:O,stretchX:ue,stretchY:Ae,content:We,sdf:k,version:0,userImage:rt}),rt.onAdd&&rt.onAdd(this,c)}},i.prototype.updateImage=function(c,y){var _=this.style.getImage(c);if(!_)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var O=y instanceof _u||Wi&&y instanceof Wi?a.browser.getImageData(y):y,k=O.width,ue=O.height,Ae=O.data;return k===void 0||ue===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):k!==_.data.width||ue!==_.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(_.data.replace(Ae,!(y instanceof _u||Wi&&y instanceof Wi)),void this.style.updateImage(c,_))},i.prototype.hasImage=function(c){return c?!!this.style.getImage(c):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(c){this.style.removeImage(c)},i.prototype.loadImage=function(c,y){a.getImage(this._requestManager.transformRequest(c,a.ResourceType.Image),y)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(c,y){return this._lazyInitEmptyStyle(),this.style.addLayer(c,y),this._update(!0)},i.prototype.moveLayer=function(c,y){return this.style.moveLayer(c,y),this._update(!0)},i.prototype.removeLayer=function(c){return this.style.removeLayer(c),this._update(!0)},i.prototype.getLayer=function(c){return this.style.getLayer(c)},i.prototype.setLayerZoomRange=function(c,y,_){return this.style.setLayerZoomRange(c,y,_),this._update(!0)},i.prototype.setFilter=function(c,y,_){return _===void 0&&(_={}),this.style.setFilter(c,y,_),this._update(!0)},i.prototype.getFilter=function(c){return this.style.getFilter(c)},i.prototype.setPaintProperty=function(c,y,_,O){return O===void 0&&(O={}),this.style.setPaintProperty(c,y,_,O),this._update(!0)},i.prototype.getPaintProperty=function(c,y){return this.style.getPaintProperty(c,y)},i.prototype.setLayoutProperty=function(c,y,_,O){return O===void 0&&(O={}),this.style.setLayoutProperty(c,y,_,O),this._update(!0)},i.prototype.getLayoutProperty=function(c,y){return this.style.getLayoutProperty(c,y)},i.prototype.setLight=function(c,y){return y===void 0&&(y={}),this._lazyInitEmptyStyle(),this.style.setLight(c,y),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(c,y){return this.style.setFeatureState(c,y),this._update()},i.prototype.removeFeatureState=function(c,y){return this.style.removeFeatureState(c,y),this._update()},i.prototype.getFeatureState=function(c){return this.style.getFeatureState(c)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var c=0,y=0;return this._container&&(c=this._container.clientWidth||400,y=this._container.clientHeight||300),[c,y]},i.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var c=this._container;c.classList.add("mapboxgl-map"),(this._missingCSSCanary=B.create("div","mapboxgl-canary",c)).style.visibility="hidden",this._detectMissingCSS();var y=this._canvasContainer=B.create("div","mapboxgl-canvas-container",c);this._interactive&&y.classList.add("mapboxgl-interactive"),this._canvas=B.create("canvas","mapboxgl-canvas",y),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var _=this._containerDimensions();this._resizeCanvas(_[0],_[1]);var O=this._controlContainer=B.create("div","mapboxgl-control-container",c),k=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ue){k[ue]=B.create("div","mapboxgl-ctrl-"+ue,O)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},i.prototype._resizeCanvas=function(c,y){var _=a.browser.devicePixelRatio||1;this._canvas.width=_*c,this._canvas.height=_*y,this._canvas.style.width=c+"px",this._canvas.style.height=y+"px"},i.prototype._setupPainter=function(){var c=a.extend({},Y.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),y=this._canvas.getContext("webgl",c)||this._canvas.getContext("experimental-webgl",c);y?(this.painter=new Ua(y,this.transform),a.webpSupported.testSupport(y)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(c){c.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:c}))},i.prototype._contextRestored=function(c){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:c}))},i.prototype._onMapScroll=function(c){if(c.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(c){return this.style?(this._styleDirty=this._styleDirty||c,this._sourcesDirty=!0,this.triggerRepaint(),this):this},i.prototype._requestRenderFrame=function(c){return this._update(),this._renderTaskQueue.add(c)},i.prototype._cancelRenderFrame=function(c){this._renderTaskQueue.remove(c)},i.prototype._render=function(c){var y,_=this,O=0,k=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(y=k.createQueryEXT(),k.beginQueryEXT(k.TIME_ELAPSED_EXT,y),O=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(c),!this._removed){var ue=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ae=this.transform.zoom,We=a.browser.now();this.style.zoomHistory.update(Ae,We);var Je=new a.EvaluationParameters(Ae,{now:We,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),rt=Je.crossFadingFactor();rt===1&&rt===this._crossFadingFactor||(ue=!0,this._crossFadingFactor=rt),this.style.update(Je)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||ue)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ft=a.browser.now()-O;k.endQueryEXT(k.TIME_ELAPSED_EXT,y),setTimeout(function(){var zt=k.getQueryObjectEXT(y,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(y),_.fire(new a.Event("gpu-timing-frame",{cpuTime:Ft,gpuTime:zt}))},50)}if(this.listens("gpu-timing-layer")){var Rt=this.painter.collectGpuTimers();setTimeout(function(){var zt=_.painter.queryGpuTimers(Rt);_.fire(new a.Event("gpu-timing-layer",{layerTimes:zt}))},50)}var Yt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Yt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||Yt||(this._fullyLoaded=!0),this}},i.prototype.remove=function(){this._hash&&this._hash.remove();for(var c=0,y=this._controls;c<y.length;c+=1)y[c].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),hl(this._canvasContainer),hl(this._controlContainer),hl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},i.prototype.triggerRepaint=function(){var c=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(y){c._frame=null,c._render(y)}))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(c){this._trackResize&&this.resize({originalEvent:c})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(c){this._showTileBoundaries!==c&&(this._showTileBoundaries=c,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(c){this._showPadding!==c&&(this._showPadding=c,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(c){this._showCollisionBoxes!==c&&(this._showCollisionBoxes=c,c?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(c){this._showOverdrawInspector!==c&&(this._showOverdrawInspector=c,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(c){this._repaint!==c&&(this._repaint=c,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(c){this._vertices=c,this._update()},i.prototype._setCacheLimits=function(c,y){a.setCacheLimits(c,y)},n.version.get=function(){return a.version},Object.defineProperties(i.prototype,n),i}(Tc);function hl(u){u.parentNode&&u.parentNode.removeChild(u)}var tc={showCompass:!0,showZoom:!0,visualizePitch:!1},Mu=function(i){var n=this;this.options=a.extend({},tc,i),this._container=B.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(c){return c.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(c){return n._map.zoomIn({},{originalEvent:c})}),B.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(c){return n._map.zoomOut({},{originalEvent:c})}),B.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(c){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:c}):n._map.resetNorth({},{originalEvent:c})}),this._compassIcon=B.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Mu.prototype._updateZoomButtons=function(){var u=this._map.getZoom(),i=u===this._map.getMaxZoom(),n=u===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},Mu.prototype._rotateCompassArrow=function(){var u=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=u},Mu.prototype.onAdd=function(u){return this._map=u,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Rs(this._map,this._compass,this.options.visualizePitch)),this._container},Mu.prototype.onRemove=function(){B.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Mu.prototype._createButton=function(u,i){var n=B.create("button",u,this._container);return n.type="button",n.addEventListener("click",i),n},Mu.prototype._setButtonTitle=function(u,i){var n=this._map._getUIString("NavigationControl."+i);u.title=n,u.setAttribute("aria-label",n)};var Rs=function(i,n,c){c===void 0&&(c=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new Sc({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,c&&(this.mousePitch=new ll({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),B.addEventListener(n,"mousedown",this.mousedown),B.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),B.addEventListener(n,"touchmove",this.touchmove),B.addEventListener(n,"touchend",this.touchend),B.addEventListener(n,"touchcancel",this.reset)};function kl(u,i,n){if(u=new a.LngLat(u.lng,u.lat),i){var c=new a.LngLat(u.lng-360,u.lat),y=new a.LngLat(u.lng+360,u.lat),_=n.locationPoint(u).distSqr(i);n.locationPoint(c).distSqr(i)<_?u=c:n.locationPoint(y).distSqr(i)<_&&(u=y)}for(;Math.abs(u.lng-n.center.lng)>180;){var O=n.locationPoint(u);if(O.x>=0&&O.y>=0&&O.x<=n.width&&O.y<=n.height)break;u.lng>n.center.lng?u.lng-=360:u.lng+=360}return u}Rs.prototype.down=function(u,i){this.mouseRotate.mousedown(u,i),this.mousePitch&&this.mousePitch.mousedown(u,i),B.disableDrag()},Rs.prototype.move=function(u,i){var n=this.map,c=this.mouseRotate.mousemoveWindow(u,i);if(c&&c.bearingDelta&&n.setBearing(n.getBearing()+c.bearingDelta),this.mousePitch){var y=this.mousePitch.mousemoveWindow(u,i);y&&y.pitchDelta&&n.setPitch(n.getPitch()+y.pitchDelta)}},Rs.prototype.off=function(){var u=this.element;B.removeEventListener(u,"mousedown",this.mousedown),B.removeEventListener(u,"touchstart",this.touchstart,{passive:!1}),B.removeEventListener(u,"touchmove",this.touchmove),B.removeEventListener(u,"touchend",this.touchend),B.removeEventListener(u,"touchcancel",this.reset),this.offTemp()},Rs.prototype.offTemp=function(){B.enableDrag(),B.removeEventListener(a.window,"mousemove",this.mousemove),B.removeEventListener(a.window,"mouseup",this.mouseup)},Rs.prototype.mousedown=function(u){this.down(a.extend({},u,{ctrlKey:!0,preventDefault:function(){return u.preventDefault()}}),B.mousePos(this.element,u)),B.addEventListener(a.window,"mousemove",this.mousemove),B.addEventListener(a.window,"mouseup",this.mouseup)},Rs.prototype.mousemove=function(u){this.move(u,B.mousePos(this.element,u))},Rs.prototype.mouseup=function(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()},Rs.prototype.touchstart=function(u){u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=B.touchPos(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return u.preventDefault()}},this._startPos))},Rs.prototype.touchmove=function(u){u.targetTouches.length!==1?this.reset():(this._lastPos=B.touchPos(this.element,u.targetTouches)[0],this.move({preventDefault:function(){return u.preventDefault()}},this._lastPos))},Rs.prototype.touchend=function(u){u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Rs.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var gs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function xf(u,i,n){var c=u.classList;for(var y in gs)c.remove("mapboxgl-"+n+"-anchor-"+y);c.add("mapboxgl-"+n+"-anchor-"+i)}var jl,jc=function(u){function i(n,c){if(u.call(this),(n instanceof a.window.HTMLElement||c)&&(n=a.extend({element:n},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=a.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=B.create("div"),this._element.setAttribute("aria-label","Map marker");var y=B.createNS("http://www.w3.org/2000/svg","svg");y.setAttributeNS(null,"display","block"),y.setAttributeNS(null,"height","41px"),y.setAttributeNS(null,"width","27px"),y.setAttributeNS(null,"viewBox","0 0 27 41");var _=B.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");var O=B.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill-rule","nonzero");var k=B.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");for(var ue=0,Ae=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ue<Ae.length;ue+=1){var We=Ae[ue],Je=B.createNS("http://www.w3.org/2000/svg","ellipse");Je.setAttributeNS(null,"opacity","0.04"),Je.setAttributeNS(null,"cx","10.5"),Je.setAttributeNS(null,"cy","5.80029008"),Je.setAttributeNS(null,"rx",We.rx),Je.setAttributeNS(null,"ry",We.ry),k.appendChild(Je)}var rt=B.createNS("http://www.w3.org/2000/svg","g");rt.setAttributeNS(null,"fill",this._color);var Ft=B.createNS("http://www.w3.org/2000/svg","path");Ft.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),rt.appendChild(Ft);var Rt=B.createNS("http://www.w3.org/2000/svg","g");Rt.setAttributeNS(null,"opacity","0.25"),Rt.setAttributeNS(null,"fill","#000000");var Yt=B.createNS("http://www.w3.org/2000/svg","path");Yt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Rt.appendChild(Yt);var zt=B.createNS("http://www.w3.org/2000/svg","g");zt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),zt.setAttributeNS(null,"fill","#FFFFFF");var Ut=B.createNS("http://www.w3.org/2000/svg","g");Ut.setAttributeNS(null,"transform","translate(8.0, 8.0)");var nr=B.createNS("http://www.w3.org/2000/svg","circle");nr.setAttributeNS(null,"fill","#000000"),nr.setAttributeNS(null,"opacity","0.25"),nr.setAttributeNS(null,"cx","5.5"),nr.setAttributeNS(null,"cy","5.5"),nr.setAttributeNS(null,"r","5.4999962");var rr=B.createNS("http://www.w3.org/2000/svg","circle");rr.setAttributeNS(null,"fill","#FFFFFF"),rr.setAttributeNS(null,"cx","5.5"),rr.setAttributeNS(null,"cy","5.5"),rr.setAttributeNS(null,"r","5.4999962"),Ut.appendChild(nr),Ut.appendChild(rr),O.appendChild(k),O.appendChild(rt),O.appendChild(Rt),O.appendChild(zt),O.appendChild(Ut),y.appendChild(O),y.setAttributeNS(null,"height",41*this._scale+"px"),y.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(y),this._offset=a.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Or){Or.preventDefault()}),this._element.addEventListener("mousedown",function(Or){Or.preventDefault()}),xf(this._element,this._anchor,"marker"),this._popup=null}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},i.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),B.remove(this._element),this._popup&&this._popup.remove(),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(n){return this._lngLat=a.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},i.prototype.getElement=function(){return this._element},i.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var c=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(24.6+c)],"bottom-right":[-c,-1*(24.6+c)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},i.prototype._onKeyPress=function(n){var c=n.code,y=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&y!==32&&y!==13||this.togglePopup()},i.prototype._onMapClick=function(n){var c=n.originalEvent.target,y=this._element;this._popup&&(c===y||y.contains(c))&&this.togglePopup()},i.prototype.getPopup=function(){return this._popup},i.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},i.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=kl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(c="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),B.setTransform(this._element,gs[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+y+" "+c)}},i.prototype.getOffset=function(){return this._offset},i.prototype.setOffset=function(n){return this._offset=a.Point.convert(n),this._update(),this},i.prototype._onMove=function(n){if(!this._isDragging){var c=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},i.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},i.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},i.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},i.prototype.isDraggable=function(){return this._draggable},i.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},i.prototype.getRotation=function(){return this._rotation},i.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},i.prototype.getRotationAlignment=function(){return this._rotationAlignment},i.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},i.prototype.getPitchAlignment=function(){return this._pitchAlignment},i}(a.Evented),bf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Vs=0,Cl=!1,Ul=function(u){function i(n){u.call(this),this.options=a.extend({},bf,n),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.onAdd=function(n){var c;return this._map=n,this._container=B.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,jl!==void 0?c(jl):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(y){c(jl=y.state!=="denied")}):c(jl=!!a.window.navigator.geolocation),this._container},i.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),B.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Vs=0,Cl=!1},i.prototype._isOutOfMapMaxBounds=function(n){var c=this._map.getMaxBounds(),y=n.coords;return c&&(y.longitude<c.getWest()||y.longitude>c.getEast()||y.latitude<c.getSouth()||y.latitude>c.getNorth())},i.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},i.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",n)),this._finish()}},i.prototype._updateCamera=function(n){var c=new a.LngLat(n.coords.longitude,n.coords.latitude),y=n.coords.accuracy,_=this._map.getBearing(),O=a.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(y),O,{geolocateSource:!0})},i.prototype._updateMarker=function(n){if(n){var c=new a.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},i.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,c=this._map.unproject([0,n]),y=this._map.unproject([1,n]),_=c.distanceTo(y),O=Math.ceil(2*this._accuracy/_);this._circleElement.style.width=O+"px",this._circleElement.style.height=O+"px"},i.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},i.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Cl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",n)),this._finish()}},i.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},i.prototype._setupUI=function(n){var c=this;if(this._container.addEventListener("contextmenu",function(O){return O.preventDefault()}),this._geolocateButton=B.create("button","mapboxgl-ctrl-geolocate",this._container),B.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var y=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=y,this._geolocateButton.setAttribute("aria-label",y)}else{var _=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=B.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new jc(this._dotElement),this._circleElement=B.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new jc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(O){O.geolocateSource||c._watchState!=="ACTIVE_LOCK"||O.originalEvent&&O.originalEvent.type==="resize"||(c._watchState="BACKGROUND",c._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),c._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),c.fire(new a.Event("trackuserlocationend")))})},i.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Vs--,Cl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Vs>1?(n={maximumAge:6e5,timeout:0},Cl=!0):(n=this.options.positionOptions,Cl=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},i.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},i}(a.Evented),Iu={maxWidth:100,unit:"metric"},Ou=function(i){this.options=a.extend({},Iu,i),a.bindAll(["_onMove","setUnit"],this)};function wl(u,i,n){var c=n&&n.maxWidth||100,y=u._container.clientHeight/2,_=u.unproject([0,y]),O=u.unproject([c,y]),k=_.distanceTo(O);if(n&&n.unit==="imperial"){var ue=3.2808*k;ue>5280?Ku(i,c,ue/5280,u._getUIString("ScaleControl.Miles")):Ku(i,c,ue,u._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Ku(i,c,k/1852,u._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Ku(i,c,k/1e3,u._getUIString("ScaleControl.Kilometers")):Ku(i,c,k,u._getUIString("ScaleControl.Meters"))}function Ku(u,i,n,c){var y,_,O,k=(y=n,(_=Math.pow(10,(""+Math.floor(y)).length-1))*(O=(O=y/_)>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function(ue){var Ae=Math.pow(10,Math.ceil(-Math.log(ue)/Math.LN10));return Math.round(ue*Ae)/Ae}(O)));u.style.width=i*(k/n)+"px",u.innerHTML=k+"&nbsp;"+c}Ou.prototype.getDefaultPosition=function(){return"bottom-left"},Ou.prototype._onMove=function(){wl(this._map,this._container,this.options)},Ou.prototype.onAdd=function(u){return this._map=u,this._container=B.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",u.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ou.prototype.onRemove=function(){B.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ou.prototype.setUnit=function(u){this.options.unit=u,wl(this._map,this._container,this.options)};var Ds=function(i){this._fullscreen=!1,i&&i.container&&(i.container instanceof a.window.HTMLElement?this._container=i.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ds.prototype.onAdd=function(u){return this._map=u,this._container||(this._container=this._map.getContainer()),this._controlContainer=B.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ds.prototype.onRemove=function(){B.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ds.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},Ds.prototype._setupUI=function(){var u=this._fullscreenButton=B.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);B.create("span","mapboxgl-ctrl-icon",u).setAttribute("aria-hidden",!0),u.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ds.prototype._updateTitle=function(){var u=this._getTitle();this._fullscreenButton.setAttribute("aria-label",u),this._fullscreenButton.title=u},Ds.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ds.prototype._isFullscreen=function(){return this._fullscreen},Ds.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ds.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ac={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),nc=function(u){function i(n){u.call(this),this.options=a.extend(Object.create(Ac),n),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return u&&(i.__proto__=u),(i.prototype=Object.create(u&&u.prototype)).constructor=i,i.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},i.prototype.isOpen=function(){return!!this._map},i.prototype.remove=function(){return this._content&&B.remove(this._content),this._container&&(B.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(n){return this._lngLat=a.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},i.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},i.prototype.getElement=function(){return this._container},i.prototype.setText=function(n){return this.setDOMContent(a.window.document.createTextNode(n))},i.prototype.setHTML=function(n){var c,y=a.window.document.createDocumentFragment(),_=a.window.document.createElement("body");for(_.innerHTML=n;c=_.firstChild;)y.appendChild(c);return this.setDOMContent(y)},i.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},i.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},i.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=B.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},i.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},i.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},i.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},i.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},i.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=B.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},i.prototype._onMouseUp=function(n){this._update(n.point)},i.prototype._onMouseMove=function(n){this._update(n.point)},i.prototype._onDrag=function(n){this._update(n.point)},i.prototype._update=function(n){var c=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=B.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=B.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Je){return c._container.classList.add(Je)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=kl(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var y=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),_=this.options.anchor,O=function Je(rt){if(rt){if(typeof rt=="number"){var Ft=Math.round(Math.sqrt(.5*Math.pow(rt,2)));return{center:new a.Point(0,0),top:new a.Point(0,rt),"top-left":new a.Point(Ft,Ft),"top-right":new a.Point(-Ft,Ft),bottom:new a.Point(0,-rt),"bottom-left":new a.Point(Ft,-Ft),"bottom-right":new a.Point(-Ft,-Ft),left:new a.Point(rt,0),right:new a.Point(-rt,0)}}if(rt instanceof a.Point||Array.isArray(rt)){var Rt=a.Point.convert(rt);return{center:Rt,top:Rt,"top-left":Rt,"top-right":Rt,bottom:Rt,"bottom-left":Rt,"bottom-right":Rt,left:Rt,right:Rt}}return{center:a.Point.convert(rt.center||[0,0]),top:a.Point.convert(rt.top||[0,0]),"top-left":a.Point.convert(rt["top-left"]||[0,0]),"top-right":a.Point.convert(rt["top-right"]||[0,0]),bottom:a.Point.convert(rt.bottom||[0,0]),"bottom-left":a.Point.convert(rt["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(rt["bottom-right"]||[0,0]),left:a.Point.convert(rt.left||[0,0]),right:a.Point.convert(rt.right||[0,0])}}return Je(new a.Point(0,0))}(this.options.offset);if(!_){var k,ue=this._container.offsetWidth,Ae=this._container.offsetHeight;k=y.y+O.bottom.y<Ae?["top"]:y.y>this._map.transform.height-Ae?["bottom"]:[],y.x<ue/2?k.push("left"):y.x>this._map.transform.width-ue/2&&k.push("right"),_=k.length===0?"bottom":k.join("-")}var We=y.add(O[_]).round();B.setTransform(this._container,gs[_]+" translate("+We.x+"px,"+We.y+"px)"),xf(this._container,_,"popup")}},i.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(rc);n&&n.focus()}},i.prototype._onClose=function(){this.remove()},i}(a.Evented),ic={version:a.version,supported:Y,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:fl,NavigationControl:Mu,GeolocateControl:Ul,AttributionControl:ms,ScaleControl:Ou,FullscreenControl:Ds,Popup:nc,Marker:jc,Style:xa,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){Er().acquire(sr)},clearPrewarmedResources:function(){var i=Cn;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(sr),Cn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(u){a.config.ACCESS_TOKEN=u},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(u){a.config.API_URL=u},get workerCount(){return kr.workerCount},set workerCount(u){kr.workerCount=u},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(u){a.config.MAX_PARALLEL_IMAGE_REQUESTS=u},clearStorage:function(i){a.clearTileCache(i)},workerUrl:""};return ic}),Z})},"4cb6":function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.METADATA_KEY=void 0;var b=o("xfSm");x.METADATA_KEY=b;var v=o("9Fde");Object.defineProperty(x,"Container",{enumerable:!0,get:function(){return v.Container}});var Z=o("FV85");Object.defineProperty(x,"BindingScopeEnum",{enumerable:!0,get:function(){return Z.BindingScopeEnum}}),Object.defineProperty(x,"BindingTypeEnum",{enumerable:!0,get:function(){return Z.BindingTypeEnum}}),Object.defineProperty(x,"TargetTypeEnum",{enumerable:!0,get:function(){return Z.TargetTypeEnum}});var F=o("dxzI");Object.defineProperty(x,"AsyncContainerModule",{enumerable:!0,get:function(){return F.AsyncContainerModule}}),Object.defineProperty(x,"ContainerModule",{enumerable:!0,get:function(){return F.ContainerModule}});var a=o("cZ5Q");Object.defineProperty(x,"injectable",{enumerable:!0,get:function(){return a.injectable}});var Y=o("0gSV");Object.defineProperty(x,"tagged",{enumerable:!0,get:function(){return Y.tagged}});var B=o("ZzCi");Object.defineProperty(x,"named",{enumerable:!0,get:function(){return B.named}});var Q=o("Yk9n");Object.defineProperty(x,"inject",{enumerable:!0,get:function(){return Q.inject}}),Object.defineProperty(x,"LazyServiceIdentifer",{enumerable:!0,get:function(){return Q.LazyServiceIdentifer}});var re=o("jYx5");Object.defineProperty(x,"optional",{enumerable:!0,get:function(){return re.optional}});var we=o("n2J3");Object.defineProperty(x,"unmanaged",{enumerable:!0,get:function(){return we.unmanaged}});var J=o("jIg/");Object.defineProperty(x,"multiInject",{enumerable:!0,get:function(){return J.multiInject}});var Ke=o("oaX6");Object.defineProperty(x,"targetName",{enumerable:!0,get:function(){return Ke.targetName}});var Ge=o("Sk89");Object.defineProperty(x,"postConstruct",{enumerable:!0,get:function(){return Ge.postConstruct}});var _e=o("wnjb");Object.defineProperty(x,"MetadataReader",{enumerable:!0,get:function(){return _e.MetadataReader}});var Re=o("d9O0");Object.defineProperty(x,"id",{enumerable:!0,get:function(){return Re.id}});var at=o("Ztfv");Object.defineProperty(x,"decorate",{enumerable:!0,get:function(){return at.decorate}});var Oe=o("RR/i");Object.defineProperty(x,"traverseAncerstors",{enumerable:!0,get:function(){return Oe.traverseAncerstors}}),Object.defineProperty(x,"taggedConstraint",{enumerable:!0,get:function(){return Oe.taggedConstraint}}),Object.defineProperty(x,"namedConstraint",{enumerable:!0,get:function(){return Oe.namedConstraint}}),Object.defineProperty(x,"typeConstraint",{enumerable:!0,get:function(){return Oe.typeConstraint}});var xt=o("ujMp");Object.defineProperty(x,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return xt.getServiceIdentifierAsString}});var Mt=o("78VC");Object.defineProperty(x,"multiBindToService",{enumerable:!0,get:function(){return Mt.multiBindToService}})},"4kj+":function(Ie,x){},"4qC0":function(Ie,x,o){var b=o("NykK"),v=o("Z0cm"),Z=o("ExA7"),F="[object String]";function a(Y){return typeof Y=="string"||!v(Y)&&Z(Y)&&b(Y)==F}Ie.exports=a},"5Tg0":function(Ie,x,o){(function(b){var v=o("Kz5y"),Z=x&&!x.nodeType&&x,F=Z&&typeof b=="object"&&b&&!b.nodeType&&b,a=F&&F.exports===Z,Y=a?v.Buffer:void 0,B=Y?Y.allocUnsafe:void 0;function Q(re,we){if(we)return re.slice();var J=re.length,Ke=B?B(J):new re.constructor(J);return re.copy(Ke),Ke}b.exports=Q}).call(this,o("YuTi")(Ie))},"5gLl":function(Ie,x,o){"use strict";o.d(x,"a",function(){return H});var b=o("lSNA"),v=o.n(b),Z=o("LvWW"),F=o.n(Z),a=o("0wsv");function Y(z){if(!z)throw new Error("coord is required");if(!Array.isArray(z)){if(z.type==="Feature"&&z.geometry!==null&&z.geometry.type==="Point")return z.geometry.coordinates;if(z.type==="Point")return z.coordinates}if(Array.isArray(z)&&z.length>=2&&!Array.isArray(z[0])&&!Array.isArray(z[1]))return z;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function B(z){if(Array.isArray(z))return z;if(z.type==="Feature"){if(z.geometry!==null)return z.geometry.coordinates}else if(z.coordinates)return z.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Q(z){if(z.length>1&&Object(a.c)(z[0])&&Object(a.c)(z[1]))return!0;if(Array.isArray(z[0])&&z[0].length)return Q(z[0]);throw new Error("coordinates must only contain numbers")}function re(z,V,Se){if(!V||!Se)throw new Error("type and name required");if(!z||z.type!==V)throw new Error("Invalid input to "+Se+": must be a "+V+", given "+z.type)}function we(z,V,Se){if(!z)throw new Error("No feature passed");if(!Se)throw new Error(".featureOf() requires a name");if(!z||z.type!=="Feature"||!z.geometry)throw new Error("Invalid input to "+Se+", Feature with geometry required");if(!z.geometry||z.geometry.type!==V)throw new Error("Invalid input to "+Se+": must be a "+V+", given "+z.geometry.type)}function J(z,V,Se){if(!z)throw new Error("No featureCollection passed");if(!Se)throw new Error(".collectionOf() requires a name");if(!z||z.type!=="FeatureCollection")throw new Error("Invalid input to "+Se+", FeatureCollection required");for(var ve=0,ce=z.features;ve<ce.length;ve++){var fe=ce[ve];if(!fe||fe.type!=="Feature"||!fe.geometry)throw new Error("Invalid input to "+Se+", Feature with geometry required");if(!fe.geometry||fe.geometry.type!==V)throw new Error("Invalid input to "+Se+": must be a "+V+", given "+fe.geometry.type)}}function Ke(z){return z.type==="Feature"?z.geometry:z}function Ge(z,V){return z.type==="FeatureCollection"?"FeatureCollection":z.type==="GeometryCollection"?"GeometryCollection":z.type==="Feature"&&z.geometry!==null?z.geometry.type:z.type}function _e(z,V,Se){if(z!==null)for(var ve,ce,fe,ke,lt,nt,le,ye=0,He=0,ft,De=z.type,Ze=De==="FeatureCollection",w=De==="Feature",R=Ze?z.features.length:1,q=0;q<R;q++){le=Ze?z.features[q].geometry:w?z.geometry:z,ft=le?le.type==="GeometryCollection":!1,lt=ft?le.geometries.length:1;for(var he=0;he<lt;he++){var Ve=0,Ye=0;if(ke=ft?le.geometries[he]:le,ke!==null){nt=ke.coordinates;var yt=ke.type;switch(ye=Se&&(yt==="Polygon"||yt==="MultiPolygon")?1:0,yt){case null:break;case"Point":if(V(nt,He,q,Ve,Ye)===!1)return!1;He++,Ve++;break;case"LineString":case"MultiPoint":for(ve=0;ve<nt.length;ve++){if(V(nt[ve],He,q,Ve,Ye)===!1)return!1;He++,yt==="MultiPoint"&&Ve++}yt==="LineString"&&Ve++;break;case"Polygon":case"MultiLineString":for(ve=0;ve<nt.length;ve++){for(ce=0;ce<nt[ve].length-ye;ce++){if(V(nt[ve][ce],He,q,Ve,Ye)===!1)return!1;He++}yt==="MultiLineString"&&Ve++,yt==="Polygon"&&Ye++}yt==="Polygon"&&Ve++;break;case"MultiPolygon":for(ve=0;ve<nt.length;ve++){for(Ye=0,ce=0;ce<nt[ve].length;ce++){for(fe=0;fe<nt[ve][ce].length-ye;fe++){if(V(nt[ve][ce][fe],He,q,Ve,Ye)===!1)return!1;He++}Ye++}Ve++}break;case"GeometryCollection":for(ve=0;ve<ke.geometries.length;ve++)if(_e(ke.geometries[ve],V,Se)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Re(z,V,Se,ve){var ce=Se;return _e(z,function(fe,ke,lt,nt,le){ke===0&&Se===void 0?ce=fe:ce=V(ce,fe,ke,lt,nt,le)},ve),ce}function at(z,V){var Se;switch(z.type){case"FeatureCollection":for(Se=0;Se<z.features.length&&V(z.features[Se].properties,Se)!==!1;Se++);break;case"Feature":V(z.properties,0);break}}function Oe(z,V,Se){var ve=Se;return at(z,function(ce,fe){fe===0&&Se===void 0?ve=ce:ve=V(ve,ce,fe)}),ve}function xt(z,V){if(z.type==="Feature")V(z,0);else if(z.type==="FeatureCollection")for(var Se=0;Se<z.features.length&&V(z.features[Se],Se)!==!1;Se++);}function Mt(z,V,Se){var ve=Se;return xt(z,function(ce,fe){fe===0&&Se===void 0?ve=ce:ve=V(ve,ce,fe)}),ve}function Et(z){var V=[];return _e(z,function(Se){V.push(Se)}),V}function St(z,V){var Se,ve,ce,fe,ke,lt,nt,le,ye,He,ft=0,De=z.type==="FeatureCollection",Ze=z.type==="Feature",w=De?z.features.length:1;for(Se=0;Se<w;Se++){for(lt=De?z.features[Se].geometry:Ze?z.geometry:z,le=De?z.features[Se].properties:Ze?z.properties:{},ye=De?z.features[Se].bbox:Ze?z.bbox:void 0,He=De?z.features[Se].id:Ze?z.id:void 0,nt=lt?lt.type==="GeometryCollection":!1,ke=nt?lt.geometries.length:1,ce=0;ce<ke;ce++){if(fe=nt?lt.geometries[ce]:lt,fe===null){if(V(null,ft,le,ye,He)===!1)return!1;continue}switch(fe.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(V(fe,ft,le,ye,He)===!1)return!1;break}case"GeometryCollection":{for(ve=0;ve<fe.geometries.length;ve++)if(V(fe.geometries[ve],ft,le,ye,He)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}ft++}}function or(z,V,Se){var ve=Se;return St(z,function(ce,fe,ke,lt,nt){fe===0&&Se===void 0?ve=ce:ve=V(ve,ce,fe,ke,lt,nt)}),ve}function $t(z,V){St(z,function(Se,ve,ce,fe,ke){var lt=Se===null?null:Se.type;switch(lt){case null:case"Point":case"LineString":case"Polygon":return V(Object(a.b)(Se,ce,{bbox:fe,id:ke}),ve,0)===!1?!1:void 0}var nt;switch(lt){case"MultiPoint":nt="Point";break;case"MultiLineString":nt="LineString";break;case"MultiPolygon":nt="Polygon";break}for(var le=0;le<Se.coordinates.length;le++){var ye=Se.coordinates[le],He={type:nt,coordinates:ye};if(V(Object(a.b)(He,ce),ve,le)===!1)return!1}})}function Ht(z,V,Se){var ve=Se;return $t(z,function(ce,fe,ke){fe===0&&ke===0&&Se===void 0?ve=ce:ve=V(ve,ce,fe,ke)}),ve}function mt(z,V){$t(z,function(Se,ve,ce){var fe=0;if(!!Se.geometry){var ke=Se.geometry.type;if(!(ke==="Point"||ke==="MultiPoint")){var lt,nt=0,le=0,ye=0;if(_e(Se,function(He,ft,De,Ze,w){if(lt===void 0||ve>nt||Ze>le||w>ye){lt=He,nt=ve,le=Ze,ye=w,fe=0;return}var R=Object(a.e)([lt,He],Se.properties);if(V(R,ve,ce,w,fe)===!1)return!1;fe++,lt=He})===!1)return!1}}})}function Xe(z,V,Se){var ve=Se,ce=!1;return mt(z,function(fe,ke,lt,nt,le){ce===!1&&Se===void 0?ve=fe:ve=V(ve,fe,ke,lt,nt,le),ce=!0}),ve}function Tt(z,V){if(!z)throw new Error("geojson is required");$t(z,function(Se,ve,ce){if(Se.geometry!==null){var fe=Se.geometry.type,ke=Se.geometry.coordinates;switch(fe){case"LineString":if(V(Se,ve,ce,0,0)===!1)return!1;break;case"Polygon":for(var lt=0;lt<ke.length;lt++)if(V(Object(a.e)(ke[lt],Se.properties),ve,ce,lt)===!1)return!1;break}}})}function ze(z,V,Se){var ve=Se;return Tt(z,function(ce,fe,ke,lt){fe===0&&Se===void 0?ve=ce:ve=V(ve,ce,fe,ke,lt)}),ve}function st(z,V){if(V=V||{},!Object(a.d)(V))throw new Error("options is invalid");var Se=V.featureIndex||0,ve=V.multiFeatureIndex||0,ce=V.geometryIndex||0,fe=V.segmentIndex||0,ke=V.properties,lt;switch(z.type){case"FeatureCollection":Se<0&&(Se=z.features.length+Se),ke=ke||z.features[Se].properties,lt=z.features[Se].geometry;break;case"Feature":ke=ke||z.properties,lt=z.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":lt=z;break;default:throw new Error("geojson is invalid")}if(lt===null)return null;var nt=lt.coordinates;switch(lt.type){case"Point":case"MultiPoint":return null;case"LineString":return fe<0&&(fe=nt.length+fe-1),Object(a.e)([nt[fe],nt[fe+1]],ke,V);case"Polygon":return ce<0&&(ce=nt.length+ce),fe<0&&(fe=nt[ce].length+fe-1),Object(a.e)([nt[ce][fe],nt[ce][fe+1]],ke,V);case"MultiLineString":return ve<0&&(ve=nt.length+ve),fe<0&&(fe=nt[ve].length+fe-1),Object(a.e)([nt[ve][fe],nt[ve][fe+1]],ke,V);case"MultiPolygon":return ve<0&&(ve=nt.length+ve),ce<0&&(ce=nt[ve].length+ce),fe<0&&(fe=nt[ve][ce].length-fe-1),Object(a.e)([nt[ve][ce][fe],nt[ve][ce][fe+1]],ke,V)}throw new Error("geojson is invalid")}function Wt(z,V){if(V=V||{},!Object(a.d)(V))throw new Error("options is invalid");var Se=V.featureIndex||0,ve=V.multiFeatureIndex||0,ce=V.geometryIndex||0,fe=V.coordIndex||0,ke=V.properties,lt;switch(z.type){case"FeatureCollection":Se<0&&(Se=z.features.length+Se),ke=ke||z.features[Se].properties,lt=z.features[Se].geometry;break;case"Feature":ke=ke||z.properties,lt=z.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":lt=z;break;default:throw new Error("geojson is invalid")}if(lt===null)return null;var nt=lt.coordinates;switch(lt.type){case"Point":return Object(a.f)(nt,ke,V);case"MultiPoint":return ve<0&&(ve=nt.length+ve),Object(a.f)(nt[ve],ke,V);case"LineString":return fe<0&&(fe=nt.length+fe),Object(a.f)(nt[fe],ke,V);case"Polygon":return ce<0&&(ce=nt.length+ce),fe<0&&(fe=nt[ce].length+fe),Object(a.f)(nt[ce][fe],ke,V);case"MultiLineString":return ve<0&&(ve=nt.length+ve),fe<0&&(fe=nt[ve].length+fe),Object(a.f)(nt[ve][fe],ke,V);case"MultiPolygon":return ve<0&&(ve=nt.length+ve),ce<0&&(ce=nt[ve].length+ce),fe<0&&(fe=nt[ve][ce].length-fe),Object(a.f)(nt[ve][ce][fe],ke,V)}throw new Error("geojson is invalid")}function bt(z,V){var Se=Object.keys(z);if(Object.getOwnPropertySymbols){var ve=Object.getOwnPropertySymbols(z);V&&(ve=ve.filter(function(ce){return Object.getOwnPropertyDescriptor(z,ce).enumerable})),Se.push.apply(Se,ve)}return Se}function dt(z){for(var V=1;V<arguments.length;V++){var Se=arguments[V]!=null?arguments[V]:{};V%2?bt(Object(Se),!0).forEach(function(ve){v()(z,ve,Se[ve])}):Object.getOwnPropertyDescriptors?Object.defineProperties(z,Object.getOwnPropertyDescriptors(Se)):bt(Object(Se)).forEach(function(ve){Object.defineProperty(z,ve,Object.getOwnPropertyDescriptor(Se,ve))})}return z}function H(z,V){var Se=[],ve={};if(z.features=z.features.filter(function(fe){var ke=fe.geometry;return fe!=null&&ke&&ke.type&&ke.coordinates&&ke.coordinates.length>0}),F()(z,!0),z.features.length===0)return{dataArray:[],featureKeys:ve};var ce=0;return $t(z,function(fe,ke){var lt=B(fe),nt=ke,le=dt(dt({},fe.properties),{},{coordinates:lt,_id:nt});Se.push(le)}),{dataArray:Se,featureKeys:ve}}},"5ku3":function(Ie,x,o){"use strict";(function(b){o.d(x,"a",function(){return F});var v=o("U8pU"),Z=o("I0ug");function F(){var Y=(typeof b=="undefined"?"undefined":Object(v.a)(b))==="object"&&String(b)==="[object process]"&&!b.browser;return!Y||Object(Z.a)()}function a(){return F()&&typeof document!="undefined"}}).call(this,o("Q2Ig"))},"5zYK":function(Ie,x,o){"use strict";o.d(x,"a",function(){return re});var b=o("lSNA"),v=o.n(b),Z=o("RIqP"),F=o.n(Z),a=o("LvWW"),Y=o.n(a);function B(we,J){var Ke=Object.keys(we);if(Object.getOwnPropertySymbols){var Ge=Object.getOwnPropertySymbols(we);J&&(Ge=Ge.filter(function(_e){return Object.getOwnPropertyDescriptor(we,_e).enumerable})),Ke.push.apply(Ke,Ge)}return Ke}function Q(we){for(var J=1;J<arguments.length;J++){var Ke=arguments[J]!=null?arguments[J]:{};J%2?B(Object(Ke),!0).forEach(function(Ge){v()(we,Ge,Ke[Ge])}):Object.getOwnPropertyDescriptors?Object.defineProperties(we,Object.getOwnPropertyDescriptors(Ke)):B(Object(Ke)).forEach(function(Ge){Object.defineProperty(we,Ge,Object.getOwnPropertyDescriptor(Ke,Ge))})}return we}function re(we,J){var Ke=J.x,Ge=J.y,_e=J.x1,Re=J.y1,at=J.coordinates,Oe=[];return we.forEach(function(xt,Mt){var Et=[];if(Ke&&Ge&&(Et=[parseFloat(xt[Ke]),parseFloat(xt[Ge])]),Ke&&Ge&&_e&&Re){var St=[parseFloat(xt[Ke]),parseFloat(xt[Ge])],or=[parseFloat(xt[_e]),parseFloat(xt[Re])];Et=[St,or]}if(at){var $t="Polygon";Array.isArray(at[0])||($t="Point"),Array.isArray(at[0])&&!Array.isArray(at[0][0])&&($t="LineString");var Ht={type:$t,coordinates:F()(xt[at])};Y()(Ht,!0),Et=Ht.coordinates}var mt=Q(Q({},xt),{},{_id:Mt,coordinates:Et});Oe.push(mt)}),{dataArray:Oe}}},"6AGu":function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingInSyntax=void 0;var b=o("FV85"),v=o("LKzl"),Z=function(){function F(a){this._binding=a}return F.prototype.inRequestScope=function(){return this._binding.scope=b.BindingScopeEnum.Request,new v.BindingWhenOnSyntax(this._binding)},F.prototype.inSingletonScope=function(){return this._binding.scope=b.BindingScopeEnum.Singleton,new v.BindingWhenOnSyntax(this._binding)},F.prototype.inTransientScope=function(){return this._binding.scope=b.BindingScopeEnum.Transient,new v.BindingWhenOnSyntax(this._binding)},F}();x.BindingInSyntax=Z},"6D9b":function(Ie,x,o){Ie.exports={"ant-statistic":"ant-statistic","ant-statistic-title":"ant-statistic-title","ant-statistic-content":"ant-statistic-content","ant-statistic-content-value":"ant-statistic-content-value","ant-statistic-content-prefix":"ant-statistic-content-prefix","ant-statistic-content-suffix":"ant-statistic-content-suffix","ant-statistic-rtl":"ant-statistic-rtl"}},"6NqC":function(Ie,x){},"6acW":function(Ie,x,o){var b=o("dt0z"),v=o("gQMU");function Z(F){return v(b(F).toLowerCase())}Ie.exports=Z},"6nK8":function(Ie,x,o){var b=o("dVn5"),v=o("fo6e"),Z=o("dt0z"),F=o("9NmV");function a(Y,B,Q){return Y=Z(Y),B=Q?void 0:B,B===void 0?v(Y)?F(Y):b(Y):Y.match(B)||[]}Ie.exports=a},"711d":function(Ie,x){function o(b){return function(v){return v==null?void 0:v[b]}}Ie.exports=o},"78VC":function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.multiBindToService=void 0,x.multiBindToService=function(b){return function(v){return function(){for(var Z=[],F=0;F<arguments.length;F++)Z[F]=arguments[F];return Z.forEach(function(a){return b.bind(a).toService(v)})}}}},"7Ix3":function(Ie,x){function o(b){var v=[];if(b!=null)for(var Z in Object(b))v.push(Z);return v}Ie.exports=o},"7W2i":function(Ie,x,o){var b=o("SksO");function v(Z,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function");Z.prototype=Object.create(F&&F.prototype,{constructor:{value:Z,writable:!0,configurable:!0}}),F&&b(Z,F)}Ie.exports=v},"7tbW":function(Ie,x,o){var b=o("LGYb");function v(Z){return Z&&Z.length?b(Z):[]}Ie.exports=v},"8/Fi":function(Ie,x,o){"use strict";var b=o("J4zp"),v=o.n(b),Z=o("9nhX"),F=o.n(Z),a=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function Y(st){return a.indexOf(st)}var B=2,Q=4,re=64,we=128,J=256,Ke=512,Ge=8192,_e=16384,Re=32768,at=32768*2,Oe=131072,xt=262144,Mt=524288,Et=1048576,St=2097152,or=4194304,$t=8388608,Ht=16777216,mt=16777216*2;function Xe(st,Wt){return st=F()(Math.floor(st),0,255),Wt=F()(Math.floor(Wt),0,255),256*st+Wt}function Tt(st){var Wt=st.color,bt=st.radius,dt=st.tileX,H=st.tileY,z=st.shape,V=st.opacity,Se=st.stroke,ve=st.strokeWidth,ce=st.strokeOpacity,fe=[],ke=[],lt=[],nt=[Xe(Wt[0],Wt[1]),Xe(Wt[2],Wt[3])],le=[Xe(Se[0],Se[1]),Xe(Se[2],Se[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ye){var He=v()(ye,2),ft=He[0],De=He[1];fe.push([].concat(nt,[(ft+1)*$t+(De+1)*St+Y(z)*Oe+bt,(dt+512)*Mt+(H+512)*re])),ke.push([].concat(le,[ve,ce])),lt.push([V,0,0,0])}),{packedBuffer:fe,packedBuffer2:ke,packedBuffer3:lt}}function ze(st,Wt){if(st===0&&!Wt)return 0;if(st===1&&Wt)return 4294967295;var bt=Wt?1:0,dt=Math.floor(st*127);return dt*mt+bt*Ht+dt*Oe+bt*at+dt*Ke+bt*J+dt*B+bt}},"88Gu":function(Ie,x){var o=800,b=16,v=Date.now;function Z(F){var a=0,Y=0;return function(){var B=v(),Q=b-(B-Y);if(Y=B,Q>0){if(++a>=o)return arguments[0]}else a=0;return F.apply(void 0,arguments)}}Ie.exports=Z},"8ml+":function(Ie,x,o){"use strict";var b=o("h1nZ");o.o(b,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return b.CityBuildingLayer}),o.o(b,"Control")&&o.d(x,"Control",function(){return b.Control}),o.o(b,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return b.HeatmapLayer}),o.o(b,"ImageLayer")&&o.d(x,"ImageLayer",function(){return b.ImageLayer}),o.o(b,"LineLayer")&&o.d(x,"LineLayer",function(){return b.LineLayer}),o.o(b,"Logo")&&o.d(x,"Logo",function(){return b.Logo}),o.o(b,"Marker")&&o.d(x,"Marker",function(){return b.Marker}),o.o(b,"PointLayer")&&o.d(x,"PointLayer",function(){return b.PointLayer}),o.o(b,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return b.PolygonLayer}),o.o(b,"Popup")&&o.d(x,"Popup",function(){return b.Popup}),o.o(b,"RasterLayer")&&o.d(x,"RasterLayer",function(){return b.RasterLayer}),o.o(b,"Scale")&&o.d(x,"Scale",function(){return b.Scale}),o.o(b,"Scene")&&o.d(x,"Scene",function(){return b.Scene}),o.o(b,"Zoom")&&o.d(x,"Zoom",function(){return b.Zoom});var v=o("kQ+U");o.d(x,"Scene",function(){return v.a});var Z=o("sxDa");o.d(x,"CityBuildingLayer",function(){return Z.a}),o.d(x,"HeatmapLayer",function(){return Z.b}),o.d(x,"ImageLayer",function(){return Z.c}),o.d(x,"LineLayer",function(){return Z.d}),o.d(x,"PointLayer",function(){return Z.e}),o.d(x,"PolygonLayer",function(){return Z.f}),o.d(x,"RasterLayer",function(){return Z.g});var F=o("k5/I");o.d(x,"Control",function(){return F.a}),o.d(x,"Logo",function(){return F.b}),o.d(x,"Marker",function(){return F.c}),o.d(x,"Popup",function(){return F.d}),o.d(x,"Scale",function(){return F.e}),o.d(x,"Zoom",function(){return F.f});var a=o("Hel2"),Y=o("RL2/")},"8uyu":function(Ie,x){},"9Fde":function(Ie,x,o){"use strict";var b=this&&this.__awaiter||function(at,Oe,xt,Mt){function Et(St){return St instanceof xt?St:new xt(function(or){or(St)})}return new(xt||(xt=Promise))(function(St,or){function $t(Xe){try{mt(Mt.next(Xe))}catch(Tt){or(Tt)}}function Ht(Xe){try{mt(Mt.throw(Xe))}catch(Tt){or(Tt)}}function mt(Xe){Xe.done?St(Xe.value):Et(Xe.value).then($t,Ht)}mt((Mt=Mt.apply(at,Oe||[])).next())})},v=this&&this.__generator||function(at,Oe){var xt={label:0,sent:function(){if(St[0]&1)throw St[1];return St[1]},trys:[],ops:[]},Mt,Et,St,or;return or={next:$t(0),throw:$t(1),return:$t(2)},typeof Symbol=="function"&&(or[Symbol.iterator]=function(){return this}),or;function $t(mt){return function(Xe){return Ht([mt,Xe])}}function Ht(mt){if(Mt)throw new TypeError("Generator is already executing.");for(;xt;)try{if(Mt=1,Et&&(St=mt[0]&2?Et.return:mt[0]?Et.throw||((St=Et.return)&&St.call(Et),0):Et.next)&&!(St=St.call(Et,mt[1])).done)return St;switch(Et=0,St&&(mt=[mt[0]&2,St.value]),mt[0]){case 0:case 1:St=mt;break;case 4:return xt.label++,{value:mt[1],done:!1};case 5:xt.label++,Et=mt[1],mt=[0];continue;case 7:mt=xt.ops.pop(),xt.trys.pop();continue;default:if(St=xt.trys,!(St=St.length>0&&St[St.length-1])&&(mt[0]===6||mt[0]===2)){xt=0;continue}if(mt[0]===3&&(!St||mt[1]>St[0]&&mt[1]<St[3])){xt.label=mt[1];break}if(mt[0]===6&&xt.label<St[1]){xt.label=St[1],St=mt;break}if(St&&xt.label<St[2]){xt.label=St[2],xt.ops.push(mt);break}St[2]&&xt.ops.pop(),xt.trys.pop();continue}mt=Oe.call(at,xt)}catch(Xe){mt=[6,Xe],Et=0}finally{Mt=St=0}if(mt[0]&5)throw mt[1];return{value:mt[0]?mt[1]:void 0,done:!0}}};Object.defineProperty(x,"__esModule",{value:!0}),x.Container=void 0;var Z=o("LgvC"),F=o("MON2"),a=o("FV85"),Y=o("xfSm"),B=o("wnjb"),Q=o("h7MG"),re=o("aPG5"),we=o("gzZq"),J=o("d9O0"),Ke=o("ujMp"),Ge=o("HpQ9"),_e=o("AwBQ"),Re=function(){function at(Oe){var xt=Oe||{};if(typeof xt!="object")throw new Error(""+F.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(xt.defaultScope===void 0)xt.defaultScope=a.BindingScopeEnum.Transient;else if(xt.defaultScope!==a.BindingScopeEnum.Singleton&&xt.defaultScope!==a.BindingScopeEnum.Transient&&xt.defaultScope!==a.BindingScopeEnum.Request)throw new Error(""+F.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(xt.autoBindInjectable===void 0)xt.autoBindInjectable=!1;else if(typeof xt.autoBindInjectable!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(xt.skipBaseClassChecks===void 0)xt.skipBaseClassChecks=!1;else if(typeof xt.skipBaseClassChecks!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:xt.autoBindInjectable,defaultScope:xt.defaultScope,skipBaseClassChecks:xt.skipBaseClassChecks},this.id=J.id(),this._bindingDictionary=new _e.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new B.MetadataReader}return at.merge=function(Oe,xt){var Mt=new at,Et=Q.getBindingDictionary(Mt),St=Q.getBindingDictionary(Oe),or=Q.getBindingDictionary(xt);function $t(Ht,mt){Ht.traverse(function(Xe,Tt){Tt.forEach(function(ze){mt.add(ze.serviceIdentifier,ze.clone())})})}return $t(St,Et),$t(or,Et),Mt},at.prototype.load=function(){for(var Oe=[],xt=0;xt<arguments.length;xt++)Oe[xt]=arguments[xt];for(var Mt=this._getContainerModuleHelpersFactory(),Et=0,St=Oe;Et<St.length;Et++){var or=St[Et],$t=Mt(or.id);or.registry($t.bindFunction,$t.unbindFunction,$t.isboundFunction,$t.rebindFunction)}},at.prototype.loadAsync=function(){for(var Oe=[],xt=0;xt<arguments.length;xt++)Oe[xt]=arguments[xt];return b(this,void 0,void 0,function(){var Mt,Et,St,or,$t;return v(this,function(Ht){switch(Ht.label){case 0:Mt=this._getContainerModuleHelpersFactory(),Et=0,St=Oe,Ht.label=1;case 1:return Et<St.length?(or=St[Et],$t=Mt(or.id),[4,or.registry($t.bindFunction,$t.unbindFunction,$t.isboundFunction,$t.rebindFunction)]):[3,4];case 2:Ht.sent(),Ht.label=3;case 3:return Et++,[3,1];case 4:return[2]}})})},at.prototype.unload=function(){for(var Oe=this,xt=[],Mt=0;Mt<arguments.length;Mt++)xt[Mt]=arguments[Mt];var Et=function(or){return function($t){return $t.moduleId===or}};xt.forEach(function(St){var or=Et(St.id);Oe._bindingDictionary.removeByCondition(or)})},at.prototype.bind=function(Oe){var xt=this.options.defaultScope||a.BindingScopeEnum.Transient,Mt=new Z.Binding(Oe,xt);return this._bindingDictionary.add(Oe,Mt),new we.BindingToSyntax(Mt)},at.prototype.rebind=function(Oe){return this.unbind(Oe),this.bind(Oe)},at.prototype.unbind=function(Oe){try{this._bindingDictionary.remove(Oe)}catch(xt){throw new Error(F.CANNOT_UNBIND+" "+Ke.getServiceIdentifierAsString(Oe))}},at.prototype.unbindAll=function(){this._bindingDictionary=new _e.Lookup},at.prototype.isBound=function(Oe){var xt=this._bindingDictionary.hasKey(Oe);return!xt&&this.parent&&(xt=this.parent.isBound(Oe)),xt},at.prototype.isBoundNamed=function(Oe,xt){return this.isBoundTagged(Oe,Y.NAMED_TAG,xt)},at.prototype.isBoundTagged=function(Oe,xt,Mt){var Et=!1;if(this._bindingDictionary.hasKey(Oe)){var St=this._bindingDictionary.get(Oe),or=Q.createMockRequest(this,Oe,xt,Mt);Et=St.some(function($t){return $t.constraint(or)})}return!Et&&this.parent&&(Et=this.parent.isBoundTagged(Oe,xt,Mt)),Et},at.prototype.snapshot=function(){this._snapshots.push(Ge.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},at.prototype.restore=function(){var Oe=this._snapshots.pop();if(Oe===void 0)throw new Error(F.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Oe.bindings,this._middleware=Oe.middleware},at.prototype.createChild=function(Oe){var xt=new at(Oe||this.options);return xt.parent=this,xt},at.prototype.applyMiddleware=function(){for(var Oe=[],xt=0;xt<arguments.length;xt++)Oe[xt]=arguments[xt];var Mt=this._middleware?this._middleware:this._planAndResolve();this._middleware=Oe.reduce(function(Et,St){return St(Et)},Mt)},at.prototype.applyCustomMetadataReader=function(Oe){this._metadataReader=Oe},at.prototype.get=function(Oe){return this._get(!1,!1,a.TargetTypeEnum.Variable,Oe)},at.prototype.getTagged=function(Oe,xt,Mt){return this._get(!1,!1,a.TargetTypeEnum.Variable,Oe,xt,Mt)},at.prototype.getNamed=function(Oe,xt){return this.getTagged(Oe,Y.NAMED_TAG,xt)},at.prototype.getAll=function(Oe){return this._get(!0,!0,a.TargetTypeEnum.Variable,Oe)},at.prototype.getAllTagged=function(Oe,xt,Mt){return this._get(!1,!0,a.TargetTypeEnum.Variable,Oe,xt,Mt)},at.prototype.getAllNamed=function(Oe,xt){return this.getAllTagged(Oe,Y.NAMED_TAG,xt)},at.prototype.resolve=function(Oe){var xt=this.createChild();return xt.bind(Oe).toSelf(),xt.get(Oe)},at.prototype._getContainerModuleHelpersFactory=function(){var Oe=this,xt=function(Ht,mt){Ht._binding.moduleId=mt},Mt=function(Ht){return function(mt){var Xe=Oe.bind.bind(Oe),Tt=Xe(mt);return xt(Tt,Ht),Tt}},Et=function(Ht){return function(mt){var Xe=Oe.unbind.bind(Oe);Xe(mt)}},St=function(Ht){return function(mt){var Xe=Oe.isBound.bind(Oe);return Xe(mt)}},or=function(Ht){return function(mt){var Xe=Oe.rebind.bind(Oe),Tt=Xe(mt);return xt(Tt,Ht),Tt}};return function($t){return{bindFunction:Mt($t),isboundFunction:St($t),rebindFunction:or($t),unbindFunction:Et($t)}}},at.prototype._get=function(Oe,xt,Mt,Et,St,or){var $t=null,Ht={avoidConstraints:Oe,contextInterceptor:function(Xe){return Xe},isMultiInject:xt,key:St,serviceIdentifier:Et,targetType:Mt,value:or};if(this._middleware){if($t=this._middleware(Ht),$t==null)throw new Error(F.INVALID_MIDDLEWARE_RETURN)}else $t=this._planAndResolve()(Ht);return $t},at.prototype._planAndResolve=function(){var Oe=this;return function(xt){var Mt=Q.plan(Oe._metadataReader,Oe,xt.isMultiInject,xt.targetType,xt.serviceIdentifier,xt.key,xt.value,xt.avoidConstraints);Mt=xt.contextInterceptor(Mt);var Et=re.resolve(Mt);return Et}},at}();x.Container=Re},"9NmV":function(Ie,x){var o="\\ud800-\\udfff",b="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",F=b+v+Z,a="\\u2700-\\u27bf",Y="a-z\\xdf-\\xf6\\xf8-\\xff",B="\\xac\\xb1\\xd7\\xf7",Q="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",re="\\u2000-\\u206f",we=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",J="A-Z\\xc0-\\xd6\\xd8-\\xde",Ke="\\ufe0e\\ufe0f",Ge=B+Q+re+we,_e="['\u2019]",Re="["+Ge+"]",at="["+F+"]",Oe="\\d+",xt="["+a+"]",Mt="["+Y+"]",Et="[^"+o+Ge+Oe+a+Y+J+"]",St="\\ud83c[\\udffb-\\udfff]",or="(?:"+at+"|"+St+")",$t="[^"+o+"]",Ht="(?:\\ud83c[\\udde6-\\uddff]){2}",mt="[\\ud800-\\udbff][\\udc00-\\udfff]",Xe="["+J+"]",Tt="\\u200d",ze="(?:"+Mt+"|"+Et+")",st="(?:"+Xe+"|"+Et+")",Wt="(?:"+_e+"(?:d|ll|m|re|s|t|ve))?",bt="(?:"+_e+"(?:D|LL|M|RE|S|T|VE))?",dt=or+"?",H="["+Ke+"]?",z="(?:"+Tt+"(?:"+[$t,Ht,mt].join("|")+")"+H+dt+")*",V="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Se="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ve=H+dt+z,ce="(?:"+[xt,Ht,mt].join("|")+")"+ve,fe=RegExp([Xe+"?"+Mt+"+"+Wt+"(?="+[Re,Xe,"$"].join("|")+")",st+"+"+bt+"(?="+[Re,Xe+ze,"$"].join("|")+")",Xe+"?"+ze+"+"+Wt,Xe+"+"+bt,Se,V,Oe,ce].join("|"),"g");function ke(lt){return lt.match(fe)||[]}Ie.exports=ke},"9lTW":function(Ie,x,o){"use strict";(function(b){var v=o("MgzW");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function Z(ze,st){if(ze===st)return 0;for(var Wt=ze.length,bt=st.length,dt=0,H=Math.min(Wt,bt);dt<H;++dt)if(ze[dt]!==st[dt]){Wt=ze[dt],bt=st[dt];break}return Wt<bt?-1:bt<Wt?1:0}function F(ze){return b.Buffer&&typeof b.Buffer.isBuffer=="function"?b.Buffer.isBuffer(ze):!!(ze!=null&&ze._isBuffer)}var a=o("MCLT"),Y=Object.prototype.hasOwnProperty,B=Array.prototype.slice,Q=function(){return function(){}.name==="foo"}();function re(ze){return Object.prototype.toString.call(ze)}function we(ze){return F(ze)||typeof b.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(ze):ze?!!(ze instanceof DataView||ze.buffer&&ze.buffer instanceof ArrayBuffer):!1}var J=Ie.exports=xt,Ke=/\s*function\s+([^\(\s]*)\s*/;function Ge(ze){if(!!a.isFunction(ze)){if(Q)return ze.name;var st=ze.toString(),Wt=st.match(Ke);return Wt&&Wt[1]}}J.AssertionError=function(st){this.name="AssertionError",this.actual=st.actual,this.expected=st.expected,this.operator=st.operator,st.message?(this.message=st.message,this.generatedMessage=!1):(this.message=at(this),this.generatedMessage=!0);var Wt=st.stackStartFunction||Oe;if(Error.captureStackTrace)Error.captureStackTrace(this,Wt);else{var bt=new Error;if(bt.stack){var dt=bt.stack,H=Ge(Wt),z=dt.indexOf(`
`+H);if(z>=0){var V=dt.indexOf(`
`,z+1);dt=dt.substring(V+1)}this.stack=dt}}},a.inherits(J.AssertionError,Error);function _e(ze,st){return typeof ze=="string"?ze.length<st?ze:ze.slice(0,st):ze}function Re(ze){if(Q||!a.isFunction(ze))return a.inspect(ze);var st=Ge(ze),Wt=st?": "+st:"";return"[Function"+Wt+"]"}function at(ze){return _e(Re(ze.actual),128)+" "+ze.operator+" "+_e(Re(ze.expected),128)}function Oe(ze,st,Wt,bt,dt){throw new J.AssertionError({message:Wt,actual:ze,expected:st,operator:bt,stackStartFunction:dt})}J.fail=Oe;function xt(ze,st){ze||Oe(ze,!0,st,"==",J.ok)}J.ok=xt,J.equal=function(st,Wt,bt){st!=Wt&&Oe(st,Wt,bt,"==",J.equal)},J.notEqual=function(st,Wt,bt){st==Wt&&Oe(st,Wt,bt,"!=",J.notEqual)},J.deepEqual=function(st,Wt,bt){Mt(st,Wt,!1)||Oe(st,Wt,bt,"deepEqual",J.deepEqual)},J.deepStrictEqual=function(st,Wt,bt){Mt(st,Wt,!0)||Oe(st,Wt,bt,"deepStrictEqual",J.deepStrictEqual)};function Mt(ze,st,Wt,bt){if(ze===st)return!0;if(F(ze)&&F(st))return Z(ze,st)===0;if(a.isDate(ze)&&a.isDate(st))return ze.getTime()===st.getTime();if(a.isRegExp(ze)&&a.isRegExp(st))return ze.source===st.source&&ze.global===st.global&&ze.multiline===st.multiline&&ze.lastIndex===st.lastIndex&&ze.ignoreCase===st.ignoreCase;if((ze===null||typeof ze!="object")&&(st===null||typeof st!="object"))return Wt?ze===st:ze==st;if(we(ze)&&we(st)&&re(ze)===re(st)&&!(ze instanceof Float32Array||ze instanceof Float64Array))return Z(new Uint8Array(ze.buffer),new Uint8Array(st.buffer))===0;if(F(ze)!==F(st))return!1;bt=bt||{actual:[],expected:[]};var dt=bt.actual.indexOf(ze);return dt!==-1&&dt===bt.expected.indexOf(st)?!0:(bt.actual.push(ze),bt.expected.push(st),St(ze,st,Wt,bt))}function Et(ze){return Object.prototype.toString.call(ze)=="[object Arguments]"}function St(ze,st,Wt,bt){if(ze==null||st===null||st===void 0)return!1;if(a.isPrimitive(ze)||a.isPrimitive(st))return ze===st;if(Wt&&Object.getPrototypeOf(ze)!==Object.getPrototypeOf(st))return!1;var dt=Et(ze),H=Et(st);if(dt&&!H||!dt&&H)return!1;if(dt)return ze=B.call(ze),st=B.call(st),Mt(ze,st,Wt);var z=Tt(ze),V=Tt(st),Se,ve;if(z.length!==V.length)return!1;for(z.sort(),V.sort(),ve=z.length-1;ve>=0;ve--)if(z[ve]!==V[ve])return!1;for(ve=z.length-1;ve>=0;ve--)if(Se=z[ve],!Mt(ze[Se],st[Se],Wt,bt))return!1;return!0}J.notDeepEqual=function(st,Wt,bt){Mt(st,Wt,!1)&&Oe(st,Wt,bt,"notDeepEqual",J.notDeepEqual)},J.notDeepStrictEqual=or;function or(ze,st,Wt){Mt(ze,st,!0)&&Oe(ze,st,Wt,"notDeepStrictEqual",or)}J.strictEqual=function(st,Wt,bt){st!==Wt&&Oe(st,Wt,bt,"===",J.strictEqual)},J.notStrictEqual=function(st,Wt,bt){st===Wt&&Oe(st,Wt,bt,"!==",J.notStrictEqual)};function $t(ze,st){if(!ze||!st)return!1;if(Object.prototype.toString.call(st)=="[object RegExp]")return st.test(ze);try{if(ze instanceof st)return!0}catch(Wt){}return Error.isPrototypeOf(st)?!1:st.call({},ze)===!0}function Ht(ze){var st;try{ze()}catch(Wt){st=Wt}return st}function mt(ze,st,Wt,bt){var dt;if(typeof st!="function")throw new TypeError('"block" argument must be a function');typeof Wt=="string"&&(bt=Wt,Wt=null),dt=Ht(st),bt=(Wt&&Wt.name?" ("+Wt.name+").":".")+(bt?" "+bt:"."),ze&&!dt&&Oe(dt,Wt,"Missing expected exception"+bt);var H=typeof bt=="string",z=!ze&&a.isError(dt),V=!ze&&dt&&!Wt;if((z&&H&&$t(dt,Wt)||V)&&Oe(dt,Wt,"Got unwanted exception"+bt),ze&&dt&&Wt&&!$t(dt,Wt)||!ze&&dt)throw dt}J.throws=function(ze,st,Wt){mt(!0,ze,st,Wt)},J.doesNotThrow=function(ze,st,Wt){mt(!1,ze,st,Wt)},J.ifError=function(ze){if(ze)throw ze};function Xe(ze,st){ze||Oe(ze,!0,st,"==",Xe)}J.strict=v(Xe,J,{equal:J.strictEqual,deepEqual:J.deepStrictEqual,notEqual:J.notStrictEqual,notDeepEqual:J.notDeepStrictEqual}),J.strict.strict=J.strict;var Tt=Object.keys||function(ze){var st=[];for(var Wt in ze)Y.call(ze,Wt)&&st.push(Wt);return st}}).call(this,o("yLpj"))},"9nhX":function(Ie,x,o){var b=o("g4R6"),v=o("tLB3");function Z(F,a,Y){return Y===void 0&&(Y=a,a=void 0),Y!==void 0&&(Y=v(Y),Y=Y===Y?Y:0),a!==void 0&&(a=v(a),a=a===a?a:0),b(v(F),a,Y)}Ie.exports=Z},AFH1:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});var b;(function(v){v.TOPRIGHT="topright",v.TOPLEFT="topleft",v.BOTTOMRIGHT="bottomright",v.BOTTOMLEFT="bottomleft"})(b||(b={}))},APxj:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0});var b=o("Ucsi");function v(Z,F){F===void 0&&(F=!0);var a=b.makePropertyInjectDecorator(Z,F),Y=b.makePropertyInjectNamedDecorator(Z,F),B=b.makePropertyInjectTaggedDecorator(Z,F),Q=b.makePropertyMultiInjectDecorator(Z,F);return{lazyInject:a,lazyInjectNamed:Y,lazyInjectTagged:B,lazyMultiInject:Q}}x.default=v},AwBQ:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Lookup=void 0;var b=o("MON2"),v=function(){function Z(){this._map=new Map}return Z.prototype.getMap=function(){return this._map},Z.prototype.add=function(F,a){if(F==null)throw new Error(b.NULL_ARGUMENT);if(a==null)throw new Error(b.NULL_ARGUMENT);var Y=this._map.get(F);Y!==void 0?(Y.push(a),this._map.set(F,Y)):this._map.set(F,[a])},Z.prototype.get=function(F){if(F==null)throw new Error(b.NULL_ARGUMENT);var a=this._map.get(F);if(a!==void 0)return a;throw new Error(b.KEY_NOT_FOUND)},Z.prototype.remove=function(F){if(F==null)throw new Error(b.NULL_ARGUMENT);if(!this._map.delete(F))throw new Error(b.KEY_NOT_FOUND)},Z.prototype.removeByCondition=function(F){var a=this;this._map.forEach(function(Y,B){var Q=Y.filter(function(re){return!F(re)});Q.length>0?a._map.set(B,Q):a._map.delete(B)})},Z.prototype.hasKey=function(F){if(F==null)throw new Error(b.NULL_ARGUMENT);return this._map.has(F)},Z.prototype.clone=function(){var F=new Z;return this._map.forEach(function(a,Y){a.forEach(function(B){return F.add(Y,B.clone())})}),F},Z.prototype.traverse=function(F){this._map.forEach(function(a,Y){F(Y,a)})},Z}();x.Lookup=v},"B6l+":function(Ie,x,o){var b=o("Sq3C"),v=o("Z1HP"),Z=o("Sxd8"),F=o("dt0z");function a(Y,B,Q){Y=F(Y),B=Z(B);var re=B?v(Y):0;return B&&re<B?Y+b(B-re,Q):Y}Ie.exports=a},BGjm:function(Ie,x){Ie.exports=o;function o(b,v){v||(v=document);var Z=v.head||v.getElementsByTagName("head")[0];if(!Z){Z=v.createElement("head");var F=v.body||v.getElementsByTagName("body")[0];F?F.parentNode.insertBefore(Z,F):v.documentElement.appendChild(Z)}var a=v.createElement("style");return a.type="text/css",a.styleSheet?a.styleSheet.cssText=b:a.appendChild(v.createTextNode(b)),Z.appendChild(a),a}},BMrR:function(Ie,x,o){"use strict";var b=o("qrJ5");x.a=b.a},BkRI:function(Ie,x,o){var b=o("OBhP"),v=1,Z=4;function F(a){return b(a,v|Z)}Ie.exports=F},BpBL:function(Ie,x,o){"use strict";o.d(x,"a",function(){return v});var b=o("Hel2");function v(F,a){var Y=a.extent,B=new Promise(function(re){Z(F,function(we){re(we)})}),Q={images:B,_id:1,dataArray:[{_id:0,coordinates:[[Y[0],Y[1]],[Y[2],Y[3]]]}]};return Q}function Z(F,a){var Y=F,B=[];if(typeof Y=="string")Object(b.o)({url:Y},function(we,J){B.push(J),a(B)});else{var Q=Y.length,re=0;Y.forEach(function(we){Object(b.o)({url:we},function(J,Ke){re++,B.push(Ke),re===Q&&a(B)})})}return v}},CIdX:function(Ie,x,o){Ie.exports={waterWave:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWave",text:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-text",waterWaveCanvasWrapper:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWaveCanvasWrapper"}},CZoQ:function(Ie,x){function o(b,v,Z){for(var F=Z-1,a=b.length;++F<a;)if(b[F]===v)return F;return-1}Ie.exports=o},"D+ow":function(Ie,x){},D9lx:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingInWhenOnSyntax=void 0;var b=o("6AGu"),v=o("406g"),Z=o("z4Hk"),F=function(){function a(Y){this._binding=Y,this._bindingWhenSyntax=new Z.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new v.BindingOnSyntax(this._binding),this._bindingInSyntax=new b.BindingInSyntax(Y)}return a.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},a.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},a.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},a.prototype.when=function(Y){return this._bindingWhenSyntax.when(Y)},a.prototype.whenTargetNamed=function(Y){return this._bindingWhenSyntax.whenTargetNamed(Y)},a.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},a.prototype.whenTargetTagged=function(Y,B){return this._bindingWhenSyntax.whenTargetTagged(Y,B)},a.prototype.whenInjectedInto=function(Y){return this._bindingWhenSyntax.whenInjectedInto(Y)},a.prototype.whenParentNamed=function(Y){return this._bindingWhenSyntax.whenParentNamed(Y)},a.prototype.whenParentTagged=function(Y,B){return this._bindingWhenSyntax.whenParentTagged(Y,B)},a.prototype.whenAnyAncestorIs=function(Y){return this._bindingWhenSyntax.whenAnyAncestorIs(Y)},a.prototype.whenNoAncestorIs=function(Y){return this._bindingWhenSyntax.whenNoAncestorIs(Y)},a.prototype.whenAnyAncestorNamed=function(Y){return this._bindingWhenSyntax.whenAnyAncestorNamed(Y)},a.prototype.whenAnyAncestorTagged=function(Y,B){return this._bindingWhenSyntax.whenAnyAncestorTagged(Y,B)},a.prototype.whenNoAncestorNamed=function(Y){return this._bindingWhenSyntax.whenNoAncestorNamed(Y)},a.prototype.whenNoAncestorTagged=function(Y,B){return this._bindingWhenSyntax.whenNoAncestorTagged(Y,B)},a.prototype.whenAnyAncestorMatches=function(Y){return this._bindingWhenSyntax.whenAnyAncestorMatches(Y)},a.prototype.whenNoAncestorMatches=function(Y){return this._bindingWhenSyntax.whenNoAncestorMatches(Y)},a.prototype.onActivation=function(Y){return this._bindingOnSyntax.onActivation(Y)},a}();x.BindingInWhenOnSyntax=F},DnfT:function(Ie,x,o){Ie.exports={"ant-pro-grid-content":"ant-pro-grid-content",wide:"wide"}},"Dw+G":function(Ie,x,o){var b=o("juv8"),v=o("mTTR");function Z(F,a){return F&&b(a,v(a),F)}Ie.exports=Z},DzJC:function(Ie,x,o){var b=o("sEfC"),v=o("GoyQ"),Z="Expected a function";function F(a,Y,B){var Q=!0,re=!0;if(typeof a!="function")throw new TypeError(Z);return v(B)&&(Q="leading"in B?!!B.leading:Q,re="trailing"in B?!!B.trailing:re),b(a,Y,{leading:Q,maxWait:Y,trailing:re})}Ie.exports=F},EA7m:function(Ie,x,o){var b=o("zZ0H"),v=o("Ioao"),Z=o("wclG");function F(a,Y){return Z(v(a,Y,b),a+"")}Ie.exports=F},EEGq:function(Ie,x,o){var b=o("juv8"),v=o("oCl/");function Z(F,a){return b(F,v(F),a)}Ie.exports=Z},EfZ0:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});var b={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},Em2t:function(Ie,x,o){var b=o("bahg"),v=o("quyA"),Z=o("0JQy");function F(a){return v(a)?Z(a):b(a)}Ie.exports=F},FI6e:function(Ie,x){},FRQA:function(Ie,x,o){"use strict";var b=o("GNNt"),v=o("wEI+"),Z=o("DnfT"),F=o.n(Z),a=o("q1tI"),Y=o.n(a),B=o("TSYQ"),Q=o.n(B),re=o("jYQm"),we=function(Ke){var Ge=Object(a.useContext)(re.a),_e=Ke.children,Re=Ke.contentWidth,at=Ke.className,Oe=Ke.style,xt=Object(a.useContext)(v.b.ConfigContext),Mt=xt.getPrefixCls,Et=Ke.prefixCls||Mt("pro"),St=Re||Ge.contentWidth,or="".concat(Et,"-grid-content");return Y.a.createElement("div",{className:Q()(or,at,{wide:St==="Fixed"}),style:Oe},Y.a.createElement("div",{className:"".concat(Et,"-grid-content-children")},_e))};x.a=we},FV85:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.TargetTypeEnum=x.BindingTypeEnum=x.BindingScopeEnum=void 0;var b={Request:"Request",Singleton:"Singleton",Transient:"Transient"};x.BindingScopeEnum=b;var v={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};x.BindingTypeEnum=v;var Z={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};x.TargetTypeEnum=Z},FmoU:function(Ie,x,o){"use strict";o.d(x,"a",function(){return Et}),o.d(x,"b",function(){return Ht});var b=function(z,V,Se){z.prototype=V.prototype=Se,Se.constructor=z};function v(z,V){var Se=Object.create(z.prototype);for(var ve in V)Se[ve]=V[ve];return Se}function Z(){}var F=.7,a=1/F,Y="\\s*([+-]?\\d+)\\s*",B="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Q="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",re=/^#([0-9a-f]{3,8})$/,we=new RegExp("^rgb\\("+[Y,Y,Y]+"\\)$"),J=new RegExp("^rgb\\("+[Q,Q,Q]+"\\)$"),Ke=new RegExp("^rgba\\("+[Y,Y,Y,B]+"\\)$"),Ge=new RegExp("^rgba\\("+[Q,Q,Q,B]+"\\)$"),_e=new RegExp("^hsl\\("+[B,Q,Q]+"\\)$"),Re=new RegExp("^hsla\\("+[B,Q,Q,B]+"\\)$"),at={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};b(Z,Et,{copy:function(V){return Object.assign(new this.constructor,this,V)},displayable:function(){return this.rgb().displayable()},hex:Oe,formatHex:Oe,formatHsl:xt,formatRgb:Mt,toString:Mt});function Oe(){return this.rgb().formatHex()}function xt(){return Wt(this).formatHsl()}function Mt(){return this.rgb().formatRgb()}function Et(z){var V,Se;return z=(z+"").trim().toLowerCase(),(V=re.exec(z))?(Se=V[1].length,V=parseInt(V[1],16),Se===6?St(V):Se===3?new mt(V>>8&15|V>>4&240,V>>4&15|V&240,(V&15)<<4|V&15,1):Se===8?or(V>>24&255,V>>16&255,V>>8&255,(V&255)/255):Se===4?or(V>>12&15|V>>8&240,V>>8&15|V>>4&240,V>>4&15|V&240,((V&15)<<4|V&15)/255):null):(V=we.exec(z))?new mt(V[1],V[2],V[3],1):(V=J.exec(z))?new mt(V[1]*255/100,V[2]*255/100,V[3]*255/100,1):(V=Ke.exec(z))?or(V[1],V[2],V[3],V[4]):(V=Ge.exec(z))?or(V[1]*255/100,V[2]*255/100,V[3]*255/100,V[4]):(V=_e.exec(z))?st(V[1],V[2]/100,V[3]/100,1):(V=Re.exec(z))?st(V[1],V[2]/100,V[3]/100,V[4]):at.hasOwnProperty(z)?St(at[z]):z==="transparent"?new mt(NaN,NaN,NaN,0):null}function St(z){return new mt(z>>16&255,z>>8&255,z&255,1)}function or(z,V,Se,ve){return ve<=0&&(z=V=Se=NaN),new mt(z,V,Se,ve)}function $t(z){return z instanceof Z||(z=Et(z)),z?(z=z.rgb(),new mt(z.r,z.g,z.b,z.opacity)):new mt}function Ht(z,V,Se,ve){return arguments.length===1?$t(z):new mt(z,V,Se,ve==null?1:ve)}function mt(z,V,Se,ve){this.r=+z,this.g=+V,this.b=+Se,this.opacity=+ve}b(mt,Ht,v(Z,{brighter:function(V){return V=V==null?a:Math.pow(a,V),new mt(this.r*V,this.g*V,this.b*V,this.opacity)},darker:function(V){return V=V==null?F:Math.pow(F,V),new mt(this.r*V,this.g*V,this.b*V,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xe,formatHex:Xe,formatRgb:Tt,toString:Tt}));function Xe(){return"#"+ze(this.r)+ze(this.g)+ze(this.b)}function Tt(){var z=this.opacity;return z=isNaN(z)?1:Math.max(0,Math.min(1,z)),(z===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(z===1?")":", "+z+")")}function ze(z){return z=Math.max(0,Math.min(255,Math.round(z)||0)),(z<16?"0":"")+z.toString(16)}function st(z,V,Se,ve){return ve<=0?z=V=Se=NaN:Se<=0||Se>=1?z=V=NaN:V<=0&&(z=NaN),new dt(z,V,Se,ve)}function Wt(z){if(z instanceof dt)return new dt(z.h,z.s,z.l,z.opacity);if(z instanceof Z||(z=Et(z)),!z)return new dt;if(z instanceof dt)return z;z=z.rgb();var V=z.r/255,Se=z.g/255,ve=z.b/255,ce=Math.min(V,Se,ve),fe=Math.max(V,Se,ve),ke=NaN,lt=fe-ce,nt=(fe+ce)/2;return lt?(V===fe?ke=(Se-ve)/lt+(Se<ve)*6:Se===fe?ke=(ve-V)/lt+2:ke=(V-Se)/lt+4,lt/=nt<.5?fe+ce:2-fe-ce,ke*=60):lt=nt>0&&nt<1?0:ke,new dt(ke,lt,nt,z.opacity)}function bt(z,V,Se,ve){return arguments.length===1?Wt(z):new dt(z,V,Se,ve==null?1:ve)}function dt(z,V,Se,ve){this.h=+z,this.s=+V,this.l=+Se,this.opacity=+ve}b(dt,bt,v(Z,{brighter:function(V){return V=V==null?a:Math.pow(a,V),new dt(this.h,this.s,this.l*V,this.opacity)},darker:function(V){return V=V==null?F:Math.pow(F,V),new dt(this.h,this.s,this.l*V,this.opacity)},rgb:function(){var V=this.h%360+(this.h<0)*360,Se=isNaN(V)||isNaN(this.s)?0:this.s,ve=this.l,ce=ve+(ve<.5?ve:1-ve)*Se,fe=2*ve-ce;return new mt(H(V>=240?V-240:V+120,fe,ce),H(V,fe,ce),H(V<120?V+240:V-120,fe,ce),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var V=this.opacity;return V=isNaN(V)?1:Math.max(0,Math.min(1,V)),(V===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(V===1?")":", "+V+")")}}));function H(z,V,Se){return(z<60?V+(Se-V)*z/60:z<180?Se:z<240?V+(Se-V)*(240-z)/60:V)*255}},G6z8:function(Ie,x,o){var b=o("fR/l"),v=o("oCl/"),Z=o("mTTR");function F(a){return b(a,Z,v)}Ie.exports=F},GXnB:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Metadata=void 0;var b=o("xfSm"),v=function(){function Z(F,a){this.key=F,this.value=a}return Z.prototype.toString=function(){return this.key===b.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},Z}();x.Metadata=v},Gi0A:function(Ie,x,o){var b=o("QqLw"),v=o("ExA7"),Z="[object Map]";function F(a){return v(a)&&b(a)==Z}Ie.exports=F},"H+7v":function(Ie,x,o){Ie.exports={activeChart:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChart",activeChartGrid:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartGrid",activeChartLegend:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartLegend",dashedLine:"antd-pro-pages-dashboard-monitor-components-active-chart-index-dashedLine",line:"antd-pro-pages-dashboard-monitor-components-active-chart-index-line"}},Hel2:function(Ie,x,o){"use strict";o.d(x,"o",function(){return ft}),o.d(x,"m",function(){return w}),o.d(x,"p",function(){return Ve}),o.d(x,"d",function(){return $}),o.d(x,"q",function(){return ie}),o.d(x,"r",function(){return jt}),o.d(x,"j",function(){return lr}),o.d(x,"h",function(){return ct}),o.d(x,"b",function(){return ht}),o.d(x,"i",function(){return Pt}),o.d(x,"s",function(){return Pe}),o.d(x,"k",function(){return ut}),o.d(x,"l",function(){return Qe}),o.d(x,"n",function(){return Vt}),o.d(x,"f",function(){return pr}),o.d(x,"e",function(){return Zr}),o.d(x,"g",function(){return cr}),o.d(x,"a",function(){return b}),o.d(x,"c",function(){return v});var b={};o.r(b),o.d(b,"getContainer",function(){return Q}),o.d(b,"trim",function(){return re}),o.d(b,"splitWords",function(){return we}),o.d(b,"create",function(){return Ke}),o.d(b,"remove",function(){return Ge}),o.d(b,"addClass",function(){return _e}),o.d(b,"removeClass",function(){return Re}),o.d(b,"hasClass",function(){return at}),o.d(b,"setClass",function(){return Oe}),o.d(b,"getClass",function(){return xt}),o.d(b,"empty",function(){return Mt}),o.d(b,"setTransform",function(){return St}),o.d(b,"triggerResize",function(){return or}),o.d(b,"printCanvas",function(){return $t}),o.d(b,"getViewPortScale",function(){return Ht}),o.d(b,"DPR",function(){return mt});var v={};o.r(v),o.d(v,"sum",function(){return ni}),o.d(v,"max",function(){return jn}),o.d(v,"min",function(){return En}),o.d(v,"mean",function(){return fi}),o.d(v,"mode",function(){return Zn}),o.d(v,"statMap",function(){return Vn}),o.d(v,"getColumn",function(){return Te}),o.d(v,"getSatByColumn",function(){return de});function Z(W){var se=131,Le=137,et=0;W+="x";for(var wt=Math.floor(9007199254740991/Le),Ne=0;Ne<W.length;Ne++)et>wt&&(et=Math.floor(et/Le)),et=et*se+W.charCodeAt(Ne);return et}function F(W){W=W.toString();for(var se=5381,Le=W.length;Le;)se=se*33^W.charCodeAt(--Le);return se>>>0}var a=o("J4zp"),Y=o.n(a),B=window.document.documentElement.style;function Q(W){var se=W;return typeof W=="string"&&(se=document.getElementById(W)),se}function re(W){return W.trim?W.trim():W.replace(/^\s+|\s+$/g,"")}function we(W){return re(W).split(/\s+/)}function J(W){if(!B)return W[0];for(var se in W)if(W[se]&&W[se]in B)return W[se];return W[0]}function Ke(W,se,Le){var et=document.createElement(W);return et.className=se||"",Le&&Le.appendChild(et),et}function Ge(W){var se=W.parentNode;se&&se.removeChild(W)}function _e(W,se){if(W.classList!==void 0)for(var Le=we(se),et=0,wt=Le.length;et<wt;et++)W.classList.add(Le[et]);else if(!at(W,se)){var Ne=xt(W);Oe(W,(Ne?Ne+" ":"")+se)}}function Re(W,se){W.classList!==void 0?W.classList.remove(se):Oe(W,re((" "+xt(W)+" ").replace(" "+se+" "," ")))}function at(W,se){if(W.classList!==void 0)return W.classList.contains(se);var Le=xt(W);return Le.length>0&&new RegExp("(^|\\s)"+se+"(\\s|$)").test(Le)}function Oe(W,se){W instanceof HTMLElement?W.className=se:W.className.baseVal=se}function xt(W){return W instanceof SVGElement&&(W=W.correspondingElement),W.className.baseVal===void 0?W.className:W.className.baseVal}function Mt(W){for(;W&&W.firstChild;)W.removeChild(W.firstChild)}var Et=J(["transform","WebkitTransform"]);function St(W,se){W.style[Et]=se}function or(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var W=window.document.createEvent("UIEvents");W.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(W)}}function $t(W){var se=["padding: "+(W.height/2-8)+"px "+W.width/2+"px;","line-height: "+W.height+"px;","background-image: url("+W.toDataURL()+");"];console.log(`%c
`,se.join(""))}function Ht(){var W,se=document.querySelector('meta[name="viewport"]');if(!se)return 1;var Le=(W=se.content)===null||W===void 0?void 0:W.split(","),et=Le.find(function(wt){var Ne=wt.split("="),gt=Y()(Ne,2),qt=gt[0],zr=gt[1];return qt==="initial-scale"});return et?et.split("=")[1]*1:1}var mt=Ht()<1?1:window.devicePixelRatio,Xe=o("lwsE"),Tt=o.n(Xe),ze=o("W8MJ"),st=o.n(ze),Wt=o("7W2i"),bt=o.n(Wt),dt=o("a1gu"),H=o.n(dt),z=o("Nsbk"),V=o.n(z),Se=o("oShl"),ve=o.n(Se);function ce(W){var se=fe();return function(){var et=V()(W),wt;if(se){var Ne=V()(this).constructor;wt=Reflect.construct(et,arguments,Ne)}else wt=et.apply(this,arguments);return H()(this,wt)}}function fe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(W){return!1}}var ke=function(W){bt()(Le,W);var se=ce(Le);function Le(et,wt,Ne){var gt;return Tt()(this,Le),gt=se.call(this,et),gt.status=void 0,gt.url=void 0,gt.status=wt,gt.url=Ne,gt.name=gt.constructor.name,gt.message=et,gt}return st()(Le,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),Le}(ve()(Error));function lt(W){var se=new XMLHttpRequest;se.open("GET",W.url,!0);for(var Le in W.headers)W.headers.hasOwnProperty(Le)&&se.setRequestHeader(Le,W.headers[Le]);return se.withCredentials=W.credentials==="include",se}var nt=function(se,Le){var et=lt(se);return et.setRequestHeader("Accept","application/json"),et.onerror=function(){Le(new Error(et.statusText))},et.onload=function(){if(et.status>=200&&et.status<300&&et.response){var wt;try{wt=JSON.parse(et.response)}catch(Ne){return Le(Ne)}Le(null,wt)}else et.status===401?Le(new ke("".concat(et.statusText),et.status,se.url)):Le(new ke(et.statusText,et.status,se.url))},et.send(),et},le=function(se,Le){var et=lt(se);return et.responseType="arraybuffer",et.onerror=function(){Le(new Error(et.statusText))},et.onload=function(){var wt=et.response;if(wt.byteLength===0&&et.status===200)return Le(new Error("http status 200 returned without content."));et.status>=200&&et.status<300&&et.response?Le(null,{data:wt,cacheControl:et.getResponseHeader("Cache-Control"),expires:et.getResponseHeader("Expires")}):Le(new ke(et.statusText,et.status,se.url))},et.send(),et};function ye(W){var se=window.document.createElement("a");return se.href=W,se.protocol===window.document.location.protocol&&se.host===window.document.location.host}var He="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",ft=function(se,Le){return le(se,function(et,wt){if(et)Le(et);else if(wt){var Ne=new window.Image;Ne.crossOrigin="anonymous";var gt=window.URL||window.webkitURL;Ne.onload=function(){Le(null,Ne),gt.revokeObjectURL(Ne.src)};var qt=new window.Blob([new Uint8Array(wt.data)],{type:"image/png"});Ne.src=wt.data.byteLength?gt.createObjectURL(qt):He}})},De=o("0wsv"),Ze=2*Math.PI*6378137/2;function w(W){var se=[Infinity,Infinity,-Infinity,-Infinity];return W.forEach(function(Le){var et=Le.coordinates;R(se,et)}),se}function R(W,se){return Array.isArray(se[0])?se.forEach(function(Le){R(W,Le)}):(W[0]>se[0]&&(W[0]=se[0]),W[1]>se[1]&&(W[1]=se[1]),W[2]<se[0]&&(W[2]=se[0]),W[3]<se[1]&&(W[3]=se[1])),W}function q(W,se){return he(W,se)}function he(W,se){return Array.isArray(W[0])?W.map(function(Le){return he(Le,se)}):se(W)}function Ve(W){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,Le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};W=Nt(W,se);var et=W[0],wt=W[1],Ne=et*Ze/180,gt=Math.log(Math.tan((90+wt)*Math.PI/360))/(Math.PI/180);return gt=gt*Ze/180,Le.enable&&(Ne=Number(Ne.toFixed(Le.decimal)),gt=Number(gt.toFixed(Le.decimal))),W.length===3?[Ne,gt,W[2]]:[Ne,gt]}function Ye(W){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,Le=W[0],et=W[1],wt=Le/Ze*180,Ne=et/Ze*180;return Ne=180/Math.PI*(2*Math.atan(Math.exp(Ne*Math.PI/180))-Math.PI/2),se!=null&&(wt=Number(wt.toFixed(se)),Ne=Number(Ne.toFixed(se))),W.length===3?[wt,Ne,W[2]]:[wt,Ne]}function yt(W){if(W==null)throw new Error("lng is required");return(W>180||W<-180)&&(W=W%360,W>180&&(W=-360+W),W<-180&&(W=360+W),W===0&&(W=0)),W}function it(W){if(W==null)throw new Error("lat is required");return(W>90||W<-90)&&(W=W%180,W>90&&(W=-180+W),W<-90&&(W=180+W),W===0&&(W=0)),W}function Nt(W,se){if(se===!1)return W;var Le=yt(W[0]),et=it(W[1]);return et>85&&(et=85),et<-85&&(et=-85),W.length===3?[Le,et,W[2]]:[Le,et]}function $(W){var se=85.0511287798,Le=Math.max(Math.min(se,W[1]),-se),et=256<<20,wt=Math.PI/180,Ne=W[0]*wt,gt=Le*wt;gt=Math.log(Math.tan(Math.PI/4+gt/2));var qt=.5/Math.PI,zr=.5,Br=-.5/Math.PI;return wt=.5,Ne=et*(qt*Ne+zr),gt=et*(Br*gt+wt),[Math.floor(Ne),Math.floor(gt)]}function $e(W){var se=.5/Math.PI,Le=.5,et=-.5/Math.PI,wt=.5,Ne=256<<20,gt=Y()(W,2),qt=gt[0],zr=gt[1];qt=(qt/Ne-Le)/se,zr=(zr/Ne-wt)/et,zr=(Math.atan(Math.pow(Math.E,zr))-Math.PI/4)*2,wt=Math.PI/180;var Br=zr/wt,sr=qt/wt;return[sr,Br]}function ie(W,se,Le){var et=Object(De.a)(se[1]-W[1]),wt=Object(De.a)(se[0]-W[0]),Ne=Object(De.a)(W[1]),gt=Object(De.a)(se[1]),qt=Math.pow(Math.sin(et/2),2)+Math.pow(Math.sin(wt/2),2)*Math.cos(Ne)*Math.cos(gt);return Object(De.g)(2*Math.atan2(Math.sqrt(qt),Math.sqrt(1-qt)),Le="meters")}function qe(W){var se=Math.PI/180,Le=85.0511287798,et=6378137,wt=Math.max(Math.min(Le,W[1]),-Le),Ne=Math.sin(wt*se),gt=et*W[0]*se,qt=et*Math.log((1+Ne)/(1-Ne))/2;return[gt,qt]}function jt(W,se){var Le=Math.abs(W[1][1]-W[0][1])*se,et=Math.abs(W[1][0]-W[0][0])*se;return[[W[0][0]-et,W[0][1]-Le],[W[1][0]+et,W[1][1]+Le]]}function lr(W,se){return W[0][0]<=se[0][0]&&W[0][1]<=se[0][1]&&W[1][0]>=se[1][0]&&W[1][1]>=se[1][1]}function ct(W){return[[W[0],W[1]],[W[2],W[3]]]}var ht=function(){function W(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,Le=arguments.length>1?arguments[1]:void 0;Tt()(this,W),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=se,this.destroy=Le||this.defaultDestroy,this.order=[],this.clear()}return st()(W,[{key:"clear",value:function(){var Le=this;this.order.forEach(function(et){Le.delete(et)}),this.cache={},this.order=[]}},{key:"get",value:function(Le){var et=this.cache[Le];return et&&(this.deleteOrder(Le),this.appendOrder(Le)),et}},{key:"set",value:function(Le,et){this.cache[Le]?(this.delete(Le),this.cache[Le]=et,this.appendOrder(Le)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[Le]=et,this.appendOrder(Le))}},{key:"delete",value:function(Le){var et=this.cache[Le];et&&(this.deleteCache(Le),this.deleteOrder(Le),this.destroy(et,Le))}},{key:"deleteCache",value:function(Le){delete this.cache[Le]}},{key:"deleteOrder",value:function(Le){var et=this.order.findIndex(function(wt){return wt===Le});et>=0&&this.order.splice(et,1)}},{key:"appendOrder",value:function(Le){this.order.push(Le)}},{key:"defaultDestroy",value:function(Le,et){return null}}]),W}();function Pt(W,se){W.forEach(function(Le){!se[Le]||(se[Le]=se[Le].bind(se))})}var vt=o("FmoU");function Pe(W){var se=vt.a(W),Le=[0,0,0,0];return se!=null&&(Le[0]=se.r/255,Le[1]=se.g/255,Le[2]=se.b/255,Le[3]=se.opacity),Le}function ut(W){var se=W&&W[0],Le=W&&W[1],et=W&&W[2],wt=se+Le*256+et*65536-1;return wt}function Qe(W){return[W+1&255,W+1>>8&255,W+1>>8>>8&255]}function Vt(W){var se=document.createElement("canvas"),Le=se.getContext("2d");se.width=256,se.height=1;for(var et=Le.createLinearGradient(0,0,256,1),wt=null,Ne=W.positions[0],gt=W.positions[W.positions.length-1],qt=0;qt<W.colors.length;++qt){var zr=(W.positions[qt]-Ne)/(gt-Ne);et.addColorStop(zr,W.colors[qt])}return Le.fillStyle=et,Le.fillRect(0,0,256,1),wt=new Uint8ClampedArray(Le.getImageData(0,0,256,1).data),new ImageData(wt,256,1)}var pr;(function(W){W.CENTER="center",W.TOP="top",W["TOP-LEFT"]="top-left",W["TOP-RIGHT"]="top-right",W.BOTTOM="bottom",W["BOTTOM-LEFT"]="bottom-left",W.LEFT="left",W.RIGHT="right"})(pr||(pr={}));var Zr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function cr(W,se,Le){var et=W.classList;for(var wt in Zr)Zr.hasOwnProperty(wt)&&et.remove("l7-".concat(Le,"-anchor-").concat(wt));et.add("l7-".concat(Le,"-anchor-").concat(se))}function jn(W){if(W.length===0)throw new Error("max requires at least one data point");for(var se=W[0],Le=1;Le<W.length;Le++)W[Le]>se&&(se=W[Le]);return se*1}function En(W){if(W.length===0)throw new Error("min requires at least one data point");for(var se=W[0],Le=1;Le<W.length;Le++)W[Le]<se&&(se=W[Le]);return se*1}function ni(W){if(W.length===0)return 0;for(var se=W[0]*1,Le=1;Le<W.length;Le++)se+=W[Le]*1;return se}function fi(W){if(W.length===0)throw new Error("mean requires at least one data point");return ni(W)/W.length}function Zn(W){if(W.length===0)throw new Error("mean requires at least one data point");if(W.length<3)return W[0];W.sort();for(var se=W[0],Le=NaN,et=0,wt=1,Ne=1;Ne<W.length+1;Ne++)W[Ne]!==se?(wt>et&&(et=wt,Le=se),wt=1,se=W[Ne]):wt++;return Le*1}var Vn={min:En,max:jn,mean:fi,sum:ni,mode:Zn};function Te(W,se){return W.map(function(Le){return Le[se]})}function de(W,se){return Vn[W](se)}},HpQ9:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.ContainerSnapshot=void 0;var b=function(){function v(){}return v.of=function(Z,F){var a=new v;return a.bindings=Z,a.middleware=F,a},v}();x.ContainerSnapshot=b},HthE:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b}),o.d(x,"b",function(){return v});var b;(function(Z){Z[Z.LNGLAT=1]="LNGLAT",Z[Z.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",Z[Z.VECTOR_TILE=3]="VECTOR_TILE",Z[Z.IDENTITY=4]="IDENTITY",Z[Z.P20=5]="P20",Z[Z.P20_OFFSET=6]="P20_OFFSET",Z[Z.METER_OFFSET=7]="METER_OFFSET"})(b||(b={}));var v={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(Ie,x,o){"use strict";(function(b){o.d(x,"a",function(){return Z});var v=o("U8pU");function Z(F){if(typeof window!="undefined"&&Object(v.a)(window.process)==="object"&&window.process.type==="renderer"||typeof b!="undefined"&&Object(v.a)(b.versions)==="object"&&Boolean(b.versions.electron))return!0;var a=(typeof navigator=="undefined"?"undefined":Object(v.a)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,Y=F||a;return!!(Y&&Y.indexOf("Electron")>=0)}}).call(this,o("Q2Ig"))},IOcx:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b}),o.d(x,"b",function(){return st}),o.d(x,"c",function(){return Wt}),o.d(x,"d",function(){return bt}),o.d(x,"e",function(){return dt});var b={};o.r(b),o.d(b,"create",function(){return Z}),o.d(b,"clone",function(){return F}),o.d(b,"copy",function(){return a}),o.d(b,"identity",function(){return Y}),o.d(b,"fromValues",function(){return B}),o.d(b,"set",function(){return Q}),o.d(b,"transpose",function(){return re}),o.d(b,"invert",function(){return we}),o.d(b,"adjoint",function(){return J}),o.d(b,"determinant",function(){return Ke}),o.d(b,"multiply",function(){return Ge}),o.d(b,"rotate",function(){return _e}),o.d(b,"scale",function(){return Re}),o.d(b,"fromRotation",function(){return at}),o.d(b,"fromScaling",function(){return Oe}),o.d(b,"str",function(){return xt}),o.d(b,"frob",function(){return Mt}),o.d(b,"LDU",function(){return Et}),o.d(b,"add",function(){return St}),o.d(b,"subtract",function(){return or}),o.d(b,"exactEquals",function(){return $t}),o.d(b,"equals",function(){return Ht}),o.d(b,"multiplyScalar",function(){return mt}),o.d(b,"multiplyScalarAndAdd",function(){return Xe}),o.d(b,"mul",function(){return Tt}),o.d(b,"sub",function(){return ze});var v=o("yU0y");function Z(){var H=new v.a(4);return v.a!=Float32Array&&(H[1]=0,H[2]=0),H[0]=1,H[3]=1,H}function F(H){var z=new v.a(4);return z[0]=H[0],z[1]=H[1],z[2]=H[2],z[3]=H[3],z}function a(H,z){return H[0]=z[0],H[1]=z[1],H[2]=z[2],H[3]=z[3],H}function Y(H){return H[0]=1,H[1]=0,H[2]=0,H[3]=1,H}function B(H,z,V,Se){var ve=new v.a(4);return ve[0]=H,ve[1]=z,ve[2]=V,ve[3]=Se,ve}function Q(H,z,V,Se,ve){return H[0]=z,H[1]=V,H[2]=Se,H[3]=ve,H}function re(H,z){if(H===z){var V=z[1];H[1]=z[2],H[2]=V}else H[0]=z[0],H[1]=z[2],H[2]=z[1],H[3]=z[3];return H}function we(H,z){var V=z[0],Se=z[1],ve=z[2],ce=z[3],fe=V*ce-ve*Se;return fe?(fe=1/fe,H[0]=ce*fe,H[1]=-Se*fe,H[2]=-ve*fe,H[3]=V*fe,H):null}function J(H,z){var V=z[0];return H[0]=z[3],H[1]=-z[1],H[2]=-z[2],H[3]=V,H}function Ke(H){return H[0]*H[3]-H[2]*H[1]}function Ge(H,z,V){var Se=z[0],ve=z[1],ce=z[2],fe=z[3],ke=V[0],lt=V[1],nt=V[2],le=V[3];return H[0]=Se*ke+ce*lt,H[1]=ve*ke+fe*lt,H[2]=Se*nt+ce*le,H[3]=ve*nt+fe*le,H}function _e(H,z,V){var Se=z[0],ve=z[1],ce=z[2],fe=z[3],ke=Math.sin(V),lt=Math.cos(V);return H[0]=Se*lt+ce*ke,H[1]=ve*lt+fe*ke,H[2]=Se*-ke+ce*lt,H[3]=ve*-ke+fe*lt,H}function Re(H,z,V){var Se=z[0],ve=z[1],ce=z[2],fe=z[3],ke=V[0],lt=V[1];return H[0]=Se*ke,H[1]=ve*ke,H[2]=ce*lt,H[3]=fe*lt,H}function at(H,z){var V=Math.sin(z),Se=Math.cos(z);return H[0]=Se,H[1]=V,H[2]=-V,H[3]=Se,H}function Oe(H,z){return H[0]=z[0],H[1]=0,H[2]=0,H[3]=z[1],H}function xt(H){return"mat2("+H[0]+", "+H[1]+", "+H[2]+", "+H[3]+")"}function Mt(H){return Math.hypot(H[0],H[1],H[2],H[3])}function Et(H,z,V,Se){return H[2]=Se[2]/Se[0],V[0]=Se[0],V[1]=Se[1],V[3]=Se[3]-H[2]*V[1],[H,z,V]}function St(H,z,V){return H[0]=z[0]+V[0],H[1]=z[1]+V[1],H[2]=z[2]+V[2],H[3]=z[3]+V[3],H}function or(H,z,V){return H[0]=z[0]-V[0],H[1]=z[1]-V[1],H[2]=z[2]-V[2],H[3]=z[3]-V[3],H}function $t(H,z){return H[0]===z[0]&&H[1]===z[1]&&H[2]===z[2]&&H[3]===z[3]}function Ht(H,z){var V=H[0],Se=H[1],ve=H[2],ce=H[3],fe=z[0],ke=z[1],lt=z[2],nt=z[3];return Math.abs(V-fe)<=v.b*Math.max(1,Math.abs(V),Math.abs(fe))&&Math.abs(Se-ke)<=v.b*Math.max(1,Math.abs(Se),Math.abs(ke))&&Math.abs(ve-lt)<=v.b*Math.max(1,Math.abs(ve),Math.abs(lt))&&Math.abs(ce-nt)<=v.b*Math.max(1,Math.abs(ce),Math.abs(nt))}function mt(H,z,V){return H[0]=z[0]*V,H[1]=z[1]*V,H[2]=z[2]*V,H[3]=z[3]*V,H}function Xe(H,z,V,Se){return H[0]=z[0]+V[0]*Se,H[1]=z[1]+V[1]*Se,H[2]=z[2]+V[2]*Se,H[3]=z[3]+V[3]*Se,H}var Tt=Ge,ze=or,st=o("ZaHm"),Wt=o("ZxFD"),bt=o("n+fv"),dt=o("bl9R")},ISu3:function(Ie,x,o){"use strict";o.d(x,"a",function(){return Z}),o.d(x,"c",function(){return F}),o.d(x,"b",function(){return a}),o.d(x,"d",function(){return Y});var b={},v={},Z=function(Q){return v[Q]},F=function(Q,re){v[Q]=re},a=function(Q){return b[Q]},Y=function(Q,re){b[Q]=re}},Ioao:function(Ie,x,o){var b=o("heNW"),v=Math.max;function Z(F,a,Y){return a=v(a===void 0?F.length-1:a,0),function(){for(var B=arguments,Q=-1,re=v(B.length-a,0),we=Array(re);++Q<re;)we[Q]=B[a+Q];Q=-1;for(var J=Array(a+1);++Q<a;)J[Q]=B[Q];return J[a]=Y(we),b(F,this,J)}}Ie.exports=Z},J2iB:function(Ie,x){function o(b){return b==null}Ie.exports=o},J7lC:function(Ie,x){},JBE3:function(Ie,x,o){var b=o("+Qka"),v=o("LsHQ"),Z=v(function(F,a,Y,B){b(F,a,Y,B)});Ie.exports=Z},K9nA:function(Ie,x,o){"use strict";(function(b,v){o.d(x,"b",function(){return Y}),o.d(x,"a",function(){return re});var Z=o("U8pU"),F={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof b!="undefined"&&b,document:typeof document!="undefined"&&document,process:(typeof v=="undefined"?"undefined":Object(Z.a)(v))==="object"&&v},a=F.self||F.window||F.global,Y=F.window||F.self||F.global,B=F.global||F.self||F.window,Q=F.document||{},re=F.process||{},we=console}).call(this,o("yLpj"),o("Q2Ig"))},KKCa:function(Ie,x){typeof Object.create=="function"?Ie.exports=function(b,v){b.super_=v,b.prototype=Object.create(v.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})}:Ie.exports=function(b,v){b.super_=v;var Z=function(){};Z.prototype=v.prototype,b.prototype=new Z,b.prototype.constructor=b}},KwMD:function(Ie,x){function o(b,v,Z,F){for(var a=b.length,Y=Z+(F?1:-1);F?Y--:++Y<a;)if(v(b[Y],Y,b))return Y;return-1}Ie.exports=o},KxBF:function(Ie,x){function o(b,v,Z){var F=-1,a=b.length;v<0&&(v=-v>a?0:a+v),Z=Z>a?a:Z,Z<0&&(Z+=a),a=v>Z?0:Z-v>>>0,v>>>=0;for(var Y=Array(a);++F<a;)Y[F]=b[F+v];return Y}Ie.exports=o},L56e:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});var b=["mapload"]},LGYb:function(Ie,x,o){var b=o("1hJj"),v=o("jbM+"),Z=o("Xt/L"),F=o("xYSL"),a=o("dQpi"),Y=o("rEGp"),B=200;function Q(re,we,J){var Ke=-1,Ge=v,_e=re.length,Re=!0,at=[],Oe=at;if(J)Re=!1,Ge=Z;else if(_e>=B){var xt=we?null:a(re);if(xt)return Y(xt);Re=!1,Ge=F,Oe=new b}else Oe=we?[]:at;e:for(;++Ke<_e;){var Mt=re[Ke],Et=we?we(Mt):Mt;if(Mt=J||Mt!==0?Mt:0,Re&&Et===Et){for(var St=Oe.length;St--;)if(Oe[St]===Et)continue e;we&&Oe.push(Et),at.push(Mt)}else Ge(Oe,Et,J)||(Oe!==at&&Oe.push(Et),at.push(Mt))}return at}Ie.exports=Q},LKzl:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingWhenOnSyntax=void 0;var b=o("406g"),v=o("z4Hk"),Z=function(){function F(a){this._binding=a,this._bindingWhenSyntax=new v.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new b.BindingOnSyntax(this._binding)}return F.prototype.when=function(a){return this._bindingWhenSyntax.when(a)},F.prototype.whenTargetNamed=function(a){return this._bindingWhenSyntax.whenTargetNamed(a)},F.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},F.prototype.whenTargetTagged=function(a,Y){return this._bindingWhenSyntax.whenTargetTagged(a,Y)},F.prototype.whenInjectedInto=function(a){return this._bindingWhenSyntax.whenInjectedInto(a)},F.prototype.whenParentNamed=function(a){return this._bindingWhenSyntax.whenParentNamed(a)},F.prototype.whenParentTagged=function(a,Y){return this._bindingWhenSyntax.whenParentTagged(a,Y)},F.prototype.whenAnyAncestorIs=function(a){return this._bindingWhenSyntax.whenAnyAncestorIs(a)},F.prototype.whenNoAncestorIs=function(a){return this._bindingWhenSyntax.whenNoAncestorIs(a)},F.prototype.whenAnyAncestorNamed=function(a){return this._bindingWhenSyntax.whenAnyAncestorNamed(a)},F.prototype.whenAnyAncestorTagged=function(a,Y){return this._bindingWhenSyntax.whenAnyAncestorTagged(a,Y)},F.prototype.whenNoAncestorNamed=function(a){return this._bindingWhenSyntax.whenNoAncestorNamed(a)},F.prototype.whenNoAncestorTagged=function(a,Y){return this._bindingWhenSyntax.whenNoAncestorTagged(a,Y)},F.prototype.whenAnyAncestorMatches=function(a){return this._bindingWhenSyntax.whenAnyAncestorMatches(a)},F.prototype.whenNoAncestorMatches=function(a){return this._bindingWhenSyntax.whenNoAncestorMatches(a)},F.prototype.onActivation=function(a){return this._bindingOnSyntax.onActivation(a)},F}();x.BindingWhenOnSyntax=Z},LcsW:function(Ie,x,o){var b=o("kekF"),v=b(Object.getPrototypeOf,Object);Ie.exports=v},LgvC:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Binding=void 0;var b=o("FV85"),v=o("d9O0"),Z=function(){function F(a,Y){this.id=v.id(),this.activated=!1,this.serviceIdentifier=a,this.scope=Y,this.type=b.BindingTypeEnum.Invalid,this.constraint=function(B){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return F.prototype.clone=function(){var a=new F(this.serviceIdentifier,this.scope);return a.activated=!1,a.implementationType=this.implementationType,a.dynamicValue=this.dynamicValue,a.scope=this.scope,a.type=this.type,a.factory=this.factory,a.provider=this.provider,a.constraint=this.constraint,a.onActivation=this.onActivation,a.cache=this.cache,a},F}();x.Binding=Z},LsHQ:function(Ie,x,o){var b=o("EA7m"),v=o("mv/X");function Z(F){return b(function(a,Y){var B=-1,Q=Y.length,re=Q>1?Y[Q-1]:void 0,we=Q>2?Y[2]:void 0;for(re=F.length>3&&typeof re=="function"?(Q--,re):void 0,we&&v(Y[0],Y[1],we)&&(re=Q<3?void 0:re,Q=1),a=Object(a);++B<Q;){var J=Y[B];J&&F(a,J,B,re)}return a})}Ie.exports=Z},LvWW:function(Ie,x,o){var b=o("mhV4");Ie.exports=v;function v(Q,re){switch(Q&&Q.type||null){case"FeatureCollection":return Q.features=Q.features.map(Z(v,re)),Q;case"GeometryCollection":return Q.geometries=Q.geometries.map(Z(v,re)),Q;case"Feature":return Q.geometry=v(Q.geometry,re),Q;case"Polygon":case"MultiPolygon":return F(Q,re);default:return Q}}function Z(Q,re){return function(we){return Q(we,re)}}function F(Q,re){return Q.type==="Polygon"?Q.coordinates=a(Q.coordinates,re):Q.type==="MultiPolygon"&&(Q.coordinates=Q.coordinates.map(Z(a,re))),Q}function a(Q,re){re=!!re,Q[0]=Y(Q[0],re);for(var we=1;we<Q.length;we++)Q[we]=Y(Q[we],!re);return Q}function Y(Q,re){return B(Q)===re?Q:Q.reverse()}function B(Q){return b.ring(Q)>=0}},MCLT:function(Ie,x,o){(function(b){var v=Object.getOwnPropertyDescriptors||function(fe){for(var ke=Object.keys(fe),lt={},nt=0;nt<ke.length;nt++)lt[ke[nt]]=Object.getOwnPropertyDescriptor(fe,ke[nt]);return lt},Z=/%[sdj%]/g;x.format=function(ce){if(!St(ce)){for(var fe=[],ke=0;ke<arguments.length;ke++)fe.push(Y(arguments[ke]));return fe.join(" ")}for(var ke=1,lt=arguments,nt=lt.length,le=String(ce).replace(Z,function(He){if(He==="%%")return"%";if(ke>=nt)return He;switch(He){case"%s":return String(lt[ke++]);case"%d":return Number(lt[ke++]);case"%j":try{return JSON.stringify(lt[ke++])}catch(ft){return"[Circular]"}default:return He}}),ye=lt[ke];ke<nt;ye=lt[++ke])xt(ye)||!mt(ye)?le+=" "+ye:le+=" "+Y(ye);return le},x.deprecate=function(ce,fe){if(typeof b!="undefined"&&b.noDeprecation===!0)return ce;if(typeof b=="undefined")return function(){return x.deprecate(ce,fe).apply(this,arguments)};var ke=!1;function lt(){if(!ke){if(b.throwDeprecation)throw new Error(fe);b.traceDeprecation?console.trace(fe):console.error(fe),ke=!0}return ce.apply(this,arguments)}return lt};var F={},a;x.debuglog=function(ce){if($t(a)&&(a=Object({NODE_ENV:"production"}).NODE_DEBUG||""),ce=ce.toUpperCase(),!F[ce])if(new RegExp("\\b"+ce+"\\b","i").test(a)){var fe=b.pid;F[ce]=function(){var ke=x.format.apply(x,arguments);console.error("%s %d: %s",ce,fe,ke)}}else F[ce]=function(){};return F[ce]};function Y(ce,fe){var ke={seen:[],stylize:Q};return arguments.length>=3&&(ke.depth=arguments[2]),arguments.length>=4&&(ke.colors=arguments[3]),Oe(fe)?ke.showHidden=fe:fe&&x._extend(ke,fe),$t(ke.showHidden)&&(ke.showHidden=!1),$t(ke.depth)&&(ke.depth=2),$t(ke.colors)&&(ke.colors=!1),$t(ke.customInspect)&&(ke.customInspect=!0),ke.colors&&(ke.stylize=B),we(ke,ce,ke.depth)}x.inspect=Y,Y.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Y.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function B(ce,fe){var ke=Y.styles[fe];return ke?"["+Y.colors[ke][0]+"m"+ce+"["+Y.colors[ke][1]+"m":ce}function Q(ce,fe){return ce}function re(ce){var fe={};return ce.forEach(function(ke,lt){fe[ke]=!0}),fe}function we(ce,fe,ke){if(ce.customInspect&&fe&&ze(fe.inspect)&&fe.inspect!==x.inspect&&!(fe.constructor&&fe.constructor.prototype===fe)){var lt=fe.inspect(ke,ce);return St(lt)||(lt=we(ce,lt,ke)),lt}var nt=J(ce,fe);if(nt)return nt;var le=Object.keys(fe),ye=re(le);if(ce.showHidden&&(le=Object.getOwnPropertyNames(fe)),Tt(fe)&&(le.indexOf("message")>=0||le.indexOf("description")>=0))return Ke(fe);if(le.length===0){if(ze(fe)){var He=fe.name?": "+fe.name:"";return ce.stylize("[Function"+He+"]","special")}if(Ht(fe))return ce.stylize(RegExp.prototype.toString.call(fe),"regexp");if(Xe(fe))return ce.stylize(Date.prototype.toString.call(fe),"date");if(Tt(fe))return Ke(fe)}var ft="",De=!1,Ze=["{","}"];if(at(fe)&&(De=!0,Ze=["[","]"]),ze(fe)){var w=fe.name?": "+fe.name:"";ft=" [Function"+w+"]"}if(Ht(fe)&&(ft=" "+RegExp.prototype.toString.call(fe)),Xe(fe)&&(ft=" "+Date.prototype.toUTCString.call(fe)),Tt(fe)&&(ft=" "+Ke(fe)),le.length===0&&(!De||fe.length==0))return Ze[0]+ft+Ze[1];if(ke<0)return Ht(fe)?ce.stylize(RegExp.prototype.toString.call(fe),"regexp"):ce.stylize("[Object]","special");ce.seen.push(fe);var R;return De?R=Ge(ce,fe,ke,ye,le):R=le.map(function(q){return _e(ce,fe,ke,ye,q,De)}),ce.seen.pop(),Re(R,ft,Ze)}function J(ce,fe){if($t(fe))return ce.stylize("undefined","undefined");if(St(fe)){var ke="'"+JSON.stringify(fe).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ce.stylize(ke,"string")}if(Et(fe))return ce.stylize(""+fe,"number");if(Oe(fe))return ce.stylize(""+fe,"boolean");if(xt(fe))return ce.stylize("null","null")}function Ke(ce){return"["+Error.prototype.toString.call(ce)+"]"}function Ge(ce,fe,ke,lt,nt){for(var le=[],ye=0,He=fe.length;ye<He;++ye)z(fe,String(ye))?le.push(_e(ce,fe,ke,lt,String(ye),!0)):le.push("");return nt.forEach(function(ft){ft.match(/^\d+$/)||le.push(_e(ce,fe,ke,lt,ft,!0))}),le}function _e(ce,fe,ke,lt,nt,le){var ye,He,ft;if(ft=Object.getOwnPropertyDescriptor(fe,nt)||{value:fe[nt]},ft.get?ft.set?He=ce.stylize("[Getter/Setter]","special"):He=ce.stylize("[Getter]","special"):ft.set&&(He=ce.stylize("[Setter]","special")),z(lt,nt)||(ye="["+nt+"]"),He||(ce.seen.indexOf(ft.value)<0?(xt(ke)?He=we(ce,ft.value,null):He=we(ce,ft.value,ke-1),He.indexOf(`
`)>-1&&(le?He=He.split(`
`).map(function(De){return"  "+De}).join(`
`).substr(2):He=`
`+He.split(`
`).map(function(De){return"   "+De}).join(`
`))):He=ce.stylize("[Circular]","special")),$t(ye)){if(le&&nt.match(/^\d+$/))return He;ye=JSON.stringify(""+nt),ye.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ye=ye.substr(1,ye.length-2),ye=ce.stylize(ye,"name")):(ye=ye.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ye=ce.stylize(ye,"string"))}return ye+": "+He}function Re(ce,fe,ke){var lt=0,nt=ce.reduce(function(le,ye){return lt++,ye.indexOf(`
`)>=0&&lt++,le+ye.replace(/\u001b\[\d\d?m/g,"").length+1},0);return nt>60?ke[0]+(fe===""?"":fe+`
 `)+" "+ce.join(`,
  `)+" "+ke[1]:ke[0]+fe+" "+ce.join(", ")+" "+ke[1]}function at(ce){return Array.isArray(ce)}x.isArray=at;function Oe(ce){return typeof ce=="boolean"}x.isBoolean=Oe;function xt(ce){return ce===null}x.isNull=xt;function Mt(ce){return ce==null}x.isNullOrUndefined=Mt;function Et(ce){return typeof ce=="number"}x.isNumber=Et;function St(ce){return typeof ce=="string"}x.isString=St;function or(ce){return typeof ce=="symbol"}x.isSymbol=or;function $t(ce){return ce===void 0}x.isUndefined=$t;function Ht(ce){return mt(ce)&&Wt(ce)==="[object RegExp]"}x.isRegExp=Ht;function mt(ce){return typeof ce=="object"&&ce!==null}x.isObject=mt;function Xe(ce){return mt(ce)&&Wt(ce)==="[object Date]"}x.isDate=Xe;function Tt(ce){return mt(ce)&&(Wt(ce)==="[object Error]"||ce instanceof Error)}x.isError=Tt;function ze(ce){return typeof ce=="function"}x.isFunction=ze;function st(ce){return ce===null||typeof ce=="boolean"||typeof ce=="number"||typeof ce=="string"||typeof ce=="symbol"||typeof ce=="undefined"}x.isPrimitive=st,x.isBuffer=o("1gqn");function Wt(ce){return Object.prototype.toString.call(ce)}function bt(ce){return ce<10?"0"+ce.toString(10):ce.toString(10)}var dt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function H(){var ce=new Date,fe=[bt(ce.getHours()),bt(ce.getMinutes()),bt(ce.getSeconds())].join(":");return[ce.getDate(),dt[ce.getMonth()],fe].join(" ")}x.log=function(){console.log("%s - %s",H(),x.format.apply(x,arguments))},x.inherits=o("KKCa"),x._extend=function(ce,fe){if(!fe||!mt(fe))return ce;for(var ke=Object.keys(fe),lt=ke.length;lt--;)ce[ke[lt]]=fe[ke[lt]];return ce};function z(ce,fe){return Object.prototype.hasOwnProperty.call(ce,fe)}var V=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;x.promisify=function(fe){if(typeof fe!="function")throw new TypeError('The "original" argument must be of type Function');if(V&&fe[V]){var ke=fe[V];if(typeof ke!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(ke,V,{value:ke,enumerable:!1,writable:!1,configurable:!0}),ke}function ke(){for(var lt,nt,le=new Promise(function(ft,De){lt=ft,nt=De}),ye=[],He=0;He<arguments.length;He++)ye.push(arguments[He]);ye.push(function(ft,De){ft?nt(ft):lt(De)});try{fe.apply(this,ye)}catch(ft){nt(ft)}return le}return Object.setPrototypeOf(ke,Object.getPrototypeOf(fe)),V&&Object.defineProperty(ke,V,{value:ke,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(ke,v(fe))},x.promisify.custom=V;function Se(ce,fe){if(!ce){var ke=new Error("Promise was rejected with a falsy value");ke.reason=ce,ce=ke}return fe(ce)}function ve(ce){if(typeof ce!="function")throw new TypeError('The "original" argument must be of type Function');function fe(){for(var ke=[],lt=0;lt<arguments.length;lt++)ke.push(arguments[lt]);var nt=ke.pop();if(typeof nt!="function")throw new TypeError("The last argument must be of type Function");var le=this,ye=function(){return nt.apply(le,arguments)};ce.apply(this,ke).then(function(He){b.nextTick(ye,null,He)},function(He){b.nextTick(Se,He,ye)})}return Object.setPrototypeOf(fe,Object.getPrototypeOf(ce)),Object.defineProperties(fe,v(ce)),fe}x.callbackify=ve}).call(this,o("Q2Ig"))},MON2:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.STACK_OVERFLOW=x.CIRCULAR_DEPENDENCY_IN_FACTORY=x.POST_CONSTRUCT_ERROR=x.MULTIPLE_POST_CONSTRUCT_METHODS=x.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=x.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=x.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=x.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=x.ARGUMENTS_LENGTH_MISMATCH=x.INVALID_DECORATOR_OPERATION=x.INVALID_TO_SELF_VALUE=x.INVALID_FUNCTION_BINDING=x.INVALID_MIDDLEWARE_RETURN=x.NO_MORE_SNAPSHOTS_AVAILABLE=x.INVALID_BINDING_TYPE=x.NOT_IMPLEMENTED=x.CIRCULAR_DEPENDENCY=x.UNDEFINED_INJECT_ANNOTATION=x.MISSING_INJECT_ANNOTATION=x.MISSING_INJECTABLE_ANNOTATION=x.NOT_REGISTERED=x.CANNOT_UNBIND=x.AMBIGUOUS_MATCH=x.KEY_NOT_FOUND=x.NULL_ARGUMENT=x.DUPLICATED_METADATA=x.DUPLICATED_INJECTABLE_DECORATOR=void 0,x.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",x.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",x.NULL_ARGUMENT="NULL argument",x.KEY_NOT_FOUND="Key Not Found",x.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",x.CANNOT_UNBIND="Could not unbind serviceIdentifier:",x.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",x.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",x.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",x.UNDEFINED_INJECT_ANNOTATION=function(b){return"@inject called with undefined this could mean that the class "+b+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},x.CIRCULAR_DEPENDENCY="Circular dependency found:",x.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",x.INVALID_BINDING_TYPE="Invalid binding type:",x.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",x.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",x.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",x.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",x.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",x.ARGUMENTS_LENGTH_MISMATCH=function(){for(var b=[],v=0;v<arguments.length;v++)b[v]=arguments[v];return"The number of constructor arguments in the derived class "+(b[0]+" must be >= than the number of constructor arguments of its base class.")},x.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",x.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",x.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",x.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",x.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",x.POST_CONSTRUCT_ERROR=function(){for(var b=[],v=0;v<arguments.length;v++)b[v]=arguments[v];return"@postConstruct error in class "+b[0]+": "+b[1]},x.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var b=[],v=0;v<arguments.length;v++)b[v]=arguments[v];return"It looks like there is a circular dependency "+("in one of the '"+b[0]+"' bindings. Please investigate bindings with")+("service identifier '"+b[1]+"'.")},x.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(Ie,x,o){var b=o("hypo"),v=o("ljhN"),Z=Object.prototype,F=Z.hasOwnProperty;function a(Y,B,Q){var re=Y[B];(!(F.call(Y,B)&&v(re,Q))||Q===void 0&&!(B in Y))&&b(Y,B,Q)}Ie.exports=a},Nsbk:function(Ie,x){function o(b){return Ie.exports=o=Object.setPrototypeOf?Object.getPrototypeOf:function(Z){return Z.__proto__||Object.getPrototypeOf(Z)},o(b)}Ie.exports=o},O0oS:function(Ie,x,o){var b=o("Cwc5"),v=function(){try{var Z=b(Object,"defineProperty");return Z({},"",{}),Z}catch(F){}}();Ie.exports=v},O1je:function(Ie,x){},OBhP:function(Ie,x,o){var b=o("fmRc"),v=o("gFfm"),Z=o("MrPd"),F=o("WwFo"),a=o("Dw+G"),Y=o("5Tg0"),B=o("Q1l4"),Q=o("VOtZ"),re=o("EEGq"),we=o("qZTm"),J=o("G6z8"),Ke=o("QqLw"),Ge=o("yHx3"),_e=o("wrZu"),Re=o("+iFO"),at=o("Z0cm"),Oe=o("DSRE"),xt=o("zEVN"),Mt=o("GoyQ"),Et=o("1+5i"),St=o("7GkX"),or=o("mTTR"),$t=1,Ht=2,mt=4,Xe="[object Arguments]",Tt="[object Array]",ze="[object Boolean]",st="[object Date]",Wt="[object Error]",bt="[object Function]",dt="[object GeneratorFunction]",H="[object Map]",z="[object Number]",V="[object Object]",Se="[object RegExp]",ve="[object Set]",ce="[object String]",fe="[object Symbol]",ke="[object WeakMap]",lt="[object ArrayBuffer]",nt="[object DataView]",le="[object Float32Array]",ye="[object Float64Array]",He="[object Int8Array]",ft="[object Int16Array]",De="[object Int32Array]",Ze="[object Uint8Array]",w="[object Uint8ClampedArray]",R="[object Uint16Array]",q="[object Uint32Array]",he={};he[Xe]=he[Tt]=he[lt]=he[nt]=he[ze]=he[st]=he[le]=he[ye]=he[He]=he[ft]=he[De]=he[H]=he[z]=he[V]=he[Se]=he[ve]=he[ce]=he[fe]=he[Ze]=he[w]=he[R]=he[q]=!0,he[Wt]=he[bt]=he[ke]=!1;function Ve(Ye,yt,it,Nt,$,$e){var ie,qe=yt&$t,jt=yt&Ht,lr=yt&mt;if(it&&(ie=$?it(Ye,Nt,$,$e):it(Ye)),ie!==void 0)return ie;if(!Mt(Ye))return Ye;var ct=at(Ye);if(ct){if(ie=Ge(Ye),!qe)return B(Ye,ie)}else{var ht=Ke(Ye),Pt=ht==bt||ht==dt;if(Oe(Ye))return Y(Ye,qe);if(ht==V||ht==Xe||Pt&&!$){if(ie=jt||Pt?{}:Re(Ye),!qe)return jt?re(Ye,a(ie,Ye)):Q(Ye,F(ie,Ye))}else{if(!he[ht])return $?Ye:{};ie=_e(Ye,ht,qe)}}$e||($e=new b);var vt=$e.get(Ye);if(vt)return vt;$e.set(Ye,ie),Et(Ye)?Ye.forEach(function(Qe){ie.add(Ve(Qe,yt,it,Qe,Ye,$e))}):xt(Ye)&&Ye.forEach(function(Qe,Vt){ie.set(Vt,Ve(Qe,yt,it,Vt,Ye,$e))});var Pe=lr?jt?J:we:jt?or:St,ut=ct?void 0:Pe(Ye);return v(ut||Ye,function(Qe,Vt){ut&&(Vt=Qe,Qe=Ye[Vt]),Z(ie,Vt,Ve(Qe,yt,it,Vt,Ye,$e))}),ie}Ie.exports=Ve},PJYZ:function(Ie,x){function o(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}Ie.exports=o},PSsN:function(Ie,x){},PUg6:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});var b;(function(v){v.normal="normal",v.additive="additive",v.subtractive="subtractive",v.min="min",v.max="max",v.none="none"})(b||(b={}))},Q1l4:function(Ie,x){function o(b,v){var Z=-1,F=b.length;for(v||(v=Array(F));++Z<F;)v[Z]=b[Z];return v}Ie.exports=o},QGbF:function(Ie,x){},"QQZ/":function(Ie,x,o){var b=o("Sq3C"),v=o("Z1HP"),Z=o("Sxd8"),F=o("dt0z");function a(Y,B,Q){Y=F(Y),B=Z(B);var re=B?v(Y):0;return B&&re<B?b(B-re,Q)+Y:Y}Ie.exports=a},QcOe:function(Ie,x,o){var b=o("GoyQ"),v=o("6sVZ"),Z=o("7Ix3"),F=Object.prototype,a=F.hasOwnProperty;function Y(B){if(!b(B))return Z(B);var Q=v(B),re=[];for(var we in B)we=="constructor"&&(Q||!a.call(B,we))||re.push(we);return re}Ie.exports=Y},QkVN:function(Ie,x,o){var b=o("+Qka"),v=o("LsHQ"),Z=v(function(F,a,Y){b(F,a,Y)});Ie.exports=Z},"R/W3":function(Ie,x,o){var b=o("KwMD"),v=o("2ajD"),Z=o("CZoQ");function F(a,Y,B){return Y===Y?Z(a,Y,B):b(a,v,B)}Ie.exports=F},"RL2/":function(Ie,x,o){"use strict";var b="2.3.7"},RMtq:function(Ie,x){},"RR/i":function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.typeConstraint=x.namedConstraint=x.taggedConstraint=x.traverseAncerstors=void 0;var b=o("xfSm"),v=o("GXnB"),Z=function B(Q,re){var we=Q.parentRequest;return we!==null?re(we)?!0:B(we,re):!1};x.traverseAncerstors=Z;var F=function(Q){return function(re){var we=function(Ke){return Ke!==null&&Ke.target!==null&&Ke.target.matchesTag(Q)(re)};return we.metaData=new v.Metadata(Q,re),we}};x.taggedConstraint=F;var a=F(b.NAMED_TAG);x.namedConstraint=a;var Y=function(Q){return function(re){var we=null;if(re!==null)if(we=re.bindings[0],typeof Q=="string"){var J=we.serviceIdentifier;return J===Q}else{var Ke=re.bindings[0].implementationType;return Q===Ke}return!1}};x.typeConstraint=Y},Sk89:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.postConstruct=void 0;var b=o("MON2"),v=o("xfSm"),Z=o("GXnB");function F(){return function(a,Y,B){var Q=new Z.Metadata(v.POST_CONSTRUCT,Y);if(Reflect.hasOwnMetadata(v.POST_CONSTRUCT,a.constructor))throw new Error(b.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(v.POST_CONSTRUCT,Q,a.constructor)}}x.postConstruct=F},SksO:function(Ie,x){function o(b,v){return Ie.exports=o=Object.setPrototypeOf||function(F,a){return F.__proto__=a,F},o(b,v)}Ie.exports=o},Sq3C:function(Ie,x,o){var b=o("sKgW"),v=o("zoYe"),Z=o("wy8a"),F=o("quyA"),a=o("Z1HP"),Y=o("Em2t"),B=Math.ceil;function Q(re,we){we=we===void 0?" ":v(we);var J=we.length;if(J<2)return J?b(we,re):we;var Ke=b(we,B(re/a(we)));return F(we)?Z(Y(Ke),0,re).join(""):Ke.slice(0,re)}Ie.exports=Q},Sxd8:function(Ie,x,o){var b=o("ZCgT");function v(Z){var F=b(Z),a=F%1;return F===F?a?F-a:F:0}Ie.exports=v},T1AV:function(Ie,x,o){var b=o("t2Dn"),v=o("5Tg0"),Z=o("yP5f"),F=o("Q1l4"),a=o("+iFO"),Y=o("03A+"),B=o("Z0cm"),Q=o("3L66"),re=o("DSRE"),we=o("lSCD"),J=o("GoyQ"),Ke=o("YO3V"),Ge=o("c6wG"),_e=o("itsj"),Re=o("jeLo");function at(Oe,xt,Mt,Et,St,or,$t){var Ht=_e(Oe,Mt),mt=_e(xt,Mt),Xe=$t.get(mt);if(Xe){b(Oe,Mt,Xe);return}var Tt=or?or(Ht,mt,Mt+"",Oe,xt,$t):void 0,ze=Tt===void 0;if(ze){var st=B(mt),Wt=!st&&re(mt),bt=!st&&!Wt&&Ge(mt);Tt=mt,st||Wt||bt?B(Ht)?Tt=Ht:Q(Ht)?Tt=F(Ht):Wt?(ze=!1,Tt=v(mt,!0)):bt?(ze=!1,Tt=Z(mt,!0)):Tt=[]:Ke(mt)||Y(mt)?(Tt=Ht,Y(Ht)?Tt=Re(Ht):(!J(Ht)||we(Ht))&&(Tt=a(mt))):ze=!1}ze&&($t.set(mt,Tt),St(Tt,mt,Et,or,$t),$t.delete(mt)),b(Oe,Mt,Tt)}Ie.exports=at},TKrE:function(Ie,x,o){var b=o("qRkn"),v=o("dt0z"),Z=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,F="\\u0300-\\u036f",a="\\ufe20-\\ufe2f",Y="\\u20d0-\\u20ff",B=F+a+Y,Q="["+B+"]",re=RegExp(Q,"g");function we(J){return J=v(J),J&&J.replace(Z,b).replace(re,"")}Ie.exports=we},"U+yc":function(Ie,x){function o(b,v,Z,F,a){var Y={};return Object.keys(F).forEach(function(B){Y[B]=F[B]}),Y.enumerable=!!Y.enumerable,Y.configurable=!!Y.configurable,("value"in Y||Y.initializer)&&(Y.writable=!0),Y=Z.slice().reverse().reduce(function(B,Q){return Q(b,v,B)||B},Y),a&&Y.initializer!==void 0&&(Y.value=Y.initializer?Y.initializer.call(a):void 0,Y.initializer=void 0),Y.initializer===void 0&&(Object.defineProperty(b,v,Y),Y=null),Y}Ie.exports=o},U1ZX:function(Ie,x){},UB5X:function(Ie,x,o){var b=o("NykK"),v=o("ExA7"),Z="[object Number]";function F(a){return typeof a=="number"||v(a)&&b(a)==Z}Ie.exports=F},Ucsi:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0});var b=Symbol.for("INJECTION");function v(B,Q,re,we){function J(){return we&&!Reflect.hasMetadata(b,this,Q)&&Reflect.defineMetadata(b,re(),this,Q),Reflect.hasMetadata(b,this,Q)?Reflect.getMetadata(b,this,Q):re()}function Ke(Ge){Reflect.defineMetadata(b,Ge,this,Q)}Object.defineProperty(B,Q,{configurable:!0,enumerable:!0,get:J,set:Ke})}function Z(B,Q){return function(re){return function(we,J){var Ke=function(){return B.get(re)};v(we,J,Ke,Q)}}}x.makePropertyInjectDecorator=Z;function F(B,Q){return function(re,we){return function(J,Ke){var Ge=function(){return B.getNamed(re,we)};v(J,Ke,Ge,Q)}}}x.makePropertyInjectNamedDecorator=F;function a(B,Q){return function(re,we,J){return function(Ke,Ge){var _e=function(){return B.getTagged(re,we,J)};v(Ke,Ge,_e,Q)}}}x.makePropertyInjectTaggedDecorator=a;function Y(B,Q){return function(re){return function(we,J){var Ke=function(){return B.getAll(re)};v(we,J,Ke,Q)}}}x.makePropertyMultiInjectDecorator=Y},V1cb:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});var b;(function(v){v.Hover="hover",v.Click="click",v.Select="select",v.Active="active",v.Drag="drag"})(b||(b={}))},VIsB:function(Ie,x,o){"use strict";o.d(x,"a",function(){return Y});var b=o("Hel2");function v(Ke,Ge){var _e;if(typeof Symbol=="undefined"||Ke[Symbol.iterator]==null){if(Array.isArray(Ke)||(_e=Z(Ke))||Ge&&Ke&&typeof Ke.length=="number"){_e&&(Ke=_e);var Re=0,at=function(){};return{s:at,n:function(){return Re>=Ke.length?{done:!0}:{done:!1,value:Ke[Re++]}},e:function(St){throw St},f:at}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Oe=!0,xt=!1,Mt;return{s:function(){_e=Ke[Symbol.iterator]()},n:function(){var St=_e.next();return Oe=St.done,St},e:function(St){xt=!0,Mt=St},f:function(){try{!Oe&&_e.return!=null&&_e.return()}finally{if(xt)throw Mt}}}}function Z(Ke,Ge){if(!!Ke){if(typeof Ke=="string")return F(Ke,Ge);var _e=Object.prototype.toString.call(Ke).slice(8,-1);if(_e==="Object"&&Ke.constructor&&(_e=Ke.constructor.name),_e==="Map"||_e==="Set")return Array.from(Ke);if(_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return F(Ke,Ge)}}function F(Ke,Ge){(Ge==null||Ge>Ke.length)&&(Ge=Ke.length);for(var _e=0,Re=new Array(Ge);_e<Ge;_e++)Re[_e]=Ke[_e];return Re}var a=6378e3;function Y(Ke,Ge){var _e=Ke.dataArray,Re=Ge.size,at=Re===void 0?10:Re,Oe=at/(2*Math.PI*a)*(256<<20)/2,xt=B(_e,at),Mt=xt.gridHash,Et=xt.gridOffset,St=J(Mt,Et,Ge);return{yOffset:Oe,xOffset:Oe,radius:Oe,type:"grid",dataArray:St}}function B(Ke,Ge){var _e=Infinity,Re=-Infinity,at,Oe=v(Ke),xt;try{for(Oe.s();!(xt=Oe.n()).done;){var Mt=xt.value;at=Mt.coordinates[1],Number.isFinite(at)&&(_e=at<_e?at:_e,Re=at>Re?at:Re)}}catch(bt){Oe.e(bt)}finally{Oe.f()}var Et=(_e+Re)/2,St=Q(Ge,Et);if(St.xOffset<=0||St.yOffset<=0)return{gridHash:{},gridOffset:St};var or={},$t=v(Ke),Ht;try{for($t.s();!(Ht=$t.n()).done;){var mt=Ht.value,Xe=mt.coordinates[1],Tt=mt.coordinates[0];if(Number.isFinite(Xe)&&Number.isFinite(Tt)){var ze=Math.floor((Xe+90)/St.yOffset),st=Math.floor((Tt+180)/St.xOffset),Wt="".concat(ze,"-").concat(st);or[Wt]=or[Wt]||{count:0,points:[]},or[Wt].count+=1,or[Wt].points.push(mt)}}}catch(bt){$t.e(bt)}finally{$t.f()}return{gridHash:or,gridOffset:St}}function Q(Ke,Ge){var _e=re(Ke),Re=we(Ge,Ke);return{yOffset:_e,xOffset:Re}}function re(Ke){return Ke/a*(180/Math.PI)}function we(Ke,Ge){return Ge/a*(180/Math.PI)/Math.cos(Ke*Math.PI/180)}function J(Ke,Ge,_e){return Object.keys(Ke).reduce(function(Re,at,Oe){var xt=at.split("-"),Mt=parseInt(xt[0],10),Et=parseInt(xt[1],10),St={};if(_e.field&&_e.method){var or=b.c.getColumn(Ke[at].points,_e.field);St[_e.method]=b.c.statMap[_e.method](or)}return Object.assign(St,{_id:Oe,coordinates:Object(b.d)([-180+Ge.xOffset*(Et+.5),-90+Ge.yOffset*(Mt+.5)]),rawData:Ke[at].points,count:Ke[at].count}),Re.push(St),Re},[])}},VOtZ:function(Ie,x,o){var b=o("juv8"),v=o("MvSz");function Z(F,a){return b(F,v(F),a)}Ie.exports=Z},VmRL:function(Ie,x,o){"use strict";Ie.exports=b,Ie.exports.default=b;function b(H,z,V){V=V||2;var Se=z&&z.length,ve=Se?z[0]*V:H.length,ce=v(H,0,ve,V,!0),fe=[];if(!ce||ce.next===ce.prev)return fe;var ke,lt,nt,le,ye,He,ft;if(Se&&(ce=re(H,z,ce,V)),H.length>80*V){ke=nt=H[0],lt=le=H[1];for(var De=V;De<ve;De+=V)ye=H[De],He=H[De+1],ye<ke&&(ke=ye),He<lt&&(lt=He),ye>nt&&(nt=ye),He>le&&(le=He);ft=Math.max(nt-ke,le-lt),ft=ft!==0?1/ft:0}return F(ce,fe,V,ke,lt,ft),fe}function v(H,z,V,Se,ve){var ce,fe;if(ve===dt(H,z,V,Se)>0)for(ce=z;ce<V;ce+=Se)fe=st(ce,H[ce],H[ce+1],fe);else for(ce=V-Se;ce>=z;ce-=Se)fe=st(ce,H[ce],H[ce+1],fe);return fe&&St(fe,fe.next)&&(Wt(fe),fe=fe.next),fe}function Z(H,z){if(!H)return H;z||(z=H);var V=H,Se;do if(Se=!1,!V.steiner&&(St(V,V.next)||Et(V.prev,V,V.next)===0)){if(Wt(V),V=z=V.prev,V===V.next)break;Se=!0}else V=V.next;while(Se||V!==z);return z}function F(H,z,V,Se,ve,ce,fe){if(!!H){!fe&&ce&&_e(H,Se,ve,ce);for(var ke=H,lt,nt;H.prev!==H.next;){if(lt=H.prev,nt=H.next,ce?Y(H,Se,ve,ce):a(H)){z.push(lt.i/V),z.push(H.i/V),z.push(nt.i/V),Wt(H),H=nt.next,ke=nt.next;continue}if(H=nt,H===ke){fe?fe===1?(H=B(Z(H),z,V),F(H,z,V,Se,ve,ce,2)):fe===2&&Q(H,z,V,Se,ve,ce):F(Z(H),z,V,Se,ve,ce,1);break}}}}function a(H){var z=H.prev,V=H,Se=H.next;if(Et(z,V,Se)>=0)return!1;for(var ve=H.next.next;ve!==H.prev;){if(xt(z.x,z.y,V.x,V.y,Se.x,Se.y,ve.x,ve.y)&&Et(ve.prev,ve,ve.next)>=0)return!1;ve=ve.next}return!0}function Y(H,z,V,Se){var ve=H.prev,ce=H,fe=H.next;if(Et(ve,ce,fe)>=0)return!1;for(var ke=ve.x<ce.x?ve.x<fe.x?ve.x:fe.x:ce.x<fe.x?ce.x:fe.x,lt=ve.y<ce.y?ve.y<fe.y?ve.y:fe.y:ce.y<fe.y?ce.y:fe.y,nt=ve.x>ce.x?ve.x>fe.x?ve.x:fe.x:ce.x>fe.x?ce.x:fe.x,le=ve.y>ce.y?ve.y>fe.y?ve.y:fe.y:ce.y>fe.y?ce.y:fe.y,ye=at(ke,lt,z,V,Se),He=at(nt,le,z,V,Se),ft=H.prevZ,De=H.nextZ;ft&&ft.z>=ye&&De&&De.z<=He;){if(ft!==H.prev&&ft!==H.next&&xt(ve.x,ve.y,ce.x,ce.y,fe.x,fe.y,ft.x,ft.y)&&Et(ft.prev,ft,ft.next)>=0||(ft=ft.prevZ,De!==H.prev&&De!==H.next&&xt(ve.x,ve.y,ce.x,ce.y,fe.x,fe.y,De.x,De.y)&&Et(De.prev,De,De.next)>=0))return!1;De=De.nextZ}for(;ft&&ft.z>=ye;){if(ft!==H.prev&&ft!==H.next&&xt(ve.x,ve.y,ce.x,ce.y,fe.x,fe.y,ft.x,ft.y)&&Et(ft.prev,ft,ft.next)>=0)return!1;ft=ft.prevZ}for(;De&&De.z<=He;){if(De!==H.prev&&De!==H.next&&xt(ve.x,ve.y,ce.x,ce.y,fe.x,fe.y,De.x,De.y)&&Et(De.prev,De,De.next)>=0)return!1;De=De.nextZ}return!0}function B(H,z,V){var Se=H;do{var ve=Se.prev,ce=Se.next.next;!St(ve,ce)&&or(ve,Se,Se.next,ce)&&Xe(ve,ce)&&Xe(ce,ve)&&(z.push(ve.i/V),z.push(Se.i/V),z.push(ce.i/V),Wt(Se),Wt(Se.next),Se=H=ce),Se=Se.next}while(Se!==H);return Z(Se)}function Q(H,z,V,Se,ve,ce){var fe=H;do{for(var ke=fe.next.next;ke!==fe.prev;){if(fe.i!==ke.i&&Mt(fe,ke)){var lt=ze(fe,ke);fe=Z(fe,fe.next),lt=Z(lt,lt.next),F(fe,z,V,Se,ve,ce),F(lt,z,V,Se,ve,ce);return}ke=ke.next}fe=fe.next}while(fe!==H)}function re(H,z,V,Se){var ve=[],ce,fe,ke,lt,nt;for(ce=0,fe=z.length;ce<fe;ce++)ke=z[ce]*Se,lt=ce<fe-1?z[ce+1]*Se:H.length,nt=v(H,ke,lt,Se,!1),nt===nt.next&&(nt.steiner=!0),ve.push(Oe(nt));for(ve.sort(we),ce=0;ce<ve.length;ce++)J(ve[ce],V),V=Z(V,V.next);return V}function we(H,z){return H.x-z.x}function J(H,z){if(z=Ke(H,z),z){var V=ze(z,H);Z(z,z.next),Z(V,V.next)}}function Ke(H,z){var V=z,Se=H.x,ve=H.y,ce=-Infinity,fe;do{if(ve<=V.y&&ve>=V.next.y&&V.next.y!==V.y){var ke=V.x+(ve-V.y)*(V.next.x-V.x)/(V.next.y-V.y);if(ke<=Se&&ke>ce){if(ce=ke,ke===Se){if(ve===V.y)return V;if(ve===V.next.y)return V.next}fe=V.x<V.next.x?V:V.next}}V=V.next}while(V!==z);if(!fe)return null;if(Se===ce)return fe;var lt=fe,nt=fe.x,le=fe.y,ye=Infinity,He;V=fe;do Se>=V.x&&V.x>=nt&&Se!==V.x&&xt(ve<le?Se:ce,ve,nt,le,ve<le?ce:Se,ve,V.x,V.y)&&(He=Math.abs(ve-V.y)/(Se-V.x),Xe(V,H)&&(He<ye||He===ye&&(V.x>fe.x||V.x===fe.x&&Ge(fe,V)))&&(fe=V,ye=He)),V=V.next;while(V!==lt);return fe}function Ge(H,z){return Et(H.prev,H,z.prev)<0&&Et(z.next,H,H.next)<0}function _e(H,z,V,Se){var ve=H;do ve.z===null&&(ve.z=at(ve.x,ve.y,z,V,Se)),ve.prevZ=ve.prev,ve.nextZ=ve.next,ve=ve.next;while(ve!==H);ve.prevZ.nextZ=null,ve.prevZ=null,Re(ve)}function Re(H){var z,V,Se,ve,ce,fe,ke,lt,nt=1;do{for(V=H,H=null,ce=null,fe=0;V;){for(fe++,Se=V,ke=0,z=0;z<nt&&(ke++,Se=Se.nextZ,!!Se);z++);for(lt=nt;ke>0||lt>0&&Se;)ke!==0&&(lt===0||!Se||V.z<=Se.z)?(ve=V,V=V.nextZ,ke--):(ve=Se,Se=Se.nextZ,lt--),ce?ce.nextZ=ve:H=ve,ve.prevZ=ce,ce=ve;V=Se}ce.nextZ=null,nt*=2}while(fe>1);return H}function at(H,z,V,Se,ve){return H=32767*(H-V)*ve,z=32767*(z-Se)*ve,H=(H|H<<8)&16711935,H=(H|H<<4)&252645135,H=(H|H<<2)&858993459,H=(H|H<<1)&1431655765,z=(z|z<<8)&16711935,z=(z|z<<4)&252645135,z=(z|z<<2)&858993459,z=(z|z<<1)&1431655765,H|z<<1}function Oe(H){var z=H,V=H;do(z.x<V.x||z.x===V.x&&z.y<V.y)&&(V=z),z=z.next;while(z!==H);return V}function xt(H,z,V,Se,ve,ce,fe,ke){return(ve-fe)*(z-ke)-(H-fe)*(ce-ke)>=0&&(H-fe)*(Se-ke)-(V-fe)*(z-ke)>=0&&(V-fe)*(ce-ke)-(ve-fe)*(Se-ke)>=0}function Mt(H,z){return H.next.i!==z.i&&H.prev.i!==z.i&&!mt(H,z)&&(Xe(H,z)&&Xe(z,H)&&Tt(H,z)&&(Et(H.prev,H,z.prev)||Et(H,z.prev,z))||St(H,z)&&Et(H.prev,H,H.next)>0&&Et(z.prev,z,z.next)>0)}function Et(H,z,V){return(z.y-H.y)*(V.x-z.x)-(z.x-H.x)*(V.y-z.y)}function St(H,z){return H.x===z.x&&H.y===z.y}function or(H,z,V,Se){var ve=Ht(Et(H,z,V)),ce=Ht(Et(H,z,Se)),fe=Ht(Et(V,Se,H)),ke=Ht(Et(V,Se,z));return!!(ve!==ce&&fe!==ke||ve===0&&$t(H,V,z)||ce===0&&$t(H,Se,z)||fe===0&&$t(V,H,Se)||ke===0&&$t(V,z,Se))}function $t(H,z,V){return z.x<=Math.max(H.x,V.x)&&z.x>=Math.min(H.x,V.x)&&z.y<=Math.max(H.y,V.y)&&z.y>=Math.min(H.y,V.y)}function Ht(H){return H>0?1:H<0?-1:0}function mt(H,z){var V=H;do{if(V.i!==H.i&&V.next.i!==H.i&&V.i!==z.i&&V.next.i!==z.i&&or(V,V.next,H,z))return!0;V=V.next}while(V!==H);return!1}function Xe(H,z){return Et(H.prev,H,H.next)<0?Et(H,z,H.next)>=0&&Et(H,H.prev,z)>=0:Et(H,z,H.prev)<0||Et(H,H.next,z)<0}function Tt(H,z){var V=H,Se=!1,ve=(H.x+z.x)/2,ce=(H.y+z.y)/2;do V.y>ce!=V.next.y>ce&&V.next.y!==V.y&&ve<(V.next.x-V.x)*(ce-V.y)/(V.next.y-V.y)+V.x&&(Se=!Se),V=V.next;while(V!==H);return Se}function ze(H,z){var V=new bt(H.i,H.x,H.y),Se=new bt(z.i,z.x,z.y),ve=H.next,ce=z.prev;return H.next=z,z.prev=H,V.next=ve,ve.prev=V,Se.next=V,V.prev=Se,ce.next=Se,Se.prev=ce,Se}function st(H,z,V,Se){var ve=new bt(H,z,V);return Se?(ve.next=Se.next,ve.prev=Se,Se.next.prev=ve,Se.next=ve):(ve.prev=ve,ve.next=ve),ve}function Wt(H){H.next.prev=H.prev,H.prev.next=H.next,H.prevZ&&(H.prevZ.nextZ=H.nextZ),H.nextZ&&(H.nextZ.prevZ=H.prevZ)}function bt(H,z,V){this.i=H,this.x=z,this.y=V,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}b.deviation=function(H,z,V,Se){var ve=z&&z.length,ce=ve?z[0]*V:H.length,fe=Math.abs(dt(H,0,ce,V));if(ve)for(var ke=0,lt=z.length;ke<lt;ke++){var nt=z[ke]*V,le=ke<lt-1?z[ke+1]*V:H.length;fe-=Math.abs(dt(H,nt,le,V))}var ye=0;for(ke=0;ke<Se.length;ke+=3){var He=Se[ke]*V,ft=Se[ke+1]*V,De=Se[ke+2]*V;ye+=Math.abs((H[He]-H[De])*(H[ft+1]-H[He+1])-(H[He]-H[ft])*(H[De+1]-H[He+1]))}return fe===0&&ye===0?0:Math.abs((ye-fe)/fe)};function dt(H,z,V,Se){for(var ve=0,ce=z,fe=V-Se;ce<V;ce+=Se)ve+=(H[fe]-H[ce])*(H[ce+1]+H[fe+1]),fe=ce;return ve}b.flatten=function(H){for(var z=H[0][0].length,V={vertices:[],holes:[],dimensions:z},Se=0,ve=0;ve<H.length;ve++){for(var ce=0;ce<H[ve].length;ce++)for(var fe=0;fe<z;fe++)V.vertices.push(H[ve][ce][fe]);ve>0&&(Se+=H[ve-1].length,V.holes.push(Se))}return V}},W8MJ:function(Ie,x){function o(v,Z){for(var F=0;F<Z.length;F++){var a=Z[F];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(v,a.key,a)}}function b(v,Z,F){return Z&&o(v.prototype,Z),F&&o(v,F),v}Ie.exports=b},WFAs:function(Ie,x){var o=Array.isArray;Ie.exports=o},Wnft:function(Ie,x,o){Ie.exports={mapChart:"antd-pro-pages-dashboard-monitor-style-mapChart",pieCard:"antd-pro-pages-dashboard-monitor-style-pieCard"}},WwFo:function(Ie,x,o){var b=o("juv8"),v=o("7GkX");function Z(F,a){return F&&b(a,v(a),F)}Ie.exports=Z},XYm9:function(Ie,x,o){var b=o("+K+b");function v(Z,F){var a=F?b(Z.buffer):Z.buffer;return new Z.constructor(a,Z.byteOffset,Z.byteLength)}Ie.exports=v},"Xt/L":function(Ie,x){function o(b,v,Z){for(var F=-1,a=b==null?0:b.length;++F<a;)if(Z(v,b[F]))return!0;return!1}Ie.exports=o},Y8BV:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});function b(v,Z){var F=Z.callback;return F&&(v.dataArray=v.dataArray.filter(F)),v}},YO3V:function(Ie,x,o){var b=o("NykK"),v=o("LcsW"),Z=o("ExA7"),F="[object Object]",a=Function.prototype,Y=Object.prototype,B=a.toString,Q=Y.hasOwnProperty,re=B.call(Object);function we(J){if(!Z(J)||b(J)!=F)return!1;var Ke=v(J);if(Ke===null)return!0;var Ge=Q.call(Ke,"constructor")&&Ke.constructor;return typeof Ge=="function"&&Ge instanceof Ge&&B.call(Ge)==re}Ie.exports=we},Yk9n:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.inject=x.LazyServiceIdentifer=void 0;var b=o("MON2"),v=o("xfSm"),Z=o("GXnB"),F=o("Ztfv"),a=function(){function B(Q){this._cb=Q}return B.prototype.unwrap=function(){return this._cb()},B}();x.LazyServiceIdentifer=a;function Y(B){return function(Q,re,we){if(B===void 0)throw new Error(b.UNDEFINED_INJECT_ANNOTATION(Q.name));var J=new Z.Metadata(v.INJECT_TAG,B);typeof we=="number"?F.tagParameter(Q,re,we,J):F.tagProperty(Q,re,J)}}x.inject=Y},Z1HP:function(Ie,x,o){var b=o("ycre"),v=o("quyA"),Z=o("q4HE");function F(a){return v(a)?Z(a):b(a)}Ie.exports=F},ZCgT:function(Ie,x,o){var b=o("tLB3"),v=1/0,Z=17976931348623157e292;function F(a){if(!a)return a===0?a:0;if(a=b(a),a===v||a===-v){var Y=a<0?-1:1;return Y*Z}return a===a?a:0}Ie.exports=F},ZK94:function(Ie,x){Ie.exports.RADIUS=6378137,Ie.exports.FLATTENING=1/298.257223563,Ie.exports.POLAR_RADIUS=63567523142e-4},ZaHm:function(Ie,x,o){"use strict";o.r(x),o.d(x,"create",function(){return v}),o.d(x,"clone",function(){return Z}),o.d(x,"copy",function(){return F}),o.d(x,"fromValues",function(){return a}),o.d(x,"set",function(){return Y}),o.d(x,"identity",function(){return B}),o.d(x,"transpose",function(){return Q}),o.d(x,"invert",function(){return re}),o.d(x,"adjoint",function(){return we}),o.d(x,"determinant",function(){return J}),o.d(x,"multiply",function(){return Ke}),o.d(x,"translate",function(){return Ge}),o.d(x,"scale",function(){return _e}),o.d(x,"rotate",function(){return Re}),o.d(x,"rotateX",function(){return at}),o.d(x,"rotateY",function(){return Oe}),o.d(x,"rotateZ",function(){return xt}),o.d(x,"fromTranslation",function(){return Mt}),o.d(x,"fromScaling",function(){return Et}),o.d(x,"fromRotation",function(){return St}),o.d(x,"fromXRotation",function(){return or}),o.d(x,"fromYRotation",function(){return $t}),o.d(x,"fromZRotation",function(){return Ht}),o.d(x,"fromRotationTranslation",function(){return mt}),o.d(x,"fromQuat2",function(){return Xe}),o.d(x,"getTranslation",function(){return Tt}),o.d(x,"getScaling",function(){return ze}),o.d(x,"getRotation",function(){return st}),o.d(x,"fromRotationTranslationScale",function(){return Wt}),o.d(x,"fromRotationTranslationScaleOrigin",function(){return bt}),o.d(x,"fromQuat",function(){return dt}),o.d(x,"frustum",function(){return H}),o.d(x,"perspective",function(){return z}),o.d(x,"perspectiveFromFieldOfView",function(){return V}),o.d(x,"ortho",function(){return Se}),o.d(x,"lookAt",function(){return ve}),o.d(x,"targetTo",function(){return ce}),o.d(x,"str",function(){return fe}),o.d(x,"frob",function(){return ke}),o.d(x,"add",function(){return lt}),o.d(x,"subtract",function(){return nt}),o.d(x,"multiplyScalar",function(){return le}),o.d(x,"multiplyScalarAndAdd",function(){return ye}),o.d(x,"exactEquals",function(){return He}),o.d(x,"equals",function(){return ft}),o.d(x,"mul",function(){return De}),o.d(x,"sub",function(){return Ze});var b=o("yU0y");function v(){var w=new b.a(16);return b.a!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w}function Z(w){var R=new b.a(16);return R[0]=w[0],R[1]=w[1],R[2]=w[2],R[3]=w[3],R[4]=w[4],R[5]=w[5],R[6]=w[6],R[7]=w[7],R[8]=w[8],R[9]=w[9],R[10]=w[10],R[11]=w[11],R[12]=w[12],R[13]=w[13],R[14]=w[14],R[15]=w[15],R}function F(w,R){return w[0]=R[0],w[1]=R[1],w[2]=R[2],w[3]=R[3],w[4]=R[4],w[5]=R[5],w[6]=R[6],w[7]=R[7],w[8]=R[8],w[9]=R[9],w[10]=R[10],w[11]=R[11],w[12]=R[12],w[13]=R[13],w[14]=R[14],w[15]=R[15],w}function a(w,R,q,he,Ve,Ye,yt,it,Nt,$,$e,ie,qe,jt,lr,ct){var ht=new b.a(16);return ht[0]=w,ht[1]=R,ht[2]=q,ht[3]=he,ht[4]=Ve,ht[5]=Ye,ht[6]=yt,ht[7]=it,ht[8]=Nt,ht[9]=$,ht[10]=$e,ht[11]=ie,ht[12]=qe,ht[13]=jt,ht[14]=lr,ht[15]=ct,ht}function Y(w,R,q,he,Ve,Ye,yt,it,Nt,$,$e,ie,qe,jt,lr,ct,ht){return w[0]=R,w[1]=q,w[2]=he,w[3]=Ve,w[4]=Ye,w[5]=yt,w[6]=it,w[7]=Nt,w[8]=$,w[9]=$e,w[10]=ie,w[11]=qe,w[12]=jt,w[13]=lr,w[14]=ct,w[15]=ht,w}function B(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function Q(w,R){if(w===R){var q=R[1],he=R[2],Ve=R[3],Ye=R[6],yt=R[7],it=R[11];w[1]=R[4],w[2]=R[8],w[3]=R[12],w[4]=q,w[6]=R[9],w[7]=R[13],w[8]=he,w[9]=Ye,w[11]=R[14],w[12]=Ve,w[13]=yt,w[14]=it}else w[0]=R[0],w[1]=R[4],w[2]=R[8],w[3]=R[12],w[4]=R[1],w[5]=R[5],w[6]=R[9],w[7]=R[13],w[8]=R[2],w[9]=R[6],w[10]=R[10],w[11]=R[14],w[12]=R[3],w[13]=R[7],w[14]=R[11],w[15]=R[15];return w}function re(w,R){var q=R[0],he=R[1],Ve=R[2],Ye=R[3],yt=R[4],it=R[5],Nt=R[6],$=R[7],$e=R[8],ie=R[9],qe=R[10],jt=R[11],lr=R[12],ct=R[13],ht=R[14],Pt=R[15],vt=q*it-he*yt,Pe=q*Nt-Ve*yt,ut=q*$-Ye*yt,Qe=he*Nt-Ve*it,Vt=he*$-Ye*it,pr=Ve*$-Ye*Nt,Zr=$e*ct-ie*lr,cr=$e*ht-qe*lr,jn=$e*Pt-jt*lr,En=ie*ht-qe*ct,ni=ie*Pt-jt*ct,fi=qe*Pt-jt*ht,Zn=vt*fi-Pe*ni+ut*En+Qe*jn-Vt*cr+pr*Zr;return Zn?(Zn=1/Zn,w[0]=(it*fi-Nt*ni+$*En)*Zn,w[1]=(Ve*ni-he*fi-Ye*En)*Zn,w[2]=(ct*pr-ht*Vt+Pt*Qe)*Zn,w[3]=(qe*Vt-ie*pr-jt*Qe)*Zn,w[4]=(Nt*jn-yt*fi-$*cr)*Zn,w[5]=(q*fi-Ve*jn+Ye*cr)*Zn,w[6]=(ht*ut-lr*pr-Pt*Pe)*Zn,w[7]=($e*pr-qe*ut+jt*Pe)*Zn,w[8]=(yt*ni-it*jn+$*Zr)*Zn,w[9]=(he*jn-q*ni-Ye*Zr)*Zn,w[10]=(lr*Vt-ct*ut+Pt*vt)*Zn,w[11]=(ie*ut-$e*Vt-jt*vt)*Zn,w[12]=(it*cr-yt*En-Nt*Zr)*Zn,w[13]=(q*En-he*cr+Ve*Zr)*Zn,w[14]=(ct*Pe-lr*Qe-ht*vt)*Zn,w[15]=($e*Qe-ie*Pe+qe*vt)*Zn,w):null}function we(w,R){var q=R[0],he=R[1],Ve=R[2],Ye=R[3],yt=R[4],it=R[5],Nt=R[6],$=R[7],$e=R[8],ie=R[9],qe=R[10],jt=R[11],lr=R[12],ct=R[13],ht=R[14],Pt=R[15];return w[0]=it*(qe*Pt-jt*ht)-ie*(Nt*Pt-$*ht)+ct*(Nt*jt-$*qe),w[1]=-(he*(qe*Pt-jt*ht)-ie*(Ve*Pt-Ye*ht)+ct*(Ve*jt-Ye*qe)),w[2]=he*(Nt*Pt-$*ht)-it*(Ve*Pt-Ye*ht)+ct*(Ve*$-Ye*Nt),w[3]=-(he*(Nt*jt-$*qe)-it*(Ve*jt-Ye*qe)+ie*(Ve*$-Ye*Nt)),w[4]=-(yt*(qe*Pt-jt*ht)-$e*(Nt*Pt-$*ht)+lr*(Nt*jt-$*qe)),w[5]=q*(qe*Pt-jt*ht)-$e*(Ve*Pt-Ye*ht)+lr*(Ve*jt-Ye*qe),w[6]=-(q*(Nt*Pt-$*ht)-yt*(Ve*Pt-Ye*ht)+lr*(Ve*$-Ye*Nt)),w[7]=q*(Nt*jt-$*qe)-yt*(Ve*jt-Ye*qe)+$e*(Ve*$-Ye*Nt),w[8]=yt*(ie*Pt-jt*ct)-$e*(it*Pt-$*ct)+lr*(it*jt-$*ie),w[9]=-(q*(ie*Pt-jt*ct)-$e*(he*Pt-Ye*ct)+lr*(he*jt-Ye*ie)),w[10]=q*(it*Pt-$*ct)-yt*(he*Pt-Ye*ct)+lr*(he*$-Ye*it),w[11]=-(q*(it*jt-$*ie)-yt*(he*jt-Ye*ie)+$e*(he*$-Ye*it)),w[12]=-(yt*(ie*ht-qe*ct)-$e*(it*ht-Nt*ct)+lr*(it*qe-Nt*ie)),w[13]=q*(ie*ht-qe*ct)-$e*(he*ht-Ve*ct)+lr*(he*qe-Ve*ie),w[14]=-(q*(it*ht-Nt*ct)-yt*(he*ht-Ve*ct)+lr*(he*Nt-Ve*it)),w[15]=q*(it*qe-Nt*ie)-yt*(he*qe-Ve*ie)+$e*(he*Nt-Ve*it),w}function J(w){var R=w[0],q=w[1],he=w[2],Ve=w[3],Ye=w[4],yt=w[5],it=w[6],Nt=w[7],$=w[8],$e=w[9],ie=w[10],qe=w[11],jt=w[12],lr=w[13],ct=w[14],ht=w[15],Pt=R*yt-q*Ye,vt=R*it-he*Ye,Pe=R*Nt-Ve*Ye,ut=q*it-he*yt,Qe=q*Nt-Ve*yt,Vt=he*Nt-Ve*it,pr=$*lr-$e*jt,Zr=$*ct-ie*jt,cr=$*ht-qe*jt,jn=$e*ct-ie*lr,En=$e*ht-qe*lr,ni=ie*ht-qe*ct;return Pt*ni-vt*En+Pe*jn+ut*cr-Qe*Zr+Vt*pr}function Ke(w,R,q){var he=R[0],Ve=R[1],Ye=R[2],yt=R[3],it=R[4],Nt=R[5],$=R[6],$e=R[7],ie=R[8],qe=R[9],jt=R[10],lr=R[11],ct=R[12],ht=R[13],Pt=R[14],vt=R[15],Pe=q[0],ut=q[1],Qe=q[2],Vt=q[3];return w[0]=Pe*he+ut*it+Qe*ie+Vt*ct,w[1]=Pe*Ve+ut*Nt+Qe*qe+Vt*ht,w[2]=Pe*Ye+ut*$+Qe*jt+Vt*Pt,w[3]=Pe*yt+ut*$e+Qe*lr+Vt*vt,Pe=q[4],ut=q[5],Qe=q[6],Vt=q[7],w[4]=Pe*he+ut*it+Qe*ie+Vt*ct,w[5]=Pe*Ve+ut*Nt+Qe*qe+Vt*ht,w[6]=Pe*Ye+ut*$+Qe*jt+Vt*Pt,w[7]=Pe*yt+ut*$e+Qe*lr+Vt*vt,Pe=q[8],ut=q[9],Qe=q[10],Vt=q[11],w[8]=Pe*he+ut*it+Qe*ie+Vt*ct,w[9]=Pe*Ve+ut*Nt+Qe*qe+Vt*ht,w[10]=Pe*Ye+ut*$+Qe*jt+Vt*Pt,w[11]=Pe*yt+ut*$e+Qe*lr+Vt*vt,Pe=q[12],ut=q[13],Qe=q[14],Vt=q[15],w[12]=Pe*he+ut*it+Qe*ie+Vt*ct,w[13]=Pe*Ve+ut*Nt+Qe*qe+Vt*ht,w[14]=Pe*Ye+ut*$+Qe*jt+Vt*Pt,w[15]=Pe*yt+ut*$e+Qe*lr+Vt*vt,w}function Ge(w,R,q){var he=q[0],Ve=q[1],Ye=q[2],yt,it,Nt,$,$e,ie,qe,jt,lr,ct,ht,Pt;return R===w?(w[12]=R[0]*he+R[4]*Ve+R[8]*Ye+R[12],w[13]=R[1]*he+R[5]*Ve+R[9]*Ye+R[13],w[14]=R[2]*he+R[6]*Ve+R[10]*Ye+R[14],w[15]=R[3]*he+R[7]*Ve+R[11]*Ye+R[15]):(yt=R[0],it=R[1],Nt=R[2],$=R[3],$e=R[4],ie=R[5],qe=R[6],jt=R[7],lr=R[8],ct=R[9],ht=R[10],Pt=R[11],w[0]=yt,w[1]=it,w[2]=Nt,w[3]=$,w[4]=$e,w[5]=ie,w[6]=qe,w[7]=jt,w[8]=lr,w[9]=ct,w[10]=ht,w[11]=Pt,w[12]=yt*he+$e*Ve+lr*Ye+R[12],w[13]=it*he+ie*Ve+ct*Ye+R[13],w[14]=Nt*he+qe*Ve+ht*Ye+R[14],w[15]=$*he+jt*Ve+Pt*Ye+R[15]),w}function _e(w,R,q){var he=q[0],Ve=q[1],Ye=q[2];return w[0]=R[0]*he,w[1]=R[1]*he,w[2]=R[2]*he,w[3]=R[3]*he,w[4]=R[4]*Ve,w[5]=R[5]*Ve,w[6]=R[6]*Ve,w[7]=R[7]*Ve,w[8]=R[8]*Ye,w[9]=R[9]*Ye,w[10]=R[10]*Ye,w[11]=R[11]*Ye,w[12]=R[12],w[13]=R[13],w[14]=R[14],w[15]=R[15],w}function Re(w,R,q,he){var Ve=he[0],Ye=he[1],yt=he[2],it=Math.hypot(Ve,Ye,yt),Nt,$,$e,ie,qe,jt,lr,ct,ht,Pt,vt,Pe,ut,Qe,Vt,pr,Zr,cr,jn,En,ni,fi,Zn,Vn;return it<b.b?null:(it=1/it,Ve*=it,Ye*=it,yt*=it,Nt=Math.sin(q),$=Math.cos(q),$e=1-$,ie=R[0],qe=R[1],jt=R[2],lr=R[3],ct=R[4],ht=R[5],Pt=R[6],vt=R[7],Pe=R[8],ut=R[9],Qe=R[10],Vt=R[11],pr=Ve*Ve*$e+$,Zr=Ye*Ve*$e+yt*Nt,cr=yt*Ve*$e-Ye*Nt,jn=Ve*Ye*$e-yt*Nt,En=Ye*Ye*$e+$,ni=yt*Ye*$e+Ve*Nt,fi=Ve*yt*$e+Ye*Nt,Zn=Ye*yt*$e-Ve*Nt,Vn=yt*yt*$e+$,w[0]=ie*pr+ct*Zr+Pe*cr,w[1]=qe*pr+ht*Zr+ut*cr,w[2]=jt*pr+Pt*Zr+Qe*cr,w[3]=lr*pr+vt*Zr+Vt*cr,w[4]=ie*jn+ct*En+Pe*ni,w[5]=qe*jn+ht*En+ut*ni,w[6]=jt*jn+Pt*En+Qe*ni,w[7]=lr*jn+vt*En+Vt*ni,w[8]=ie*fi+ct*Zn+Pe*Vn,w[9]=qe*fi+ht*Zn+ut*Vn,w[10]=jt*fi+Pt*Zn+Qe*Vn,w[11]=lr*fi+vt*Zn+Vt*Vn,R!==w&&(w[12]=R[12],w[13]=R[13],w[14]=R[14],w[15]=R[15]),w)}function at(w,R,q){var he=Math.sin(q),Ve=Math.cos(q),Ye=R[4],yt=R[5],it=R[6],Nt=R[7],$=R[8],$e=R[9],ie=R[10],qe=R[11];return R!==w&&(w[0]=R[0],w[1]=R[1],w[2]=R[2],w[3]=R[3],w[12]=R[12],w[13]=R[13],w[14]=R[14],w[15]=R[15]),w[4]=Ye*Ve+$*he,w[5]=yt*Ve+$e*he,w[6]=it*Ve+ie*he,w[7]=Nt*Ve+qe*he,w[8]=$*Ve-Ye*he,w[9]=$e*Ve-yt*he,w[10]=ie*Ve-it*he,w[11]=qe*Ve-Nt*he,w}function Oe(w,R,q){var he=Math.sin(q),Ve=Math.cos(q),Ye=R[0],yt=R[1],it=R[2],Nt=R[3],$=R[8],$e=R[9],ie=R[10],qe=R[11];return R!==w&&(w[4]=R[4],w[5]=R[5],w[6]=R[6],w[7]=R[7],w[12]=R[12],w[13]=R[13],w[14]=R[14],w[15]=R[15]),w[0]=Ye*Ve-$*he,w[1]=yt*Ve-$e*he,w[2]=it*Ve-ie*he,w[3]=Nt*Ve-qe*he,w[8]=Ye*he+$*Ve,w[9]=yt*he+$e*Ve,w[10]=it*he+ie*Ve,w[11]=Nt*he+qe*Ve,w}function xt(w,R,q){var he=Math.sin(q),Ve=Math.cos(q),Ye=R[0],yt=R[1],it=R[2],Nt=R[3],$=R[4],$e=R[5],ie=R[6],qe=R[7];return R!==w&&(w[8]=R[8],w[9]=R[9],w[10]=R[10],w[11]=R[11],w[12]=R[12],w[13]=R[13],w[14]=R[14],w[15]=R[15]),w[0]=Ye*Ve+$*he,w[1]=yt*Ve+$e*he,w[2]=it*Ve+ie*he,w[3]=Nt*Ve+qe*he,w[4]=$*Ve-Ye*he,w[5]=$e*Ve-yt*he,w[6]=ie*Ve-it*he,w[7]=qe*Ve-Nt*he,w}function Mt(w,R){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=R[0],w[13]=R[1],w[14]=R[2],w[15]=1,w}function Et(w,R){return w[0]=R[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=R[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=R[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function St(w,R,q){var he=q[0],Ve=q[1],Ye=q[2],yt=Math.hypot(he,Ve,Ye),it,Nt,$;return yt<b.b?null:(yt=1/yt,he*=yt,Ve*=yt,Ye*=yt,it=Math.sin(R),Nt=Math.cos(R),$=1-Nt,w[0]=he*he*$+Nt,w[1]=Ve*he*$+Ye*it,w[2]=Ye*he*$-Ve*it,w[3]=0,w[4]=he*Ve*$-Ye*it,w[5]=Ve*Ve*$+Nt,w[6]=Ye*Ve*$+he*it,w[7]=0,w[8]=he*Ye*$+Ve*it,w[9]=Ve*Ye*$-he*it,w[10]=Ye*Ye*$+Nt,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)}function or(w,R){var q=Math.sin(R),he=Math.cos(R);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=he,w[6]=q,w[7]=0,w[8]=0,w[9]=-q,w[10]=he,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function $t(w,R){var q=Math.sin(R),he=Math.cos(R);return w[0]=he,w[1]=0,w[2]=-q,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=q,w[9]=0,w[10]=he,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function Ht(w,R){var q=Math.sin(R),he=Math.cos(R);return w[0]=he,w[1]=q,w[2]=0,w[3]=0,w[4]=-q,w[5]=he,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function mt(w,R,q){var he=R[0],Ve=R[1],Ye=R[2],yt=R[3],it=he+he,Nt=Ve+Ve,$=Ye+Ye,$e=he*it,ie=he*Nt,qe=he*$,jt=Ve*Nt,lr=Ve*$,ct=Ye*$,ht=yt*it,Pt=yt*Nt,vt=yt*$;return w[0]=1-(jt+ct),w[1]=ie+vt,w[2]=qe-Pt,w[3]=0,w[4]=ie-vt,w[5]=1-($e+ct),w[6]=lr+ht,w[7]=0,w[8]=qe+Pt,w[9]=lr-ht,w[10]=1-($e+jt),w[11]=0,w[12]=q[0],w[13]=q[1],w[14]=q[2],w[15]=1,w}function Xe(w,R){var q=new b.a(3),he=-R[0],Ve=-R[1],Ye=-R[2],yt=R[3],it=R[4],Nt=R[5],$=R[6],$e=R[7],ie=he*he+Ve*Ve+Ye*Ye+yt*yt;return ie>0?(q[0]=(it*yt+$e*he+Nt*Ye-$*Ve)*2/ie,q[1]=(Nt*yt+$e*Ve+$*he-it*Ye)*2/ie,q[2]=($*yt+$e*Ye+it*Ve-Nt*he)*2/ie):(q[0]=(it*yt+$e*he+Nt*Ye-$*Ve)*2,q[1]=(Nt*yt+$e*Ve+$*he-it*Ye)*2,q[2]=($*yt+$e*Ye+it*Ve-Nt*he)*2),mt(w,R,q),w}function Tt(w,R){return w[0]=R[12],w[1]=R[13],w[2]=R[14],w}function ze(w,R){var q=R[0],he=R[1],Ve=R[2],Ye=R[4],yt=R[5],it=R[6],Nt=R[8],$=R[9],$e=R[10];return w[0]=Math.hypot(q,he,Ve),w[1]=Math.hypot(Ye,yt,it),w[2]=Math.hypot(Nt,$,$e),w}function st(w,R){var q=new b.a(3);ze(q,R);var he=1/q[0],Ve=1/q[1],Ye=1/q[2],yt=R[0]*he,it=R[1]*Ve,Nt=R[2]*Ye,$=R[4]*he,$e=R[5]*Ve,ie=R[6]*Ye,qe=R[8]*he,jt=R[9]*Ve,lr=R[10]*Ye,ct=yt+$e+lr,ht=0;return ct>0?(ht=Math.sqrt(ct+1)*2,w[3]=.25*ht,w[0]=(ie-jt)/ht,w[1]=(qe-Nt)/ht,w[2]=(it-$)/ht):yt>$e&&yt>lr?(ht=Math.sqrt(1+yt-$e-lr)*2,w[3]=(ie-jt)/ht,w[0]=.25*ht,w[1]=(it+$)/ht,w[2]=(qe+Nt)/ht):$e>lr?(ht=Math.sqrt(1+$e-yt-lr)*2,w[3]=(qe-Nt)/ht,w[0]=(it+$)/ht,w[1]=.25*ht,w[2]=(ie+jt)/ht):(ht=Math.sqrt(1+lr-yt-$e)*2,w[3]=(it-$)/ht,w[0]=(qe+Nt)/ht,w[1]=(ie+jt)/ht,w[2]=.25*ht),w}function Wt(w,R,q,he){var Ve=R[0],Ye=R[1],yt=R[2],it=R[3],Nt=Ve+Ve,$=Ye+Ye,$e=yt+yt,ie=Ve*Nt,qe=Ve*$,jt=Ve*$e,lr=Ye*$,ct=Ye*$e,ht=yt*$e,Pt=it*Nt,vt=it*$,Pe=it*$e,ut=he[0],Qe=he[1],Vt=he[2];return w[0]=(1-(lr+ht))*ut,w[1]=(qe+Pe)*ut,w[2]=(jt-vt)*ut,w[3]=0,w[4]=(qe-Pe)*Qe,w[5]=(1-(ie+ht))*Qe,w[6]=(ct+Pt)*Qe,w[7]=0,w[8]=(jt+vt)*Vt,w[9]=(ct-Pt)*Vt,w[10]=(1-(ie+lr))*Vt,w[11]=0,w[12]=q[0],w[13]=q[1],w[14]=q[2],w[15]=1,w}function bt(w,R,q,he,Ve){var Ye=R[0],yt=R[1],it=R[2],Nt=R[3],$=Ye+Ye,$e=yt+yt,ie=it+it,qe=Ye*$,jt=Ye*$e,lr=Ye*ie,ct=yt*$e,ht=yt*ie,Pt=it*ie,vt=Nt*$,Pe=Nt*$e,ut=Nt*ie,Qe=he[0],Vt=he[1],pr=he[2],Zr=Ve[0],cr=Ve[1],jn=Ve[2],En=(1-(ct+Pt))*Qe,ni=(jt+ut)*Qe,fi=(lr-Pe)*Qe,Zn=(jt-ut)*Vt,Vn=(1-(qe+Pt))*Vt,Te=(ht+vt)*Vt,de=(lr+Pe)*pr,W=(ht-vt)*pr,se=(1-(qe+ct))*pr;return w[0]=En,w[1]=ni,w[2]=fi,w[3]=0,w[4]=Zn,w[5]=Vn,w[6]=Te,w[7]=0,w[8]=de,w[9]=W,w[10]=se,w[11]=0,w[12]=q[0]+Zr-(En*Zr+Zn*cr+de*jn),w[13]=q[1]+cr-(ni*Zr+Vn*cr+W*jn),w[14]=q[2]+jn-(fi*Zr+Te*cr+se*jn),w[15]=1,w}function dt(w,R){var q=R[0],he=R[1],Ve=R[2],Ye=R[3],yt=q+q,it=he+he,Nt=Ve+Ve,$=q*yt,$e=he*yt,ie=he*it,qe=Ve*yt,jt=Ve*it,lr=Ve*Nt,ct=Ye*yt,ht=Ye*it,Pt=Ye*Nt;return w[0]=1-ie-lr,w[1]=$e+Pt,w[2]=qe-ht,w[3]=0,w[4]=$e-Pt,w[5]=1-$-lr,w[6]=jt+ct,w[7]=0,w[8]=qe+ht,w[9]=jt-ct,w[10]=1-$-ie,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function H(w,R,q,he,Ve,Ye,yt){var it=1/(q-R),Nt=1/(Ve-he),$=1/(Ye-yt);return w[0]=Ye*2*it,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=Ye*2*Nt,w[6]=0,w[7]=0,w[8]=(q+R)*it,w[9]=(Ve+he)*Nt,w[10]=(yt+Ye)*$,w[11]=-1,w[12]=0,w[13]=0,w[14]=yt*Ye*2*$,w[15]=0,w}function z(w,R,q,he,Ve){var Ye=1/Math.tan(R/2),yt;return w[0]=Ye/q,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=Ye,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,Ve!=null&&Ve!==Infinity?(yt=1/(he-Ve),w[10]=(Ve+he)*yt,w[14]=2*Ve*he*yt):(w[10]=-1,w[14]=-2*he),w}function V(w,R,q,he){var Ve=Math.tan(R.upDegrees*Math.PI/180),Ye=Math.tan(R.downDegrees*Math.PI/180),yt=Math.tan(R.leftDegrees*Math.PI/180),it=Math.tan(R.rightDegrees*Math.PI/180),Nt=2/(yt+it),$=2/(Ve+Ye);return w[0]=Nt,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=$,w[6]=0,w[7]=0,w[8]=-((yt-it)*Nt*.5),w[9]=(Ve-Ye)*$*.5,w[10]=he/(q-he),w[11]=-1,w[12]=0,w[13]=0,w[14]=he*q/(q-he),w[15]=0,w}function Se(w,R,q,he,Ve,Ye,yt){var it=1/(R-q),Nt=1/(he-Ve),$=1/(Ye-yt);return w[0]=-2*it,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*Nt,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*$,w[11]=0,w[12]=(R+q)*it,w[13]=(Ve+he)*Nt,w[14]=(yt+Ye)*$,w[15]=1,w}function ve(w,R,q,he){var Ve,Ye,yt,it,Nt,$,$e,ie,qe,jt,lr=R[0],ct=R[1],ht=R[2],Pt=he[0],vt=he[1],Pe=he[2],ut=q[0],Qe=q[1],Vt=q[2];return Math.abs(lr-ut)<b.b&&Math.abs(ct-Qe)<b.b&&Math.abs(ht-Vt)<b.b?B(w):($e=lr-ut,ie=ct-Qe,qe=ht-Vt,jt=1/Math.hypot($e,ie,qe),$e*=jt,ie*=jt,qe*=jt,Ve=vt*qe-Pe*ie,Ye=Pe*$e-Pt*qe,yt=Pt*ie-vt*$e,jt=Math.hypot(Ve,Ye,yt),jt?(jt=1/jt,Ve*=jt,Ye*=jt,yt*=jt):(Ve=0,Ye=0,yt=0),it=ie*yt-qe*Ye,Nt=qe*Ve-$e*yt,$=$e*Ye-ie*Ve,jt=Math.hypot(it,Nt,$),jt?(jt=1/jt,it*=jt,Nt*=jt,$*=jt):(it=0,Nt=0,$=0),w[0]=Ve,w[1]=it,w[2]=$e,w[3]=0,w[4]=Ye,w[5]=Nt,w[6]=ie,w[7]=0,w[8]=yt,w[9]=$,w[10]=qe,w[11]=0,w[12]=-(Ve*lr+Ye*ct+yt*ht),w[13]=-(it*lr+Nt*ct+$*ht),w[14]=-($e*lr+ie*ct+qe*ht),w[15]=1,w)}function ce(w,R,q,he){var Ve=R[0],Ye=R[1],yt=R[2],it=he[0],Nt=he[1],$=he[2],$e=Ve-q[0],ie=Ye-q[1],qe=yt-q[2],jt=$e*$e+ie*ie+qe*qe;jt>0&&(jt=1/Math.sqrt(jt),$e*=jt,ie*=jt,qe*=jt);var lr=Nt*qe-$*ie,ct=$*$e-it*qe,ht=it*ie-Nt*$e;return jt=lr*lr+ct*ct+ht*ht,jt>0&&(jt=1/Math.sqrt(jt),lr*=jt,ct*=jt,ht*=jt),w[0]=lr,w[1]=ct,w[2]=ht,w[3]=0,w[4]=ie*ht-qe*ct,w[5]=qe*lr-$e*ht,w[6]=$e*ct-ie*lr,w[7]=0,w[8]=$e,w[9]=ie,w[10]=qe,w[11]=0,w[12]=Ve,w[13]=Ye,w[14]=yt,w[15]=1,w}function fe(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"}function ke(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])}function lt(w,R,q){return w[0]=R[0]+q[0],w[1]=R[1]+q[1],w[2]=R[2]+q[2],w[3]=R[3]+q[3],w[4]=R[4]+q[4],w[5]=R[5]+q[5],w[6]=R[6]+q[6],w[7]=R[7]+q[7],w[8]=R[8]+q[8],w[9]=R[9]+q[9],w[10]=R[10]+q[10],w[11]=R[11]+q[11],w[12]=R[12]+q[12],w[13]=R[13]+q[13],w[14]=R[14]+q[14],w[15]=R[15]+q[15],w}function nt(w,R,q){return w[0]=R[0]-q[0],w[1]=R[1]-q[1],w[2]=R[2]-q[2],w[3]=R[3]-q[3],w[4]=R[4]-q[4],w[5]=R[5]-q[5],w[6]=R[6]-q[6],w[7]=R[7]-q[7],w[8]=R[8]-q[8],w[9]=R[9]-q[9],w[10]=R[10]-q[10],w[11]=R[11]-q[11],w[12]=R[12]-q[12],w[13]=R[13]-q[13],w[14]=R[14]-q[14],w[15]=R[15]-q[15],w}function le(w,R,q){return w[0]=R[0]*q,w[1]=R[1]*q,w[2]=R[2]*q,w[3]=R[3]*q,w[4]=R[4]*q,w[5]=R[5]*q,w[6]=R[6]*q,w[7]=R[7]*q,w[8]=R[8]*q,w[9]=R[9]*q,w[10]=R[10]*q,w[11]=R[11]*q,w[12]=R[12]*q,w[13]=R[13]*q,w[14]=R[14]*q,w[15]=R[15]*q,w}function ye(w,R,q,he){return w[0]=R[0]+q[0]*he,w[1]=R[1]+q[1]*he,w[2]=R[2]+q[2]*he,w[3]=R[3]+q[3]*he,w[4]=R[4]+q[4]*he,w[5]=R[5]+q[5]*he,w[6]=R[6]+q[6]*he,w[7]=R[7]+q[7]*he,w[8]=R[8]+q[8]*he,w[9]=R[9]+q[9]*he,w[10]=R[10]+q[10]*he,w[11]=R[11]+q[11]*he,w[12]=R[12]+q[12]*he,w[13]=R[13]+q[13]*he,w[14]=R[14]+q[14]*he,w[15]=R[15]+q[15]*he,w}function He(w,R){return w[0]===R[0]&&w[1]===R[1]&&w[2]===R[2]&&w[3]===R[3]&&w[4]===R[4]&&w[5]===R[5]&&w[6]===R[6]&&w[7]===R[7]&&w[8]===R[8]&&w[9]===R[9]&&w[10]===R[10]&&w[11]===R[11]&&w[12]===R[12]&&w[13]===R[13]&&w[14]===R[14]&&w[15]===R[15]}function ft(w,R){var q=w[0],he=w[1],Ve=w[2],Ye=w[3],yt=w[4],it=w[5],Nt=w[6],$=w[7],$e=w[8],ie=w[9],qe=w[10],jt=w[11],lr=w[12],ct=w[13],ht=w[14],Pt=w[15],vt=R[0],Pe=R[1],ut=R[2],Qe=R[3],Vt=R[4],pr=R[5],Zr=R[6],cr=R[7],jn=R[8],En=R[9],ni=R[10],fi=R[11],Zn=R[12],Vn=R[13],Te=R[14],de=R[15];return Math.abs(q-vt)<=b.b*Math.max(1,Math.abs(q),Math.abs(vt))&&Math.abs(he-Pe)<=b.b*Math.max(1,Math.abs(he),Math.abs(Pe))&&Math.abs(Ve-ut)<=b.b*Math.max(1,Math.abs(Ve),Math.abs(ut))&&Math.abs(Ye-Qe)<=b.b*Math.max(1,Math.abs(Ye),Math.abs(Qe))&&Math.abs(yt-Vt)<=b.b*Math.max(1,Math.abs(yt),Math.abs(Vt))&&Math.abs(it-pr)<=b.b*Math.max(1,Math.abs(it),Math.abs(pr))&&Math.abs(Nt-Zr)<=b.b*Math.max(1,Math.abs(Nt),Math.abs(Zr))&&Math.abs($-cr)<=b.b*Math.max(1,Math.abs($),Math.abs(cr))&&Math.abs($e-jn)<=b.b*Math.max(1,Math.abs($e),Math.abs(jn))&&Math.abs(ie-En)<=b.b*Math.max(1,Math.abs(ie),Math.abs(En))&&Math.abs(qe-ni)<=b.b*Math.max(1,Math.abs(qe),Math.abs(ni))&&Math.abs(jt-fi)<=b.b*Math.max(1,Math.abs(jt),Math.abs(fi))&&Math.abs(lr-Zn)<=b.b*Math.max(1,Math.abs(lr),Math.abs(Zn))&&Math.abs(ct-Vn)<=b.b*Math.max(1,Math.abs(ct),Math.abs(Vn))&&Math.abs(ht-Te)<=b.b*Math.max(1,Math.abs(ht),Math.abs(Te))&&Math.abs(Pt-de)<=b.b*Math.max(1,Math.abs(Pt),Math.abs(de))}var De=Ke,Ze=nt},Ztfv:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.tagProperty=x.tagParameter=x.decorate=void 0;var b=o("MON2"),v=o("xfSm");function Z(re,we,J,Ke){var Ge=v.TAGGED;a(Ge,re,we,Ke,J)}x.tagParameter=Z;function F(re,we,J){var Ke=v.TAGGED_PROP;a(Ke,re.constructor,we,J)}x.tagProperty=F;function a(re,we,J,Ke,Ge){var _e={},Re=typeof Ge=="number",at=Ge!==void 0&&Re?Ge.toString():J;if(Re&&J!==void 0)throw new Error(b.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(re,we)&&(_e=Reflect.getMetadata(re,we));var Oe=_e[at];if(!Array.isArray(Oe))Oe=[];else for(var xt=0,Mt=Oe;xt<Mt.length;xt++){var Et=Mt[xt];if(Et.key===Ke.key)throw new Error(b.DUPLICATED_METADATA+" "+Et.key.toString())}Oe.push(Ke),_e[at]=Oe,Reflect.defineMetadata(re,_e,we)}function Y(re,we){Reflect.decorate(re,we)}function B(re,we){return function(J,Ke){we(J,Ke,re)}}function Q(re,we,J){typeof J=="number"?Y([B(J,re)],we):typeof J=="string"?Reflect.decorate([re],we,J):Y([re],we)}x.decorate=Q},ZxFD:function(Ie,x,o){"use strict";o.r(x),o.d(x,"create",function(){return v}),o.d(x,"clone",function(){return Z}),o.d(x,"fromValues",function(){return F}),o.d(x,"copy",function(){return a}),o.d(x,"set",function(){return Y}),o.d(x,"add",function(){return B}),o.d(x,"subtract",function(){return Q}),o.d(x,"multiply",function(){return re}),o.d(x,"divide",function(){return we}),o.d(x,"ceil",function(){return J}),o.d(x,"floor",function(){return Ke}),o.d(x,"min",function(){return Ge}),o.d(x,"max",function(){return _e}),o.d(x,"round",function(){return Re}),o.d(x,"scale",function(){return at}),o.d(x,"scaleAndAdd",function(){return Oe}),o.d(x,"distance",function(){return xt}),o.d(x,"squaredDistance",function(){return Mt}),o.d(x,"length",function(){return Et}),o.d(x,"squaredLength",function(){return St}),o.d(x,"negate",function(){return or}),o.d(x,"inverse",function(){return $t}),o.d(x,"normalize",function(){return Ht}),o.d(x,"dot",function(){return mt}),o.d(x,"cross",function(){return Xe}),o.d(x,"lerp",function(){return Tt}),o.d(x,"random",function(){return ze}),o.d(x,"transformMat2",function(){return st}),o.d(x,"transformMat2d",function(){return Wt}),o.d(x,"transformMat3",function(){return bt}),o.d(x,"transformMat4",function(){return dt}),o.d(x,"rotate",function(){return H}),o.d(x,"angle",function(){return z}),o.d(x,"zero",function(){return V}),o.d(x,"str",function(){return Se}),o.d(x,"exactEquals",function(){return ve}),o.d(x,"equals",function(){return ce}),o.d(x,"len",function(){return fe}),o.d(x,"sub",function(){return ke}),o.d(x,"mul",function(){return lt}),o.d(x,"div",function(){return nt}),o.d(x,"dist",function(){return le}),o.d(x,"sqrDist",function(){return ye}),o.d(x,"sqrLen",function(){return He}),o.d(x,"forEach",function(){return ft});var b=o("yU0y");function v(){var De=new b.a(2);return b.a!=Float32Array&&(De[0]=0,De[1]=0),De}function Z(De){var Ze=new b.a(2);return Ze[0]=De[0],Ze[1]=De[1],Ze}function F(De,Ze){var w=new b.a(2);return w[0]=De,w[1]=Ze,w}function a(De,Ze){return De[0]=Ze[0],De[1]=Ze[1],De}function Y(De,Ze,w){return De[0]=Ze,De[1]=w,De}function B(De,Ze,w){return De[0]=Ze[0]+w[0],De[1]=Ze[1]+w[1],De}function Q(De,Ze,w){return De[0]=Ze[0]-w[0],De[1]=Ze[1]-w[1],De}function re(De,Ze,w){return De[0]=Ze[0]*w[0],De[1]=Ze[1]*w[1],De}function we(De,Ze,w){return De[0]=Ze[0]/w[0],De[1]=Ze[1]/w[1],De}function J(De,Ze){return De[0]=Math.ceil(Ze[0]),De[1]=Math.ceil(Ze[1]),De}function Ke(De,Ze){return De[0]=Math.floor(Ze[0]),De[1]=Math.floor(Ze[1]),De}function Ge(De,Ze,w){return De[0]=Math.min(Ze[0],w[0]),De[1]=Math.min(Ze[1],w[1]),De}function _e(De,Ze,w){return De[0]=Math.max(Ze[0],w[0]),De[1]=Math.max(Ze[1],w[1]),De}function Re(De,Ze){return De[0]=Math.round(Ze[0]),De[1]=Math.round(Ze[1]),De}function at(De,Ze,w){return De[0]=Ze[0]*w,De[1]=Ze[1]*w,De}function Oe(De,Ze,w,R){return De[0]=Ze[0]+w[0]*R,De[1]=Ze[1]+w[1]*R,De}function xt(De,Ze){var w=Ze[0]-De[0],R=Ze[1]-De[1];return Math.hypot(w,R)}function Mt(De,Ze){var w=Ze[0]-De[0],R=Ze[1]-De[1];return w*w+R*R}function Et(De){var Ze=De[0],w=De[1];return Math.hypot(Ze,w)}function St(De){var Ze=De[0],w=De[1];return Ze*Ze+w*w}function or(De,Ze){return De[0]=-Ze[0],De[1]=-Ze[1],De}function $t(De,Ze){return De[0]=1/Ze[0],De[1]=1/Ze[1],De}function Ht(De,Ze){var w=Ze[0],R=Ze[1],q=w*w+R*R;return q>0&&(q=1/Math.sqrt(q)),De[0]=Ze[0]*q,De[1]=Ze[1]*q,De}function mt(De,Ze){return De[0]*Ze[0]+De[1]*Ze[1]}function Xe(De,Ze,w){var R=Ze[0]*w[1]-Ze[1]*w[0];return De[0]=De[1]=0,De[2]=R,De}function Tt(De,Ze,w,R){var q=Ze[0],he=Ze[1];return De[0]=q+R*(w[0]-q),De[1]=he+R*(w[1]-he),De}function ze(De,Ze){Ze=Ze||1;var w=b.c()*2*Math.PI;return De[0]=Math.cos(w)*Ze,De[1]=Math.sin(w)*Ze,De}function st(De,Ze,w){var R=Ze[0],q=Ze[1];return De[0]=w[0]*R+w[2]*q,De[1]=w[1]*R+w[3]*q,De}function Wt(De,Ze,w){var R=Ze[0],q=Ze[1];return De[0]=w[0]*R+w[2]*q+w[4],De[1]=w[1]*R+w[3]*q+w[5],De}function bt(De,Ze,w){var R=Ze[0],q=Ze[1];return De[0]=w[0]*R+w[3]*q+w[6],De[1]=w[1]*R+w[4]*q+w[7],De}function dt(De,Ze,w){var R=Ze[0],q=Ze[1];return De[0]=w[0]*R+w[4]*q+w[12],De[1]=w[1]*R+w[5]*q+w[13],De}function H(De,Ze,w,R){var q=Ze[0]-w[0],he=Ze[1]-w[1],Ve=Math.sin(R),Ye=Math.cos(R);return De[0]=q*Ye-he*Ve+w[0],De[1]=q*Ve+he*Ye+w[1],De}function z(De,Ze){var w=De[0],R=De[1],q=Ze[0],he=Ze[1],Ve=Math.sqrt(w*w+R*R)*Math.sqrt(q*q+he*he),Ye=Ve&&(w*q+R*he)/Ve;return Math.acos(Math.min(Math.max(Ye,-1),1))}function V(De){return De[0]=0,De[1]=0,De}function Se(De){return"vec2("+De[0]+", "+De[1]+")"}function ve(De,Ze){return De[0]===Ze[0]&&De[1]===Ze[1]}function ce(De,Ze){var w=De[0],R=De[1],q=Ze[0],he=Ze[1];return Math.abs(w-q)<=b.b*Math.max(1,Math.abs(w),Math.abs(q))&&Math.abs(R-he)<=b.b*Math.max(1,Math.abs(R),Math.abs(he))}var fe=Et,ke=Q,lt=re,nt=we,le=xt,ye=Mt,He=St,ft=function(){var De=v();return function(Ze,w,R,q,he,Ve){var Ye,yt;for(w||(w=2),R||(R=0),q?yt=Math.min(q*w+R,Ze.length):yt=Ze.length,Ye=R;Ye<yt;Ye+=w)De[0]=Ze[Ye],De[1]=Ze[Ye+1],he(De,De,Ve),Ze[Ye]=De[0],Ze[Ye+1]=De[1];return Ze}}()},ZzCi:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.named=void 0;var b=o("xfSm"),v=o("GXnB"),Z=o("Ztfv");function F(a){return function(Y,B,Q){var re=new v.Metadata(b.NAMED_TAG,a);typeof Q=="number"?Z.tagParameter(Y,B,Q,re):Z.tagProperty(Y,B,re)}}x.named=F},a1gu:function(Ie,x,o){var b=o("cDf5"),v=o("PJYZ");function Z(F,a){return a&&(b(a)==="object"||typeof a=="function")?a:v(F)}Ie.exports=Z},a5Wf:function(Ie,x,o){"use strict";o.r(x);var b=o("IzEo"),v=o("bx4M"),Z=o("14J3"),F=o("BMrR"),a=o("nKUr"),Y=o("jCWc"),B=o("kPKH"),Q=o("1OyB"),re=o("vuIU"),we=o("Ji7U"),J=o("LK+K"),Ke=o("aHsQ"),Ge=o("sGsY"),_e=o("9kvl"),Re=o("q1tI"),at=o.n(Re),Oe=o("FRQA"),xt=o("ZhIB"),Mt=o.n(xt),Et=o("yP6+"),St=o("VTBJ");function or(P){var p=P.style;p.height="100%";var s=parseInt("".concat(getComputedStyle(P).height),10),d=parseInt("".concat(getComputedStyle(P).paddingTop),10)+parseInt("".concat(getComputedStyle(P).paddingBottom),10);return s-d}function $t(P){if(!P)return 0;var p=P,s=or(p),d=p.parentNode;return d&&(s=or(d)),s}function Ht(){return function(P){var p=function(s){Object(we.a)(g,s);var d=Object(J.a)(g);function g(){var L;Object(Q.a)(this,g);for(var N=arguments.length,K=new Array(N),ee=0;ee<N;ee++)K[ee]=arguments[ee];return L=d.call.apply(d,[this].concat(K)),L.state={computedHeight:0},L.root=null,L.handleRoot=function(X){L.root=X},L}return Object(re.a)(g,[{key:"componentDidMount",value:function(){var N=this.props.height;if(!N&&this.root){var K=$t(this.root);this.setState({computedHeight:K}),K<1&&(K=$t(this.root),this.setState({computedHeight:K}))}}},{key:"render",value:function(){var N=this.props.height,K=this.state.computedHeight,ee=N||K;return Object(a.jsx)("div",{ref:this.handleRoot,children:ee>0&&Object(a.jsx)(P,Object(St.a)(Object(St.a)({},this.props),{},{height:ee}))})}}]),g}(at.a.Component);return p}}var mt=Ht,Xe=Et.Guide.Arc,Tt=Et.Guide.Html,ze=Et.Guide.Line,st=function(p){switch(p){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};Et.Shape.registerShape&&Et.Shape.registerShape("point","pointer",{drawShape:function(p,s){var d=p.points[0];d=this.parsePoint(d);var g=this.parsePoint({x:0,y:0});return s.addShape("line",{attrs:{x1:g.x,y1:g.y,x2:d.x,y2:d.y,stroke:p.color,lineWidth:2,lineCap:"round"}}),s.addShape("circle",{attrs:{x:g.x,y:g.y,r:6,stroke:p.color,lineWidth:3,fill:"#fff"}})}});var Wt=function(p){var s=p.title,d=p.height,g=d===void 0?1:d,L=p.percent,N=p.forceFit,K=N===void 0?!0:N,ee=p.formatter,X=ee===void 0?st:ee,be=p.color,me=be===void 0?"#2F9CFF":be,Be=p.bgColor,pt=Be===void 0?"#F0F2F5":Be,Kt={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},kt=[{value:L/10}],Qt=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(s,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((kt[0].value*10).toFixed(2),`%
    </div>
  </div>`)},ur={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return Object(a.jsxs)(Et.Chart,{height:g,data:kt,scale:Kt,padding:[-16,0,16,0],forceFit:K,children:[Object(a.jsx)(Et.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8}),Object(a.jsx)(Et.Axis,{name:"1",line:void 0}),Object(a.jsx)(Et.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:X,textStyle:ur}}),Object(a.jsxs)(Et.Guide,{children:[Object(a.jsx)(ze,{start:[3,.905],end:[3,.85],lineStyle:{stroke:me,lineDash:void 0,lineWidth:2}}),Object(a.jsx)(ze,{start:[5,.905],end:[5,.85],lineStyle:{stroke:me,lineDash:void 0,lineWidth:3}}),Object(a.jsx)(ze,{start:[7,.905],end:[7,.85],lineStyle:{stroke:me,lineDash:void 0,lineWidth:3}}),Object(a.jsx)(Xe,{start:[0,.965],end:[10,.965],style:{stroke:pt,lineWidth:10}}),Object(a.jsx)(Xe,{start:[0,.965],end:[kt[0].value,.965],style:{stroke:me,lineWidth:10}}),Object(a.jsx)(Tt,{position:["50%","95%"],html:Qt()})]}),Object(a.jsx)(Et.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:me,active:!1})]})},bt=mt()(Wt),dt=o("iz+Y"),H=o.n(dt),z=function(p){var s=p.height,d=s===void 0?1:s,g=p.data,L=g===void 0?[]:g,N=p.forceFit,K=N===void 0?!0:N,ee=p.color,X=ee===void 0?"rgba(24, 144, 255, 0.2)":ee,be=p.borderColor,me=be===void 0?"#1089ff":be,Be=p.scale,pt=Be===void 0?{x:{},y:{}}:Be,Kt=p.borderWidth,kt=Kt===void 0?2:Kt,Qt=p.line,ur=p.xAxis,Ur=p.yAxis,on=p.animate,Hr=on===void 0?!0:on,ln=[36,5,30,5],Pn={x:Object(St.a)({type:"cat",range:[0,1]},pt.x),y:Object(St.a)({min:0},pt.y)},Hn=["x*y",function(Hi,ma){return{name:Hi,value:ma}}],ai=d+54;return Object(a.jsx)("div",{className:H.a.miniChart,style:{height:d},children:Object(a.jsx)("div",{className:H.a.chartContent,children:d>0&&Object(a.jsxs)(Et.Chart,{animate:Hr,scale:Pn,height:ai,forceFit:K,data:L,padding:ln,children:[Object(a.jsx)(Et.Axis,Object(St.a)({name:"x",label:null,line:null,tickLine:null,grid:null},ur),"axis-x"),Object(a.jsx)(Et.Axis,Object(St.a)({name:"y",label:null,line:null,tickLine:null,grid:null},Ur),"axis-y"),Object(a.jsx)(Et.Tooltip,{showTitle:!1,crosshairs:!1}),Object(a.jsx)(Et.Geom,{type:"area",position:"x*y",color:X,tooltip:Hn,shape:"smooth",style:{fillOpacity:1}}),Qt?Object(a.jsx)(Et.Geom,{type:"line",position:"x*y",shape:"smooth",color:me,size:kt,tooltip:!1}):Object(a.jsx)("span",{style:{display:"none"}})]})})})},V=mt()(z),Se=o("/zsF"),ve=o("PArb"),ce=o("rePB"),fe=o("cQSq"),ke=o.n(fe),lt=o("9/5/"),nt=o.n(lt),le=o("Jssm"),ye=o.n(le),He=o("TSYQ"),ft=o.n(He),De=o("d9mD"),Ze=o.n(De),w=function(P){Object(we.a)(s,P);var p=Object(J.a)(s);function s(){var d;Object(Q.a)(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.state={legendData:[],legendBlock:!1},d.chart=void 0,d.root=void 0,d.requestRef=0,d.resize=nt()(function(){var K=d.props.hasLegend,ee=d.state.legendBlock;if(!K||!d.root){window.removeEventListener("resize",d.resize);return}d.root&&d.root.parentNode&&d.root.parentNode.clientWidth<=380?ee||d.setState({legendBlock:!0}):ee&&d.setState({legendBlock:!1})},300),d.getG2Instance=function(K){d.chart=K,requestAnimationFrame(function(){d.getLegendData(),d.resize()})},d.getLegendData=function(){if(!!d.chart){var K=d.chart.getAllGeoms()[0];if(!!K){var ee=K.get("dataArray")||[],X=ee.map(function(be){var me=be[0]._origin;return me.color=be[0].color,me.checked=!0,me});d.setState({legendData:X})}}},d.handleRoot=function(K){d.root=K},d.handleLegendClick=function(K,ee){var X=K;X.checked=!X.checked;var be=d.state.legendData;be[ee]=X;var me=be.filter(function(Be){return Be.checked}).map(function(Be){return Be.x});d.chart&&d.chart.filter("x",function(Be){return me.indexOf("".concat(Be))>-1}),d.setState({legendData:be})},d}return Object(re.a)(s,[{key:"componentDidMount",value:function(){var g=this;window.addEventListener("resize",function(){g.requestRef=requestAnimationFrame(function(){return g.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(g){var L=this.props.data;L!==g.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var g,L=this,N=this.props,K=N.valueFormat,ee=N.subTitle,X=N.total,be=N.hasLegend,me=be===void 0?!1:be,Be=N.className,pt=N.style,Kt=N.height,kt=Kt===void 0?0:Kt,Qt=N.forceFit,ur=Qt===void 0?!0:Qt,Ur=N.percent,on=N.color,Hr=N.inner,ln=Hr===void 0?.75:Hr,Pn=N.animate,Hn=Pn===void 0?!0:Pn,ai=N.colors,Hi=N.lineWidth,ma=Hi===void 0?1:Hi,La=this.state,qu=La.legendData,ts=La.legendBlock,ls=ft()(Ze.a.pie,Be,(g={},Object(ce.a)(g,Ze.a.hasLegend,!!me),Object(ce.a)(g,Ze.a.legendBlock,ts),g)),Su=this.props,Nf=Su.data,Ml=Su.selected,Wc=Ml===void 0?!0:Ml,wa=Su.tooltip,Fa=wa===void 0?!0:wa,Pc=Nf||[],pl=Wc,Xc=Fa,Jf=ai;Pc=Pc||[],pl=pl||!0,Xc=Xc||!0;var go,vl={x:{type:"cat",range:[0,1]},y:{min:0}};(Ur||Ur===0)&&(pl=!1,Xc=!1,go=function(wf){return wf==="\u5360\u6BD4"?on||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},Pc=[{x:"\u5360\u6BD4",y:parseFloat("".concat(Ur))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat(Ur))}]);var hf=["x*percent",function(Ya,wf){return{name:Ya,value:"".concat((wf*100).toFixed(2),"%")}}],df=[12,0,12,0],Ch=new fe.DataView;return Ch.source(Pc).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),Object(a.jsxs)("div",{ref:this.handleRoot,className:ls,style:pt,children:[Object(a.jsx)(ye.a,{maxFontSize:25,children:Object(a.jsxs)("div",{className:Ze.a.chart,children:[Object(a.jsxs)(Et.Chart,{scale:vl,height:kt,forceFit:ur,data:Ch,padding:df,animate:Hn,onGetG2Instance:this.getG2Instance,children:[!!Xc&&Object(a.jsx)(Et.Tooltip,{showTitle:!1}),Object(a.jsx)(Et.Coord,{type:"theta",innerRadius:ln}),Object(a.jsx)(Et.Geom,{style:{lineWidth:ma,stroke:"#fff"},tooltip:Xc?hf:void 0,type:"intervalStack",position:"percent",color:["x",Ur||Ur===0?go:Jf],selected:pl})]}),(ee||X)&&Object(a.jsxs)("div",{className:Ze.a.total,children:[ee&&Object(a.jsx)("h4",{className:"pie-sub-title",children:ee}),X&&Object(a.jsx)("div",{className:"pie-stat",children:typeof X=="function"?X():X})]})]})}),me&&Object(a.jsx)("ul",{className:Ze.a.legend,children:qu.map(function(Ya,wf){return Object(a.jsxs)("li",{onClick:function(){return L.handleLegendClick(Ya,wf)},children:[Object(a.jsx)("span",{className:Ze.a.dot,style:{backgroundColor:Ya.checked?Ya.color:"#aaa"}}),Object(a.jsx)("span",{className:Ze.a.legendTitle,children:Ya.x}),Object(a.jsx)(ve.a,{type:"vertical"}),Object(a.jsx)("span",{className:Ze.a.percent,children:"".concat((Number.isNaN(Ya.percent)?0:Ya.percent*100).toFixed(2),"%")}),Object(a.jsx)("span",{className:Ze.a.value,children:K?K(Ya.y):Ya.y})]},Ya.x)})})]})}}]),s}(Re.Component),R=mt()(w),q=o("ODXe"),he=o("1XEM"),Ve=o.n(he),Ye="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",yt=function(P){Object(we.a)(s,P);var p=Object(J.a)(s);function s(){var d;Object(Q.a)(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.state={dv:null,height:0,width:0},d.requestRef=0,d.isUnmount=!1,d.root=void 0,d.imageMask=void 0,d.resize=function(){d.requestRef=requestAnimationFrame(function(){d.renderChart(d.props)})},d.saveRootRef=function(K){d.root=K},d.initTagCloud=function(){function K(ee){return Object(St.a)(Object(St.a)({},ee.style),{},{fillOpacity:ee.opacity,fontSize:ee.origin._origin.size,rotate:ee.origin._origin.rotate,text:ee.origin._origin.text,textAlign:"center",fontFamily:ee.origin._origin.font,fill:ee.color,textBaseline:"Alphabetic"})}Et.Shape.registerShape("point","cloud",{drawShape:function(X,be){var me=K(X);return be.addShape("text",{attrs:Object(St.a)(Object(St.a)({},me),{},{x:X.x,y:X.y})})}})},d.renderChart=nt()(function(K){var ee=K||d.props,X=ee.data,be=ee.height;if(!(X.length<1||!d.root)){var me=be,Be=d.root.offsetWidth,pt=function(){var kt=new ke.a.View().source(X),Qt=kt.range("value"),ur=Object(q.a)(Qt,2),Ur=ur[0],on=ur[1];kt.transform({type:"tag-cloud",fields:["name","value"],imageMask:d.imageMask,font:"Verdana",size:[Be,me],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(ln){var Pn=Math.pow((ln.value-Ur)/(on-Ur),2);return Pn*(17.5-5)+5}}),!d.isUnmount&&d.setState({dv:kt,width:Be,height:me})};d.imageMask?pt():(d.imageMask=new Image,d.imageMask.crossOrigin="",d.imageMask.src=Ye,d.imageMask.onload=pt)}},200),d}return Object(re.a)(s,[{key:"componentDidMount",value:function(){var g=this;requestAnimationFrame(function(){g.initTagCloud(),g.renderChart(g.props)}),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(g){var L=this.props.data;g&&JSON.stringify(g.data)!==JSON.stringify(L)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var g=this.props,L=g.className,N=g.height,K=this.state,ee=K.dv,X=K.width,be=K.height;return Object(a.jsx)("div",{className:ft()(Ve.a.tagCloud,L),style:{width:"100%",height:N},ref:this.saveRootRef,children:ee&&Object(a.jsxs)(Et.Chart,{width:X,height:be,data:ee,padding:0,scale:{x:{nice:!1},y:{nice:!1}},children:[Object(a.jsx)(Et.Tooltip,{showTitle:!1}),Object(a.jsx)(Et.Coord,{reflect:"y"}),Object(a.jsx)(Et.Geom,{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(Be,pt){return{name:Be,value:pt}}]})]})})}}]),s}(Re.Component),it=mt()(yt),Nt=o("CIdX"),$=o.n(Nt),$e=function(P){Object(we.a)(s,P);var p=Object(J.a)(s);function s(){var d;Object(Q.a)(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.state={radio:1},d.timer=0,d.root=null,d.node=null,d.resize=function(){if(d.root){var K=d.props.height,ee=K===void 0?1:K,X=d.root.parentNode,be=X.offsetWidth;d.setState({radio:be<ee?be/ee:1})}},d}return Object(re.a)(s,[{key:"componentDidMount",value:function(){var g=this;this.renderChart(),this.resize(),window.addEventListener("resize",function(){requestAnimationFrame(function(){return g.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(g){var L=this.props.percent;g.percent!==L&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(g){var L=this.props,N=L.percent,K=L.color,ee=K===void 0?"#1890FF":K,X=N/100,be=this;if(cancelAnimationFrame(this.timer),!this.node||X!==0&&!X)return;var me=this.node,Be=me.getContext("2d");if(!Be)return;var pt=me.width,Kt=me.height,kt=pt/2,Qt=2,ur=kt-Qt;Be.beginPath(),Be.lineWidth=Qt*2;for(var Ur=pt-Qt,on=Ur/8,Hr=.2,ln=Hr,Pn=Qt,Hn=0,ai=0,Hi=.005,ma=[],La=kt-Qt,qu=-(Math.PI/2),ts=!0,ls=qu;ls<qu+2*Math.PI;ls+=1/(8*Math.PI))ma.push([kt+La*Math.cos(ls),kt+La*Math.sin(ls)]);var Su=ma.shift();Be.strokeStyle=ee,Be.moveTo(Su[0],Su[1]);function Nf(){if(!!Be){Be.beginPath(),Be.save();for(var Wc=[],wa=Pn;wa<=Pn+Ur;wa+=20/Ur){var Fa=Hn+(Pn+wa)/on,Pc=Math.sin(Fa)*ln,pl=wa,Xc=2*ur*(1-ai)+(kt-ur)-on*Pc;Be.lineTo(pl,Xc),Wc.push([pl,Xc])}var Jf=Wc.shift();Be.lineTo(Pn+Ur,Kt),Be.lineTo(Pn,Kt),Be.lineTo(Jf[0],Jf[1]);var go=Be.createLinearGradient(0,0,0,Kt);go.addColorStop(0,"#ffffff"),go.addColorStop(1,ee),Be.fillStyle=go,Be.fill(),Be.restore()}}function Ml(){if(!!Be){if(Be.clearRect(0,0,pt,Kt),ts&&g!=="update")if(ma.length){var Wc=ma.shift();Be.lineTo(Wc[0],Wc[1]),Be.stroke()}else ts=!1,Be.lineTo(Su[0],Su[1]),Be.stroke(),ma=[],Be.globalCompositeOperation="destination-over",Be.beginPath(),Be.lineWidth=Qt,Be.arc(kt,kt,La,0,2*Math.PI,!0),Be.beginPath(),Be.save(),Be.arc(kt,kt,kt-3*Qt,0,2*Math.PI,!0),Be.restore(),Be.clip(),Be.fillStyle=ee;else{if(X>=.85){if(ln>Hr/4){var wa=Hr*.01;ln-=wa}}else if(X<=.1){if(ln<Hr*1.5){var Fa=Hr*.01;ln+=Fa}}else{if(ln<=Hr){var Pc=Hr*.01;ln+=Pc}if(ln>=Hr){var pl=Hr*.01;ln-=pl}}X-ai>0&&(ai+=Hi),X-ai<0&&(ai-=Hi),Hn+=.07,Nf()}be.timer=requestAnimationFrame(Ml)}}Ml()}},{key:"render",value:function(){var g=this,L=this.state.radio,N=this.props,K=N.percent,ee=N.title,X=N.height,be=X===void 0?1:X;return Object(a.jsxs)("div",{className:$.a.waterWave,ref:function(Be){return g.root=Be},style:{transform:"scale(".concat(L,")")},children:[Object(a.jsx)("div",{style:{width:be,height:be,overflow:"hidden"},children:Object(a.jsx)("canvas",{className:$.a.waterWaveCanvasWrapper,ref:function(Be){return g.node=Be},width:be*2,height:be*2})}),Object(a.jsxs)("div",{className:$.a.text,style:{width:be},children:[ee&&Object(a.jsx)("span",{children:ee}),Object(a.jsxs)("h4",{children:[K,"%"]})]})]})}}]),s}(Re.Component),ie=mt()($e),qe=o("o0o1"),jt=o.n(qe),lr=o("HaE+"),ct=Object(Re.createContext)({});function ht(){return Object(Re.useContext)(ct)}var Pt=o("8ml+"),vt=o("lwsE"),Pe=o.n(vt),ut=o("W8MJ"),Qe=o.n(ut),Vt=o("7W2i"),pr=o.n(Vt),Zr=o("a1gu"),cr=o.n(Zr),jn=o("Nsbk"),En=o.n(jn),ni=o("lSNA"),fi=o.n(ni),Zn=o("yG8O"),Vn=o.n(Zn),Te=o("U+yc"),de=o.n(Te),W=o("1ABj"),se=o("h1nZ"),Le,et,wt,Ne,gt,qt;function zr(P,p){var s=Object.keys(P);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(P);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(P,g).enumerable})),s.push.apply(s,d)}return s}function Br(P){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?zr(Object(s),!0).forEach(function(d){fi()(P,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(s)):zr(Object(s)).forEach(function(d){Object.defineProperty(P,d,Object.getOwnPropertyDescriptor(s,d))})}return P}var sr=(Le=Object(se.lazyInject)(se.TYPES.ILogService),et=Object(se.lazyInject)(se.TYPES.IGlobalConfigService),wt=(qt=function(){function P(p){Pe()(this,P),Vn()(this,"logger",Ne,this),Vn()(this,"configService",gt,this),this.config=void 0,this.config=p}return Qe()(P,[{key:"setContainer",value:function(s,d){s.bind(se.TYPES.MapConfig).toConstantValue(Br(Br({},this.config),{},{id:d})),s.bind(se.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),P}(),qt),Ne=de()(wt.prototype,"logger",[Le],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gt=de()(wt.prototype,"configService",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt),kr=o("QILm"),Cn=o.n(kr),dn=o("yXPU"),Er=o.n(dn),Tn=o("hi0z"),vn=o.n(Tn),mn=o("Hel2"),Ar=o("IOcx"),$r=o("4cb6"),Mn={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},Ki=o("J4zp"),vi=o.n(Ki),Mi=Math.PI/180,zi=function(){function P(){Pe()(this,P),this.projectionMatrix=Ar.b.create(),this.viewMatrix=Ar.b.create(),this.viewProjectionMatrix=Ar.b.create(),this.ViewProjectionMatrixUncentered=Ar.b.create(),this.viewUncenteredMatrix=Ar.b.create(),this.zoom=void 0,this.center=void 0}return Qe()(P,[{key:"syncWithMapCamera",value:function(s){var d=s.zoom,g=d===void 0?1:d,L=s.pitch,N=L===void 0?0:L,K=s.bearing,ee=K===void 0?0:K,X=s.center,be=X===void 0?[0,0]:X,me=s.offsetOrigin,Be=me===void 0?[0,0]:me,pt=s.cameraHeight,Kt=pt===void 0?1:pt,kt=s.aspect,Qt=kt===void 0?1:kt,ur=s.near,Ur=ur===void 0?.1:ur,on=s.far,Hr=on===void 0?1e3:on,ln=s.fov,Pn=ln===void 0?0:ln;this.zoom=g,this.center=be;var Hn=N*Mi,ai=(360-ee)*Mi;Ar.b.perspective(this.projectionMatrix,Pn,Qt,Ur,Hr);var Hi=Ar.d.fromValues(Kt*Math.sin(Hn)*Math.sin(ai),-Kt*Math.sin(Hn)*Math.cos(ai),Kt*Math.cos(Hn)),ma=Ar.d.fromValues(-Math.cos(Hn)*Math.sin(ai),Math.cos(Hn)*Math.cos(ai),Math.sin(Hn));Ar.b.lookAt(this.viewMatrix,Hi,Ar.d.fromValues(0,0,0),ma),this.viewUncenteredMatrix=Ar.b.clone(this.viewMatrix),Ar.b.translate(this.viewMatrix,this.viewMatrix,Ar.d.fromValues(-Be[0],Be[1],0)),Ar.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),Ar.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var s=vi()(this.center,2),d=s[0],g=s[1];return[d,g]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(s,d){var g=85.0511287798,L=Math.max(Math.min(g,s[1]),-g),N=256<<20,K=Math.PI/180,ee=s[0]*K,X=L*K;X=Math.log(Math.tan(Math.PI/4+X/2));var be=.5/Math.PI,me=.5,Be=-.5/Math.PI;return K=.5,ee=N*(be*ee+me)-215440491,X=-(N*(Be*X+K)-106744817),[ee,X]}}]),P}(),Ka,hi,ya,Ii,yi,ci,Ra,xo,$a,Ko,Uu,Gi,Pa,ns;function na(P,p){var s=Object.keys(P);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(P);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(P,g).enumerable})),s.push.apply(s,d)}return s}function Ja(P){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?na(Object(s),!0).forEach(function(d){fi()(P,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(s)):na(Object(s)).forEach(function(d){Object.defineProperty(P,d,Object.getOwnPropertyDescriptor(s,d))})}return P}o("BGjm")(`/* @antv/l7-maps */
.amap-logo{
 display: none !important;
}
`);var is=0;window.forceWebGL=!0;var Ji="15cd8a57710d40c9b7c0e3cc120f1200",lo="1.4.15",co="amap-script",Ks=!1,wo=[],Zl=12,$s=(Ka=Object($r.injectable)(),hi=Object($r.inject)(se.TYPES.IGlobalConfigService),ya=Object($r.inject)(se.TYPES.ILogService),Ii=Object($r.inject)(se.TYPES.MapConfig),yi=Object($r.inject)(se.TYPES.ICoordinateSystemService),ci=Object($r.inject)(se.TYPES.IEventEmitter),Ka(Ra=(xo=(ns=function(){function P(){var p=this;Pe()(this,P),this.map=void 0,Vn()(this,"configService",$a,this),Vn()(this,"logger",Ko,this),Vn()(this,"config",Uu,this),Vn()(this,"coordinateSystemService",Gi,this),Vn()(this,"eventEmitter",Pa,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(s){var d=s.camera,g=d.fov,L=d.near,N=d.far,K=d.height,ee=d.pitch,X=d.rotation,be=d.aspect,me=d.position,Be=p.getCenter(),pt=Be.lng,Kt=Be.lat;p.cameraChangedCallback&&(p.viewport.syncWithMapCamera({aspect:be,bearing:360-X,far:N,fov:g,cameraHeight:K,near:L,pitch:ee,zoom:p.map.getZoom()-1,center:[pt,Kt],offsetOrigin:[me.x,me.y]}),p.viewport.getZoom()>Zl?p.coordinateSystemService.setCoordinateSystem(se.CoordinateSystem.P20_OFFSET):p.coordinateSystemService.setCoordinateSystem(se.CoordinateSystem.P20),p.cameraChangedCallback(p.viewport))}}return Qe()(P,[{key:"addMarkerContainer",value:function(){var s=this.map.getContainer();if(s!==null){var d=s.getElementsByClassName("amap-maps")[0];this.markerContainer=mn.a.create("div","l7-marker-container",d)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(s,d){se.MapServiceEvent.indexOf(s)!==-1?this.eventEmitter.on(s,d):this.map.on(s,d)}},{key:"off",value:function(s,d){se.MapServiceEvent.indexOf(s)!==-1?this.eventEmitter.off(s,d):this.map.off(s,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var s;return(s=this.map.getContainer())===null||s===void 0?void 0:s.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var s=this.map.getSize();return[s.getWidth(),s.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(s){return this.map.setZoom(s)}},{key:"getCenter",value:function(){var s=this.map.getCenter();return{lng:s.getLng(),lat:s.getLat()}}},{key:"setCenter",value:function(s){this.map.setCenter(s)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var s=this.map.getBounds().toBounds(),d=s.getNorthEast(),g=s.getSouthWest(),L=this.getCenter(),N=L.lng>d.getLng()||L.lng<g.getLng()?180-d.getLng():d.getLng(),K=L.lng<g.getLng()?g.getLng()-180:g.getLng();return[[K,g.getLat()],[N,d.getLat()]]}},{key:"getMinZoom",value:function(){var s=this.map.get("zooms");return s[0]-1}},{key:"getMaxZoom",value:function(){var s=this.map.get("zooms");return s[1]-1}},{key:"setRotation",value:function(s){return this.map.setRotation(s)}},{key:"setPitch",value:function(s){return this.map.setPitch(s)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(s){this.map.panTo(s)}},{key:"panBy",value:function(s){this.map.panTo(s)}},{key:"fitBounds",value:function(s){this.map.setBounds(new AMap.Bounds([s[0][0],s[0][1],s[1][0],s[1][1]]))}},{key:"setZoomAndCenter",value:function(s,d){this.map.setZoomAndCenter(s,d)}},{key:"setMapStyle",value:function(s){this.map.setMapStyle(this.getMapStyle(s))}},{key:"setMapStatus",value:function(s){this.map.setStatus(s)}},{key:"pixelToLngLat",value:function(s){var d=this.map.pixelToLngLat(new AMap.Pixel(s[0],s[1]));return{lng:d.getLng(),lat:d.getLat()}}},{key:"lngLatToPixel",value:function(s){var d=this.map.lnglatToPixel(new AMap.LngLat(s[0],s[1]));return{x:d.getX(),y:d.getY()}}},{key:"containerToLngLat",value:function(s){var d=new AMap.Pixel(s[0],s[1]),g=this.map.containerToLngLat(d);return{lng:g==null?void 0:g.getLng(),lat:g==null?void 0:g.getLat()}}},{key:"lngLatToContainer",value:function(s){var d=new AMap.LngLat(s[0],s[1]),g=this.map.lngLatToContainer(d);return{x:g.getX(),y:g.getY()}}},{key:"lngLatToMercator",value:function(s,d){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(s,d,g){var L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},K=this.viewport.projectFlat(s),ee=Ar.b.create();return Ar.b.translate(ee,ee,Ar.d.fromValues(K[0],K[1],d)),Ar.b.scale(ee,ee,Ar.d.fromValues(L[0],L[1],L[2])),Ar.b.rotateX(ee,ee,g[0]),Ar.b.rotateY(ee,ee,g[1]),Ar.b.rotateZ(ee,ee,g[2]),ee}},{key:"init",value:function(){var p=Er()(jt.a.mark(function d(){var g=this,L,N,K,ee,X,be,me,Be,pt,Kt,kt,Qt,ur,Ur;return jt.a.wrap(function(Hr){for(;;)switch(Hr.prev=Hr.next){case 0:return L=this.config,N=L.id,K=L.style,ee=K===void 0?"light":K,X=L.minZoom,be=X===void 0?0:X,me=L.maxZoom,Be=me===void 0?18:me,pt=L.token,Kt=pt===void 0?Ji:pt,kt=L.mapInstance,Qt=L.plugin,ur=Qt===void 0?[]:Qt,Ur=Cn()(L,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),Hr.next=3,new Promise(function(ln){var Pn=function(){if(kt)g.map=kt,g.$mapContainer=g.map.getContainer(),setTimeout(function(){g.map.on("camerachange",g.handleCameraChanged),ln()},30);else{g.$mapContainer=g.creatAmapContainer(N);var ai=new AMap.Map(g.$mapContainer,Ja({mapStyle:g.getMapStyle(ee),zooms:[be,Be],viewMode:"3D"},Ur));ai.on("camerachange",g.handleCameraChanged),g.map=ai,setTimeout(function(){ln()},10)}};!Ks&&!kt?(Kt===Ji&&g.logger.warn(g.configService.getSceneWarninfo("MapToken")),Ks=!0,ur.push("Map3D"),vn.a.load({key:Kt,version:lo,plugins:ur}).then(function(Hn){Pn(),wo.length&&(wo.forEach(function(ai){return ai()}),wo=[])}).catch(function(Hn){throw new Error(Hn)})):Ks&&window.AMap||kt?Pn():wo.push(Pn)});case 3:this.viewport=new zi;case 4:case"end":return Hr.stop()}},d,this)}));function s(){return p.apply(this,arguments)}return s}()},{key:"exportMap",value:function(s){var d,g=(d=this.getContainer())===null||d===void 0?void 0:d.getElementsByClassName("amap-layer")[0],L=s==="jpg"?g==null?void 0:g.toDataURL("image/jpeg"):g==null?void 0:g.toDataURL("image/png");return L}},{key:"emit",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).emit.apply(d,[s].concat(L))}},{key:"once",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).once.apply(d,[s].concat(L))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var s=document.getElementById(co);s&&document.head.removeChild(s)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(s){this.cameraChangedCallback=s}},{key:"getMapStyle",value:function(s){return Mn[s]?Mn[s]:s}},{key:"creatAmapContainer",value:function(s){var d=s;typeof s=="string"&&(d=document.getElementById(s));var g=document.createElement("div");return g.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,g.id="l7_amap_div"+is++,d.appendChild(g),g}}]),P}(),ns),$a=de()(xo.prototype,"configService",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ko=de()(xo.prototype,"logger",[ya],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uu=de()(xo.prototype,"config",[Ii],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gi=de()(xo.prototype,"coordinateSystemService",[yi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pa=de()(xo.prototype,"eventEmitter",[ci],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xo))||Ra);function Po(P){var p=Bt();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Bt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var Fe=function(P){pr()(s,P);var p=Po(s);function s(){return Pe()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"getServiceConstructor",value:function(){return $s}}]),s}(sr);function Ot(P,p){var s=Object.keys(P);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(P);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(P,g).enumerable})),s.push.apply(s,d)}return s}function fr(P){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?Ot(Object(s),!0).forEach(function(d){rn(P,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(s)):Ot(Object(s)).forEach(function(d){Object.defineProperty(P,d,Object.getOwnPropertyDescriptor(s,d))})}return P}function rn(P,p,s){return p in P?Object.defineProperty(P,p,{value:s,enumerable:!0,configurable:!0,writable:!0}):P[p]=s,P}function bn(P,p){return Fo(P)||bo(P,p)||Da(P,p)||Un()}function Un(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Da(P,p){if(!!P){if(typeof P=="string")return ao(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ao(P,p)}}function ao(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}function bo(P,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(P)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=P[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function Fo(P){if(Array.isArray(P))return P}var Vu=at.a.memo(function(P){var p=P.style,s=P.className,d=P.map,g=P.option,L=P.onSceneLoaded,N=P.children,K=Object(Re.useRef)(null),ee=Object(Re.useState)(),X=bn(ee,2),be=X[0],me=X[1];return Object(Re.useEffect)(function(){var Be=new Pt.Scene(fr(fr({id:K.current},g),{},{map:new Fe(d)}));return Be.on("loaded",function(){me(Be),L&&L(Be)}),function(){Be.destroy()}},[]),Object(Re.useEffect)(function(){be&&d.style&&be.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(Re.useEffect)(function(){be&&d.zoom&&be.setZoom(d.zoom)},[d.zoom]),Object(Re.useEffect)(function(){be&&d.center&&be.setCenter(d.center)},[JSON.stringify(d.center)]),Object(Re.useEffect)(function(){be&&d.pitch&&be.setPitch(d.pitch)},[d.pitch]),Object(Re.useEffect)(function(){be&&d.rotation&&be.setRotation(d.rotation)},[d.rotation]),at.a.createElement(ct.Provider,{value:be},at.a.createElement("div",{ref:K,className:s,style:p},be&&N))}),Wl=Vu,Js=o("4ZJM"),Ic=o.n(Js),Il=o("md7G"),hs=o("foSv"),Ns=o("JX7q"),fo=o("bl9R");function ds(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Qs(P,p){var s=fo.transformMat4([],p,P);return fo.scale(s,s,1/s[3]),s}function lu(P,p){var s=P%p;return s<0?p+s:s}function Xl(P,p,s){return s*p+(1-s)*P}var xa=o("ZaHm"),ka=o("ZxFD"),ml=o("n+fv");function Fs(P,p){if(!P)throw new Error(p||"viewport-mercator-project: assertion failed.")}var ps=Math.PI,It=ps/4,ir=ps/180,Mr=180/ps,Gn=512,Qi=4003e4,za=1.5;function Za(P){return Math.pow(2,P)}function qi(P){return Math.log2(P)}function ba(P,p){var s=Object(q.a)(P,2),d=s[0],g=s[1];Fs(Number.isFinite(d)&&Number.isFinite(p)),Fs(Number.isFinite(g)&&g>=-90&&g<=90,"invalid latitude"),p*=Gn;var L=d*ir,N=g*ir,K=p*(L+ps)/(2*ps),ee=p*(ps-Math.log(Math.tan(It+N*.5)))/(2*ps);return[K,ee]}function _o(P,p){var s=Object(q.a)(P,2),d=s[0],g=s[1];p*=Gn;var L=d/p*(2*ps)-ps,N=2*(Math.atan(Math.exp(ps-g/p*(2*ps)))-It);return[L*Mr,N*Mr]}function Bs(P){var p=P.latitude;Fs(Number.isFinite(p));var s=Math.cos(p*ir);return qi(Qi*s)-9}function ha(P){var p=P.latitude,s=P.longitude,d=P.zoom,g=P.scale,L=P.highPrecision,N=L===void 0?!1:L;g=g!==void 0?g:Za(d),Fs(Number.isFinite(p)&&Number.isFinite(s)&&Number.isFinite(g));var K={},ee=Gn*g,X=Math.cos(p*ir),be=ee/360,me=be/X,Be=ee/Qi/X;if(K.pixelsPerMeter=[Be,-Be,Be],K.metersPerPixel=[1/Be,-1/Be,1/Be],K.pixelsPerDegree=[be,-me,Be],K.degreesPerPixel=[1/be,-1/me,1/Be],N){var pt=ir*Math.tan(p*ir)/X,Kt=be*pt/2,kt=ee/Qi*pt,Qt=kt/me*Be;K.pixelsPerDegree2=[0,-Kt,kt],K.pixelsPerMeter2=[Qt,0,Qt]}return K}function Yl(P,p){var s=Object(q.a)(P,3),d=s[0],g=s[1],L=s[2],N=Object(q.a)(p,3),K=N[0],ee=N[1],X=N[2],be=1,me=ha({longitude:d,latitude:g,scale:be,highPrecision:!0}),Be=me.pixelsPerMeter,pt=me.pixelsPerMeter2,Kt=ba(P,be);Kt[0]+=K*(Be[0]+pt[0]*ee),Kt[1]+=ee*(Be[1]+pt[1]*ee);var kt=_o(Kt,be),Qt=(L||0)+(X||0);return Number.isFinite(L)||Number.isFinite(X)?[kt[0],kt[1],Qt]:kt}function cu(P){var p=P.height,s=P.pitch,d=P.bearing,g=P.altitude,L=P.center,N=L===void 0?null:L,K=P.flipY,ee=K===void 0?!1:K,X=ds();return xa.translate(X,X,[0,0,-g]),xa.scale(X,X,[1,1,1/p]),xa.rotateX(X,X,-s*ir),xa.rotateZ(X,X,d*ir),ee&&xa.scale(X,X,[1,-1,1]),N&&xa.translate(X,X,ml.negate([],N)),X}function _s(P){var p=P.width,s=P.height,d=P.altitude,g=d===void 0?za:d,L=P.pitch,N=L===void 0?0:L,K=P.nearZMultiplier,ee=K===void 0?1:K,X=P.farZMultiplier,be=X===void 0?1:X,me=N*ir,Be=Math.atan(.5/g),pt=Math.sin(Be)*g/Math.sin(Math.PI/2-me-Be),Kt=Math.cos(Math.PI/2-me)*pt+g;return{fov:2*Math.atan(s/2/g),aspect:p/s,focalDistance:g,near:ee,far:Kt*be}}function gl(P){var p=P.width,s=P.height,d=P.pitch,g=P.altitude,L=P.nearZMultiplier,N=P.farZMultiplier,K=_s({width:p,height:s,altitude:g,pitch:d,nearZMultiplier:L,farZMultiplier:N}),ee=K.fov,X=K.aspect,be=K.near,me=K.far,Be=xa.perspective([],ee,X,be,me);return Be}function fu(P,p){var s=Object(q.a)(P,3),d=s[0],g=s[1],L=s[2],N=L===void 0?0:L;return Fs(Number.isFinite(d)&&Number.isFinite(g)&&Number.isFinite(N)),Qs(p,[d,g,N,1])}function Gu(P,p){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=Object(q.a)(P,3),g=d[0],L=d[1],N=d[2];if(Fs(Number.isFinite(g)&&Number.isFinite(L),"invalid pixel coordinate"),Number.isFinite(N)){var K=Qs(p,[g,L,N,1]);return K}var ee=Qs(p,[g,L,0,1]),X=Qs(p,[g,L,1,1]),be=ee[2],me=X[2],Be=be===me?0:((s||0)-be)/(me-be);return ka.lerp([],ee,X,Be)}var qs=ds(),rl=function(){function P(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=p.width,d=p.height,g=p.viewMatrix,L=g===void 0?qs:g,N=p.projectionMatrix,K=N===void 0?qs:N;Object(Q.a)(this,P),this.width=s||1,this.height=d||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=L,this.projectionMatrix=K;var ee=ds();xa.multiply(ee,ee,this.projectionMatrix),xa.multiply(ee,ee,this.viewMatrix),this.viewProjectionMatrix=ee;var X=ds();xa.scale(X,X,[this.width/2,-this.height/2,1]),xa.translate(X,X,[1,-1,0]),xa.multiply(X,X,this.viewProjectionMatrix);var be=xa.invert(ds(),X);if(!be)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=X,this.pixelUnprojectionMatrix=be,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(re.a)(P,[{key:"equals",value:function(s){return s instanceof P?s.width===this.width&&s.height===this.height&&xa.equals(s.projectionMatrix,this.projectionMatrix)&&xa.equals(s.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=d.topLeft,L=g===void 0?!0:g,N=this.projectPosition(s),K=fu(N,this.pixelProjectionMatrix),ee=Object(q.a)(K,2),X=ee[0],be=ee[1],me=L?be:this.height-be;return s.length===2?[X,me]:[X,me,K[2]]}},{key:"unproject",value:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=d.topLeft,L=g===void 0?!0:g,N=d.targetZ,K=Object(q.a)(s,3),ee=K[0],X=K[1],be=K[2],me=L?X:this.height-X,Be=N&&N*this.pixelsPerMeter,pt=Gu([ee,me,be],this.pixelUnprojectionMatrix,Be),Kt=this.unprojectPosition(pt),kt=Object(q.a)(Kt,3),Qt=kt[0],ur=kt[1],Ur=kt[2];return Number.isFinite(be)?[Qt,ur,Ur]:Number.isFinite(N)?[Qt,ur,N]:[Qt,ur]}},{key:"projectPosition",value:function(s){var d=this.projectFlat(s),g=Object(q.a)(d,2),L=g[0],N=g[1],K=(s[2]||0)*this.pixelsPerMeter;return[L,N,K]}},{key:"unprojectPosition",value:function(s){var d=this.unprojectFlat(s),g=Object(q.a)(d,2),L=g[0],N=g[1],K=(s[2]||0)/this.pixelsPerMeter;return[L,N,K]}},{key:"projectFlat",value:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return s}},{key:"unprojectFlat",value:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return s}}]),P}();function hu(P){var p=P.width,s=P.height,d=P.bounds,g=P.minExtent,L=g===void 0?0:g,N=P.maxZoom,K=N===void 0?24:N,ee=P.padding,X=ee===void 0?0:ee,be=P.offset,me=be===void 0?[0,0]:be,Be=Object(q.a)(d,2),pt=Object(q.a)(Be[0],2),Kt=pt[0],kt=pt[1],Qt=Object(q.a)(Be[1],2),ur=Qt[0],Ur=Qt[1];if(Number.isFinite(X)){var on=X;X={top:on,bottom:on,left:on,right:on}}else Fs(Number.isFinite(X.top)&&Number.isFinite(X.bottom)&&Number.isFinite(X.left)&&Number.isFinite(X.right));var Hr=new pc({width:p,height:s,longitude:0,latitude:0,zoom:0}),ln=Hr.project([Kt,Ur]),Pn=Hr.project([ur,kt]),Hn=[Math.max(Math.abs(Pn[0]-ln[0]),L),Math.max(Math.abs(Pn[1]-ln[1]),L)],ai=[p-X.left-X.right-Math.abs(me[0])*2,s-X.top-X.bottom-Math.abs(me[1])*2];Fs(ai[0]>0&&ai[1]>0);var Hi=ai[0]/Hn[0],ma=ai[1]/Hn[1],La=(X.right-X.left)/2/Hi,qu=(X.bottom-X.top)/2/ma,ts=[(Pn[0]+ln[0])/2+La,(Pn[1]+ln[1])/2+qu],ls=Hr.unproject(ts),Su=Hr.zoom+Math.log2(Math.abs(Math.min(Hi,ma)));return{longitude:ls[0],latitude:ls[1],zoom:Math.min(Su,K)}}var pc=function(P){Object(we.a)(p,P);function p(){var s,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=d.width,L=d.height,N=d.latitude,K=N===void 0?0:N,ee=d.longitude,X=ee===void 0?0:ee,be=d.zoom,me=be===void 0?0:be,Be=d.pitch,pt=Be===void 0?0:Be,Kt=d.bearing,kt=Kt===void 0?0:Kt,Qt=d.altitude,ur=Qt===void 0?1.5:Qt,Ur=d.nearZMultiplier,on=d.farZMultiplier;Object(Q.a)(this,p),g=g||1,L=L||1;var Hr=Za(me);ur=Math.max(.75,ur);var ln=ba([X,K],Hr);ln[2]=0;var Pn=gl({width:g,height:L,pitch:pt,bearing:kt,altitude:ur,nearZMultiplier:Ur||1/L,farZMultiplier:on||1.01}),Hn=cu({height:L,center:ln,pitch:pt,bearing:kt,altitude:ur,flipY:!0});return s=Object(Il.a)(this,Object(hs.a)(p).call(this,{width:g,height:L,viewMatrix:Hn,projectionMatrix:Pn})),s.latitude=K,s.longitude=X,s.zoom=me,s.pitch=pt,s.bearing=kt,s.altitude=ur,s.scale=Hr,s.center=ln,s.pixelsPerMeter=ha(Object(Ns.a)(Object(Ns.a)(s))).pixelsPerMeter[2],Object.freeze(Object(Ns.a)(Object(Ns.a)(s))),s}return Object(re.a)(p,[{key:"projectFlat",value:function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return ba(d,g)}},{key:"unprojectFlat",value:function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return _o(d,g)}},{key:"getMapCenterByLngLatPosition",value:function(d){var g=d.lngLat,L=d.pos,N=Gu(L,this.pixelUnprojectionMatrix),K=ba(g,this.scale),ee=ka.add([],K,ka.negate([],N)),X=ka.add([],this.center,ee);return _o(X,this.scale)}},{key:"getLocationAtPoint",value:function(d){var g=d.lngLat,L=d.pos;return this.getMapCenterByLngLatPosition({lngLat:g,pos:L})}},{key:"fitBounds",value:function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L=this.width,N=this.height,K=hu(Object.assign({width:L,height:N,bounds:d},g)),ee=K.longitude,X=K.latitude,be=K.zoom;return new p({width:L,height:N,longitude:ee,latitude:X,zoom:be})}}]),p}(rl),_f=function(){function P(){Pe()(this,P),this.viewport=void 0}return Qe()(P,[{key:"syncWithMapCamera",value:function(s){var d=s.center,g=s.zoom,L=s.pitch,N=s.bearing,K=s.viewportHeight,ee=s.viewportWidth;this.viewport=new pc({width:ee,height:K,longitude:d&&d[0],latitude:d&&d[1],zoom:g,pitch:L,bearing:N})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(s,d){return this.viewport.projectFlat(s,d)}}]),P}(),da={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Oc,vc,qc,ef,tf,Qa,Au,eu,vs,Lc,mc,yl,nl,gc;function tu(P,p){var s=Object.keys(P);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(P);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(P,g).enumerable})),s.push.apply(s,d)}return s}function Hu(P){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?tu(Object(s),!0).forEach(function(d){fi()(P,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(s)):tu(Object(s)).forEach(function(d){Object.defineProperty(P,d,Object.getOwnPropertyDescriptor(s,d))})}return P}o("BGjm")(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Ic.a;var Rc={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Kl=0,_a=12,Dc="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",Mf=(Oc=Object($r.injectable)(),vc=Object($r.inject)(se.TYPES.MapConfig),qc=Object($r.inject)(se.TYPES.IGlobalConfigService),ef=Object($r.inject)(se.TYPES.ILogService),tf=Object($r.inject)(se.TYPES.ICoordinateSystemService),Qa=Object($r.inject)(se.TYPES.IEventEmitter),Oc(Au=(eu=(gc=function(){function P(){var p=this;Pe()(this,P),this.map=void 0,Vn()(this,"config",vs,this),Vn()(this,"configService",Lc,this),Vn()(this,"logger",mc,this),Vn()(this,"coordinateSystemService",yl,this),Vn()(this,"eventEmitter",nl,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var s=p.map.getCenter().wrap(),d=s.lat,g=s.lng;p.viewport.syncWithMapCamera({bearing:p.map.getBearing(),center:[g,d],viewportHeight:p.map.transform.height,pitch:p.map.getPitch(),viewportWidth:p.map.transform.width,zoom:p.map.getZoom(),cameraHeight:0}),p.viewport.getZoom()>_a?p.coordinateSystemService.setCoordinateSystem(se.CoordinateSystem.LNGLAT_OFFSET):p.coordinateSystemService.setCoordinateSystem(se.CoordinateSystem.LNGLAT),p.cameraChangedCallback(p.viewport)}}return Qe()(P,[{key:"addMarkerContainer",value:function(){var s=this.map.getCanvasContainer();this.markerContainer=mn.a.create("div","l7-marker-container",s),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(s,d){se.MapServiceEvent.indexOf(s)!==-1?this.eventEmitter.on(s,d):this.map.on(Rc[s]||s,d)}},{key:"off",value:function(s,d){this.map.off(Rc[s]||s,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var s=this.map.transform;return[s.width,s.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(s){return this.map.setZoom(s)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(s){this.map.setCenter(s)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(s){this.map.setBearing(s)}},{key:"zoomIn",value:function(s,d){this.map.zoomIn(s,d)}},{key:"zoomOut",value:function(s,d){this.map.zoomOut(s,d)}},{key:"setPitch",value:function(s){return this.map.setPitch(s)}},{key:"panTo",value:function(s){this.map.panTo(s)}},{key:"panBy",value:function(s){this.panTo(s)}},{key:"fitBounds",value:function(s,d){this.map.fitBounds(s,d)}},{key:"setMaxZoom",value:function(s){this.map.setMaxZoom(s)}},{key:"setMinZoom",value:function(s){this.map.setMinZoom(s)}},{key:"setMapStatus",value:function(s){s.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),s.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),s.dragEnable===!1&&this.map.dragPan.disable(),s.dragEnable===!0&&this.map.dragPan.enable(),s.rotateEnable===!1&&this.map.dragRotate.disable(),s.rotateEnable===!0&&this.map.dragRotate.enable(),s.keyboardEnable===!1&&this.map.keyboard.disable(),s.keyboardEnable===!0&&this.map.keyboard.enable(),s.zoomEnable===!1&&this.map.scrollZoom.disable(),s.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(s,d){this.map.flyTo({zoom:s,center:d})}},{key:"setMapStyle",value:function(s){this.map.setStyle(this.getMapStyle(s))}},{key:"pixelToLngLat",value:function(s){return this.map.unproject(s)}},{key:"lngLatToPixel",value:function(s){return this.map.project(s)}},{key:"containerToLngLat",value:function(s){return this.map.unproject(s)}},{key:"lngLatToContainer",value:function(s){return this.map.project(s)}},{key:"lngLatToMercator",value:function(s,d){var g=window.mapboxgl.MercatorCoordinate.fromLngLat(s,d),L=g.x,N=L===void 0?0:L,K=g.y,ee=K===void 0?0:K,X=g.z,be=X===void 0?0:X;return{x:N,y:ee,z:be}}},{key:"getModelMatrix",value:function(s,d,g){var L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},K=window.mapboxgl.MercatorCoordinate.fromLngLat(s,d),ee=K.meterInMercatorCoordinateUnits(),X=Ar.b.create();return Ar.b.translate(X,X,Ar.d.fromValues(K.x-N.x,K.y-N.y,K.z||0-N.z)),Ar.b.scale(X,X,Ar.d.fromValues(ee*L[0],-ee*L[1],ee*L[2])),Ar.b.rotateX(X,X,g[0]),Ar.b.rotateY(X,X,g[1]),Ar.b.rotateZ(X,X,g[2]),X}},{key:"init",value:function(){var p=Er()(jt.a.mark(function d(){var g,L,N,K,ee,X,be,me,Be,pt,Kt,kt,Qt;return jt.a.wrap(function(Ur){for(;;)switch(Ur.prev=Ur.next){case 0:g=this.config,L=g.id,N=L===void 0?"map":L,K=g.attributionControl,ee=K===void 0?!1:K,X=g.style,be=X===void 0?"light":X,me=g.token,Be=me===void 0?Dc:me,pt=g.rotation,Kt=pt===void 0?0:pt,kt=g.mapInstance,Qt=Cn()(g,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new _f,!kt&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),Be===Dc&&be!=="blank"&&!window.mapboxgl.accessToken&&!kt&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!kt&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Be),kt?(this.map=kt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(N),this.map=new window.mapboxgl.Map(Hu({container:this.$mapContainer,style:this.getMapStyle(be),attributionControl:ee,bearing:Kt},Qt))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return Ur.stop()}},d,this)}));function s(){return p.apply(this,arguments)}return s}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).emit.apply(d,[s].concat(L))}},{key:"once",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).once.apply(d,[s].concat(L))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(s){var d=this.map.getCanvas(),g=s==="jpg"?d==null?void 0:d.toDataURL("image/jpeg"):d==null?void 0:d.toDataURL("image/png");return g}},{key:"onCameraChanged",value:function(s){this.cameraChangedCallback=s}},{key:"creatAmapContainer",value:function(s){var d=s;typeof s=="string"&&(d=document.getElementById(s));var g=document.createElement("div");return g.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,g.id="l7_mapbox_div"+Kl++,d.appendChild(g),g}},{key:"getMapStyle",value:function(s){return typeof s!="string"?s:da[s]?da[s]:s}}]),P}(),gc),vs=de()(eu.prototype,"config",[vc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lc=de()(eu.prototype,"configService",[qc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mc=de()(eu.prototype,"logger",[ef],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl=de()(eu.prototype,"coordinateSystemService",[tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nl=de()(eu.prototype,"eventEmitter",[Qa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eu))||Au);function yc(P){var p=zc();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function zc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}o("BGjm")(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var $l=function(P){pr()(s,P);var p=yc(s);function s(){return Pe()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"getServiceConstructor",value:function(){return Mf}}]),s}(sr);function Zu(P,p){var s=Object.keys(P);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(P);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(P,g).enumerable})),s.push.apply(s,d)}return s}function Cu(P){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?Zu(Object(s),!0).forEach(function(d){Ol(P,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(s)):Zu(Object(s)).forEach(function(d){Object.defineProperty(P,d,Object.getOwnPropertyDescriptor(s,d))})}return P}function Ol(P,p,s){return p in P?Object.defineProperty(P,p,{value:s,enumerable:!0,configurable:!0,writable:!0}):P[p]=s,P}function Bo(P,p){return Rl(P)||Nc(P,p)||Ll(P,p)||Jl()}function Jl(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ll(P,p){if(!!P){if(typeof P=="string")return xl(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return xl(P,p)}}function xl(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}function Nc(P,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(P)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=P[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function Rl(P){if(Array.isArray(P))return P}var ru=at.a.memo(function(P){var p=P.style,s=P.className,d=P.map,g=P.option,L=P.onSceneLoaded,N=Object(Re.createRef)(),K=Object(Re.useState)(),ee=Bo(K,2),X=ee[0],be=ee[1];return Object(Re.useEffect)(function(){var me=new Pt.Scene(Cu(Cu({id:N.current},g),{},{map:new $l(d)}));return me.on("loaded",function(){be(me),L&&L(me)}),function(){me.destroy()}},[]),Object(Re.useEffect)(function(){X&&d.style&&X.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(Re.useEffect)(function(){X&&d.zoom&&X.setZoom(d.zoom)},[d.zoom]),Object(Re.useEffect)(function(){X&&d.center&&X.setCenter(d.center)},[JSON.stringify(d.center)]),Object(Re.useEffect)(function(){X&&d.pitch!==void 0&&X.setPitch(d.pitch||0)},[d.pitch]),Object(Re.useEffect)(function(){X&&d.rotation&&X.setRotation(d.rotation)},[d.rotation]),at.a.createElement(ct.Provider,{value:X},Object(Re.createElement)("div",{ref:N,style:p,className:s},X&&P.children))}),mf=ru,gf=o("PJYZ"),rf=o.n(gf),bl=o("QkVN"),ja=o.n(bl),il=o("uhBA"),Dl=o("cDf5"),xc=o.n(Dl),Fc=o("zvhG"),zl=o.n(Fc);function If(P,p){var s;if(typeof Symbol=="undefined"||P[Symbol.iterator]==null){if(Array.isArray(P)||(s=Of(P))||p&&P&&typeof P.length=="number"){s&&(P=s);var d=0,g=function(){};return{s:g,n:function(){return d>=P.length?{done:!0}:{done:!1,value:P[d++]}},e:function(X){throw X},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=P[Symbol.iterator]()},n:function(){var X=s.next();return L=X.done,X},e:function(X){N=!0,K=X},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function Of(P,p){if(!!P){if(typeof P=="string")return nf(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return nf(P,p)}}function nf(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}var Sl;function Ql(P,p,s){var d=s-p,g=((P-p)%d+d)%d+p;return g===p?s:g}function wu(P,p,s){return Math.min(s,Math.max(p,P))}function ks(P,p,s){return P*(1-s)+p*s}function al(P,p,s,d){var g=new zl.a(P,p,s,d);return function(L){return g.solve(L)}}var Bc=al(.25,.1,.25,1);function Wu(){return window.matchMedia?(Sl==null&&(Sl=window.matchMedia("(prefers-reduced-motion: reduce)")),Sl.matches):!1}function Ua(P,p){var s={},d=If(p),g;try{for(d.s();!(g=d.n()).done;){var L=g.value;L in P&&(s[L]=P[L])}}catch(N){d.e(N)}finally{d.f()}return s}var du=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),ol=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,sl=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;function Ni(P){var p=ol(P);return{cancel:function(){return sl(p)}}}var pa=function(){Qe()(P,null,[{key:"convert",value:function(s){return s instanceof P?s:new P(s)}}]);function P(p,s){Pe()(this,P),this.ne=void 0,this.sw=void 0,p&&(s?this.setSouthWest(p).setNorthEast(s):p.length===4?this.setSouthWest([p[0],p[1]]).setNorthEast([p[2],p[3]]):this.setSouthWest(p[0]).setNorthEast(p[1]))}return Qe()(P,[{key:"setNorthEast",value:function(s){return this.ne=s instanceof Ea?new Ea(s.lng,s.lat):Ea.convert(s),this}},{key:"setSouthWest",value:function(s){return this.sw=s instanceof Ea?new Ea(s.lng,s.lat):Ea.convert(s),this}},{key:"extend",value:function(s){var d=this.sw,g=this.ne,L,N;if(s instanceof Ea)L=s,N=s;else if(s instanceof P){if(L=s.sw,N=s.ne,!L||!N)return this}else{if(Array.isArray(s))if(s.length===4||s.every(Array.isArray)){var K=s;return this.extend(P.convert(K))}else{var ee=s;return this.extend(Ea.convert(ee))}return this}return!d&&!g?(this.sw=new Ea(L.lng,L.lat),this.ne=new Ea(N.lng,N.lat)):(d.lng=Math.min(L.lng,d.lng),d.lat=Math.min(L.lat,d.lat),g.lng=Math.max(N.lng,g.lng),g.lat=Math.max(N.lat,g.lat)),this}},{key:"getCenter",value:function(){return new Ea((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new Ea(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new Ea(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(s){var d=Ea.convert(s),g=d.lng,L=d.lat,N=this.sw.lat<=L&&L<=this.ne.lat,K=this.sw.lng<=g&&g<=this.ne.lng;return this.sw.lng>this.ne.lng&&(K=this.sw.lng>=g&&g>=this.ne.lng),N&&K}}]),P}(),Ms=63710088e-1,Ea=function(){Qe()(P,null,[{key:"convert",value:function(s){if(s instanceof P)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new P(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&xc()(s)==="object"&&s!==null){var d="lng"in s?s.lng:s.lon;return new P(Number(d),Number(s.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]);function P(p,s){if(Pe()(this,P),this.lng=void 0,this.lat=void 0,isNaN(p)||isNaN(s))throw new Error("Invalid LngLat object: (".concat(p,", ").concat(s,")"));if(this.lng=+p,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return Qe()(P,[{key:"wrap",value:function(){return new P(Ql(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toBounds",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=40075017,g=360*s/d,L=g/Math.cos(Math.PI/180*this.lat);return new pa(new P(this.lng-L,this.lat-g),new P(this.lng+L,this.lat+g))}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(s){var d=Math.PI/180,g=this.lat*d,L=s.lat*d,N=Math.sin(g)*Math.sin(L)+Math.cos(g)*Math.cos(L)*Math.cos((s.lng-this.lng)*d),K=Ms*Math.acos(Math.min(N,1));return K}}]),P}(),Zi=function(){Qe()(P,null,[{key:"convert",value:function(s){return s instanceof P?s:Array.isArray(s)?new P(s[0],s[1]):s}}]);function P(p,s){Pe()(this,P),this.x=void 0,this.y=void 0,this.x=p,this.y=s}return Qe()(P,[{key:"clone",value:function(){return new P(this.x,this.y)}},{key:"_add",value:function(s){return this.x+=s.x,this.y+=s.y,this}},{key:"add",value:function(s){return this.clone()._add(s)}},{key:"_sub",value:function(s){return this.x-=s.x,this.y-=s.y,this}},{key:"sub",value:function(s){return this.clone()._sub(s)}},{key:"_multByPoint",value:function(s){return this.x*=s.x,this.y*=s.y,this}},{key:"multByPoint",value:function(s){return this.clone()._multByPoint(s)}},{key:"_divByPoint",value:function(s){return this.x/=s.x,this.y/=s.y,this}},{key:"divByPoint",value:function(s){return this.clone()._divByPoint(s)}},{key:"_mult",value:function(s){return this.x*=s,this.y*=s,this}},{key:"mult",value:function(s){return this.clone()._mult(s)}},{key:"_div",value:function(s){return this.x/=s,this.y/=s,this}},{key:"div",value:function(s){return this.clone()._div(s)}},{key:"_rotate",value:function(s){var d=Math.cos(s),g=Math.sin(s),L=d*this.x-g*this.y,N=g*this.x+d*this.y;return this.x=L,this.y=N,this}},{key:"rotate",value:function(s){return this.clone()._rotate(s)}},{key:"_rotateAround",value:function(s,d){var g=Math.cos(s),L=Math.sin(s),N=d.x+g*(this.x-d.x)-L*(this.y-d.y),K=d.y+L*(this.x-d.x)+g*(this.y-d.y);return this.x=N,this.y=K,this}},{key:"roateAround",value:function(s,d){return this.clone()._rotateAround(s,d)}},{key:"_matMult",value:function(s){var d=s[0]*this.x+s[1]*this.y,g=s[2]*this.x+s[3]*this.y;return this.x=d,this.y=g,this}},{key:"matMult",value:function(s){return this.clone()._matMult(s)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var s=this.y;return this.y=this.x,this.x=-s,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(s){return this.x===s.x&&this.y===s.y}},{key:"dist",value:function(s){return Math.sqrt(this.distSqr(s))}},{key:"distSqr",value:function(s){var d=s.x-this.x,g=s.y-this.y;return d*d+g*g}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(s){return Math.atan2(this.y-s.y,this.x-s.x)}},{key:"angleWith",value:function(s){return this.angleWithSep(s.x,s.y)}},{key:"angleWithSep",value:function(s,d){return Math.atan2(this.x*d-this.y*s,this.x*s+this.y*d)}}]),P}(),ql=function(){function P(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(Pe()(this,P),this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,isNaN(p)||p<0||isNaN(s)||s<0||isNaN(d)||d<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=p,this.bottom=s,this.left=d,this.right=g}return Qe()(P,[{key:"interpolate",value:function(s,d,g){return d.top!=null&&s.top!=null&&(this.top=ks(s.top,d.top,g)),d.bottom!=null&&s.bottom!=null&&(this.bottom=ks(s.bottom,d.bottom,g)),d.left!=null&&s.left!=null&&(this.left=ks(s.left,d.left,g)),d.right!=null&&s.right!=null&&(this.right=ks(s.right,d.right,g)),this}},{key:"getCenter",value:function(s,d){var g=wu((this.left+s-this.right)/2,0,s),L=wu((this.top+d-this.bottom)/2,0,d);return new Zi(g,L)}},{key:"equals",value:function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}},{key:"clone",value:function(){return new P(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),P}(),yf=2*Math.PI*Ms;function as(P){return yf*Math.cos(P*Math.PI/180)}function ul(P){return(180+P)/360}function pu(P){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+P*Math.PI/360)))/360}function Xu(P,p){return P/as(p)}function oo(P){return P*360-180}function os(P){var p=180-P*360;return 360/Math.PI*Math.atan(Math.exp(p*Math.PI/180))-90}function Nl(P,p){return P*as(os(p))}function ho(P){return 1/Math.cos(P*Math.PI/180)}var In=function(){Qe()(P,null,[{key:"fromLngLat",value:function(s){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,g=Ea.convert(s);return new P(ul(g.lng),pu(g.lat),Xu(d,g.lat))}}]);function P(p,s){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Pe()(this,P),this.x=void 0,this.y=void 0,this.z=void 0,this.x=+p,this.y=+s,this.z=+d}return Qe()(P,[{key:"toLngLat",value:function(){return new Ea(oo(this.x),os(this.y))}},{key:"toAltitude",value:function(){return Nl(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/yf*ho(os(this.y))}}]),P}();function js(P,p){var s;if(typeof Symbol=="undefined"||P[Symbol.iterator]==null){if(Array.isArray(P)||(s=bc(P))||p&&P&&typeof P.length=="number"){s&&(P=s);var d=0,g=function(){};return{s:g,n:function(){return d>=P.length?{done:!0}:{done:!1,value:P[d++]}},e:function(X){throw X},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=P[Symbol.iterator]()},n:function(){var X=s.next();return L=X.done,X},e:function(X){N=!0,K=X},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function bc(P,p){if(!!P){if(typeof P=="string")return El(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return El(P,p)}}function El(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}var Pu=8192,Us=function(){Qe()(P,[{key:"minZoom",get:function(){return this._minZoom},set:function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}},{key:"minPitch",get:function(){return this._minPitch},set:function(s){this._minPitch!==s&&(this._minPitch=s,this._pitch=Math.max(this._pitch,s))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(s){this._maxPitch!==s&&(this._maxPitch=s,this._pitch=Math.min(this._pitch,s))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Zi(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(s){var d=-Ql(s,-180,180)*Math.PI/180;this.angle!==d&&(this.unmodified=!1,this.angle=d,this.calcMatrices(),this.rotationMatrix=Ar.a.create(),Ar.a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(s){var d=wu(s,this._minPitch,this._maxPitch)/180*Math.PI;this._pitch!==d&&(this.unmodified=!1,this._pitch=d,this.calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this.unmodified=!1,this._fov=s/180*Math.PI,this.calcMatrices())}},{key:"zoom",get:function(){return this._zoom},set:function(s){var d=Math.min(Math.max(s,this._minZoom),this._maxZoom);this._zoom!==d&&(this.unmodified=!1,this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom,this.constrain(),this.calcMatrices())}},{key:"center",get:function(){return this._center},set:function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this.unmodified=!1,this._center=s,this.constrain(),this.calcMatrices())}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(s){this.edgeInsets.equals(s)||(this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,s,1),this.calcMatrices())}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}}]);function P(p,s,d,g,L){Pe()(this,P),this.tileSize=void 0,this.tileZoom=void 0,this.lngRange=void 0,this.latRange=void 0,this.maxValidLatitude=void 0,this.scale=void 0,this.width=void 0,this.height=void 0,this.angle=void 0,this.rotationMatrix=void 0,this.pixelsToGLUnits=void 0,this.cameraToCenterDistance=void 0,this.mercatorMatrix=void 0,this.projMatrix=void 0,this.invProjMatrix=void 0,this.alignedProjMatrix=void 0,this.pixelMatrix=void 0,this.pixelMatrixInverse=void 0,this.glCoordMatrix=void 0,this.labelPlaneMatrix=void 0,this._fov=void 0,this._pitch=void 0,this._zoom=void 0,this._renderWorldCopies=void 0,this._minZoom=void 0,this._maxZoom=void 0,this._minPitch=void 0,this._maxPitch=void 0,this._center=void 0,this.zoomFraction=void 0,this.unmodified=void 0,this.edgeInsets=void 0,this.constraining=void 0,this.posMatrixCache=void 0,this.alignedPosMatrixCache=void 0,this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=L===void 0?!0:L,this._minZoom=p||0,this._maxZoom=s||22,this._minPitch=d==null?0:d,this._maxPitch=g==null?60:g,this.setMaxBounds(),this.width=0,this.height=0,this._center=new Ea(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new ql,this.posMatrixCache={},this.alignedPosMatrixCache={}}return Qe()(P,[{key:"clone",value:function(){var s=new P(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s.center=this._center,s.zoom=this.zoom,s.angle=this.angle,s.fov=this._fov,s.pitch=this._pitch,s.unmodified=this.unmodified,s.edgeInsets=this.edgeInsets.clone(),s.calcMatrices(),s}},{key:"isPaddingEqual",value:function(s){return this.edgeInsets.equals(s)}},{key:"interpolatePadding",value:function(s,d,g){this.unmodified=!1,this.edgeInsets.interpolate(s,d,g),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(s){var d=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,d)}},{key:"resize",value:function(s,d){this.width=s,this.height=d,this.pixelsToGLUnits=[2/s,-2/d],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(s){return Math.pow(2,s)}},{key:"scaleZoom",value:function(s){return Math.log(s)/Math.LN2}},{key:"project",value:function(s){var d=wu(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Zi(ul(s.lng)*this.worldSize,pu(d)*this.worldSize)}},{key:"unproject",value:function(s){return new In(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(s,d){var g=this.pointCoordinate(d),L=this.pointCoordinate(this.centerPoint),N=this.locationCoordinate(s),K=new In(N.x-(g.x-L.x),N.y-(g.y-L.y));this.center=this.coordinateLocation(K),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(s){var d=0,g=new Float32Array([s.x,s.y,0,1]),L=new Float32Array([s.x,s.y,1,1]);Ar.e.transformMat4(g,g,this.pixelMatrixInverse),Ar.e.transformMat4(L,L,this.pixelMatrixInverse);var N=g[3],K=L[3],ee=g[0]/N,X=L[0]/K,be=g[1]/N,me=L[1]/K,Be=g[2]/N,pt=L[2]/K,Kt=Be===pt?0:(d-Be)/(pt-Be);return new In(ks(ee,X,Kt)/this.worldSize,ks(be,me,Kt)/this.worldSize)}},{key:"getBounds",value:function(){return new pa().extend(this.pointLocation(new Zi(0,0))).extend(this.pointLocation(new Zi(this.width,0))).extend(this.pointLocation(new Zi(this.width,this.height))).extend(this.pointLocation(new Zi(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new pa([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new Zi(0,0)),d=new Float32Array([s.x*this.worldSize,s.y*this.worldSize,0,1]),g=Ar.e.transformMat4(d,d,this.pixelMatrix);return g[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var s=this._pitch,d=Math.tan(s)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Zi(0,d))}},{key:"getCameraQueryGeometry",value:function(s){var d=this.getCameraPoint();if(s.length===1)return[s[0],d];var g=d.x,L=d.y,N=d.x,K=d.y,ee=js(s),X;try{for(ee.s();!(X=ee.n()).done;){var be=X.value;g=Math.min(g,be.x),L=Math.min(L,be.y),N=Math.max(N,be.x),K=Math.max(K,be.y)}}catch(me){ee.e(me)}finally{ee.f()}return[new Zi(g,L),new Zi(N,L),new Zi(N,K),new Zi(g,K),new Zi(g,L)]}},{key:"coordinatePoint",value:function(s){var d=Ar.e.fromValues(s.x*this.worldSize,s.y*this.worldSize,0,1);return Ar.e.transformMat4(d,d,this.pixelMatrix),new Zi(d[0]/d[3],d[1]/d[3])}},{key:"locationPoint",value:function(s){return this.coordinatePoint(this.locationCoordinate(s))}},{key:"pointLocation",value:function(s){return this.coordinateLocation(this.pointCoordinate(s))}},{key:"locationCoordinate",value:function(s){return In.fromLngLat(s)}},{key:"coordinateLocation",value:function(s){return s.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!(!this.center||!this.width||!this.height||this.constraining)){this.constraining=!0;var s=-90,d=90,g=-180,L=180,N,K,ee,X,be=this.size,me=this.unmodified;if(this.latRange){var Be=this.latRange;s=pu(Be[1])*this.worldSize,d=pu(Be[0])*this.worldSize,N=d-s<be.y?be.y/(d-s):0}if(this.lngRange){var pt=this.lngRange;g=ul(pt[0])*this.worldSize,L=ul(pt[1])*this.worldSize,K=L-g<be.x?be.x/(L-g):0}var Kt=this.point,kt=Math.max(K||0,N||0);if(kt){this.center=this.unproject(new Zi(K?(L+g)/2:Kt.x,N?(d+s)/2:Kt.y)),this.zoom+=this.scaleZoom(kt),this.unmodified=me,this.constraining=!1;return}if(this.latRange){var Qt=Kt.y,ur=be.y/2;Qt-ur<s&&(X=s+ur),Qt+ur>d&&(X=d-ur)}if(this.lngRange){var Ur=Kt.x,on=be.x/2;Ur-on<g&&(ee=g+on),Ur+on>L&&(ee=L-on)}(ee!==void 0||X!==void 0)&&(this.center=this.unproject(new Zi(ee!==void 0?ee:Kt.x,X!==void 0?X:Kt.y))),this.unmodified=me,this.constraining=!1}}},{key:"calcMatrices",value:function(){if(!!this.height){var s=this._fov/2,d=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(s)*this.height;var g=Math.PI/2+this._pitch,L=this._fov*(.5+d.y/this.height),N=Math.sin(L)*this.cameraToCenterDistance/Math.sin(wu(Math.PI-g-L,.01,Math.PI-.01)),K=this.point,ee=K.x,X=K.y,be=Math.cos(Math.PI/2-this._pitch)*N+this.cameraToCenterDistance,me=be*1.01,Be=this.height/50,pt=Ar.b.create();Ar.b.perspective(pt,this._fov,this.width/this.height,Be,me),pt[8]=-d.x*2/this.width,pt[9]=d.y*2/this.height,Ar.b.scale(pt,pt,[1,-1,1]),Ar.b.translate(pt,pt,[0,0,-this.cameraToCenterDistance]),Ar.b.rotateX(pt,pt,this._pitch),Ar.b.rotateZ(pt,pt,this.angle),Ar.b.translate(pt,pt,[-ee,-X,0]),this.mercatorMatrix=Ar.b.scale(Ar.b.create(),pt,[this.worldSize,this.worldSize,this.worldSize]),Ar.b.scale(pt,pt,Ar.d.fromValues(1,1,Xu(1,this.center.lat)*this.worldSize)),this.projMatrix=pt,this.invProjMatrix=Ar.b.invert(Ar.b.create(),this.projMatrix);var Kt=this.width%2/2,kt=this.height%2/2,Qt=Math.cos(this.angle),ur=Math.sin(this.angle),Ur=ee-Math.round(ee)+Qt*Kt+ur*kt,on=X-Math.round(X)+Qt*kt+ur*Kt,Hr=Ar.b.clone(pt);if(Ar.b.translate(Hr,Hr,[Ur>.5?Ur-1:Ur,on>.5?on-1:on,0]),this.alignedProjMatrix=Hr,pt=Ar.b.create(),Ar.b.scale(pt,pt,[this.width/2,-this.height/2,1]),Ar.b.translate(pt,pt,[1,-1,0]),this.labelPlaneMatrix=pt,pt=Ar.b.create(),Ar.b.scale(pt,pt,[1,-1,1]),Ar.b.translate(pt,pt,[-1,-1,0]),Ar.b.scale(pt,pt,[2/this.width,2/this.height,1]),this.glCoordMatrix=pt,this.pixelMatrix=Ar.b.multiply(Ar.b.create(),this.labelPlaneMatrix,this.projMatrix),pt=Ar.b.invert(Ar.b.create(),this.pixelMatrix),!pt)throw new Error("failed to invert matrix");this.pixelMatrixInverse=pt,this.posMatrixCache={},this.alignedPosMatrixCache={}}}}]),P}(),ea=function P(p){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Pe()(this,P),this.type=void 0,ja()(this,s),this.type=p};function en(P){var p=kc();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function kc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var Sc=function(P){pr()(s,P);var p=en(s);function s(d){var g;Pe()(this,s),g=p.call(this),g.transform=void 0,g.options=void 0,g.moving=void 0,g.zooming=void 0,g.rotating=void 0,g.pitching=void 0,g.padding=void 0,g.bearingSnap=void 0,g.easeEndTimeoutID=void 0,g.easeStart=void 0,g.easeOptions=void 0,g.easeId=void 0,g.onEaseFrame=void 0,g.onEaseEnd=void 0,g.easeFrameId=void 0,g.renderFrameCallback=function(){var be=Math.min((du()-g.easeStart)/g.easeOptions.duration,1);g.onEaseFrame(g.easeOptions.easing(be)),be<1?g.easeFrameId=g.requestRenderFrame(g.renderFrameCallback):g.stop()},g.options=d;var L=d.minZoom,N=d.maxZoom,K=d.minPitch,ee=d.maxPitch,X=d.renderWorldCopies;return g.moving=!1,g.zooming=!1,g.bearingSnap=d.bearingSnap,g.transform=new Us(L,N,K,ee,X),g}return Qe()(s,[{key:"requestRenderFrame",value:function(g){return 0}},{key:"cancelRenderFrame",value:function(g){}},{key:"getCenter",value:function(){var g=this.transform.center,L=g.lng,N=g.lat;return new Ea(L,N)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(g,L){return this.jumpTo({center:g},L)}},{key:"setPitch",value:function(g,L){return this.jumpTo({pitch:g},L),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(g,L,N){return this.easeTo(ja()({center:g},L),N)}},{key:"zoomOut",value:function(g,L){return this.zoomTo(this.getZoom()-1,g,L),this}},{key:"setBearing",value:function(g,L){return this.jumpTo({bearing:g},L),this}},{key:"setZoom",value:function(g,L){return this.jumpTo({zoom:g},L),this}},{key:"zoomIn",value:function(g,L){return this.zoomTo(this.getZoom()+1,g,L),this}},{key:"zoomTo",value:function(g,L,N){return this.easeTo(ja()({zoom:g},L),N)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(g,L){return this.jumpTo({padding:g},L),this}},{key:"rotateTo",value:function(g,L,N){return this.easeTo(ja()({bearing:g},L),N)}},{key:"resetNorth",value:function(g,L){return this.rotateTo(0,ja()({duration:1e3},g),L),this}},{key:"resetNorthPitch",value:function(g,L){return this.easeTo(ja()({bearing:0,pitch:0,duration:1e3},g),L),this}},{key:"fitBounds",value:function(g,L,N){return this.fitInternal(this.cameraForBounds(g,L),L,N)}},{key:"cameraForBounds",value:function(g,L){return g=pa.convert(g),this.cameraForBoxAndBearing(g.getNorthWest(),g.getSouthEast(),0,L)}},{key:"snapToNorth",value:function(g,L){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(g,L):this}},{key:"jumpTo",value:function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},L=arguments.length>1?arguments[1]:void 0;this.stop();var N=this.transform,K=!1,ee=!1,X=!1;return g.zoom&&N.zoom!==+g.zoom&&(K=!0,N.zoom=+g.zoom),g.center!==void 0&&(N.center=Ea.convert(g.center)),g.bearing&&N.bearing!==+g.bearing&&(ee=!0,N.bearing=+g.bearing),g.pitch&&N.pitch!==+g.pitch&&(X=!0,N.pitch=+g.pitch),g.padding!=null&&!N.isPaddingEqual(g.padding)&&(N.padding=g.padding),this.emit("movestart",new ea("movestart",L)),this.emit("move",new ea("move",L)),K&&(this.emit("zoomstart",new ea("zoomstart",L)),this.emit("zoom",new ea("zoom",L)),this.emit("zoomend",new ea("zoomend",L))),ee&&(this.emit("rotatestart",new ea("rotatestart",L)),this.emit("rotate",new ea("rotate",L)),this.emit("rotateend",new ea("rotateend",L))),X&&(this.emit("pitchstart",new ea("pitchstart",L)),this.emit("pitch",new ea("pitch",L)),this.emit("pitchend",new ea("pitchend",L))),this.emit("moveend",new ea("moveend",L))}},{key:"easeTo",value:function(){var g=this,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=arguments.length>1?arguments[1]:void 0;L=ja()({offset:[0,0],duration:500,easing:Bc},L),(L.animate===!1||!L.essential&&Wu())&&(L.duration=0);var K=this.transform,ee=this.getZoom(),X=this.getBearing(),be=this.getPitch(),me=this.getPadding(),Be=L.zoom?+L.zoom:ee,pt=L.bearing?this.normalizeBearing(L.bearing,X):X,Kt=L.pitch?+L.pitch:be,kt=L.padding?L.padding:K.padding,Qt=Zi.convert(L.offset),ur=K.centerPoint.add(Qt),Ur=K.pointLocation(ur),on=Ea.convert(L.center||Ur);this.normalizeCenter(on);var Hr=K.project(Ur),ln=K.project(on).sub(Hr),Pn=K.zoomScale(Be-ee),Hn,ai;L.around&&(Hn=Ea.convert(L.around),ai=K.locationPoint(Hn));var Hi={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||Be!==ee,this.rotating=this.rotating||X!==pt,this.pitching=this.pitching||Kt!==be,this.padding=!K.isPaddingEqual(kt),this.easeId=L.easeId,this.prepareEase(N,L.noMoveStart,Hi),clearTimeout(this.easeEndTimeoutID),this.ease(function(ma){if(g.zooming&&(K.zoom=ks(ee,Be,ma)),g.rotating&&(K.bearing=ks(X,pt,ma)),g.pitching&&(K.pitch=ks(be,Kt,ma)),g.padding&&(K.interpolatePadding(me,kt,ma),ur=K.centerPoint.add(Qt)),Hn)K.setLocationAtPoint(Hn,ai);else{var La=K.zoomScale(K.zoom-ee),qu=Be>ee?Math.min(2,Pn):Math.max(.5,Pn),ts=Math.pow(qu,1-ma),ls=K.unproject(Hr.add(ln.mult(ma*ts)).mult(La));K.setLocationAtPoint(K.renderWorldCopies?ls.wrap():ls,ur)}g.fireMoveEvents(N)},function(ma){g.afterEase(N,ma)},L),this}},{key:"flyTo",value:function(){var g=this,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=arguments.length>1?arguments[1]:void 0;if(!L.essential&&Wu()){var K=Ua(L,["center","zoom","bearing","pitch","around"]);return this.jumpTo(K,N)}this.stop(),L=ja()({offset:[0,0],speed:1.2,curve:1.42,easing:Bc},L);var ee=this.transform,X=this.getZoom(),be=this.getBearing(),me=this.getPitch(),Be=this.getPadding(),pt=L.zoom?wu(+L.zoom,ee.minZoom,ee.maxZoom):X,Kt=L.bearing?this.normalizeBearing(L.bearing,be):be,kt=L.pitch?+L.pitch:me,Qt="padding"in L?L.padding:ee.padding,ur=ee.zoomScale(pt-X),Ur=Zi.convert(L.offset),on=ee.centerPoint.add(Ur),Hr=ee.pointLocation(on),ln=Ea.convert(L.center||Hr);this.normalizeCenter(ln);var Pn=ee.project(Hr),Hn=ee.project(ln).sub(Pn),ai=L.curve,Hi=Math.max(ee.width,ee.height),ma=Hi/ur,La=Hn.mag();if("minZoom"in L){var qu=wu(Math.min(L.minZoom,X,pt),ee.minZoom,ee.maxZoom),ts=Hi/ee.zoomScale(qu-X);ai=Math.sqrt(ts/La*2)}var ls=ai*ai;function Su(go){var vl=(ma*ma-Hi*Hi+(go?-1:1)*ls*ls*La*La)/(2*(go?ma:Hi)*ls*La);return Math.log(Math.sqrt(vl*vl+1)-vl)}function Nf(go){return(Math.exp(go)-Math.exp(-go))/2}function Ml(go){return(Math.exp(go)+Math.exp(-go))/2}function Wc(go){return Nf(go)/Ml(go)}var wa=Su(0),Fa=function(vl){return Ml(wa)/Ml(wa+ai*vl)},Pc=function(vl){return Hi*((Ml(wa)*Wc(wa+ai*vl)-Nf(wa))/ls)/La},pl=(Su(1)-wa)/ai;if(Math.abs(La)<1e-6||!isFinite(pl)){if(Math.abs(Hi-ma)<1e-6)return this.easeTo(L,N);var Xc=ma<Hi?-1:1;pl=Math.abs(Math.log(ma/Hi))/ai,Pc=function(){return 0},Fa=function(vl){return Math.exp(Xc*ai*vl)}}if("duration"in L)L.duration=+L.duration;else{var Jf="screenSpeed"in L?+L.screenSpeed/ai:+L.speed;L.duration=1e3*pl/Jf}return L.maxDuration&&L.duration>L.maxDuration&&(L.duration=0),this.zooming=!0,this.rotating=be!==Kt,this.pitching=kt!==me,this.padding=!ee.isPaddingEqual(Qt),this.prepareEase(N,!1),this.ease(function(go){var vl=go*pl,hf=1/Fa(vl);ee.zoom=go===1?pt:X+ee.scaleZoom(hf),g.rotating&&(ee.bearing=ks(be,Kt,go)),g.pitching&&(ee.pitch=ks(me,kt,go)),g.padding&&(ee.interpolatePadding(Be,Qt,go),on=ee.centerPoint.add(Ur));var df=go===1?ln:ee.unproject(Pn.add(Hn.mult(Pc(vl))).mult(hf));ee.setLocationAtPoint(ee.renderWorldCopies?df.wrap():df,on),g.fireMoveEvents(N)},function(){return g.afterEase(N)},L),this}},{key:"fitScreenCoordinates",value:function(g,L,N,K,ee){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Zi.convert(g)),this.transform.pointLocation(Zi.convert(L)),N,K),K,ee)}},{key:"stop",value:function(g,L){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var N=this.onEaseEnd;delete this.onEaseEnd,N.call(this,L)}return this}},{key:"normalizeBearing",value:function(g,L){g=Ql(g,-180,180);var N=Math.abs(g-L);return Math.abs(g-360-L)<N&&(g-=360),Math.abs(g+360-L)<N&&(g+=360),g}},{key:"normalizeCenter",value:function(g){var L=this.transform;if(!(!L.renderWorldCopies||L.lngRange)){var N=g.lng-L.center.lng;g.lng+=N>180?-360:N<-180?360:0}}},{key:"fireMoveEvents",value:function(g){this.emit("move",new ea("move",g)),this.zooming&&this.emit("zoom",new ea("zoom",g)),this.rotating&&this.emit("rotate",new ea("rotate",g)),this.pitching&&this.emit("rotate",new ea("pitch",g))}},{key:"prepareEase",value:function(g){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!L&&!N.moving&&this.emit("movestart",new ea("movestart",g)),this.zooming&&!N.zooming&&this.emit("zoomstart",new ea("zoomstart",g)),this.rotating&&!N.rotating&&this.emit("rotatestart",new ea("rotatestart",g)),this.pitching&&!N.pitching&&this.emit("pitchstart",new ea("pitchstart",g))}},{key:"afterEase",value:function(g,L){if(!(this.easeId&&L&&this.easeId===L)){delete this.easeId;var N=this.zooming,K=this.rotating,ee=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,N&&this.emit("zoomend",new ea("zoomend",g)),K&&this.emit("rotateend",new ea("rotateend",g)),ee&&this.emit("pitchend",new ea("pitchend",g)),this.emit("moveend",new ea("moveend",g))}}},{key:"ease",value:function(g,L,N){N.animate===!1||N.duration===0?(g(1),L()):(this.easeStart=du(),this.easeOptions=N,this.onEaseFrame=g,this.onEaseEnd=L,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(g,L,N,K){var ee={top:0,bottom:0,right:0,left:0};if(K=ja()({padding:ee,offset:[0,0],maxZoom:this.transform.maxZoom},K),typeof K.padding=="number"){var X=K.padding;K.padding={top:X,bottom:X,right:X,left:X}}K.padding=ja()(ee,K.padding);var be=this.transform,me=be.padding,Be=be.project(Ea.convert(g)),pt=be.project(Ea.convert(L)),Kt=Be.rotate(-N*Math.PI/180),kt=pt.rotate(-N*Math.PI/180),Qt=new Zi(Math.max(Kt.x,kt.x),Math.max(Kt.y,kt.y)),ur=new Zi(Math.min(Kt.x,kt.x),Math.min(Kt.y,kt.y)),Ur=Qt.sub(ur),on=(be.width-(me.left+me.right+K.padding.left+K.padding.right))/Ur.x,Hr=(be.height-(me.top+me.bottom+K.padding.top+K.padding.bottom))/Ur.y;if(!(Hr<0||on<0)){var ln=Math.min(be.scaleZoom(be.scale*Math.min(on,Hr)),K.maxZoom),Pn=Zi.convert(K.offset),Hn=(K.padding.left-K.padding.right)/2,ai=(K.padding.top-K.padding.bottom)/2,Hi=new Zi(Pn.x+Hn,Pn.y+ai),ma=Hi.mult(be.scale/be.zoomScale(ln)),La=be.unproject(Be.add(pt).div(2).sub(ma));return{center:La,zoom:ln,bearing:N}}}},{key:"fitInternal",value:function(g,L,N){return g?(L=ja()(g,L),delete L.padding,L.linear?this.easeTo(L,N):this.flyTo(L,N)):this}}]),s}(il.EventEmitter);function ll(P,p){var s;if(typeof Symbol=="undefined"||P[Symbol.iterator]==null){if(Array.isArray(P)||(s=vu(P))||p&&P&&typeof P.length=="number"){s&&(P=s);var d=0,g=function(){};return{s:g,n:function(){return d>=P.length?{done:!0}:{done:!1,value:P[d++]}},e:function(X){throw X},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=P[Symbol.iterator]()},n:function(){var X=s.next();return L=X.done,X},e:function(X){N=!0,K=X},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function vu(P,p){if(!!P){if(typeof P=="string")return Is(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Is(P,p)}}function Is(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}var Os={},$o=Os;Os.create=function(P,p,s){var d=window.document.createElement(P);return p!==void 0&&(d.className=p),s&&s.appendChild(d),d},Os.createNS=function(P,p){var s=window.document.createElementNS(P,p);return s};var ko=window.document&&window.document.documentElement.style;function cl(P){if(!ko)return P[0];var p=ll(P),s;try{for(p.s();!(s=p.n()).done;){var d=s.value;if(d in ko)return d}}catch(g){p.e(g)}finally{p.f()}return P[0]}var Tl=cl(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Fl;Os.disableDrag=function(){ko&&Tl&&(Fl=ko[Tl],ko[Tl]="none")},Os.enableDrag=function(){ko&&Tl&&(ko[Tl]=Fl)};var af=cl(["transform","WebkitTransform"]);Os.setTransform=function(P,p){P.style[af]=p};var Bl=!1;try{var Ls=Object.defineProperty({},"passive",{get:function(){Bl=!0}});window.addEventListener("test",Ls,Ls),window.removeEventListener("test",Ls,Ls)}catch(P){Bl=!1}Os.addEventListener=function(P,p,s){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in d&&Bl?P.addEventListener(p,s,d):P.addEventListener(p,s,d.capture)},Os.removeEventListener=function(P,p,s){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in d&&Bl?P.removeEventListener(p,s,d):P.removeEventListener(p,s,d.capture)};var ss=function P(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",P,!0)};Os.suppressClick=function(){window.addEventListener("click",ss,!0),window.setTimeout(function(){window.removeEventListener("click",ss,!0)},0)},Os.mousePos=function(P,p){var s=P.getBoundingClientRect();return new Zi(p.clientX-s.left-P.clientLeft,p.clientY-s.top-P.clientTop)},Os.touchPos=function(P,p){var s=P.getBoundingClientRect(),d=[],g=ll(p),L;try{for(g.s();!(L=g.n()).done;){var N=L.value;d.push(new Zi(N.clientX-s.left-P.clientLeft,N.clientY-s.top-P.clientTop))}}catch(K){g.e(K)}finally{g.f()}return d},Os.mouseButton=function(P){return typeof window.InstallTrigger!="undefined"&&P.button===2&&P.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:P.button},Os.remove=function(P){P.parentNode&&P.parentNode.removeChild(P)};function Oi(P){var p=Yu();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Yu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var Va=function(P){pr()(s,P);var p=Oi(s);function s(d,g,L){var N,K=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Pe()(this,s);var ee=$o.mousePos(g.getCanvasContainer(),L),X=g.unproject(ee);return N=p.call(this,d,ja()({point:ee,lngLat:X,originalEvent:L},K)),N.type=void 0,N.target=void 0,N.originalEvent=void 0,N.point=void 0,N.lngLat=void 0,N.defaultPrevented=void 0,N.defaultPrevented=!1,N.target=g,N}return Qe()(s,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),s}(ea);function Mo(P){var p=Al();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Al(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var mu=function(P){pr()(s,P);var p=Mo(s);function s(d,g,L){var N;Pe()(this,s);var K=d==="touchend"?L.changedTouches:L.touches,ee=$o.touchPos(g.getCanvasContainer(),K),X=ee.map(function(Be){return g.unproject(Be)}),be=ee.reduce(function(Be,pt,Kt,kt){return Be.add(pt.div(kt.length))},new Zi(0,0)),me=g.unproject(be);return N=p.call(this,d,{points:ee,point:be,lngLats:X,lngLat:me,originalEvent:L}),N.type=void 0,N.target=void 0,N.originalEvent=void 0,N.lngLat=void 0,N.point=void 0,N.points=void 0,N.lngLats=void 0,N.defaultPrevented=void 0,N.defaultPrevented=!1,N}return Qe()(s,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),s}(ea);function gu(P){var p=Ts();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Ts(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var Ec=function(P){pr()(s,P);var p=gu(s);function s(d,g,L){var N;return Pe()(this,s),N=p.call(this,d,{originalEvent:L}),N.type=void 0,N.originalEvent=void 0,N.defaultPrevented=void 0,N.target=void 0,N.defaultPrevented=!1,N}return Qe()(s,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),s}(ea),$n=function(){function P(p){Pe()(this,P),this.map=void 0,this.delayContextMenu=void 0,this.contextMenuEvent=void 0,this.map=p}return Qe()(P,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(s){this.map.emit(s.type,new Va(s.type,this.map,s))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new Va("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(s){this.delayContextMenu?this.contextMenuEvent=s:this.map.emit(s.type,new Va(s.type,this.map,s)),this.map.listeners("contextmenu")&&s.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),P}(),Fn=function(){function P(p,s){Pe()(this,P),this.map=void 0,this.el=void 0,this.container=void 0,this.enabled=void 0,this.active=void 0,this.startPos=void 0,this.lastPos=void 0,this.box=void 0,this.clickTolerance=void 0,this.map=p,this.el=p.getCanvasContainer(),this.container=p.getContainer(),this.clickTolerance=s.clickTolerance||1}return Qe()(P,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){this.isEnabled()||(this.enabled=!0)}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"mousedown",value:function(s,d){!this.isEnabled()||!(s.shiftKey&&s.button===0)||($o.disableDrag(),this.startPos=this.lastPos=d,this.active=!0)}},{key:"mousemoveWindow",value:function(s,d){if(!!this.active){var g=d;if(!(this.lastPos.equals(g)||!this.box&&g.dist(this.startPos)<this.clickTolerance)){var L=this.startPos;this.lastPos=g,this.box||(this.box=$o.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",s));var N=Math.min(L.x,g.x),K=Math.max(L.x,g.x),ee=Math.min(L.y,g.y),X=Math.max(L.y,g.y);$o.setTransform(this.box,"translate(".concat(N,"px,").concat(ee,"px)")),this.box&&(this.box.style.width="".concat(K-N,"px"),this.box.style.height="".concat(X-ee,"px"))}}}},{key:"mouseupWindow",value:function(s,d){var g=this;if(!!this.active&&s.button===0){var L=this.startPos,N=d;if(this.reset(),$o.suppressClick(),L.x===N.x&&L.y===N.y)this.fireEvent("boxzoomcancel",s);else return this.map.emit("boxzoomend",new ea("boxzoomend",{originalEvent:s})),{cameraAnimation:function(ee){return ee.fitScreenCoordinates(L,N,g.map.getBearing(),{linear:!0})}}}}},{key:"keydown",value:function(s){!this.active||s.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",s))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&($o.remove(this.box),this.box=null),$o.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(s,d){return this.map.emit(s,new ea(s,{originalEvent:d}))}}]),P}(),Tc=Fn,ms=function(){function P(){Pe()(this,P),this.enabled=void 0,this.active=void 0,this.reset()}return Qe()(P,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(s,d){return s.preventDefault(),{cameraAnimation:function(L){L.easeTo({duration:300,zoom:L.getZoom()+(s.shiftKey?-1:1),around:L.unproject(d)},{originalEvent:s})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),P}();function jo(P){var p=Io();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Io(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var nu=function(P){pr()(s,P);var p=jo(s);function s(){var d;Pe()(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.type="renderFrame",d.timeStamp=void 0,d}return s}(ea);function _u(P,p){var s;if(typeof Symbol=="undefined"||P[Symbol.iterator]==null){if(Array.isArray(P)||(s=ec(P))||p&&P&&typeof P.length=="number"){s&&(P=s);var d=0,g=function(){};return{s:g,n:function(){return d>=P.length?{done:!0}:{done:!1,value:P[d++]}},e:function(X){throw X},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=P[Symbol.iterator]()},n:function(){var X=s.next();return L=X.done,X},e:function(X){N=!0,K=X},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function ec(P,p){if(!!P){if(typeof P=="string")return Wi(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Wi(P,p)}}function Wi(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}var Wa={linearity:.3,easing:al(0,0,.3,1)},fl=ja()({deceleration:2500,maxSpeed:1400},Wa),hl=ja()({deceleration:20,maxSpeed:1400},Wa),tc=ja()({deceleration:1e3,maxSpeed:360},Wa),Mu=ja()({deceleration:1e3,maxSpeed:90},Wa),Rs=function(){function P(p){Pe()(this,P),this.map=void 0,this.inertiaBuffer=void 0,this.map=p,this.clear()}return Qe()(P,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(s){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:du(),settings:s})}},{key:"drainInertiaBuffer",value:function(){for(var s=this.inertiaBuffer,d=du(),g=160;s.length>0&&d-s[0].time>g;)s.shift()}},{key:"onMoveEnd",value:function(s){if(this.drainInertiaBuffer(),!(this.inertiaBuffer.length<2)){var d={zoom:0,bearing:0,pitch:0,pan:new Zi(0,0),pinchAround:void 0,around:void 0},g=_u(this.inertiaBuffer),L;try{for(g.s();!(L=g.n()).done;){var N=L.value.settings;d.zoom+=N.zoomDelta||0,d.bearing+=N.bearingDelta||0,d.pitch+=N.pitchDelta||0,N.panDelta&&d.pan._add(N.panDelta),N.around&&(d.around=N.around),N.pinchAround&&(d.pinchAround=N.pinchAround)}}catch(kt){g.e(kt)}finally{g.f()}var K=this.inertiaBuffer[this.inertiaBuffer.length-1],ee=K.time-this.inertiaBuffer[0].time,X={};if(d.pan.mag()){var be=gs(d.pan.mag(),ee,ja()({},fl,s||{}));X.offset=d.pan.mult(be.amount/d.pan.mag()),X.center=this.map.transform.center,kl(X,be)}if(d.zoom){var me=gs(d.zoom,ee,hl);X.zoom=this.map.transform.zoom+me.amount,kl(X,me)}if(d.bearing){var Be=gs(d.bearing,ee,tc);X.bearing=this.map.transform.bearing+wu(Be.amount,-179,179),kl(X,Be)}if(d.pitch){var pt=gs(d.pitch,ee,Mu);X.pitch=this.map.transform.pitch+pt.amount,kl(X,pt)}if(X.zoom||X.bearing){var Kt=d.pinchAround===void 0?d.around:d.pinchAround;X.around=Kt?this.map.unproject(Kt):this.map.getCenter()}return this.clear(),ja()(X,{noMoveStart:!0})}}}]),P}();function kl(P,p){(!P.duration||P.duration<p.duration)&&(P.duration=p.duration,P.easing=p.easing)}function gs(P,p,s){var d=s.maxSpeed,g=s.linearity,L=s.deceleration,N=wu(P*g/(p/1e3),-d,d),K=Math.abs(N)/(L*g);return{easing:s.easing,duration:K*1e3,amount:N*(K/2)}}var xf={panStep:100,bearingStep:15,pitchStep:10},jl=function(){function P(){Pe()(this,P),this.enabled=void 0,this.active=void 0,this.panStep=void 0,this.bearingStep=void 0,this.pitchStep=void 0;var p=xf;this.panStep=p.panStep,this.bearingStep=p.bearingStep,this.pitchStep=p.pitchStep}return Qe()(P,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(s){var d=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var g=0,L=0,N=0,K=0,ee=0;switch(s.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:s.shiftKey?L=-1:(s.preventDefault(),K=-1);break;case 39:s.shiftKey?L=1:(s.preventDefault(),K=1);break;case 38:s.shiftKey?N=1:(s.preventDefault(),ee=-1);break;case 40:s.shiftKey?N=-1:(s.preventDefault(),ee=1);break;default:return}return{cameraAnimation:function(be){var me=be.getZoom();be.easeTo({duration:300,easeId:"keyboardHandler",easing:jc,zoom:g?Math.round(me)+g*(s.shiftKey?2:1):me,bearing:be.getBearing()+L*d.bearingStep,pitch:be.getPitch()+N*d.pitchStep,offset:[-K*d.panStep,-ee*d.panStep],center:be.getCenter()},{originalEvent:s})}}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),P}();function jc(P){return P*(2-P)}var bf=jl,Vs=function(){function P(p,s){Pe()(this,P),this.mousedownPos=void 0,this.clickTolerance=void 0,this.map=void 0,this.map=p,this.clickTolerance=s.clickTolerance}return Qe()(P,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(s){return this.firePreventable(new Ec(s.type,this.map,s))}},{key:"mousedown",value:function(s,d){return this.mousedownPos=d,this.firePreventable(new Va(s.type,this.map,s))}},{key:"mouseup",value:function(s){this.map.emit(s.type,new Va(s.type,this.map,s))}},{key:"click",value:function(s,d){this.mousedownPos&&this.mousedownPos.dist(d)>=this.clickTolerance||this.map.emit(s.type,new Va(s.type,this.map,s))}},{key:"dblclick",value:function(s){return this.firePreventable(new Va(s.type,this.map,s))}},{key:"mouseover",value:function(s){this.map.emit(s.type,new Va(s.type,this.map,s))}},{key:"mouseout",value:function(s){this.map.emit(s.type,new Va(s.type,this.map,s))}},{key:"touchstart",value:function(s){return this.firePreventable(new mu(s.type,this.map,s))}},{key:"touchmove",value:function(s){this.map.emit(s.type,new mu(s.type,this.map,s))}},{key:"touchend",value:function(s){this.map.emit(s.type,new mu(s.type,this.map,s))}},{key:"touchcancel",value:function(s){this.map.emit(s.type,new mu(s.type,this.map,s))}},{key:"firePreventable",value:function(s){if(this.map.emit(s.type,s),s.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),P}(),Cl=o("iWIM"),Ul=o.n(Cl),Iu,Ou=0,wl=2,Ku=(Iu={},fi()(Iu,Ou,1),fi()(Iu,wl,2),Iu);function Ds(P,p){var s=Ku[p];return P.buttons===void 0||(P.buttons&s)!==s}var Ac=function(){function P(p){Pe()(this,P),this.enabled=void 0,this.active=void 0,this.lastPoint=void 0,this.eventButton=void 0,this.moved=void 0,this.clickTolerance=void 0,this.reset(),this.clickTolerance=p.clickTolerance||1}return Qe()(P,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(s,d){if(!this.lastPoint){var g=$o.mouseButton(s);!this.correctButton(s,g)||(this.lastPoint=d,this.eventButton=g)}}},{key:"mousemoveWindow",value:function(s,d){var g=this.lastPoint;if(!!g){if(s.preventDefault(),Ds(s,this.eventButton)){this.reset();return}if(!(!this.moved&&d.dist(g)<this.clickTolerance))return this.moved=!0,this.lastPoint=d,this.move(g,d)}}},{key:"mouseupWindow",value:function(s){if(!!this.lastPoint){var d=$o.mouseButton(s);d===this.eventButton&&(this.moved&&$o.suppressClick(),this.reset())}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(s,d){return!1}},{key:"move",value:function(s,d){}}]),P}();function rc(P){var p=nc();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function nc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var ic=function(P){pr()(s,P);var p=rc(s);function s(){return Pe()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"mousedown",value:function(g,L){Ul()(En()(s.prototype),"mousedown",this).call(this,g,L),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(g,L){return{around:L,panDelta:L.sub(g)}}},{key:"correctButton",value:function(g,L){return L===Ou&&!g.ctrlKey}}]),s}(Ac);function u(P){var p=i();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function i(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var n=function(P){pr()(s,P);var p=u(s);function s(){return Pe()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"correctButton",value:function(g,L){return L===Ou&&g.ctrlKey||L===wl}},{key:"move",value:function(g,L){var N=-.5,K=(L.y-g.y)*N;if(K)return this.active=!0,{pitchDelta:K}}},{key:"contextmenu",value:function(g){g.preventDefault()}}]),s}(Ac);function c(P){var p=y();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function y(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var _=function(P){pr()(s,P);var p=c(s);function s(){return Pe()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"contextmenu",value:function(g){g.preventDefault()}},{key:"correctButton",value:function(g,L){return L===Ou&&g.ctrlKey||L===wl}},{key:"move",value:function(g,L){var N=.8,K=(L.x-g.x)*N;if(K)return this.active=!0,{bearingDelta:K}}}]),s}(Ac),O=4.000244140625,k=1/100,ue=1/450,Ae=2,We=function(){function P(p,s){var d=this;Pe()(this,P),this.map=void 0,this.el=void 0,this.enabled=void 0,this.active=void 0,this.zooming=void 0,this.aroundCenter=void 0,this.around=void 0,this.aroundPoint=void 0,this.type=void 0,this.lastValue=void 0,this.timeout=void 0,this.finishTimeout=void 0,this.lastWheelEvent=void 0,this.lastWheelEventTime=void 0,this.startZoom=void 0,this.targetZoom=void 0,this.delta=void 0,this.easing=void 0,this.prevEase=void 0,this.frameId=void 0,this.handler=void 0,this.defaultZoomRate=void 0,this.wheelZoomRate=void 0,this.onScrollFrame=function(){if(!!d.frameId&&(d.frameId=null,!!d.isActive())){var g=d.map.transform;if(d.delta!==0){var L=d.type==="wheel"&&Math.abs(d.delta)>O?d.wheelZoomRate:d.defaultZoomRate,N=Ae/(1+Math.exp(-Math.abs(d.delta*L)));d.delta<0&&N!==0&&(N=1/N);var K=typeof d.targetZoom=="number"?g.zoomScale(d.targetZoom):g.scale;d.targetZoom=Math.min(g.maxZoom,Math.max(g.minZoom,g.scaleZoom(K*N))),d.type==="wheel"&&(d.startZoom=g.zoom,d.easing=d.smoothOutEasing(200)),d.delta=0}var ee=typeof d.targetZoom=="number"?d.targetZoom:g.zoom,X=d.startZoom,be=d.easing,me=!1,Be;if(d.type==="wheel"&&X&&be){var pt=Math.min((du()-d.lastWheelEventTime)/200,1),Kt=be(pt);Be=ks(X,ee,Kt),pt<1?d.frameId||(d.frameId=!0):me=!0}else Be=ee,me=!0;return d.active=!0,me&&(d.active=!1,d.finishTimeout=setTimeout(function(){d.zooming=!1,d.handler.triggerRenderFrame(),delete d.targetZoom,delete d.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!me,zoomDelta:Be-g.zoom,around:d.aroundPoint,originalEvent:d.lastWheelEvent}}},this.map=p,this.el=p.getCanvasContainer(),this.handler=s,this.delta=0,this.defaultZoomRate=k,this.wheelZoomRate=ue}return Qe()(P,[{key:"setZoomRate",value:function(s){this.defaultZoomRate=s}},{key:"setWheelZoomRate",value:function(s){this.wheelZoomRate=s}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(s){this.isEnabled()||(this.enabled=!0,this.aroundCenter=s&&s.around==="center")}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"wheel",value:function(s){if(!!this.isEnabled()){var d=s.deltaMode===window.WheelEvent.DOM_DELTA_LINE?s.deltaY*40:s.deltaY,g=du(),L=g-(this.lastWheelEventTime||0);this.lastWheelEventTime=g,d!==0&&d%O==0?this.type="wheel":d!==0&&Math.abs(d)<4?this.type="trackpad":L>400?(this.type=null,this.lastValue=d,this.timeout=setTimeout(this.onTimeout,40,s)):this.type||(this.type=Math.abs(L*d)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,d+=this.lastValue)),s.shiftKey&&d&&(d=d/4),this.type&&(this.lastWheelEvent=s,this.delta-=d,this.active||this.start(s)),s.preventDefault()}}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(s){this.type="wheel",this.delta-=this.lastValue,this.active||this.start(s)}},{key:"start",value:function(s){if(!!this.delta){this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var d=$o.mousePos(this.el,s);this.around=Ea.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(d)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}}},{key:"smoothOutEasing",value:function(s){var d=Bc;if(this.prevEase){var g=this.prevEase,L=(du()-g.start)/g.duration,N=g.easing(L+.01)-g.easing(L),K=.27/Math.sqrt(N*N+1e-4)*.01,ee=Math.sqrt(.27*.27-K*K);d=al(K,ee,.25,1)}return this.prevEase={start:du(),duration:s,easing:d},d}}]),P}(),Je=We,rt=function(){function P(p,s){Pe()(this,P),this.clickZoom=void 0,this.tapZoom=void 0,this.clickZoom=p,this.tapZoom=s}return Qe()(P,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),P}(),Ft=function(){function P(p,s,d){Pe()(this,P),this.inertiaOptions=void 0,this.el=void 0,this.mousePan=void 0,this.touchPan=void 0,this.el=p,this.mousePan=s,this.touchPan=d}return Qe()(P,[{key:"enable",value:function(s){this.inertiaOptions=s||{},this.mousePan.enable(),this.touchPan.enable(),this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),P}(),Rt=function(){function P(p,s,d){Pe()(this,P),this.mouseRotate=void 0,this.mousePitch=void 0,this.pitchWithRotate=void 0,this.pitchWithRotate=p.pitchWithRotate,this.mouseRotate=s,this.mousePitch=d}return Qe()(P,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),P}(),Yt=function(){function P(p,s,d,g){Pe()(this,P),this.el=void 0,this.touchZoom=void 0,this.touchRotate=void 0,this.tapDragZoom=void 0,this.rotationDisabled=void 0,this.enabled=void 0,this.el=p,this.touchZoom=s,this.touchRotate=d,this.tapDragZoom=g,this.rotationDisabled=!1,this.enabled=!0}return Qe()(P,[{key:"enable",value:function(s){this.touchZoom.enable(s),this.rotationDisabled||this.touchRotate.enable(s),this.tapDragZoom.enable(),this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),P}();function zt(P,p){for(var s={},d=0;d<P.length;d++)s[P[d].identifier]=p[d];return s}function Ut(P,p){var s;if(typeof Symbol=="undefined"||P[Symbol.iterator]==null){if(Array.isArray(P)||(s=nr(P))||p&&P&&typeof P.length=="number"){s&&(P=s);var d=0,g=function(){};return{s:g,n:function(){return d>=P.length?{done:!0}:{done:!1,value:P[d++]}},e:function(X){throw X},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=P[Symbol.iterator]()},n:function(){var X=s.next();return L=X.done,X},e:function(X){N=!0,K=X},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function nr(P,p){if(!!P){if(typeof P=="string")return rr(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return rr(P,p)}}function rr(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}function Or(P){var p=new Zi(0,0),s=Ut(P),d;try{for(s.s();!(d=s.n()).done;){var g=d.value;p._add(g)}}catch(L){s.e(L)}finally{s.f()}return p.div(P.length)}var hr=500,Tr=500,Cr=30,an=function(){function P(p){Pe()(this,P),this.numTouches=void 0,this.centroid=void 0,this.startTime=void 0,this.aborted=void 0,this.touches=void 0,this.reset(),this.numTouches=p.numTouches}return Qe()(P,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(s,d,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=s.timeStamp),g.length===this.numTouches&&(this.centroid=Or(d),this.touches=zt(g,d)))}},{key:"touchmove",value:function(s,d,g){if(!(this.aborted||!this.centroid)){var L=zt(g,d);for(var N in this.touches)if(this.touches[N]){var K=this.touches[N],ee=L[N];(!ee||ee.dist(K)>Cr)&&(this.aborted=!0)}}}},{key:"touchend",value:function(s,d,g){if((!this.centroid||s.timeStamp-this.startTime>Tr)&&(this.aborted=!0),g.length===0){var L=!this.aborted&&this.centroid;if(this.reset(),L)return L}}}]),P}(),Yr=function(){function P(p){Pe()(this,P),this.singleTap=void 0,this.numTaps=void 0,this.lastTime=void 0,this.lastTap=void 0,this.count=void 0,this.singleTap=new an(p),this.numTaps=p.numTaps,this.reset()}return Qe()(P,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(s,d,g){this.singleTap.touchstart(s,d,g)}},{key:"touchmove",value:function(s,d,g){this.singleTap.touchmove(s,d,g)}},{key:"touchend",value:function(s,d,g){var L=this.singleTap.touchend(s,d,g);if(L){var N=s.timeStamp-this.lastTime<hr,K=!this.lastTap||this.lastTap.dist(L)<Cr;if((!N||!K)&&this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=L,this.count===this.numTaps)return this.reset(),L}}}]),P}(),yn=function(){function P(){Pe()(this,P),this.enabled=void 0,this.active=void 0,this.swipePoint=void 0,this.swipeTouch=void 0,this.tapTime=void 0,this.tap=void 0,this.tap=new Yr({numTouches:1,numTaps:1}),this.reset()}return Qe()(P,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(s,d,g){this.swipePoint||(this.tapTime&&s.timeStamp-this.tapTime>hr&&this.reset(),this.tapTime?g.length>0&&(this.swipePoint=d[0],this.swipeTouch=g[0].identifier):this.tap.touchstart(s,d,g))}},{key:"touchmove",value:function(s,d,g){if(!this.tapTime)this.tap.touchmove(s,d,g);else if(this.swipePoint){if(g[0].identifier!==this.swipeTouch)return;var L=d[0],N=L.y-this.swipePoint.y;return this.swipePoint=L,s.preventDefault(),this.active=!0,{zoomDelta:N/128}}}},{key:"touchend",value:function(s,d,g){if(this.tapTime)this.swipePoint&&g.length===0&&this.reset();else{var L=this.tap.touchend(s,d,g);L&&(this.tapTime=s.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),P}(),On=function(){function P(){Pe()(this,P),this.enabled=void 0,this.active=void 0,this.zoomIn=void 0,this.zoomOut=void 0,this.zoomIn=new Yr({numTouches:1,numTaps:2}),this.zoomOut=new Yr({numTouches:2,numTaps:1}),this.reset()}return Qe()(P,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(s,d,g){this.zoomIn.touchstart(s,d,g),this.zoomOut.touchstart(s,d,g)}},{key:"touchmove",value:function(s,d,g){this.zoomIn.touchmove(s,d,g),this.zoomOut.touchmove(s,d,g)}},{key:"touchend",value:function(s,d,g){var L=this,N=this.zoomIn.touchend(s,d,g),K=this.zoomOut.touchend(s,d,g);if(N)return this.active=!0,s.preventDefault(),setTimeout(function(){return L.reset()},0),{cameraAnimation:function(X){return X.easeTo({duration:300,zoom:X.getZoom()+1,around:X.unproject(N)},{originalEvent:s})}};if(K)return this.active=!0,s.preventDefault(),setTimeout(function(){return L.reset()},0),{cameraAnimation:function(X){return X.easeTo({duration:300,zoom:X.getZoom()-1,around:X.unproject(K)},{originalEvent:s})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),P}(),Qn=function(){function P(p){Pe()(this,P),this.enabled=void 0,this.active=void 0,this.touches=void 0,this.minTouches=void 0,this.clickTolerance=void 0,this.sum=void 0,this.minTouches=1,this.clickTolerance=p.clickTolerance||1,this.reset()}return Qe()(P,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Zi(0,0)}},{key:"touchstart",value:function(s,d,g){return this.calculateTransform(s,d,g)}},{key:"touchmove",value:function(s,d,g){if(!!this.active)return s.preventDefault(),this.calculateTransform(s,d,g)}},{key:"touchend",value:function(s,d,g){this.calculateTransform(s,d,g),this.active&&g.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(s,d,g){g.length>0&&(this.active=!0);var L=zt(g,d),N=new Zi(0,0),K=new Zi(0,0),ee=0;for(var X in L)if(L[X]){var be=L[X],me=this.touches[X];me&&(N._add(be),K._add(be.sub(me)),ee++,L[X]=be)}if(this.touches=L,!(ee<this.minTouches||!K.mag())){var Be=K.div(ee);if(this.sum._add(Be),!(this.sum.mag()<this.clickTolerance)){var pt=N.div(ee);return{around:pt,panDelta:Be}}}}}]),P}(),oi=function(){function P(){Pe()(this,P),this.enabled=void 0,this.active=void 0,this.firstTwoTouches=void 0,this.vector=void 0,this.startVector=void 0,this.aroundCenter=void 0,this.reset()}return Qe()(P,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(s){}},{key:"move",value:function(s,d,g){}},{key:"touchstart",value:function(s,d,g){this.firstTwoTouches||g.length<2||(this.firstTwoTouches=[g[0].identifier,g[1].identifier],this.start([d[0],d[1]]))}},{key:"touchmove",value:function(s,d,g){if(!!this.firstTwoTouches){s.preventDefault();var L=vi()(this.firstTwoTouches,2),N=L[0],K=L[1],ee=xi(g,d,N),X=xi(g,d,K);if(!(!ee||!X)){var be=this.aroundCenter?null:ee.add(X).div(2);return this.move([ee,X],be,s)}}}},{key:"touchend",value:function(s,d,g){if(!!this.firstTwoTouches){var L=vi()(this.firstTwoTouches,2),N=L[0],K=L[1],ee=xi(g,d,N),X=xi(g,d,K);ee&&X||(this.active&&$o.suppressClick(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(s){this.enabled=!0,this.aroundCenter=!!s&&s.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),P}();function xi(P,p,s){for(var d=0;d<P.length;d++)if(P[d].identifier===s)return p[d]}function Xi(P){var p=An();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function An(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}function si(P){return Math.abs(P.y)>Math.abs(P.x)}var bi=100,Wn=function(P){pr()(s,P);var p=Xi(s);function s(){var d;Pe()(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.valid=void 0,d.firstMove=void 0,d.lastPoints=void 0,d}return Qe()(s,[{key:"reset",value:function(){Ul()(En()(s.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(g){this.lastPoints=g,si(g[0].sub(g[1]))&&(this.valid=!1)}},{key:"move",value:function(g,L,N){var K=g[0].sub(this.lastPoints[0]),ee=g[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(K,ee,N.timeStamp),!!this.valid){this.lastPoints=g,this.active=!0;var X=(K.y+ee.y)/2,be=-.5;return{pitchDelta:X*be}}}},{key:"gestureBeginsVertically",value:function(g,L,N){if(this.valid!==void 0)return this.valid;var K=2,ee=g.mag()>=K,X=L.mag()>=K;if(!(!ee&&!X)){if(!ee||!X)return this.firstMove===void 0&&(this.firstMove=N),N-this.firstMove<bi?void 0:!1;var be=g.y>0==L.y>0;return si(g)&&si(L)&&be}}}]),s}(oi);function Ti(P){var p=ii();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function ii(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var Li=25;function ji(P,p){return P.angleWith(p)*180/Math.PI}var qa=function(P){pr()(s,P);var p=Ti(s);function s(){var d;Pe()(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.minDiameter=void 0,d}return Qe()(s,[{key:"reset",value:function(){Ul()(En()(s.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(g){this.startVector=this.vector=g[0].sub(g[1]),this.minDiameter=g[0].dist(g[1])}},{key:"move",value:function(g,L){var N=this.vector;if(this.vector=g[0].sub(g[1]),!(!this.active&&this.isBelowThreshold(this.vector)))return this.active=!0,{bearingDelta:ji(this.vector,N),pinchAround:L}}},{key:"isBelowThreshold",value:function(g){this.minDiameter=Math.min(this.minDiameter,g.mag());var L=Math.PI*this.minDiameter,N=Li/L*360,K=ji(g,this.startVector);return Math.abs(K)<N}}]),s}(oi);function Ma(P){var p=So();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function So(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var Ta=.1;function Xa(P,p){return Math.log(P/p)/Math.LN2}var zs=function(P){pr()(s,P);var p=Ma(s);function s(){var d;Pe()(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.distance=void 0,d.startDistance=void 0,d}return Qe()(s,[{key:"reset",value:function(){Ul()(En()(s.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(g){this.startDistance=this.distance=g[0].dist(g[1])}},{key:"move",value:function(g,L){var N=this.distance;if(this.distance=g[0].dist(g[1]),!(!this.active&&Math.abs(Xa(this.distance,this.startDistance))<Ta))return this.active=!0,{zoomDelta:Xa(this.distance,N),pinchAround:L}}}]),s}(oi);function Eo(P,p){var s;if(typeof Symbol=="undefined"||P[Symbol.iterator]==null){if(Array.isArray(P)||(s=yu(P))||p&&P&&typeof P.length=="number"){s&&(P=s);var d=0,g=function(){};return{s:g,n:function(){return d>=P.length?{done:!0}:{done:!1,value:P[d++]}},e:function(X){throw X},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=P[Symbol.iterator]()},n:function(){var X=s.next();return L=X.done,X},e:function(X){N=!0,K=X},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function yu(P,p){if(!!P){if(typeof P=="string")return xu(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return xu(P,p)}}function xu(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}var Uo=function(p){return p.zoom||p.drag||p.pitch||p.rotate};function As(P){return P.panDelta&&P.panDelta.mag()||P.zoomDelta||P.bearingDelta||P.pitchDelta}var Lu=function(){function P(p,s){var d=this;Pe()(this,P),this.map=void 0,this.el=void 0,this.handlers=void 0,this.eventsInProgress=void 0,this.frameId=void 0,this.inertia=void 0,this.bearingSnap=void 0,this.handlersById=void 0,this.updatingCamera=void 0,this.changes=void 0,this.previousActiveHandlers=void 0,this.bearingChanged=void 0,this.listeners=void 0,this.handleWindowEvent=function(me){d.handleEvent(me,"".concat(me.type,"Window"))},this.handleEvent=function(me,Be){if(me.type==="blur"){d.stop();return}d.updatingCamera=!0;var pt=me.type==="renderFrame"?void 0:me,Kt={needsRenderFrame:!1},kt={},Qt={},ur=me.touches?d.getMapTouches(me.touches):void 0,Ur=ur?$o.touchPos(d.el,ur):$o.mousePos(d.el,me),on=Eo(d.handlers),Hr;try{for(on.s();!(Hr=on.n()).done;){var ln=Hr.value,Pn=ln.handlerName,Hn=ln.handler,ai=ln.allowed;if(!!Hn.isEnabled()){var Hi=void 0;if(d.blockedByActive(Qt,ai,Pn))Hn.reset();else{var ma=Be||me.type;Hn&&Hn[ma]&&(Hi=Hn[ma](me,Ur,ur),d.mergeIHandlerResult(Kt,kt,Hi,Pn,pt),Hi&&Hi.needsRenderFrame&&d.triggerRenderFrame())}(Hi||Hn.isActive())&&(Qt[Pn]=Hn)}}}catch(ls){on.e(ls)}finally{on.f()}var La={};for(var qu in d.previousActiveHandlers)Qt[qu]||(La[qu]=pt);d.previousActiveHandlers=Qt,(Object.keys(La).length||As(Kt))&&(d.changes.push([Kt,kt,La]),d.triggerRenderFrame()),(Object.keys(Qt).length||As(Kt))&&d.map.stop(!0),d.updatingCamera=!1;var ts=Kt.cameraAnimation;ts&&(d.inertia.clear(),d.fireEvents({},{}),d.changes=[],ts(d.map))},this.map=p,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new Rs(p),this.bearingSnap=s.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(s);var g=this.el;this.listeners=[[g,"touchstart",{passive:!1}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];var L=Eo(this.listeners),N;try{for(L.s();!(N=L.n()).done;){var K=vi()(N.value,3),ee=K[0],X=K[1],be=K[2];$o.addEventListener(ee,X,ee===window.document?this.handleWindowEvent:this.handleEvent,be)}}catch(me){L.e(me)}finally{L.f()}}return Qe()(P,[{key:"destroy",value:function(){var s=Eo(this.listeners),d;try{for(s.s();!(d=s.n()).done;){var g=vi()(d.value,3),L=g[0],N=g[1],K=g[2];$o.removeEventListener(L,N,L===window.document?this.handleWindowEvent:this.handleEvent,K)}}catch(ee){s.e(ee)}finally{s.f()}}},{key:"stop",value:function(){if(!this.updatingCamera){var s=Eo(this.handlers),d;try{for(s.s();!(d=s.n()).done;){var g=d.value.handler;g.reset()}}catch(L){s.e(L)}finally{s.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}}},{key:"isActive",value:function(){var s=Eo(this.handlers),d;try{for(s.s();!(d=s.n()).done;){var g=d.value.handler;if(g.isActive())return!0}}catch(L){s.e(L)}finally{s.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(Uo(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(s,d,g,L,N){if(!!g){ja()(s,g);var K={handlerName:L,originalEvent:g.originalEvent||N};g.zoomDelta!==void 0&&(d.zoom=K),g.panDelta!==void 0&&(d.drag=K),g.pitchDelta!==void 0&&(d.pitch=K),g.bearingDelta!==void 0&&(d.rotate=K)}}},{key:"triggerRenderFrame",value:function(){var s=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(d){delete s.frameId,s.handleEvent(new nu("renderFrame",{timeStamp:d})),s.applyChanges()}))}},{key:"addDefaultHandlers",value:function(s){var d=this.map,g=d.getCanvasContainer();this.add("mapEvent",new Vs(d,s));var L=d.boxZoom=new Tc(d,s);this.add("boxZoom",L);var N=new On,K=new ms;d.doubleClickZoom=new rt(K,N),this.add("tapZoom",N),this.add("clickZoom",K);var ee=new yn;this.add("tapDragZoom",ee);var X=d.touchPitch=new Wn;this.add("touchPitch",X);var be=new n(s),me=new _(s);d.dragRotate=new Rt(s,be,me),this.add("mouseRotate",be,["mousePitch"]),this.add("mousePitch",me,["mouseRotate"]);var Be=new ic(s),pt=new Qn(s);d.dragPan=new Ft(g,Be,pt),this.add("mousePan",Be),this.add("touchPan",pt,["touchZoom","touchRotate"]);var Kt=new qa,kt=new zs;d.touchZoomRotate=new Yt(g,kt,Kt,ee),this.add("touchRotate",Kt,["touchPan","touchZoom"]),this.add("touchZoom",kt,["touchPan","touchRotate"]);var Qt=d.scrollZoom=new Je(d,this);this.add("scrollZoom",Qt,["mousePan"]);var ur=d.keyboard=new bf;this.add("keyboard",ur),this.add("blockableMapEvent",new $n(d));for(var Ur=0,on=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Ur<on.length;Ur++){var Hr=on[Ur];s.interactive&&s[Hr]&&d[Hr].enable(s[Hr])}}},{key:"add",value:function(s,d,g){this.handlers.push({handlerName:s,handler:d,allowed:g}),this.handlersById[s]=d}},{key:"blockedByActive",value:function(s,d,g){for(var L in s)if(L!==g&&(!d||d.indexOf(L)<0))return!0;return!1}},{key:"getMapTouches",value:function(s){var d=[],g=Eo(s),L;try{for(g.s();!(L=g.n()).done;){var N=L.value,K=N.target;this.el.contains(K)&&d.push(N)}}catch(ee){g.e(ee)}finally{g.f()}return d}},{key:"applyChanges",value:function(){var s={},d={},g={},L=Eo(this.changes),N;try{for(L.s();!(N=L.n()).done;){var K=vi()(N.value,3),ee=K[0],X=K[1],be=K[2];ee.panDelta&&(s.panDelta=(s.panDelta||new Zi(0,0))._add(ee.panDelta)),ee.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+ee.zoomDelta),ee.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+ee.bearingDelta),ee.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+ee.pitchDelta),ee.around!==void 0&&(s.around=ee.around),ee.pinchAround!==void 0&&(s.pinchAround=ee.pinchAround),ee.noInertia&&(s.noInertia=ee.noInertia),ja()(d,X),ja()(g,be)}}catch(me){L.e(me)}finally{L.f()}this.updateMapTransform(s,d,g),this.changes=[]}},{key:"updateMapTransform",value:function(s,d,g){var L=this.map,N=L.transform;if(!As(s))return this.fireEvents(d,g);var K=s.panDelta,ee=s.zoomDelta,X=s.bearingDelta,be=s.pitchDelta,me=s.pinchAround,Be=s.around;me!==void 0&&(Be=me),L.stop(!0),Be=Be||L.transform.centerPoint;var pt=N.pointLocation(K?Be.sub(K):Be);X&&(N.bearing+=X),be&&(N.pitch+=be),ee&&(N.zoom+=ee),N.setLocationAtPoint(pt,Be),this.map.update(),s.noInertia||this.inertia.record(s),this.fireEvents(d,g)}},{key:"fireEvents",value:function(s,d){var g=this,L=Uo(this.eventsInProgress),N=Uo(s),K={};for(var ee in s)if(s[ee]){var X=s[ee].originalEvent;this.eventsInProgress[ee]||(K["".concat(ee,"start")]=X),this.eventsInProgress[ee]=s[ee]}!L&&N&&this.fireEvent("movestart",N.originalEvent);for(var be in K)K[be]&&this.fireEvent(be,K[be]);s.rotate&&(this.bearingChanged=!0),N&&this.fireEvent("move",N.originalEvent);for(var me in s)if(s[me]){var Be=s[me].originalEvent;this.fireEvent(me,Be)}var pt={},Kt;for(var kt in this.eventsInProgress)if(this.eventsInProgress[kt]){var Qt=this.eventsInProgress[kt],ur=Qt.handlerName,Ur=Qt.originalEvent;this.handlersById[ur].isActive()||(delete this.eventsInProgress[kt],Kt=d[ur]||Ur,pt["".concat(kt,"end")]=Kt)}for(var on in pt)pt[on]&&this.fireEvent(on,pt[on]);var Hr=Uo(this.eventsInProgress);if((L||N)&&!Hr){this.updatingCamera=!0;var ln=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),Pn=function(ai){return ai!==0&&-g.bearingSnap<ai&&ai<g.bearingSnap};ln?(Pn(ln.bearing||this.map.getBearing())&&(ln.bearing=0),this.map.easeTo(ln,{originalEvent:Kt})):(this.map.emit("moveend",new ea("moveend",{originalEvent:Kt})),Pn(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(s,d){this.map.emit(s,new ea(s,d?{originalEvent:d}:{}))}}]),P}(),ac=Lu,$u=o("DzJC"),oc=o.n($u),sc=function(){function P(p){var s=this;Pe()(this,P),this.map=void 0,this.updateHash=void 0,this.hashName=void 0,this.onHashChange=function(){var d=s.getCurrentHash();if(d.length>=3&&!d.some(function(L){return isNaN(+L)})){var g=s.map.dragRotate.isEnabled()&&s.map.touchZoomRotate.isEnabled()?+(d[3]||0):s.map.getBearing();return s.map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:g,pitch:+(d[4]||0)}),!0}return!1},this.getCurrentHash=function(){var d=window.location.hash.replace("#","");if(s.hashName){var g;return d.split("&").map(function(L){return L.split("=")}).forEach(function(L){L[0]===s.hashName&&(g=L)}),(g&&g[1]||"").split("/")}return d.split("/")},this.updateHashUnthrottled=function(){var d=s.getHashString();try{window.history.replaceState(window.history.state,"",d)}catch(g){}},this.hashName=p&&encodeURIComponent(p),this.updateHash=oc()(this.updateHashUnthrottled,30*1e3/100)}return Qe()(P,[{key:"addTo",value:function(s){return this.map=s,window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(s){var d=this.map.getCenter(),g=Math.round(this.map.getZoom()*100)/100,L=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),N=Math.pow(10,L),K=Math.round(d.lng*N)/N,ee=Math.round(d.lat*N)/N,X=this.map.getBearing(),be=this.map.getPitch(),me="";if(s?me+="/".concat(K,"/").concat(ee,"/").concat(g):me+="".concat(g,"/").concat(ee,"/").concat(K),(X||be)&&(me+="/".concat(Math.round(X*10)/10)),be&&(me+="/".concat(Math.round(be))),this.hashName){var Be=this.hashName,pt=!1,Kt=window.location.hash.slice(1).split("&").map(function(kt){var Qt=kt.split("=")[0];return Qt===Be?(pt=!0,"".concat(Qt,"=").concat(me)):kt}).filter(function(kt){return kt});return pt||Kt.push("".concat(Be,"=").concat(me)),"#".concat(Kt.join("&"))}return"#".concat(me)}}]),P}(),Ru=sc,dl=null,Cs=[],po=30,Du=1e3/po,bu=window.performance,Oo={create:"create",load:"load",fullLoad:"fullLoad"},Lo={mark:function(p){bu.mark(p)},frame:function(p){var s=p;if(dl!=null){var d=s-dl;Cs.push(d)}dl=s},clearMetrics:function(){dl=null,Cs=[],bu.clearMeasures("loadTime"),bu.clearMeasures("fullLoadTime");for(var p in Oo)bu.clearMarks(Oo[p])},getPerformanceMetrics:function(){var p=bu.measure("loadTime",Oo.create,Oo.load).duration,s=bu.measure("fullLoadTime",Oo.create,Oo.fullLoad).duration,d=Cs.length,g=Cs.reduce(function(ee,X){return ee+X},0)/d/1e3,L=1/g,N=Cs.filter(function(ee){return ee>Du}).reduce(function(ee,X){return ee+(X-Du)/Du},0),K=N/(d+N)*100;return{loadTime:p,fullLoadTime:s,fps:L,percentDroppedFrames:K}}};function Ro(P,p){var s;if(typeof Symbol=="undefined"||P[Symbol.iterator]==null){if(Array.isArray(P)||(s=Jo(P))||p&&P&&typeof P.length=="number"){s&&(P=s);var d=0,g=function(){};return{s:g,n:function(){return d>=P.length?{done:!0}:{done:!1,value:P[d++]}},e:function(X){throw X},f:g}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,N=!1,K;return{s:function(){s=P[Symbol.iterator]()},n:function(){var X=s.next();return L=X.done,X},e:function(X){N=!0,K=X},f:function(){try{!L&&s.return!=null&&s.return()}finally{if(N)throw K}}}}function Jo(P,p){if(!!P){if(typeof P=="string")return To(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return To(P,p)}}function To(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}var Vo=function(){function P(){Pe()(this,P),this.queue=void 0,this.id=void 0,this.cleared=void 0,this.currentlyRunning=void 0,this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return Qe()(P,[{key:"add",value:function(s){var d=++this.id,g=this.queue;return g.push({callback:s,id:d,cancelled:!1}),d}},{key:"remove",value:function(s){var d=this.currentlyRunning,g=d?this.queue.concat(d):this.queue,L=Ro(g),N;try{for(L.s();!(N=L.n()).done;){var K=N.value;if(K.id===s){K.cancelled=!0;return}}}catch(ee){L.e(ee)}finally{L.f()}}},{key:"run",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=this.currentlyRunning=this.queue;this.queue=[];var g=Ro(d),L;try{for(g.s();!(L=g.n()).done;){var N=L.value;if(!N.cancelled&&(N.callback(s),this.cleared))break}}catch(K){g.e(K)}finally{g.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),P}(),Gs=Vo;function Pl(P){var p=Uc();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function Uc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}o("BGjm")(`/* @antv/l7-map */
.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var Vl=-2,Ju=22,zu=0,Nu=60,Hs={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:Vl,maxZoom:Ju,minPitch:zu,maxPitch:Nu,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},Do=function(P){pr()(s,P);var p=Pl(s);function s(d){var g;Pe()(this,s),g=p.call(this,ja()({},Hs,d)),g.doubleClickZoom=void 0,g.dragRotate=void 0,g.dragPan=void 0,g.touchZoomRotate=void 0,g.scrollZoom=void 0,g.keyboard=void 0,g.touchPitch=void 0,g.boxZoom=void 0,g.handlers=void 0,g.container=void 0,g.canvas=void 0,g.canvasContainer=void 0,g.renderTaskQueue=new Gs,g.frame=void 0,g.trackResize=!0,g.hash=void 0,g.onWindowOnline=function(){g.update()},g.onWindowResize=function(N){g.trackResize&&g.resize({originalEvent:N}).update()},g.initContainer(),g.resize(),g.handlers=new ac(rf()(g),g.options),typeof window!="undefined"&&(window.addEventListener("online",g.onWindowOnline,!1),window.addEventListener("resize",g.onWindowResize,!1),window.addEventListener("orientationchange",g.onWindowResize,!1));var L=typeof d.hash=="string"&&d.hash||void 0;return d.hash&&(g.hash=new Ru(L).addTo(rf()(g))),(!g.hash||!g.hash.onHashChange())&&(g.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(g.resize(),g.fitBounds(d.bounds,ja()({},d.fitBoundsOptions,{duration:0})))),g}return Qe()(s,[{key:"resize",value:function(g){var L=this.containerDimensions(),N=L[0],K=L[1];this.transform.resize(N,K);var ee=!this.moving;return ee&&(this.stop(),this.emit("movestart",new Event("movestart",g)),this.emit("move",new Event("move",g))),this.emit("resize",new Event("resize",g)),ee&&this.emit("moveend",new Event("moveend",g)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(g){return this.transform.locationPoint(Ea.convert(g))}},{key:"unproject",value:function(g){return this.transform.pointLocation(Zi.convert(g))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(g){this.transform.setMaxBounds(pa.convert(g))}},{key:"setStyle",value:function(g){}},{key:"setMinZoom",value:function(g){if(g=g==null?Vl:g,g>=Vl&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between ".concat(Vl," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(g){if(g=g==null?Ju:g,g>=this.transform.minZoom)return this.transform.maxZoom=g,this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(g){if(g=g==null?zu:g,g<zu)throw new Error("minPitch must be greater than or equal to ".concat(zu));if(g>=zu&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between ".concat(zu," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(g){if(g=g==null?Nu:g,g>Nu)throw new Error("maxPitch must be less than or equal to ".concat(Nu));if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(g){this.transform.renderWorldCopies=!!g}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(g){return this.update(),this.renderTaskQueue.add(g)}},{key:"cancelRenderFrame",value:function(g){return this.renderTaskQueue.remove(g)}},{key:"triggerRepaint",value:function(){var g=this;this.frame||(this.frame=Ni(function(L){Lo.frame(L),g.frame=null,g.update(L)}))}},{key:"update",value:function(g){var L=this;this.frame||(this.frame=Ni(function(N){Lo.frame(N),L.frame=null,L.renderTaskQueue.run(g)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var g=this.container;g.classList.add("l7-map");var L=this.canvasContainer=mn.a.create("div","l7-canvas-container",g);this.options.interactive&&L.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var g=0,L=0;return this.container&&(g=this.container.clientWidth||400,L=this.container.clientHeight||300),[g,L]}},{key:"resizeCanvas",value:function(g,L){var N=mn.a.DPR||1;this.canvas.width=N*g,this.canvas.height=N*L,this.canvas.style.width="".concat(g,"px"),this.canvas.style.height="".concat(L,"px")}}]),s}(Sc),Vc=function(){function P(){Pe()(this,P),this.viewport=void 0}return Qe()(P,[{key:"syncWithMapCamera",value:function(s){var d=s.center,g=s.zoom,L=s.pitch,N=s.bearing,K=s.viewportHeight,ee=s.viewportWidth;this.viewport=new pc({width:ee,height:K,longitude:d&&d[0],latitude:d&&d[1],zoom:g,pitch:L,bearing:N})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(s,d){return this.viewport.projectFlat(s,d)}}]),P}(),ys={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},of,Lf,Rf,Uf,Qu,Sf,sf,uc,Fu,lc,Vf,Cc,wc,Gf;function Hf(P,p){var s=Object.keys(P);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(P);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(P,g).enumerable})),s.push.apply(s,d)}return s}function ah(P){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?Hf(Object(s),!0).forEach(function(d){fi()(P,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(s)):Hf(Object(s)).forEach(function(d){Object.defineProperty(P,d,Object.getOwnPropertyDescriptor(s,d))})}return P}var Zf={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Df=12,ch=(of=Object($r.injectable)(),Lf=Object($r.inject)(se.TYPES.MapConfig),Rf=Object($r.inject)(se.TYPES.IGlobalConfigService),Uf=Object($r.inject)(se.TYPES.ILogService),Qu=Object($r.inject)(se.TYPES.ICoordinateSystemService),Sf=Object($r.inject)(se.TYPES.IEventEmitter),of(sf=(uc=(Gf=function(){function P(){var p=this;Pe()(this,P),this.map=void 0,Vn()(this,"config",Fu,this),Vn()(this,"configService",lc,this),Vn()(this,"logger",Vf,this),Vn()(this,"coordinateSystemService",Cc,this),Vn()(this,"eventEmitter",wc,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var s=p.map.getCenter(),d=s.lat,g=s.lng,L=p.config.offsetCoordinate,N=L===void 0?!0:L;p.viewport.syncWithMapCamera({bearing:p.map.getBearing(),center:[g,d],viewportHeight:p.map.transform.height,pitch:p.map.getPitch(),viewportWidth:p.map.transform.width,zoom:p.map.getZoom(),cameraHeight:0}),p.viewport.getZoom()>Df&&N?p.coordinateSystemService.setCoordinateSystem(se.CoordinateSystem.LNGLAT_OFFSET):p.coordinateSystemService.setCoordinateSystem(se.CoordinateSystem.LNGLAT),p.cameraChangedCallback(p.viewport)}}return Qe()(P,[{key:"addMarkerContainer",value:function(){var s=this.map.getCanvasContainer();this.markerContainer=mn.a.create("div","l7-marker-container",s),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(s,d){se.MapServiceEvent.indexOf(s)!==-1?this.eventEmitter.on(s,d):this.map.on(Zf[s]||s,d)}},{key:"off",value:function(s,d){this.map.off(Zf[s]||s,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var s=this.map.transform;return[s.width,s.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(s){return this.map.setZoom(s)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(s){this.map.setCenter(s)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(s){this.map.setBearing(s)}},{key:"zoomIn",value:function(s,d){this.map.zoomIn(s,d)}},{key:"zoomOut",value:function(s,d){this.map.zoomOut(s,d)}},{key:"setPitch",value:function(s){return this.map.setPitch(s)}},{key:"panTo",value:function(s){this.map.panTo(s)}},{key:"panBy",value:function(s){this.panTo(s)}},{key:"fitBounds",value:function(s,d){this.map.fitBounds(s,d)}},{key:"setMaxZoom",value:function(s){this.map.setMaxZoom(s)}},{key:"setMinZoom",value:function(s){this.map.setMinZoom(s)}},{key:"setMapStatus",value:function(s){s.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),s.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),s.dragEnable===!1&&this.map.dragPan.disable(),s.dragEnable===!0&&this.map.dragPan.enable(),s.rotateEnable===!1&&this.map.dragRotate.disable(),s.dragEnable===!0&&this.map.dragRotate.enable(),s.keyboardEnable===!1&&this.map.keyboard.disable(),s.keyboardEnable===!0&&this.map.keyboard.enable(),s.zoomEnable===!1&&this.map.scrollZoom.disable(),s.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(s,d){this.map.flyTo({zoom:s,center:d})}},{key:"setMapStyle",value:function(s){this.map.setStyle(this.getMapStyle(s))}},{key:"pixelToLngLat",value:function(s){return this.map.unproject(s)}},{key:"lngLatToPixel",value:function(s){return this.map.project(s)}},{key:"containerToLngLat",value:function(s){return this.map.unproject(s)}},{key:"lngLatToContainer",value:function(s){return this.map.project(s)}},{key:"lngLatToMercator",value:function(s,d){throw new Error("not implement")}},{key:"getModelMatrix",value:function(s,d,g){var L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var p=Er()(jt.a.mark(function d(){var g,L,N,K,ee,X,be,me,Be,pt,Kt;return jt.a.wrap(function(Qt){for(;;)switch(Qt.prev=Qt.next){case 0:g=this.config,L=g.id,N=L===void 0?"map":L,K=g.attributionControl,ee=K===void 0?!1:K,X=g.style,be=X===void 0?"light":X,me=g.rotation,Be=me===void 0?0:me,pt=g.mapInstance,Kt=Cn()(g,["id","attributionControl","style","rotation","mapInstance"]),this.viewport=new Vc,pt?(this.map=pt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(N),this.map=new Do(ah({container:this.$mapContainer,style:this.getMapStyle(be),bearing:Be},Kt))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 6:case"end":return Qt.stop()}},d,this)}));function s(){return p.apply(this,arguments)}return s}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).emit.apply(d,[s].concat(L))}},{key:"once",value:function(s){for(var d,g=arguments.length,L=new Array(g>1?g-1:0),N=1;N<g;N++)L[N-1]=arguments[N];(d=this.eventEmitter).once.apply(d,[s].concat(L))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(s){var d=this.map.getCanvas(),g=s==="jpg"?d==null?void 0:d.toDataURL("image/jpeg"):d==null?void 0:d.toDataURL("image/png");return g}},{key:"onCameraChanged",value:function(s){this.cameraChangedCallback=s}},{key:"creatAmapContainer",value:function(s){var d=s;return typeof s=="string"&&(d=document.getElementById(s)),d}},{key:"getMapStyle",value:function(s){return typeof s!="string"?s:ys[s]?ys[s]:s}}]),P}(),Gf),Fu=de()(uc.prototype,"config",[Lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lc=de()(uc.prototype,"configService",[Rf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vf=de()(uc.prototype,"logger",[Uf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc=de()(uc.prototype,"coordinateSystemService",[Qu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wc=de()(uc.prototype,"eventEmitter",[Sf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uc))||sf);function cc(P){var p=uf();return function(){var d=En()(P),g;if(p){var L=En()(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return cr()(this,g)}}function uf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}var so=function(P){pr()(s,P);var p=cc(s);function s(){return Pe()(this,s),p.apply(this,arguments)}return Qe()(s,[{key:"getServiceConstructor",value:function(){return ch}}]),s}(sr);function Gl(P,p){var s=Object.keys(P);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(P);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(P,g).enumerable})),s.push.apply(s,d)}return s}function lf(P){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?Gl(Object(s),!0).forEach(function(d){Gc(P,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(s)):Gl(Object(s)).forEach(function(d){Object.defineProperty(P,d,Object.getOwnPropertyDescriptor(s,d))})}return P}function Gc(P,p,s){return p in P?Object.defineProperty(P,p,{value:s,enumerable:!0,configurable:!0,writable:!0}):P[p]=s,P}function iu(P,p){return cf(P)||Hc(P,p)||Ef(P,p)||_l()}function _l(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ef(P,p){if(!!P){if(typeof P=="string")return Tf(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Tf(P,p)}}function Tf(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}function Hc(P,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(P)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=P[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function cf(P){if(Array.isArray(P))return P}var Zc=at.a.memo(function(P){var p=P.style,s=P.className,d=P.map,g=P.option,L=P.onSceneLoaded,N=P.children,K=Object(Re.useRef)(null),ee=Object(Re.useState)(),X=iu(ee,2),be=X[0],me=X[1];return Object(Re.useEffect)(function(){var Be=new Pt.Scene(lf(lf({id:K.current},g),{},{map:new so(d)}));return Be.on("loaded",function(){me(Be),L&&L(Be)}),function(){Be.destroy()}},[]),Object(Re.useEffect)(function(){be&&d.style&&be.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(Re.useEffect)(function(){be&&d.zoom&&be.setZoom(d.zoom)},[d.zoom]),Object(Re.useEffect)(function(){be&&d.center&&be.setCenter(d.center)},[JSON.stringify(d.center)]),Object(Re.useEffect)(function(){be&&d.pitch&&be.setPitch(d.pitch)},[d.pitch]),Object(Re.useEffect)(function(){be&&d.rotation&&be.setRotation(d.rotation)},[d.rotation]),at.a.createElement(ct.Provider,{value:be},at.a.createElement("div",{ref:K,className:s,style:p},be&&N))}),Hl=Zc;function ne(P,p){return tt(P)||Ee(P,p)||D(P,p)||oe()}function oe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D(P,p){if(!!P){if(typeof P=="string")return U(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return U(P,p)}}function U(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}function Ee(P,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(P)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=P[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function tt(P){if(Array.isArray(P))return P}var Gt=at.a.memo(function(P){var p=P.style,s=P.className,d=P.map,g=P.children,L=Object(Re.useRef)(null),N=Object(Re.useState)(),K=ne(N,2),ee=K[0],X=K[1];return Object(Re.useEffect)(function(){var be=new Pt.Scene({id:L.current,map:d});return be.on("loaded",function(){X(be)}),function(){be.destroy()}},[]),at.a.createElement(ct.Provider,{value:ee},at.a.createElement("div",{ref:L,className:s,style:p},ee&&g))}),tr=at.a.memo(function(p){var s=ht(),d=Object(Re.useRef)(),g=p.type,L=p.position;return Object(Re.useEffect)(function(){var N;switch(g){case"scale":N=new Pt.Scale({position:L||"bottomright"});break;case"zoom":N=new Pt.Zoom({position:L||"topright"});break;case"logo":N=new Pt.Logo({position:L||"bottomleft"})}return d.current=N,s.addControl(N),function(){d.current=void 0,s.removeControl(N)}},[g]),Object(Re.useEffect)(function(){d.current&&d.current.setPosition(L)},[L]),null}),er=o("i8i4");function Pr(P,p){return wi(P)||ri(P,p)||Rn(P,p)||Jr()}function Jr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rn(P,p){if(!!P){if(typeof P=="string")return Xn(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Xn(P,p)}}function Xn(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}function ri(P,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(P)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=P[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function wi(P){if(Array.isArray(P))return P}var Pi=Re.useEffect,ia=Re.useState;function ra(P){var p=P.className,s=P.style,d=P.children,g=P.position,L=ht(),N=ia(function(){return document.createElement("div")}),K=Pr(N,1),ee=K[0];return Pi(function(){var X=new Pt.Control({position:g});return X.onAdd=function(){if(p&&(ee.className=p),s){var be=Object.keys(s).map(function(me){return"".concat(me,":").concat(s[me])}).join(";");ee.style.cssText=be}return ee},L.addControl(X),function(){L.removeControl(X)}},[]),Object(er.createPortal)(d,ee)}var Ia=Object(Re.createContext)({});function uo(){return Object(Re.useContext)(Ia)}var eo=Re.useEffect,Na=Re.memo(function(p){var s=p.layer,d=p.active;return eo(function(){s.active(d.option)},[JSON.stringify(d)]),null}),vo=Re.useEffect,Fi=Re.memo(function(p){var s=p.layer,d=p.animate;return vo(function(){s.animate(d)},[JSON.stringify(d)]),null}),to=Re.useEffect,us=Re.memo(function(p){var s=p.layer,d=p.color;return to(function(){d.field?s.color(d.field,d.values):s.color(d.values)},[d.field,d.scale,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),va=Re.useEffect,Aa=Re.memo(function(p){var s=p.layer,d=p.filter;return va(function(){d.field&&s.filter(d.field,d.values)},[d.field,d.values,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),mi=Re.useEffect,zo=Re.memo(function(p){var s=p.layer,d=p.scale;return mi(function(){s.scale(d.values)},[d.values]),null}),fc=Re.useEffect,Wf=Re.memo(function(p){var s=p.layer,d=p.select;return fc(function(){s.select(d.option)},[JSON.stringify(d)]),null}),fh=Re.useEffect,Xf=Re.memo(function(p){var s=p.layer,d=p.shape;return fh(function(){d.field?s.shape(d.field,d.values):s.shape(d.values)},[d.field,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),Bu=Re.useEffect,Yf=Re.memo(function(p){var s=p.layer,d=p.size;return Bu(function(){d.field?s.size(d.field,d.values):s.size(d.values)},[d.field,d.scale,JSON.stringify(d.values),JSON.stringify(d.options)]),null});function ff(P,p){if(P==null)return{};var s=Kf(P,p),d,g;if(Object.getOwnPropertySymbols){var L=Object.getOwnPropertySymbols(P);for(g=0;g<L.length;g++)d=L[g],!(p.indexOf(d)>=0)&&(!Object.prototype.propertyIsEnumerable.call(P,d)||(s[d]=P[d]))}return s}function Kf(P,p){if(P==null)return{};var s={},d=Object.keys(P),g,L;for(L=0;L<d.length;L++)g=d[L],!(p.indexOf(g)>=0)&&(s[g]=P[g]);return s}var Th=Re.useEffect,hh=Re.memo(function(p){var s=p.layer,d=p.source,g=d.data,L=ff(d,["data"]);return Th(function(){s.inited?s.setData(g,L):s.source(g,L),L.autoFit&&s.fitBounds(L&&L.fitBoundsOptions)},[g,JSON.stringify(L)]),null}),Af=Re.useEffect,oh=Re.memo(function(p){var s=p.layer,d=p.style;return Af(function(){s.style(d)},Object.keys(d).map(function(g){return d[g]})),null});function $f(P,p){return Ah(P)||zf(P,p)||Fh(P,p)||dh()}function dh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fh(P,p){if(!!P){if(typeof P=="string")return Cf(P,p);var s=Object.prototype.toString.call(P).slice(8,-1);if(s==="Object"&&P.constructor&&(s=P.constructor.name),s==="Map"||s==="Set")return Array.from(P);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Cf(P,p)}}function Cf(P,p){(p==null||p>P.length)&&(p=P.length);for(var s=0,d=new Array(p);s<p;s++)d[s]=P[s];return d}function zf(P,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(P)))){var s=[],d=!0,g=!1,L=void 0;try{for(var N=P[Symbol.iterator](),K;!(d=(K=N.next()).done)&&(s.push(K.value),!(p&&s.length===p));d=!0);}catch(ee){g=!0,L=ee}finally{try{!d&&N.return!=null&&N.return()}finally{if(g)throw L}}return s}}function Ah(P){if(Array.isArray(P))return P}var xe=Re.useEffect,je=Re.useState;function At(P,p){var s=p.source,d=p.color,g=p.shape,L=p.style,N=p.size,K=p.scale,ee=p.active,X=p.select,be=p.filter,me=p.animate,Be=p.options,pt=p.onLayerLoaded,Kt=ht(),kt=je(),Qt=$f(kt,2),ur=Qt[0],Ur=Qt[1];if(!ur){var on;switch(P){case"polygonLayer":on=new Pt.PolygonLayer(Be);break;case"lineLayer":on=new Pt.LineLayer(Be);break;case"pointLayer":on=new Pt.PointLayer(Be);break;case"heatmapLayer":on=new Pt.HeatmapLayer(Be);break;case"rasterLayer":on=new Pt.RasterLayer(Be);break;case"imageLayer":on=new Pt.ImageLayer(Be);break;case"citybuildingLayer":on=new Pt.CityBuildingLayer(Be);break;default:on=new Pt.PolygonLayer(Be)}on.on("inited",function(){pt&&pt(on,Kt)}),Ur(on)}return xe(function(){if(ur!==void 0)return Kt.addLayer(ur),function(){Kt.removeLayer(ur)}},[]),xe(function(){ur&&ur.inited&&Be&&(ur.updateLayerConfig(Be),Kt.render())},[Be==null?void 0:Be.minZoom,Be==null?void 0:Be.maxZoom,Be==null?void 0:Be.visible]),xe(function(){ur&&ur.inited&&Be&&Be.zIndex&&ur.setIndex(Be.zIndex)},[Be==null?void 0:Be.zIndex]),xe(function(){ur&&ur.inited&&Be&&Be.blend&&ur.setBlend(Be.blend)},[Be==null?void 0:Be.blend]),xe(function(){ur&&Kt.render()},[]),ur!=null?Re.createElement(Ia.Provider,{value:ur},Re.createElement(hh,{layer:ur,source:s}),K&&Re.createElement(zo,{layer:ur,scale:K}),d&&Re.createElement(us,{layer:ur,color:d}),N&&Re.createElement(Yf,{layer:ur,size:N}),g&&Re.createElement(Xf,{layer:ur,shape:g}),L&&Re.createElement(oh,{layer:ur,style:L}),ee&&Re.createElement(Na,{layer:ur,active:ee}),X&&Re.createElement(Wf,{layer:ur,select:X}),be&&Re.createElement(Aa,{layer:ur,filter:be}),me&&Re.createElement(Fi,{layer:ur,animate:me}),p.children):null}var gr=Re.memo(function(p){return At("polygonLayer",p)}),Ir=Re.memo(function(p){return At("lineLayer",p)}),wr=Re.memo(function(p){return At("pointLayer",p)}),xr=Re.memo(function(p){return At("heatmapLayer",p)}),Wr=Re.memo(function(p){return At("rasterLayer",p)}),sn=Re.memo(function(p){return At("imageLayer",p)}),tn=Re.memo(function(p){return At("citybuildingLayer",p)}),qr=Re.useEffect,fn=Re.memo(function(P){var p=P.type,s=P.handler,d=uo();return qr(function(){return d.off(p,s),d.on(p,s),function(){d.off(p,s)}},[p,s]),null}),wn=Re.memo(function(P){var p=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}],s=P.items,d=s===void 0?p:s;return Re.createElement("div",null,Re.createElement("div",null,d.map(function(g,L){return Re.createElement("div",{key:L,style:{background:g.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-d.length)/d.length+"%",marginRight:"1%",padding:5}})})),Re.createElement("div",null,d.map(function(g,L){return Re.createElement("div",{key:L,style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-d.length)/d.length+"%",marginRight:"1%"}},g.title)})))});function cn(P){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?cn=function(s){return typeof s}:cn=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},cn(P)}function nn(P,p){var s=Object.keys(P);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(P);p&&(d=d.filter(function(g){return Object.getOwnPropertyDescriptor(P,g).enumerable})),s.push.apply(s,d)}return s}function yr(P){for(var p=1;p<arguments.length;p++){var s=arguments[p]!=null?arguments[p]:{};p%2?nn(Object(s),!0).forEach(function(d){vr(P,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(s)):nn(Object(s)).forEach(function(d){Object.defineProperty(P,d,Object.getOwnPropertyDescriptor(s,d))})}return P}function vr(P,p,s){return p in P?Object.defineProperty(P,p,{value:s,enumerable:!0,configurable:!0,writable:!0}):P[p]=s,P}function Xr(P,p){if(!(P instanceof p))throw new TypeError("Cannot call a class as a function")}function _n(P,p){for(var s=0;s<p.length;s++){var d=p[s];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(P,d.key,d)}}function Lr(P,p,s){return p&&_n(P.prototype,p),s&&_n(P,s),P}function qn(P,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");P.prototype=Object.create(p&&p.prototype,{constructor:{value:P,writable:!0,configurable:!0}}),p&&Qr(P,p)}function Qr(P,p){return Qr=Object.setPrototypeOf||function(d,g){return d.__proto__=g,d},Qr(P,p)}function jr(P){var p=Yn();return function(){var d=ti(P),g;if(p){var L=ti(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return Vr(this,g)}}function Vr(P,p){return p&&(cn(p)==="object"||typeof p=="function")?p:Kr(P)}function Kr(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}function Yn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}function ti(P){return ti=Object.setPrototypeOf?Object.getPrototypeOf:function(s){return s.__proto__||Object.getPrototypeOf(s)},ti(P)}var un=function(P){qn(s,P);var p=jr(s);function s(d){var g;return Xr(this,s),g=p.call(this,d),g.el=document.createElement("div"),g}return Lr(s,[{key:"componentDidMount",value:function(){var g,L=this.props,N=L.lnglat,K=L.children,ee=L.option,X=L.lngLat,be=new Pt.Popup(yr(yr({},ee),{},{stopPropagation:(g=this.props.option)===null||g===void 0?void 0:g.stopPropagation}));N&&be.setLnglat(N),X&&be.setLnglat(X),K&&be.setDOMContent(this.el),this.popup=be,this.scene.addPopup(be)}},{key:"componentDidUpdate",value:function(g){var L,N,K,ee,X,be,me=Array.isArray(g.lnglat)?g.lnglat:[g==null||(L=g.lnglat)===null||L===void 0?void 0:L.lng,g==null||(N=g.lnglat)===null||N===void 0?void 0:N.lat],Be=Array.isArray(this.props.lnglat)?this.props.lnglat:[(K=this.props)===null||K===void 0||(ee=K.lnglat)===null||ee===void 0?void 0:ee.lng,(X=this.props)===null||X===void 0||(be=X.lnglat)===null||be===void 0?void 0:be.lat],pt=me.toString()!==Be.toString();if(pt){var Kt;this.popup.remove(),this.popup=new Pt.Popup(yr(yr({},this.props.option),{},{stopPropagation:(Kt=this.props.option)===null||Kt===void 0?void 0:Kt.stopPropagation})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup)}}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var g=this;return Re.createElement(ct.Consumer,{},function(L){return L&&(g.scene=L),Object(er.createPortal)(g.props.children,g.el)})}}]),s}(Re.PureComponent);function Gr(P){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Gr=function(s){return typeof s}:Gr=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Gr(P)}function Fr(P,p){if(!(P instanceof p))throw new TypeError("Cannot call a class as a function")}function di(P,p){for(var s=0;s<p.length;s++){var d=p[s];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(P,d.key,d)}}function pi(P,p,s){return p&&di(P.prototype,p),s&&di(P,s),P}function kn(P,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");P.prototype=Object.create(p&&p.prototype,{constructor:{value:P,writable:!0,configurable:!0}}),p&&Bi(P,p)}function Bi(P,p){return Bi=Object.setPrototypeOf||function(d,g){return d.__proto__=g,d},Bi(P,p)}function _i(P){var p=Go();return function(){var d=Ho(P),g;if(p){var L=Ho(this).constructor;g=Reflect.construct(d,arguments,L)}else g=d.apply(this,arguments);return Ui(this,g)}}function Ui(P,p){return p&&(Gr(p)==="object"||typeof p=="function")?p:ca(P)}function ca(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}function Go(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(P){return!1}}function Ho(P){return Ho=Object.setPrototypeOf?Object.getPrototypeOf:function(s){return s.__proto__||Object.getPrototypeOf(s)},Ho(P)}var ta=function(P){kn(s,P);var p=_i(s);function s(d){var g;return Fr(this,s),g=p.call(this,d),g.el=document.createElement("div"),g}return pi(s,[{key:"componentDidMount",value:function(){var g=this.props,L=g.lnglat,N=g.children,K=g.option,ee=g.onMarkerLoaded,X=new Pt.Marker(K);L&&X.setLnglat(L),N&&X.setElement(this.el),this.marker=X,ee&&ee(X),this.scene.addMarker(X)}},{key:"componentDidUpdate",value:function(g){var L,N=(g==null?void 0:g.lnglat.toString())!==((L=this.props)===null||L===void 0?void 0:L.lnglat.toString());N&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var g=this;return Re.createElement(ct.Consumer,{},function(L){return L&&(g.scene=L),Object(er.createPortal)(g.props.children,g.el)})}}]),s}(Re.PureComponent),mo=Re.useEffect,Oa=Re.memo(function(P){var p=P.type,s=P.handler,d=ht();return mo(function(){return d.on(p,s),function(){d.off(p,s)}},[p]),null}),ws=Oa,Qo=Re.useEffect,xs=Re.memo(function(p){var s=p.name,d=p.url,g=ht();return Qo(function(){g.addImage(s,d)},[s,d]),null}),qo=o("95SA"),Zs=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],No=function(P){Object(we.a)(s,P);var p=Object(J.a)(s);function s(){var d;Object(Q.a)(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.state={data:null,grid:null,loading:!1},d}return Object(re.a)(s,[{key:"componentDidMount",value:function(){var d=Object(lr.a)(jt.a.mark(function L(){var N,K,ee,X;return jt.a.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return me.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then(function(Be){return Be.json()}),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then(function(Be){return Be.json()})]);case 2:N=me.sent,K=Object(q.a)(N,2),ee=K[0],X=K[1],this.setState({data:ee,grid:X,loading:!0});case 7:case"end":return me.stop()}},L,this)}));function g(){return d.apply(this,arguments)}return g}()},{key:"render",value:function(){var g=this.state,L=g.data,N=g.grid,K=g.loading;return K===!1?Object(a.jsx)(qo.a,{}):Object(a.jsxs)(mf,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"},children:[N&&Object(a.jsx)(xr,{source:{data:N,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8}},"1"),L&&[Object(a.jsx)(wr,{options:{autoFit:!0},source:{data:L},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:Zs},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8}},"2"),Object(a.jsx)(wr,{source:{data:L},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(X){return X>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0}},"5")]]})}}]),s}(Re.Component),ui={Pie:R,WaterWave:ie,Gauge:bt,MiniArea:V,TagCloud:it,Map:No},Ws=o("KQm4"),Ca=o("H+7v"),Sn=o.n(Ca);function Ri(P){return P*1<10?"0".concat(P):P}function Vi(){for(var P=[],p=0;p<24;p+=1)P.push({x:"".concat(Ri(p),":00"),y:Math.floor(Math.random()*200)+p*50});return P}var es=function(P){Object(we.a)(s,P);var p=Object(J.a)(s);function s(){var d;Object(Q.a)(this,s);for(var g=arguments.length,L=new Array(g),N=0;N<g;N++)L[N]=arguments[N];return d=p.call.apply(p,[this].concat(L)),d.state={activeData:Vi()},d.timer=void 0,d.requestRef=void 0,d.loopData=function(){d.requestRef=requestAnimationFrame(function(){d.timer=window.setTimeout(function(){d.setState({activeData:Vi()},function(){d.loopData()})},1e3)})},d}return Object(re.a)(s,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var g=this.state.activeData,L=g===void 0?[]:g;return Object(a.jsxs)("div",{className:Sn.a.activeChart,children:[Object(a.jsx)(Ge.a,{title:"\u76EE\u6807\u8BC4\u4F30",value:"\u6709\u671B\u8FBE\u5230\u9884\u671F"}),Object(a.jsx)("div",{style:{marginTop:32},children:Object(a.jsx)(V,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:L})}),L&&Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:Sn.a.activeChartGrid,children:[Object(a.jsxs)("p",{children:[Object(Ws.a)(L).sort()[L.length-1].y+200," \u4EBF\u5143"]}),Object(a.jsxs)("p",{children:[Object(Ws.a)(L).sort()[Math.floor(L.length/2)].y," \u4EBF\u5143"]})]}),Object(a.jsx)("div",{className:Sn.a.dashedLine,children:Object(a.jsx)("div",{className:Sn.a.line})}),Object(a.jsx)("div",{className:Sn.a.dashedLine,children:Object(a.jsx)("div",{className:Sn.a.line})})]}),L&&Object(a.jsxs)("div",{className:Sn.a.activeChartLegend,children:[Object(a.jsx)("span",{children:"00:00"}),Object(a.jsx)("span",{children:L[Math.floor(L.length/2)].x}),Object(a.jsx)("span",{children:L[L.length-1].x})]})]})}}]),s}(Re.Component),au=o("Wnft"),hc=o.n(au),Lt=Ge.a.Countdown,Sr=Date.now()+1e3*60*60*24*2+1e3*30,mr=function(P){Object(we.a)(s,P);var p=Object(J.a)(s);function s(){return Object(Q.a)(this,s),p.apply(this,arguments)}return Object(re.a)(s,[{key:"componentDidMount",value:function(){var g=this.props.dispatch;g({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var g=this.props,L=g.dashboardAndmonitor,N=g.loading,K=L.tags;return Object(a.jsx)(Oe.a,{children:Object(a.jsxs)(at.a.Fragment,{children:[Object(a.jsxs)(F.a,{gutter:24,children:[Object(a.jsx)(B.a,{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24},children:Object(a.jsxs)(v.a,{title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity"}),bordered:!1,children:[Object(a.jsxs)(F.a,{children:[Object(a.jsx)(B.a,{md:6,sm:12,xs:24,children:Object(a.jsx)(Ge.a,{title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today"}),suffix:"\u5143",value:Mt()(124543233).format("0,0")})}),Object(a.jsx)(B.a,{md:6,sm:12,xs:24,children:Object(a.jsx)(Ge.a,{title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate"}),value:"92%"})}),Object(a.jsx)(B.a,{md:6,sm:12,xs:24,children:Object(a.jsx)(Lt,{title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity"}),value:Sr,format:"HH:mm:ss:SSS"})}),Object(a.jsx)(B.a,{md:6,sm:12,xs:24,children:Object(a.jsx)(Ge.a,{title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second"}),suffix:"\u5143",value:Mt()(234).format("0,0")})})]}),Object(a.jsx)("div",{className:hc.a.mapChart,children:Object(a.jsx)(No,{})})]})}),Object(a.jsxs)(B.a,{xl:6,lg:24,md:24,sm:24,xs:24,children:[Object(a.jsx)(v.a,{title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast"}),style:{marginBottom:24},bordered:!1,children:Object(a.jsx)(es,{})}),Object(a.jsx)(v.a,{title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1,children:Object(a.jsx)(bt,{title:Object(_e.d)({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87})})]})]}),Object(a.jsxs)(F.a,{gutter:24,children:[Object(a.jsx)(B.a,{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24},children:Object(a.jsx)(v.a,{title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category"}),bordered:!1,className:hc.a.pieCard,children:Object(a.jsxs)(F.a,{style:{padding:"16px 0"},children:[Object(a.jsx)(B.a,{span:8,children:Object(a.jsx)(R,{animate:!1,percent:28,title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food"}),total:"28%",height:128,lineWidth:2})}),Object(a.jsx)(B.a,{span:8,children:Object(a.jsx)(R,{animate:!1,color:"#5DDECF",percent:22,title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food"}),total:"22%",height:128,lineWidth:2})}),Object(a.jsx)(B.a,{span:8,children:Object(a.jsx)(R,{animate:!1,color:"#2FC25B",percent:32,title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot"}),total:"32%",height:128,lineWidth:2})})]})})}),Object(a.jsx)(B.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24},children:Object(a.jsx)(v.a,{title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches"}),loading:N,bordered:!1,bodyStyle:{overflow:"hidden"},children:Object(a.jsx)(it,{data:K||[],height:161})})}),Object(a.jsx)(B.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24},children:Object(a.jsx)(v.a,{title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1,children:Object(a.jsx)(ie,{height:161,title:Object(a.jsx)(_e.a,{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus"}),percent:34})})})]})]})})}}]),s}(Re.Component),Dn=x.default=Object(_e.c)(function(P){var p=P.dashboardAndmonitor,s=P.loading;return{dashboardAndmonitor:p,loading:s.models.dashboardAndmonitor}})(mr)},aF1E:function(Ie,x,o){"use strict";o.d(x,"a",function(){return a});var b=o("lSNA"),v=o.n(b);function Z(Y,B){var Q=Object.keys(Y);if(Object.getOwnPropertySymbols){var re=Object.getOwnPropertySymbols(Y);B&&(re=re.filter(function(we){return Object.getOwnPropertyDescriptor(Y,we).enumerable})),Q.push.apply(Q,re)}return Q}function F(Y){for(var B=1;B<arguments.length;B++){var Q=arguments[B]!=null?arguments[B]:{};B%2?Z(Object(Q),!0).forEach(function(re){v()(Y,re,Q[re])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Y,Object.getOwnPropertyDescriptors(Q)):Z(Object(Q)).forEach(function(re){Object.defineProperty(Y,re,Object.getOwnPropertyDescriptor(Q,re))})}return Y}function a(Y,B){var Q=B.sourceField,re=B.targetField,we=B.data,J={};return we.forEach(function(Ke){J[Ke[Q]]=Ke}),Y.dataArray=Y.dataArray.map(function(Ke){var Ge=Ke[re];return F(F({},Ke),J[Ge])}),Y}},aHsQ:function(Ie,x,o){"use strict";var b=o("cIOH"),v=o.n(b),Z=o("6D9b"),F=o.n(Z),a=o("cWXX")},aPG5:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.resolve=void 0;var b=o("MON2"),v=o("FV85"),Z=o("qK8v"),F=o("ujMp"),a=o("cSJO"),Y=function(we,J,Ke){try{return Ke()}catch(Ge){throw Z.isStackOverflowExeption(Ge)?new Error(b.CIRCULAR_DEPENDENCY_IN_FACTORY(we,J.toString())):Ge}},B=function re(we){return function(J){J.parentContext.setCurrentRequest(J);var Ke=J.bindings,Ge=J.childRequests,_e=J.target&&J.target.isArray(),Re=!J.parentRequest||!J.parentRequest.target||!J.target||!J.parentRequest.target.matchesArray(J.target.serviceIdentifier);if(_e&&Re)return Ge.map(function(St){var or=re(we);return or(St)});var at=null;if(J.target.isOptional()&&Ke.length===0)return;var Oe=Ke[0],xt=Oe.scope===v.BindingScopeEnum.Singleton,Mt=Oe.scope===v.BindingScopeEnum.Request;if(xt&&Oe.activated)return Oe.cache;if(Mt&&we!==null&&we.has(Oe.id))return we.get(Oe.id);if(Oe.type===v.BindingTypeEnum.ConstantValue)at=Oe.cache;else if(Oe.type===v.BindingTypeEnum.Function)at=Oe.cache;else if(Oe.type===v.BindingTypeEnum.Constructor)at=Oe.implementationType;else if(Oe.type===v.BindingTypeEnum.DynamicValue&&Oe.dynamicValue!==null)at=Y("toDynamicValue",Oe.serviceIdentifier,function(){return Oe.dynamicValue(J.parentContext)});else if(Oe.type===v.BindingTypeEnum.Factory&&Oe.factory!==null)at=Y("toFactory",Oe.serviceIdentifier,function(){return Oe.factory(J.parentContext)});else if(Oe.type===v.BindingTypeEnum.Provider&&Oe.provider!==null)at=Y("toProvider",Oe.serviceIdentifier,function(){return Oe.provider(J.parentContext)});else if(Oe.type===v.BindingTypeEnum.Instance&&Oe.implementationType!==null)at=a.resolveInstance(Oe.implementationType,Ge,re(we));else{var Et=F.getServiceIdentifierAsString(J.serviceIdentifier);throw new Error(b.INVALID_BINDING_TYPE+" "+Et)}return typeof Oe.onActivation=="function"&&(at=Oe.onActivation(J.parentContext,at)),xt&&(Oe.cache=at,Oe.activated=!0),Mt&&we!==null&&!we.has(Oe.id)&&we.set(Oe.id,at),at}};function Q(re){var we=B(re.plan.rootRequest.requestScope);return we(re.plan.rootRequest)}x.resolve=Q},asDA:function(Ie,x){function o(b,v,Z,F){var a=-1,Y=b==null?0:b.length;for(F&&Y&&(Z=b[++a]);++a<Y;)Z=v(Z,b[a],a,b);return Z}Ie.exports=o},b2z7:function(Ie,x){var o=/\w*$/;function b(v){var Z=new v.constructor(v.source,o.exec(v));return Z.lastIndex=v.lastIndex,Z}Ie.exports=b},b48C:function(Ie,x){function o(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}Ie.exports=o},bB6j:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});var b={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});var b;(function(v){v.Normal="normal",v.PostProcessing="post-processing"})(b||(b={}))},bTtR:function(Ie,x){},bYl4:function(Ie,x){},bahg:function(Ie,x){function o(b){return b.split("")}Ie.exports=o},bl9R:function(Ie,x,o){"use strict";o.r(x),o.d(x,"create",function(){return v}),o.d(x,"clone",function(){return Z}),o.d(x,"fromValues",function(){return F}),o.d(x,"copy",function(){return a}),o.d(x,"set",function(){return Y}),o.d(x,"add",function(){return B}),o.d(x,"subtract",function(){return Q}),o.d(x,"multiply",function(){return re}),o.d(x,"divide",function(){return we}),o.d(x,"ceil",function(){return J}),o.d(x,"floor",function(){return Ke}),o.d(x,"min",function(){return Ge}),o.d(x,"max",function(){return _e}),o.d(x,"round",function(){return Re}),o.d(x,"scale",function(){return at}),o.d(x,"scaleAndAdd",function(){return Oe}),o.d(x,"distance",function(){return xt}),o.d(x,"squaredDistance",function(){return Mt}),o.d(x,"length",function(){return Et}),o.d(x,"squaredLength",function(){return St}),o.d(x,"negate",function(){return or}),o.d(x,"inverse",function(){return $t}),o.d(x,"normalize",function(){return Ht}),o.d(x,"dot",function(){return mt}),o.d(x,"cross",function(){return Xe}),o.d(x,"lerp",function(){return Tt}),o.d(x,"random",function(){return ze}),o.d(x,"transformMat4",function(){return st}),o.d(x,"transformQuat",function(){return Wt}),o.d(x,"zero",function(){return bt}),o.d(x,"str",function(){return dt}),o.d(x,"exactEquals",function(){return H}),o.d(x,"equals",function(){return z}),o.d(x,"sub",function(){return V}),o.d(x,"mul",function(){return Se}),o.d(x,"div",function(){return ve}),o.d(x,"dist",function(){return ce}),o.d(x,"sqrDist",function(){return fe}),o.d(x,"len",function(){return ke}),o.d(x,"sqrLen",function(){return lt}),o.d(x,"forEach",function(){return nt});var b=o("yU0y");function v(){var le=new b.a(4);return b.a!=Float32Array&&(le[0]=0,le[1]=0,le[2]=0,le[3]=0),le}function Z(le){var ye=new b.a(4);return ye[0]=le[0],ye[1]=le[1],ye[2]=le[2],ye[3]=le[3],ye}function F(le,ye,He,ft){var De=new b.a(4);return De[0]=le,De[1]=ye,De[2]=He,De[3]=ft,De}function a(le,ye){return le[0]=ye[0],le[1]=ye[1],le[2]=ye[2],le[3]=ye[3],le}function Y(le,ye,He,ft,De){return le[0]=ye,le[1]=He,le[2]=ft,le[3]=De,le}function B(le,ye,He){return le[0]=ye[0]+He[0],le[1]=ye[1]+He[1],le[2]=ye[2]+He[2],le[3]=ye[3]+He[3],le}function Q(le,ye,He){return le[0]=ye[0]-He[0],le[1]=ye[1]-He[1],le[2]=ye[2]-He[2],le[3]=ye[3]-He[3],le}function re(le,ye,He){return le[0]=ye[0]*He[0],le[1]=ye[1]*He[1],le[2]=ye[2]*He[2],le[3]=ye[3]*He[3],le}function we(le,ye,He){return le[0]=ye[0]/He[0],le[1]=ye[1]/He[1],le[2]=ye[2]/He[2],le[3]=ye[3]/He[3],le}function J(le,ye){return le[0]=Math.ceil(ye[0]),le[1]=Math.ceil(ye[1]),le[2]=Math.ceil(ye[2]),le[3]=Math.ceil(ye[3]),le}function Ke(le,ye){return le[0]=Math.floor(ye[0]),le[1]=Math.floor(ye[1]),le[2]=Math.floor(ye[2]),le[3]=Math.floor(ye[3]),le}function Ge(le,ye,He){return le[0]=Math.min(ye[0],He[0]),le[1]=Math.min(ye[1],He[1]),le[2]=Math.min(ye[2],He[2]),le[3]=Math.min(ye[3],He[3]),le}function _e(le,ye,He){return le[0]=Math.max(ye[0],He[0]),le[1]=Math.max(ye[1],He[1]),le[2]=Math.max(ye[2],He[2]),le[3]=Math.max(ye[3],He[3]),le}function Re(le,ye){return le[0]=Math.round(ye[0]),le[1]=Math.round(ye[1]),le[2]=Math.round(ye[2]),le[3]=Math.round(ye[3]),le}function at(le,ye,He){return le[0]=ye[0]*He,le[1]=ye[1]*He,le[2]=ye[2]*He,le[3]=ye[3]*He,le}function Oe(le,ye,He,ft){return le[0]=ye[0]+He[0]*ft,le[1]=ye[1]+He[1]*ft,le[2]=ye[2]+He[2]*ft,le[3]=ye[3]+He[3]*ft,le}function xt(le,ye){var He=ye[0]-le[0],ft=ye[1]-le[1],De=ye[2]-le[2],Ze=ye[3]-le[3];return Math.hypot(He,ft,De,Ze)}function Mt(le,ye){var He=ye[0]-le[0],ft=ye[1]-le[1],De=ye[2]-le[2],Ze=ye[3]-le[3];return He*He+ft*ft+De*De+Ze*Ze}function Et(le){var ye=le[0],He=le[1],ft=le[2],De=le[3];return Math.hypot(ye,He,ft,De)}function St(le){var ye=le[0],He=le[1],ft=le[2],De=le[3];return ye*ye+He*He+ft*ft+De*De}function or(le,ye){return le[0]=-ye[0],le[1]=-ye[1],le[2]=-ye[2],le[3]=-ye[3],le}function $t(le,ye){return le[0]=1/ye[0],le[1]=1/ye[1],le[2]=1/ye[2],le[3]=1/ye[3],le}function Ht(le,ye){var He=ye[0],ft=ye[1],De=ye[2],Ze=ye[3],w=He*He+ft*ft+De*De+Ze*Ze;return w>0&&(w=1/Math.sqrt(w)),le[0]=He*w,le[1]=ft*w,le[2]=De*w,le[3]=Ze*w,le}function mt(le,ye){return le[0]*ye[0]+le[1]*ye[1]+le[2]*ye[2]+le[3]*ye[3]}function Xe(le,ye,He,ft){var De=He[0]*ft[1]-He[1]*ft[0],Ze=He[0]*ft[2]-He[2]*ft[0],w=He[0]*ft[3]-He[3]*ft[0],R=He[1]*ft[2]-He[2]*ft[1],q=He[1]*ft[3]-He[3]*ft[1],he=He[2]*ft[3]-He[3]*ft[2],Ve=ye[0],Ye=ye[1],yt=ye[2],it=ye[3];return le[0]=Ye*he-yt*q+it*R,le[1]=-(Ve*he)+yt*w-it*Ze,le[2]=Ve*q-Ye*w+it*De,le[3]=-(Ve*R)+Ye*Ze-yt*De,le}function Tt(le,ye,He,ft){var De=ye[0],Ze=ye[1],w=ye[2],R=ye[3];return le[0]=De+ft*(He[0]-De),le[1]=Ze+ft*(He[1]-Ze),le[2]=w+ft*(He[2]-w),le[3]=R+ft*(He[3]-R),le}function ze(le,ye){ye=ye||1;var He,ft,De,Ze,w,R;do He=b.c()*2-1,ft=b.c()*2-1,w=He*He+ft*ft;while(w>=1);do De=b.c()*2-1,Ze=b.c()*2-1,R=De*De+Ze*Ze;while(R>=1);var q=Math.sqrt((1-w)/R);return le[0]=ye*He,le[1]=ye*ft,le[2]=ye*De*q,le[3]=ye*Ze*q,le}function st(le,ye,He){var ft=ye[0],De=ye[1],Ze=ye[2],w=ye[3];return le[0]=He[0]*ft+He[4]*De+He[8]*Ze+He[12]*w,le[1]=He[1]*ft+He[5]*De+He[9]*Ze+He[13]*w,le[2]=He[2]*ft+He[6]*De+He[10]*Ze+He[14]*w,le[3]=He[3]*ft+He[7]*De+He[11]*Ze+He[15]*w,le}function Wt(le,ye,He){var ft=ye[0],De=ye[1],Ze=ye[2],w=He[0],R=He[1],q=He[2],he=He[3],Ve=he*ft+R*Ze-q*De,Ye=he*De+q*ft-w*Ze,yt=he*Ze+w*De-R*ft,it=-w*ft-R*De-q*Ze;return le[0]=Ve*he+it*-w+Ye*-q-yt*-R,le[1]=Ye*he+it*-R+yt*-w-Ve*-q,le[2]=yt*he+it*-q+Ve*-R-Ye*-w,le[3]=ye[3],le}function bt(le){return le[0]=0,le[1]=0,le[2]=0,le[3]=0,le}function dt(le){return"vec4("+le[0]+", "+le[1]+", "+le[2]+", "+le[3]+")"}function H(le,ye){return le[0]===ye[0]&&le[1]===ye[1]&&le[2]===ye[2]&&le[3]===ye[3]}function z(le,ye){var He=le[0],ft=le[1],De=le[2],Ze=le[3],w=ye[0],R=ye[1],q=ye[2],he=ye[3];return Math.abs(He-w)<=b.b*Math.max(1,Math.abs(He),Math.abs(w))&&Math.abs(ft-R)<=b.b*Math.max(1,Math.abs(ft),Math.abs(R))&&Math.abs(De-q)<=b.b*Math.max(1,Math.abs(De),Math.abs(q))&&Math.abs(Ze-he)<=b.b*Math.max(1,Math.abs(Ze),Math.abs(he))}var V=Q,Se=re,ve=we,ce=xt,fe=Mt,ke=Et,lt=St,nt=function(){var le=v();return function(ye,He,ft,De,Ze,w){var R,q;for(He||(He=4),ft||(ft=0),De?q=Math.min(De*He+ft,ye.length):q=ye.length,R=ft;R<q;R+=He)le[0]=ye[R],le[1]=ye[R+1],le[2]=ye[R+2],le[3]=ye[R+3],Ze(le,le,w),ye[R]=le[0],ye[R+1]=le[1],ye[R+2]=le[2],ye[R+3]=le[3];return ye}}()},bzyH:function(Ie,x){},cSJO:function(Ie,x,o){"use strict";var b=this&&this.__spreadArrays||function(){for(var re=0,we=0,J=arguments.length;we<J;we++)re+=arguments[we].length;for(var Ke=Array(re),Ge=0,we=0;we<J;we++)for(var _e=arguments[we],Re=0,at=_e.length;Re<at;Re++,Ge++)Ke[Ge]=_e[Re];return Ke};Object.defineProperty(x,"__esModule",{value:!0}),x.resolveInstance=void 0;var v=o("MON2"),Z=o("FV85"),F=o("xfSm");function a(re,we,J){var Ke=we.filter(function(_e){return _e.target!==null&&_e.target.type===Z.TargetTypeEnum.ClassProperty}),Ge=Ke.map(J);return Ke.forEach(function(_e,Re){var at="";at=_e.target.name.value();var Oe=Ge[Re];re[at]=Oe}),re}function Y(re,we){return new(re.bind.apply(re,b([void 0],we)))}function B(re,we){if(Reflect.hasMetadata(F.POST_CONSTRUCT,re)){var J=Reflect.getMetadata(F.POST_CONSTRUCT,re);try{we[J.value]()}catch(Ke){throw new Error(v.POST_CONSTRUCT_ERROR(re.name,Ke.message))}}}function Q(re,we,J){var Ke=null;if(we.length>0){var Ge=we.filter(function(Re){return Re.target!==null&&Re.target.type===Z.TargetTypeEnum.ConstructorArgument}),_e=Ge.map(J);Ke=Y(re,_e),Ke=a(Ke,we,J)}else Ke=new re;return B(re,Ke),Ke}x.resolveInstance=Q},cWXX:function(Ie,x,o){"use strict";var b=o("cIOH"),v=o.n(b),Z=o("oIFs"),F=o.n(Z)},cZ5Q:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.injectable=void 0;var b=o("MON2"),v=o("xfSm");function Z(){return function(F){if(Reflect.hasOwnMetadata(v.PARAM_TYPES,F))throw new Error(b.DUPLICATED_INJECTABLE_DECORATOR);var a=Reflect.getMetadata(v.DESIGN_PARAM_TYPES,F)||[];return Reflect.defineMetadata(v.PARAM_TYPES,a,F),F}}x.injectable=Z},cZlC:function(Ie,x,o){"use strict";o.d(x,"b",function(){return b}),o.d(x,"c",function(){return v}),o.d(x,"a",function(){return Z});var b;(function(F){F.LINEAR="linear",F.POWER="power",F.LOG="log",F.IDENTITY="identity",F.TIME="time",F.QUANTILE="quantile",F.QUANTIZE="quantize",F.THRESHOLD="threshold",F.CAT="cat"})(b||(b={}));var v;(function(F){F.CONSTANT="constant",F.VARIABLE="variable"})(v||(v={}));var Z;(function(F){F[F.Attribute=0]="Attribute",F[F.InstancedAttribute=1]="InstancedAttribute",F[F.Uniform=2]="Uniform"})(Z||(Z={}))},"cq/+":function(Ie,x,o){var b=o("mc0g"),v=b();Ie.exports=v},cvCv:function(Ie,x){function o(b){return function(){return b}}Ie.exports=o},d9O0:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.id=void 0;var b=0;function v(){return b++}x.id=v},d9mD:function(Ie,x,o){Ie.exports={pie:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-pie",chart:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-chart",hasLegend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-hasLegend",legend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legend",dot:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-dot",line:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-line",legendTitle:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendTitle",percent:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-percent",value:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-value",title:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-title",total:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-total",legendBlock:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendBlock"}},dQpi:function(Ie,x,o){var b=o("yGk4"),v=o("vN+2"),Z=o("rEGp"),F=1/0,a=b&&1/Z(new b([,-0]))[1]==F?function(Y){return new b(Y)}:v;Ie.exports=a},dTAl:function(Ie,x,o){var b=o("GoyQ"),v=Object.create,Z=function(){function F(){}return function(a){if(!b(a))return{};if(v)return v(a);F.prototype=a;var Y=new F;return F.prototype=void 0,Y}}();Ie.exports=Z},dVn5:function(Ie,x){var o=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function b(v){return v.match(o)||[]}Ie.exports=b},dX1H:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Target=void 0;var b=o("xfSm"),v=o("d9O0"),Z=o("GXnB"),F=o("zxMA"),a=function(){function Y(B,Q,re,we){this.id=v.id(),this.type=B,this.serviceIdentifier=re,this.name=new F.QueryableString(Q||""),this.metadata=new Array;var J=null;typeof we=="string"?J=new Z.Metadata(b.NAMED_TAG,we):we instanceof Z.Metadata&&(J=we),J!==null&&this.metadata.push(J)}return Y.prototype.hasTag=function(B){for(var Q=0,re=this.metadata;Q<re.length;Q++){var we=re[Q];if(we.key===B)return!0}return!1},Y.prototype.isArray=function(){return this.hasTag(b.MULTI_INJECT_TAG)},Y.prototype.matchesArray=function(B){return this.matchesTag(b.MULTI_INJECT_TAG)(B)},Y.prototype.isNamed=function(){return this.hasTag(b.NAMED_TAG)},Y.prototype.isTagged=function(){return this.metadata.some(function(B){return B.key!==b.INJECT_TAG&&B.key!==b.MULTI_INJECT_TAG&&B.key!==b.NAME_TAG&&B.key!==b.UNMANAGED_TAG&&B.key!==b.NAMED_TAG})},Y.prototype.isOptional=function(){return this.matchesTag(b.OPTIONAL_TAG)(!0)},Y.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(B){return B.key===b.NAMED_TAG})[0]:null},Y.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(B){return B.key!==b.INJECT_TAG&&B.key!==b.MULTI_INJECT_TAG&&B.key!==b.NAME_TAG&&B.key!==b.UNMANAGED_TAG&&B.key!==b.NAMED_TAG}):null},Y.prototype.matchesNamedTag=function(B){return this.matchesTag(b.NAMED_TAG)(B)},Y.prototype.matchesTag=function(B){var Q=this;return function(re){for(var we=0,J=Q.metadata;we<J.length;we++){var Ke=J[we];if(Ke.key===B&&Ke.value===re)return!0}return!1}},Y}();x.Target=a},doU7:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingCount=void 0;var b={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};x.BindingCount=b},dt0z:function(Ie,x,o){var b=o("zoYe");function v(Z){return Z==null?"":b(Z)}Ie.exports=v},dxzI:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.AsyncContainerModule=x.ContainerModule=void 0;var b=o("d9O0"),v=function(){function F(a){this.id=b.id(),this.registry=a}return F}();x.ContainerModule=v;var Z=function(){function F(a){this.id=b.id(),this.registry=a}return F}();x.AsyncContainerModule=Z},eUgh:function(Ie,x){function o(b,v){for(var Z=-1,F=b==null?0:b.length,a=Array(F);++Z<F;)a[Z]=v(b[Z],Z,b);return a}Ie.exports=o},"eg+a":function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});var b=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(Ie,x,o){"use strict";o.d(x,"d",function(){return Ef}),o.d(x,"b",function(){return Zc}),o.d(x,"a",function(){return Hl});var b=o("mNvP"),v=o("uhBA"),Z=o.n(v),F=o("4cb6"),a=o("APxj"),Y=o.n(a),B=o("bB6j"),Q=o("lSNA"),re=o.n(Q),we=o("lwsE"),J=o.n(we),Ke=o("W8MJ"),Ge=o.n(Ke),_e=o("Hel2"),Re=o("rxlC"),at=o.n(Re);function Oe(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function xt(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?Oe(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):Oe(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}function Mt(ne,oe){var D;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(D=Et(ne))||oe&&ne&&typeof ne.length=="number"){D&&(ne=D);var U=0,Ee=function(){};return{s:Ee,n:function(){return U>=ne.length?{done:!0}:{done:!1,value:ne[U++]}},e:function(Pr){throw Pr},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var tt=!0,Gt=!1,tr;return{s:function(){D=ne[Symbol.iterator]()},n:function(){var Pr=D.next();return tt=Pr.done,Pr},e:function(Pr){Gt=!0,tr=Pr},f:function(){try{!tt&&D.return!=null&&D.return()}finally{if(Gt)throw tr}}}}function Et(ne,oe){if(!!ne){if(typeof ne=="string")return St(ne,oe);var D=Object.prototype.toString.call(ne).slice(8,-1);if(D==="Object"&&ne.constructor&&(D=ne.constructor.name),D==="Map"||D==="Set")return Array.from(ne);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return St(ne,oe)}}function St(ne,oe){(oe==null||oe>ne.length)&&(oe=ne.length);for(var D=0,U=new Array(oe);D<oe;D++)U[D]=ne[D];return U}var or=30;function $t(ne){var oe=ne.characterSet,D=ne.getFontWidth,U=ne.fontHeight,Ee=ne.buffer,tt=ne.maxCanvasWidth,Gt=ne.mapping,tr=Gt===void 0?{}:Gt,er=ne.xOffset,Pr=er===void 0?0:er,Jr=ne.yOffset,Rn=Jr===void 0?0:Jr,Xn=0,ri=Pr;Array.from(oe).forEach(function(Pi,ia){if(!tr[Pi]){var ra=D(Pi,ia);ri+or>tt&&(ri=0,Xn++),tr[Pi]={x:ri,y:Rn+Xn*or,width:or,height:or,advance:ra},ri+=or}});var wi=U+Ee*2;return{mapping:tr,xOffset:ri,yOffset:Rn+Xn*wi,canvasHeight:Xe(Rn+(Xn+1)*wi)}}function Ht(ne,oe,D){var U=0,Ee=0,tt=0,Gt=[],tr={},er=Mt(ne),Pr;try{for(er.s();!(Pr=er.n()).done;){var Jr=Pr.value;if(!tr[Jr.id]){var Rn=Jr.size;U+Rn+oe>D&&(mt(tr,Gt,Ee),U=0,Ee=tt+Ee+oe,tt=0,Gt=[]),Gt.push({icon:Jr,xOffset:U}),U=U+Rn+oe,tt=Math.max(tt,Rn)}}}catch(ri){er.e(ri)}finally{er.f()}Gt.length>0&&mt(tr,Gt,Ee);var Xn=Xe(tt+Ee+oe);return{mapping:tr,canvasHeight:Xn}}function mt(ne,oe,D){var U=Mt(oe),Ee;try{for(U.s();!(Ee=U.n()).done;){var tt=Ee.value,Gt=tt.icon,tr=tt.xOffset;ne[Gt.id]=xt(xt({},Gt),{},{x:tr,y:D,image:Gt.image,width:Gt.width,height:Gt.height})}}catch(er){U.e(er)}finally{U.f()}}function Xe(ne){return Math.pow(2,Math.ceil(Math.log2(ne)))}var Tt,ze,st;function Wt(ne,oe){var D;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(D=bt(ne))||oe&&ne&&typeof ne.length=="number"){D&&(ne=D);var U=0,Ee=function(){};return{s:Ee,n:function(){return U>=ne.length?{done:!0}:{done:!1,value:ne[U++]}},e:function(Pr){throw Pr},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var tt=!0,Gt=!1,tr;return{s:function(){D=ne[Symbol.iterator]()},n:function(){var Pr=D.next();return tt=Pr.done,Pr},e:function(Pr){Gt=!0,tr=Pr},f:function(){try{!tt&&D.return!=null&&D.return()}finally{if(Gt)throw tr}}}}function bt(ne,oe){if(!!ne){if(typeof ne=="string")return dt(ne,oe);var D=Object.prototype.toString.call(ne).slice(8,-1);if(D==="Object"&&ne.constructor&&(D=ne.constructor.name),D==="Map"||D==="Set")return Array.from(ne);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return dt(ne,oe)}}function dt(ne,oe){(oe==null||oe>ne.length)&&(oe=ne.length);for(var D=0,U=new Array(oe);D<oe;D++)U[D]=ne[D];return U}function H(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function z(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?H(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):H(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}var V=De(),Se="sans-serif",ve="normal",ce=24,fe=3,ke=.25,lt=8,nt=1024,le=1,ye=1,He=3,ft=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function De(){for(var ne=[],oe=32;oe<128;oe++)ne.push(String.fromCharCode(oe));return ne}function Ze(ne,oe,D,U){ne.font="".concat(U," ").concat(D,"px ").concat(oe),ne.fillStyle="black",ne.textBaseline="middle"}function w(ne,oe){for(var D=0;D<ne.length;D++)oe.data[4*D+3]=ne[D]}var R=(Tt=Object(F.injectable)(),Tt(ze=(st=function(){function ne(){J()(this,ne),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new _e.b(He)}return Ge()(ne,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Se,fontWeight:ve,characterSet:V,fontSize:ce,buffer:fe,sdf:!0,cutoff:ke,radius:lt},this.key=""}},{key:"addIconGlyphs",value:function(D){var U=this;D.forEach(function(Ee){U.iconFontGlyphs[Ee.name]=Ee.unicode})}},{key:"getGlyph",value:function(D){return this.iconFontGlyphs[D]?String.fromCharCode(parseInt(this.iconFontGlyphs[D],16)):""}},{key:"setFontOptions",value:function(D){this.fontOptions=z(z({},this.fontOptions),D),this.key=this.getKey();var U=this.getNewChars(this.key,this.fontOptions.characterSet),Ee=this.cache.get(this.key);if(!(Ee&&U.length===0)){var tt=this.generateFontAtlas(this.key,U,Ee);this.fontAtlas=tt,this.cache.set(this.key,tt)}}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(D,U,Ee){var tt=this.fontOptions,Gt=tt.fontFamily,tr=tt.fontWeight,er=tt.fontSize,Pr=tt.buffer,Jr=tt.sdf,Rn=tt.radius,Xn=tt.cutoff,ri=Ee&&Ee.data;ri||(ri=document.createElement("canvas"),ri.width=nt);var wi=ri.getContext("2d");Ze(wi,Gt,er,tr);var Pi=$t(z({getFontWidth:function(fc){return wi.measureText(fc).width},fontHeight:er*ye,buffer:Pr,characterSet:U,maxCanvasWidth:nt},Ee&&{mapping:Ee.mapping,xOffset:Ee.xOffset,yOffset:Ee.yOffset})),ia=Pi.mapping,ra=Pi.canvasHeight,Ia=Pi.xOffset,uo=Pi.yOffset,eo=wi.getImageData(0,0,ri.width,ri.height);if(ri.height=ra,wi.putImageData(eo,0,0),Ze(wi,Gt,er,tr),Jr){var Na=new at.a(er,Pr,Rn,Xn,Gt,tr),vo=wi.getImageData(0,0,Na.size,Na.size),Fi=Wt(U),to;try{for(Fi.s();!(to=Fi.n()).done;){var us=to.value;w(Na.draw(us),vo),wi.putImageData(vo,ia[us].x,ia[us].y)}}catch(zo){Fi.e(zo)}finally{Fi.f()}}else{var va=Wt(U),Aa;try{for(va.s();!(Aa=va.n()).done;){var mi=Aa.value;wi.fillText(mi,ia[mi].x,ia[mi].y+er*le)}}catch(zo){va.e(zo)}finally{va.f()}}return{xOffset:Ia,yOffset:uo,mapping:ia,data:ri,width:ri.width,height:ri.height}}},{key:"getKey",value:function(){var D=this.fontOptions,U=D.fontFamily,Ee=D.fontWeight,tt=D.fontSize,Gt=D.buffer,tr=D.sdf,er=D.radius,Pr=D.cutoff;return tr?"".concat(U," ").concat(Ee," ").concat(tt," ").concat(Gt," ").concat(er," ").concat(Pr):"".concat(U," ").concat(Ee," ").concat(tt," ").concat(Gt)}},{key:"getNewChars",value:function(D,U){var Ee=this.cache.get(D);if(!Ee)return U;var tt=[],Gt=Ee.mapping,tr=new Set(Object.keys(Gt)),er=new Set(U);return er.forEach(function(Pr){tr.has(Pr)||tt.push(Pr)}),tt}},{key:"scale",get:function(){return ye}},{key:"canvas",get:function(){var D=this.cache.get(this.key);return D&&D.data}},{key:"mapping",get:function(){var D=this.cache.get(this.key);return D&&D.mapping}}]),ne}(),st))||ze),q=o("7W2i"),he=o.n(q),Ve=o("a1gu"),Ye=o.n(Ve),yt=o("Nsbk"),it=o.n(yt),Nt,$,$e;function ie(ne){var oe=qe();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function qe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var jt=3,lr=1024,ct=64,ht=(Nt=Object(F.injectable)(),Nt($=($e=function(ne){he()(D,ne);var oe=ie(D);function D(){var U;J()(this,D);for(var Ee=arguments.length,tt=new Array(Ee),Gt=0;Gt<Ee;Gt++)tt[Gt]=arguments[Gt];return U=oe.call.apply(oe,[this].concat(tt)),U.canvasHeight=128,U.texture=void 0,U.canvas=void 0,U.iconData=void 0,U.iconMap=void 0,U.ctx=void 0,U.loadingImageCount=0,U}return Ge()(D,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(Ee,tt){var Gt=this,tr=new Image;if(this.loadingImageCount++,this.hasImage(Ee))throw new Error("Image Id already exists");this.iconData.push({id:Ee,size:ct}),this.updateIconMap(),this.loadImage(tt).then(function(er){tr=er;var Pr=Gt.iconData.find(function(Jr){return Jr.id===Ee});Pr&&(Pr.image=tr,Pr.width=tr.width,Pr.height=tr.height),Gt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(Ee){return this.iconMap.hasOwnProperty(Ee)}},{key:"removeImage",value:function(Ee){this.hasImage(Ee)&&(this.iconData=this.iconData.filter(function(tt){return tt.id!==Ee}),delete this.iconMap[Ee],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var Ee=this;this.canvas.width=lr,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(tt){var Gt=Ee.iconMap[tt],tr=Gt.x,er=Gt.y,Pr=Gt.image,Jr=Gt.width,Rn=Jr===void 0?64:Jr,Xn=Gt.height,ri=Xn===void 0?64:Xn,wi=Math.max(Rn,ri),Pi=wi/ct,ia=ri/Pi,ra=Rn/Pi;Pr&&Ee.ctx.drawImage(Pr,tr+(ct-ra)/2,er+(ct-ia)/2,ra,ia)})}},{key:"updateIconMap",value:function(){var Ee=Ht(this.iconData,jt,lr),tt=Ee.mapping,Gt=Ee.canvasHeight;this.iconMap=tt,this.canvasHeight=Gt}},{key:"loadImage",value:function(Ee){return new Promise(function(tt,Gt){if(Ee instanceof HTMLImageElement){tt(Ee);return}var tr=new Image;tr.crossOrigin="anonymous",tr.onload=function(){tt(tr)},tr.onerror=function(){Gt(new Error("Could not load image at "+Ee))},tr.src=Ee instanceof File?URL.createObjectURL(Ee):Ee})}}]),D}(v.EventEmitter),$e))||$),Pt=o("J4zp"),vt=o.n(Pt),Pe=o("IOcx"),ut,Qe,Vt,pr=(ut=Object(F.injectable)(),ut(Qe=(Vt=function(){function ne(){J()(this,ne),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return Ge()(ne,[{key:"init",value:function(){}},{key:"update",value:function(D){this.viewport=D,this.viewMatrixInverse=Pe.b.invert(Pe.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var D=this.viewport.getCenter(),U=vt()(D,2),Ee=U[0],tt=U[1];return[Ee,tt]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(D,U){return this.viewport.projectFlat(D,U)}},{key:"setViewProjectionMatrix",value:function(D){this.overridedViewProjectionMatrix=D}},{key:"jitterProjectionMatrix",value:function(D,U){var Ee=Pe.b.fromTranslation(Pe.b.create(),[D,U,0]);this.jitteredProjectionMatrix=Pe.b.multiply(Pe.b.create(),Ee,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Pe.b.multiply(Pe.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),ne}(),Vt))||Qe),Zr,cr,jn;function En(ne,oe){var D;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(D=ni(ne))||oe&&ne&&typeof ne.length=="number"){D&&(ne=D);var U=0,Ee=function(){};return{s:Ee,n:function(){return U>=ne.length?{done:!0}:{done:!1,value:ne[U++]}},e:function(Pr){throw Pr},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var tt=!0,Gt=!1,tr;return{s:function(){D=ne[Symbol.iterator]()},n:function(){var Pr=D.next();return tt=Pr.done,Pr},e:function(Pr){Gt=!0,tr=Pr},f:function(){try{!tt&&D.return!=null&&D.return()}finally{if(Gt)throw tr}}}}function ni(ne,oe){if(!!ne){if(typeof ne=="string")return fi(ne,oe);var D=Object.prototype.toString.call(ne).slice(8,-1);if(D==="Object"&&ne.constructor&&(D=ne.constructor.name),D==="Map"||D==="Set")return Array.from(ne);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return fi(ne,oe)}}function fi(ne,oe){(oe==null||oe>ne.length)&&(oe=ne.length);for(var D=0,U=new Array(oe);D<oe;D++)U[D]=ne[D];return U}var Zn=(Zr=Object(F.injectable)(),Zr(cr=(jn=function(){function ne(){J()(this,ne),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return Ge()(ne,[{key:"init",value:function(D,U){this.container=D.container,this.scene=U,this.mapsService=U.get(B.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(D,U){var Ee=U.get(B.a.IMapService);Ee.map?(D.addTo(this.scene),this.controls.push(D)):this.unAddControls.push(D)}},{key:"getControlByName",value:function(D){return this.controls.find(function(U){return U.controlOption.name===D})}},{key:"removeControl",value:function(D){var U=this.controls.indexOf(D);return U>-1&&this.controls.splice(U,1),D.remove(),this}},{key:"addControls",value:function(){var D=this;this.unAddControls.forEach(function(U){U.addTo(D.scene),D.controls.push(U)}),this.unAddControls=[]}},{key:"destroy",value:function(){var D=En(this.controls),U;try{for(D.s();!(U=D.n()).done;){var Ee=U.value;Ee.remove()}}catch(tt){D.e(tt)}finally{D.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var D=this.controlCorners={},U="l7-",Ee=this.controlContainer=_e.a.create("div",U+"control-container",this.container);function tt(Gt,tr){var er=U+Gt+" "+U+tr;D[Gt+tr]=_e.a.create("div",er,Ee)}tt("top","left"),tt("top","right"),tt("bottom","left"),tt("bottom","right")}},{key:"clearControlPos",value:function(){for(var D in this.controlCorners)this.controlCorners[D]&&_e.a.remove(this.controlCorners[D]);this.controlContainer&&_e.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),ne}(),jn))||cr),Vn,Te,de,W=(Vn=Object(F.injectable)(),Vn(Te=(de=function(){function ne(){J()(this,ne),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return Ge()(ne,[{key:"addMarkerLayer",value:function(D){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(D),D.addTo(this.scene)):this.unAddMarkerLayers.push(D)}},{key:"removeMarkerLayer",value:function(D){D.destroy(),this.markerLayers.indexOf(D);var U=this.markerLayers.indexOf(D);U>-1&&this.markerLayers.splice(U,1)}},{key:"addMarker",value:function(D){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(D),D.addTo(this.scene)):this.unAddMarkers.push(D)}},{key:"addMarkers",value:function(){var D=this;this.unAddMarkers.forEach(function(U){U.addTo(D.scene),D.markers.push(U)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var D=this;this.unAddMarkerLayers.forEach(function(U){D.markerLayers.push(U),U.addTo(D.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(D){D.remove(),this.markers.indexOf(D);var U=this.markers.indexOf(D);U>-1&&this.markers.splice(U,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(D){this.scene=D,this.mapsService=D.get(B.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(D){D.remove()}),this.markers=[],this.markerLayers.forEach(function(D){D.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(D){D.destroy()}}]),ne}(),de))||Te),se,Le,et,wt=(se=Object(F.injectable)(),se(Le=(et=function(){function ne(){J()(this,ne),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return Ge()(ne,[{key:"removePopup",value:function(D){D.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(D){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(D.addTo(this.scene),this.popup=D):this.unAddPopup=D}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(D){this.scene=D,this.mapsService=D.get(B.a.IMapService)}}]),ne}(),et))||Le),Ne=o("QkVN"),gt=o.n(Ne),qt={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},zr=qt,Br,sr,kr;function Cn(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function dn(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?Cn(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):Cn(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}var Er={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Tn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},vn=(Br=Object(F.injectable)(),Br(sr=(kr=function(){function ne(){J()(this,ne),this.sceneConfigCache={},this.layerConfigCache={}}return Ge()(ne,[{key:"getSceneConfig",value:function(D){return this.sceneConfigCache[D]}},{key:"getSceneWarninfo",value:function(D){return zr[D]}},{key:"setSceneConfig",value:function(D,U){this.sceneConfigCache[D]=dn(dn({},Er),U)}},{key:"getLayerConfig",value:function(D){return this.layerConfigCache[D]}},{key:"setLayerConfig",value:function(D,U,Ee){this.layerConfigCache[U]=dn({},gt()({},this.sceneConfigCache[D],Tn,Ee))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),ne}(),kr))||sr),mn=o("yG8O"),Ar=o.n(mn),$r=o("U+yc"),Mn=o.n($r),Ki=o("1ABj"),vi=Math.PI/180,Mi=512,zi=4003e4;function Ka(ne){var oe=ne.latitude,D=oe===void 0?0:oe,U=ne.zoom,Ee=U===void 0?0:U,tt=ne.scale,Gt=ne.highPrecision,tr=Gt===void 0?!1:Gt,er=ne.flipY,Pr=er===void 0?!1:er;tt=tt!==void 0?tt:Math.pow(2,Ee);var Jr={},Rn=Mi*tt,Xn=Math.cos(D*vi),ri=Rn/360,wi=ri/Xn,Pi=Rn/zi/Xn;if(Jr.pixelsPerMeter=[Pi,-Pi,Pi],Jr.metersPerPixel=[1/Pi,-1/Pi,1/Pi],Jr.pixelsPerDegree=[ri,-wi,Pi],Jr.degreesPerPixel=[1/ri,-1/wi,1/Pi],tr){var ia=vi*Math.tan(D*vi)/Xn,ra=ri*ia/2,Ia=Rn/zi*ia,uo=Ia/wi*Pi;Jr.pixelsPerDegree2=[0,-ra,Ia],Jr.pixelsPerMeter2=[uo,0,uo],Pr&&(Jr.pixelsPerDegree2[1]=-Jr.pixelsPerDegree2[1],Jr.pixelsPerMeter2[1]=-Jr.pixelsPerMeter2[1])}return Pr&&(Jr.pixelsPerMeter[1]=-Jr.pixelsPerMeter[1],Jr.metersPerPixel[1]=-Jr.metersPerPixel[1],Jr.pixelsPerDegree[1]=-Jr.pixelsPerDegree[1],Jr.degreesPerPixel[1]=-Jr.degreesPerPixel[1]),Jr}var hi=o("HthE"),ya,Ii,yi,ci,Ra,xo,$a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Ko=(ya=Object(F.injectable)(),Ii=Object(F.inject)(B.a.ICameraService),ya(yi=(ci=(xo=function(){function ne(){J()(this,ne),this.needRefresh=!0,Ar()(this,"cameraService",Ra,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return Ge()(ne,[{key:"refresh",value:function(){var D=this.cameraService.getZoom(),U=this.cameraService.getZoomScale(),Ee=this.cameraService.getCenter(),tt=Ka({latitude:Ee[1],zoom:D}),Gt=tt.pixelsPerMeter,tr=tt.pixelsPerDegree;this.viewportCenter=Ee,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Gt,this.pixelsPerDegree=tr,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===hi.a.LNGLAT||this.coordinateSystem===hi.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===hi.a.LNGLAT_OFFSET?this.calculateLnglatOffset(Ee,D):this.coordinateSystem===hi.a.P20_OFFSET&&this.calculateLnglatOffset(Ee,D,U,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(D){this.coordinateSystem=D}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(D,U,Ee,tt){var Gt=Ka({latitude:D[1],zoom:U,scale:Ee,flipY:tt,highPrecision:!0}),tr=Gt.pixelsPerMeter,er=Gt.pixelsPerDegree,Pr=Gt.pixelsPerDegree2,Jr=this.cameraService.getViewMatrix(),Rn=this.cameraService.getProjectionMatrix(),Xn=Pe.b.multiply([],Rn,Jr),ri=this.cameraService.projectFlat([Math.fround(D[0]),Math.fround(D[1])],Math.pow(2,U));this.viewportCenterProjection=Pe.e.transformMat4([],[ri[0],ri[1],0,1],Xn),Jr=this.cameraService.getViewMatrixUncentered()||Jr,Xn=Pe.b.multiply([],Rn,Jr),Xn=Pe.b.multiply([],Xn,$a),this.cameraService.setViewProjectionMatrix(Xn),this.pixelsPerMeter=tr,this.pixelsPerDegree=er,this.pixelsPerDegree2=Pr}}]),ne}(),xo),Ra=Mn()(ci.prototype,"cameraService",[Ii],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ci))||yi),Uu=o("PJYZ"),Gi=o.n(Uu),Pa=o("yLV6"),ns=o.n(Pa),na=o("V1cb"),Ja,is,Ji,lo,co,Ks,wo,Zl;function $s(ne){var oe=Po();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function Po(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Bt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Fe=(Ja=Object(F.injectable)(),is=Object(F.inject)(B.a.IMapService),Ji=Object(F.inject)(B.a.ILogService),Ja(lo=(co=(Zl=function(ne){he()(D,ne);var oe=$s(D);function D(){var U;J()(this,D);for(var Ee=arguments.length,tt=new Array(Ee),Gt=0;Gt<Ee;Gt++)tt[Gt]=arguments[Gt];return U=oe.call.apply(oe,[this].concat(tt)),Ar()(U,"mapService",Ks,Gi()(U)),Ar()(U,"logger",wo,Gi()(U)),U.hammertime=void 0,U.lastClickTime=0,U.lastClickXY=[-1,-1],U.clickTimer=void 0,U.$containter=void 0,U.onDrag=function(tr){var er=U.interactionEvent(tr);er.type=Bt[er.type],U.emit(na.a.Drag,er)},U.onHammer=function(tr){tr.srcEvent.stopPropagation();var er=U.interactionEvent(tr);U.emit(na.a.Hover,er)},U.onTouch=function(tr){var er=tr.touches[0];U.onHover({x:er.pageX,y:er.pageY,type:"touch"})},U.onHover=function(tr){var er=tr.clientX,Pr=tr.clientY,Jr=er,Rn=Pr,Xn=tr.type,ri=U.mapService.getMapContainer();if(ri){var wi=ri.getBoundingClientRect(),Pi=wi.top,ia=wi.left;Jr=Jr-ia-ri.clientLeft,Rn=Rn-Pi-ri.clientTop}var ra=U.mapService.containerToLngLat([Jr,Rn]);if(Xn==="click"){if("ontouchstart"in document.documentElement)return;U.isDoubleTap(Jr,Rn,ra);return}if(Xn==="touch"){U.isDoubleTap(Jr,Rn,ra);return}Xn!=="click"&&Xn!=="dblclick"&&U.emit(na.a.Hover,{x:Jr,y:Rn,lngLat:ra,type:Xn,target:tr})},U}return Ge()(D,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(na.a.Hover)}},{key:"triggerHover",value:function(Ee){var tt=Ee.x,Gt=Ee.y;this.emit(na.a.Hover,{x:tt,y:Gt})}},{key:"triggerSelect",value:function(Ee){this.emit(na.a.Select,{featureId:Ee})}},{key:"triggerActive",value:function(Ee){this.emit(na.a.Active,{featureId:Ee})}},{key:"addEventListenerOnMap",value:function(){var Ee=this.mapService.getMapContainer();if(Ee){var tt=new ns.a.Manager(Ee);tt.add(new ns.a.Tap({event:"dblclick",taps:2})),tt.add(new ns.a.Tap({event:"click"})),tt.add(new ns.a.Pan({threshold:0,pointers:0})),tt.add(new ns.a.Press({})),tt.on("dblclick click",this.onHammer),tt.on("panstart panmove panend pancancel",this.onDrag),Ee.addEventListener("mousemove",this.onHover),Ee.addEventListener("mousedown",this.onHover,!0),Ee.addEventListener("mouseup",this.onHover),Ee.addEventListener("contextmenu",this.onHover),this.hammertime=tt,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var Ee=this.mapService.getMapContainer();Ee&&(Ee.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),Ee.removeEventListener("mousedown",this.onHover),Ee.removeEventListener("mouseup",this.onHover),Ee.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(Ee){var tt=Ee.type,Gt=Ee.pointerType,tr,er;Gt==="touch"?(er=Math.floor(Ee.pointers[0].clientY),tr=Math.floor(Ee.pointers[0].clientX)):(er=Math.floor(Ee.srcEvent.y),tr=Math.floor(Ee.srcEvent.x));var Pr=this.mapService.getMapContainer();if(Pr){var Jr=Pr.getBoundingClientRect(),Rn=Jr.top,Xn=Jr.left;tr-=Xn,er-=Rn}var ri=this.mapService.containerToLngLat([tr,er]);return{x:tr,y:er,lngLat:ri,type:tt,target:Ee.srcEvent}}},{key:"isDoubleTap",value:function(Ee,tt,Gt){var tr=this,er=new Date().getTime(),Pr="click";er-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-Ee)<10&&Math.abs(this.lastClickXY[1]-tt)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),Pr="dblclick",this.emit(na.a.Hover,{x:Ee,y:tt,lngLat:Gt,type:Pr})):(this.lastClickTime=er,this.lastClickXY=[Ee,tt],this.clickTimer=setTimeout(function(){Pr="click",tr.emit(na.a.Hover,{x:Ee,y:tt,lngLat:Gt,type:Pr})},400))}}]),D}(Z.a),Zl),Ks=Mn()(co.prototype,"mapService",[is],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wo=Mn()(co.prototype,"logger",[Ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),co))||lo),Ot=o("o0o1"),fr=o.n(Ot),rn=o("yXPU"),bn=o.n(rn),Un=o("o+pz"),Da,ao,bo,Fo,Vu,Wl,Js,Ic,Il,hs,Ns,fo;function ds(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function Qs(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?ds(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):ds(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}var lu=(Da=Object(F.injectable)(),ao=Object(F.inject)(B.a.IRendererService),bo=Object(F.inject)(B.a.IGlobalConfigService),Fo=Object(F.inject)(B.a.IInteractionService),Vu=Object(F.inject)(B.a.ILayerService),Da(Wl=(Js=(fo=function(){function ne(){var oe=this;J()(this,ne),Ar()(this,"rendererService",Ic,this),Ar()(this,"configService",Il,this),Ar()(this,"interactionService",hs,this),Ar()(this,"layerService",Ns,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(D,U){var Ee,tt=U.x,Gt=U.y,tr=U.lngLat,er=U.type,Pr=U.target,Jr=!1,Rn=oe.rendererService,Xn=Rn.getViewportSize,ri=Rn.readPixels,wi=Rn.getContainer,Pi=wi().getBoundingClientRect(),ia=Pi.width,ra=Pi.height;ia*=_e.a.DPR,ra*=_e.a.DPR;var Ia=D.getLayerConfig(),uo=Ia.enableHighlight,eo=Ia.enableSelect,Na=tt*_e.a.DPR,vo=Gt*_e.a.DPR;if(Na>ia-1*_e.a.DPR||Na<0||vo>ra-1*_e.a.DPR||vo<0)return!1;var Fi;if(Fi=ri({x:Math.floor(Na/oe.pickBufferScale),y:Math.floor((ra-(Gt+1)*_e.a.DPR)/oe.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:oe.pickingFBO}),Fi[0]!==0||Fi[1]!==0||Fi[2]!==0){var to=Object(_e.k)(Fi),us=D.getSource().getFeatureById(to);to!==D.getCurrentPickId()&&er==="mousemove"&&(er="mouseenter");var va={x:tt,y:Gt,type:er,lngLat:tr,featureId:to,feature:us,target:Pr};us&&(Jr=!0,D.setCurrentPickId(to),oe.triggerHoverOnLayer(D,va))}else{var Aa={x:tt,y:Gt,lngLat:tr,type:D.getCurrentPickId()!==null&&er==="mousemove"?"mouseout":"un"+er,featureId:null,target:Pr,feature:null};oe.triggerHoverOnLayer(D,Qs(Qs({},Aa),{},{type:"unpick"})),oe.triggerHoverOnLayer(D,Aa),D.setCurrentPickId(null)}if(uo&&oe.highlightPickedFeature(D,Fi),eo&&er==="click"&&((Ee=Fi)===null||Ee===void 0?void 0:Ee.toString())!==[0,0,0,0].toString()){var mi=Object(_e.k)(Fi);D.getCurrentSelectedId()===null||mi!==D.getCurrentSelectedId()?(oe.selectFeature(D,Fi),D.setCurrentSelectedId(mi)):(oe.selectFeature(D,new Uint8Array([0,0,0,0])),D.setCurrentSelectedId(null))}return Jr}}return Ge()(ne,[{key:"init",value:function(D){var U=this.rendererService,Ee=U.createTexture2D,tt=U.createFramebuffer,Gt=U.getViewportSize,tr=U.getContainer,er=tr().getBoundingClientRect(),Pr=er.width,Jr=er.height;Pr*=_e.a.DPR,Jr*=_e.a.DPR,this.pickBufferScale=this.configService.getSceneConfig(D).pickBufferScale||1,this.pickingFBO=tt({color:Ee({width:Math.round(Pr/this.pickBufferScale),height:Math.round(Jr/this.pickBufferScale),wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})}),this.interactionService.on(na.a.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var oe=bn()(fr.a.mark(function U(Ee,tt,Gt){var tr=this,er,Pr,Jr,Rn;return fr.a.wrap(function(ri){for(;;)switch(ri.prev=ri.next){case 0:er=this.rendererService,Pr=er.useFramebuffer,Jr=er.clear,Rn=er.getContainer,this.resizePickingFBO(),Pr(this.pickingFBO,function(){Jr({framebuffer:tr.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Ee.hooks.beforePickingEncode.call(),Ee.renderModels(),Ee.hooks.afterPickingEncode.call();var wi=tr.pickBox(Ee,tt);Gt(wi)});case 3:case"end":return ri.stop()}},U,this)}));function D(U,Ee,tt){return oe.apply(this,arguments)}return D}()},{key:"pickBox",value:function(D,U){var Ee=this,tt=U.map(function(Aa){var mi=Aa<0?0:Aa;return Math.floor(mi*_e.a.DPR/Ee.pickBufferScale)}),Gt=vt()(tt,4),tr=Gt[0],er=Gt[1],Pr=Gt[2],Jr=Gt[3],Rn=this.rendererService,Xn=Rn.getViewportSize,ri=Rn.readPixels,wi=Rn.getContainer,Pi=wi().getBoundingClientRect(),ia=Pi.width,ra=Pi.height;if(ia*=_e.a.DPR,ra*=_e.a.DPR,tr>(ia-1)*_e.a.DPR/this.pickBufferScale||Pr<0||er>(ra-1)*_e.a.DPR/this.pickBufferScale||Jr<0)return[];var Ia,uo=Math.min(ia/this.pickBufferScale,Pr)-tr,eo=Math.min(ra/this.pickBufferScale,Jr)-er;Ia=ri({x:tr,y:Math.floor(ra/this.pickBufferScale-(Jr+1)),width:uo,height:eo,data:new Uint8Array(uo*eo*4),framebuffer:this.pickingFBO});for(var Na=[],vo={},Fi=0;Fi<Ia.length/4;Fi=Fi+1){var to=Ia.slice(Fi*4,Fi*4+4),us=Object(_e.k)(to);if(us!==-1&&!vo[us]){var va=D.getSource().getFeatureById(us);Na.push(va),vo[us]=!0}}return Na}},{key:"pickingAllLayer",value:function(){var oe=bn()(fr.a.mark(function U(Ee){return fr.a.wrap(function(Gt){for(;;)switch(Gt.prev=Gt.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){Gt.next=2;break}return Gt.abrupt("return");case 2:return this.alreadyInPicking=!0,Gt.next=5,this.pickingLayers(Ee);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return Gt.stop()}},U,this)}));function D(U){return oe.apply(this,arguments)}return D}()},{key:"resizePickingFBO",value:function(){var D=this.rendererService.getContainer,U=D().getBoundingClientRect(),Ee=U.width,tt=U.height;Ee*=_e.a.DPR,tt*=_e.a.DPR,(this.width!==Ee||this.height!==tt)&&(this.pickingFBO.resize({width:Math.round(Ee/this.pickBufferScale),height:Math.round(tt/this.pickBufferScale)}),this.width=Ee,this.height=tt)}},{key:"pickingLayers",value:function(){var oe=bn()(fr.a.mark(function U(Ee){var tt=this,Gt,tr,er,Pr,Jr;return fr.a.wrap(function(Xn){for(;;)switch(Xn.prev=Xn.next){case 0:Gt=this.rendererService,tr=Gt.getViewportSize,er=Gt.useFramebuffer,Pr=Gt.clear,Jr=Gt.getContainer,this.resizePickingFBO(),er(this.pickingFBO,function(){var ri=tt.layerService.getLayers();ri.filter(function(wi){return wi.needPick(Ee.type)}).reverse().some(function(wi){Pr({framebuffer:tt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),wi.hooks.beforePickingEncode.call(),wi.renderModels(),wi.hooks.afterPickingEncode.call();var Pi=tt.pickFromPickingFBO(wi,Ee);return Pi&&!wi.getLayerConfig().enablePropagation})});case 3:case"end":return Xn.stop()}},U,this)}));function D(U){return oe.apply(this,arguments)}return D}()},{key:"triggerHoverOnLayer",value:function(D,U){D.emit(U.type,U)}},{key:"highlightPickedFeature",value:function(D,U){var Ee=vt()(U,3),tt=Ee[0],Gt=Ee[1],tr=Ee[2];D.hooks.beforeHighlight.call([tt,Gt,tr])}},{key:"selectFeature",value:function(D,U){var Ee=vt()(U,3),tt=Ee[0],Gt=Ee[1],tr=Ee[2];D.hooks.beforeSelect.call([tt,Gt,tr])}}]),ne}(),fo),Ic=Mn()(Js.prototype,"rendererService",[ao],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Il=Mn()(Js.prototype,"configService",[bo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hs=Mn()(Js.prototype,"interactionService",[Fo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ns=Mn()(Js.prototype,"layerService",[Vu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Js))||Wl),Xl=function(){function ne(){var oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;J()(this,ne),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=oe}return Ge()(ne,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var D=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var U=(typeof performance=="undefined"?Date:performance).now();D=(U-this.oldTime)/1e3,this.oldTime=U,this.elapsedTime+=D}return D}}]),ne}(),xa,ka,ml,Fs,ps,It,ir,Mr,Gn=(xa=Object(F.injectable)(),ka=Object(F.inject)(B.a.IRendererService),ml=Object(F.inject)(B.a.IGlobalConfigService),xa(Fs=(ps=(Mr=function(){function ne(){J()(this,ne),this.clock=new Xl,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,Ar()(this,"renderService",It,this),Ar()(this,"configService",ir,this)}return Ge()(ne,[{key:"add",value:function(D){this.sceneInited&&D.init(),this.layers.push(D)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(D){D.inited||D.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(D){return this.layers.find(function(U){return U.id===D})}},{key:"getLayerByName",value:function(D){return this.layers.find(function(U){return U.name===D})}},{key:"remove",value:function(D){var U=this.layers.indexOf(D);U>-1&&this.layers.splice(U,1),D.emit("remove",null),D.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(D){return D.inited}).filter(function(D){return D.isVisible()}).forEach(function(D){D.hooks.beforeRenderData.call(),D.hooks.beforeRender.call(),D.render(),D.hooks.afterRender.call()}),this.alreadyInRendering=!1)}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(D,U){return D.zIndex-U.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(D){return D.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++==0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount==0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),ne}(),Mr),It=Mn()(ps.prototype,"renderService",[ka],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ir=Mn()(ps.prototype,"configService",[ml],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ps))||Fs),Qi=o("QILm"),za=o.n(Qi),Za=o("RIqP"),qi=o.n(Za),ba=o("J2iB"),_o=o.n(ba),Bs=function(){function ne(oe){var D=this;J()(this,ne),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(U){if(U.length===0){var Ee;return((Ee=D.scale)===null||Ee===void 0?void 0:Ee.defaultValues)||[]}return U.map(function(tt,Gt){var tr,er=(tr=D.scale)===null||tr===void 0?void 0:tr.scalers[Gt].func,Pr=er(tt);return Pr})},this.setProps(oe)}return Ge()(ne,[{key:"setProps",value:function(D){Object.assign(this,D)}},{key:"mapping",value:function(D){var U;if((U=this.scale)===null||U===void 0?void 0:U.callback){var Ee,tt=(Ee=this.scale)===null||Ee===void 0?void 0:Ee.callback.apply(Ee,qi()(D));if(!_o()(tt))return[tt]}return this.defaultCallback(D)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),ne}(),ha,Yl,cu,_s,gl,fu,Gu;function qs(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function rl(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?qs(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):qs(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}function hu(ne){return new Promise(function(oe){return setTimeout(oe,ne)})}var pc=(ha={},re()(ha,Un.a.FLOAT,4),re()(ha,Un.a.UNSIGNED_BYTE,1),re()(ha,Un.a.UNSIGNED_SHORT,2),ha),_f=(Yl=Object(F.injectable)(),cu=Object(F.inject)(B.a.IRendererService),Yl(_s=(gl=(Gu=function(){function ne(){J()(this,ne),this.attributesAndIndices=void 0,Ar()(this,"rendererService",fu,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return Ge()(ne,[{key:"registerStyleAttribute",value:function(D){var U=this.getLayerStyleAttribute(D.name||"");return U?U.setProps(D):(U=new Bs(D),this.attributes.push(U)),U}},{key:"updateStyleAttribute",value:function(D,U,Ee){var tt=this.getLayerStyleAttribute(D);tt||(tt=this.registerStyleAttribute(rl(rl({},U),{},{name:D})));var Gt=U.scale;Gt&&tt&&(tt.scale=Gt,tt.needRescale=!0,tt.needRemapping=!0,tt.needRegenerateVertices=!0,Ee&&Ee.featureRange&&(tt.featureRange=Ee.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(D){return this.attributes.find(function(U){return U.name===D})}},{key:"getLayerAttributeScale",value:function(D){var U,Ee=this.getLayerStyleAttribute(D),tt=Ee==null||(U=Ee.scale)===null||U===void 0?void 0:U.scalers;return tt&&tt[0]?tt[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(D,U){var Ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,tt=arguments.length>3?arguments[3]:void 0,Gt=this.attributes.find(function(eo){return eo.name===D});if(Gt&&Gt.descriptor){var tr=Gt.descriptor,er=tr.update,Pr=tr.buffer,Jr=tr.size,Rn=Jr===void 0?0:Jr,Xn=pc[Pr.type||Un.a.FLOAT];if(er){var ri=this.featureLayout,wi=ri.elements,Pi=ri.sizePerElement,ia=wi.slice(Ee,tt);if(!ia.length)return;var ra=ia[0].offset,Ia=ra*Rn*Xn,uo=ia.map(function(eo,Na){for(var vo=eo.featureIdx,Fi=eo.vertices,to=eo.normals,us=Fi.length/Pi,va=[],Aa=0;Aa<us;Aa++){var mi=to?to.slice(Aa*3,Aa*3+3):[];va.push.apply(va,qi()(er(U[vo],vo,Fi.slice(Aa*Pi,Aa*Pi+Pi),Na,mi)))}return va}).reduce(function(eo,Na){return eo.push.apply(eo,qi()(Na)),eo},[]);Gt.vertexAttribute.updateBuffer({data:uo,offset:Ia})}}}},{key:"createAttributesAndIndices",value:function(D,U){var Ee=this;this.featureLayout={sizePerElement:0,elements:[]},U&&(this.triangulation=U);var tt=this.attributes.map(function(ra){return ra.resetDescriptor(),ra.descriptor}),Gt=0,tr=[],er=[],Pr=[],Jr=3;D.forEach(function(ra,Ia){var uo=Ee.triangulation(ra),eo=uo.indices,Na=uo.vertices,vo=uo.normals,Fi=uo.size;eo.forEach(function(Aa){er.push(Aa+Gt)}),Jr=Fi;var to=Na.length/Fi;Ee.featureLayout.sizePerElement=Jr,Ee.featureLayout.elements.push({featureIdx:Ia,vertices:Na,normals:vo,offset:Gt}),Gt+=to;for(var us=function(mi){var zo=(vo==null?void 0:vo.slice(mi*3,mi*3+3))||[],fc=Na.slice(mi*Fi,mi*Fi+Fi);tt.forEach(function(Wf,fh){if(Wf&&Wf.update){var Xf;(Xf=Wf.buffer.data).push.apply(Xf,qi()(Wf.update(ra,Ia,fc,mi,zo)))}})},va=0;va<to;va++)us(va)});var Rn=this.rendererService,Xn=Rn.createAttribute,ri=Rn.createBuffer,wi=Rn.createElements,Pi={};tt.forEach(function(ra,Ia){if(ra){var uo=ra.buffer,eo=ra.update,Na=ra.name,vo=za()(ra,["buffer","update","name"]),Fi=Xn(rl({buffer:ri(uo)},vo));Pi[ra.name||""]=Fi,Ee.attributes[Ia].vertexAttribute=Fi}});var ia=wi({data:er,type:Un.a.UNSIGNED_INT,count:er.length});return this.attributesAndIndices={attributes:Pi,elements:ia},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var D;this.attributes.forEach(function(U){U.vertexAttribute&&U.vertexAttribute.destroy()}),(D=this.attributesAndIndices)===null||D===void 0||D.elements.destroy(),this.attributes=[]}}]),ne}(),Gu),fu=Mn()(gl.prototype,"rendererService",[cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gl))||_s),da=o("U8pU"),Oc=o("KQm4"),vc=o("rePB"),qc=o("1OyB"),ef=o("vuIU"),tf=o("5ku3"),Qa=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",Au=Object(tf.a)();function eu(ne){try{var oe=window[ne],D="__storage_test__";return oe.setItem(D,D),oe.removeItem(D),oe}catch(U){return null}}var vs=function(){function ne(oe,D){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Object(qc.a)(this,ne),this.storage=eu(U),this.id=oe,this.config={},Object.assign(this.config,D),this._loadConfiguration()}return Object(ef.a)(ne,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(D){return this.config={},this.updateConfiguration(D)}},{key:"updateConfiguration",value:function(D){if(Object.assign(this.config,D),this.storage){var U=JSON.stringify(this.config);this.storage.setItem(this.id,U)}return this}},{key:"_loadConfiguration",value:function(){var D={};if(this.storage){var U=this.storage.getItem(this.id);D=U?JSON.parse(U):{}}return Object.assign(this.config,D),this}}]),ne}();function Lc(ne){var oe;return ne<10?oe="".concat(ne.toFixed(2),"ms"):ne<100?oe="".concat(ne.toFixed(1),"ms"):ne<1e3?oe="".concat(ne.toFixed(0),"ms"):oe="".concat((ne/1e3).toFixed(2),"s"),oe}function mc(ne){var oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,D=Math.max(oe-ne.length,0);return"".concat(" ".repeat(D)).concat(ne)}function yl(ne){var oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,D=Math.max(oe-ne.length,0);return"".concat(ne).concat(" ".repeat(D))}function nl(ne){var oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=1e-16,U=oe.isInteger,Ee=U===void 0?!1:U;if(Array.isArray(ne)||ArrayBuffer.isView(ne))return gc(ne,oe);if(!Number.isFinite(ne))return String(ne);if(Math.abs(ne)<D)return Ee?"0":"0.";if(Ee||Math.abs(ne)>100&&Math.abs(ne)<1e4)return ne.toFixed(0);var tt=ne.toPrecision(2),Gt=tt.indexOf(".0");return Gt===tt.length-2?tt.slice(0,-1):tt}function gc(ne,oe){for(var D=oe.maxElts,U=D===void 0?16:D,Ee=oe.size,tt=Ee===void 0?1:Ee,Gt="[",tr=0;tr<ne.length&&tr<U;++tr)tr>0&&(Gt+=",".concat(tr%tt==0?" ":"")),Gt+=nl(ne[tr],oe);var er=ne.length>U?"...":"]";return"".concat(Gt).concat(er)}function tu(ne,oe,D){var U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,Ee=ne.src.replace(/\(/g,"%28").replace(/\)/g,"%29");ne.width>U&&(D=Math.min(D,U/ne.width));var tt=ne.width*D,Gt=ne.height*D,tr=["font-size:1px;","padding:".concat(Math.floor(Gt/2),"px ").concat(Math.floor(tt/2),"px;"),"line-height:".concat(Gt,"px;"),"background:url(".concat(Ee,");"),"background-size:".concat(tt,"px ").concat(Gt,"px;"),"color:transparent;"].join("");return["".concat(oe," %c+"),tr]}var Hu={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Rc(ne){return typeof ne=="string"?Hu[ne.toUpperCase()]||Hu.WHITE:ne}function Kl(ne,oe,D){return!Au&&typeof ne=="string"&&(oe&&(oe=Rc(oe),ne="[".concat(oe,"m").concat(ne,"[39m")),D&&(oe=Rc(D),ne="[".concat(D+10,"m").concat(ne,"[49m"))),ne}function _a(ne){if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(ne=Dc(ne))){var oe=0,D=function(){};return{s:D,n:function(){return oe>=ne.length?{done:!0}:{done:!1,value:ne[oe++]}},e:function(er){throw er},f:D}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var U,Ee=!0,tt=!1,Gt;return{s:function(){U=ne[Symbol.iterator]()},n:function(){var er=U.next();return Ee=er.done,er},e:function(er){tt=!0,Gt=er},f:function(){try{!Ee&&U.return!=null&&U.return()}finally{if(tt)throw Gt}}}}function Dc(ne,oe){if(!!ne){if(typeof ne=="string")return Mf(ne,oe);var D=Object.prototype.toString.call(ne).slice(8,-1);if(D==="Object"&&ne.constructor&&(D=ne.constructor.name),D==="Map"||D==="Set")return Array.from(D);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return Mf(ne,oe)}}function Mf(ne,oe){(oe==null||oe>ne.length)&&(oe=ne.length);for(var D=0,U=new Array(oe);D<oe;D++)U[D]=ne[D];return U}function yc(ne){var oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],D=Object.getPrototypeOf(ne),U=Object.getOwnPropertyNames(D),Ee=_a(U),tt;try{var Gt=function(){var er=tt.value;typeof ne[er]=="function"&&(oe.find(function(Pr){return er===Pr})||(ne[er]=ne[er].bind(ne)))};for(Ee.s();!(tt=Ee.n()).done;)Gt()}catch(tr){Ee.e(tr)}finally{Ee.f()}}function zc(ne,oe){if(!ne)throw new Error(oe||"Assertion failed")}var $l=o("K9nA");function Zu(){var ne;if(Au&&$l.b.performance)ne=$l.b.performance.now();else if($l.a.hrtime){var oe=$l.a.hrtime();ne=oe[0]*1e3+oe[1]/1e6}else ne=Date.now();return ne}var Cu={debug:Au&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Ol={enabled:!0,level:0};function Bo(){}var Jl={},Ll={once:!0};function xl(ne){for(var oe in ne)for(var D in ne[oe])return D||"untitled";return"empty"}var Nc=function(){function ne(){var oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},D=oe.id;Object(qc.a)(this,ne),this.id=D,this.VERSION=Qa,this._startTs=Zu(),this._deltaTs=Zu(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new vs("__probe-".concat(this.id,"__"),Ol),this.userData={},this.timeStamp("".concat(this.id," started")),yc(this),Object.seal(this)}return Object(ef.a)(ne,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Zu()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Zu()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:D}),this}},{key:"setLevel",value:function(D){return this._storage.updateConfiguration({level:D}),this}},{key:"assert",value:function(D,U){zc(D,U)}},{key:"warn",value:function(D){return this._getLogFunction(0,D,Cu.warn,arguments,Ll)}},{key:"error",value:function(D){return this._getLogFunction(0,D,Cu.error,arguments)}},{key:"deprecated",value:function(D,U){return this.warn("`".concat(D,"` is deprecated and will be removed in a later version. Use `").concat(U,"` instead"))}},{key:"removed",value:function(D,U){return this.error("`".concat(D,"` has been removed. Use `").concat(U,"` instead"))}},{key:"probe",value:function(D,U){return this._getLogFunction(D,U,Cu.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(D,U){return this._getLogFunction(D,U,Cu.debug,arguments)}},{key:"info",value:function(D,U){return this._getLogFunction(D,U,console.info,arguments)}},{key:"once",value:function(D,U){return this._getLogFunction(D,U,Cu.debug||Cu.info,arguments,Ll)}},{key:"table",value:function(D,U,Ee){return U?this._getLogFunction(D,U,console.table||Bo,Ee&&[Ee],{tag:xl(U)}):Bo}},{key:"image",value:function(D){var U=D.logLevel,Ee=D.priority,tt=D.image,Gt=D.message,tr=Gt===void 0?"":Gt,er=D.scale,Pr=er===void 0?1:er;return this._shouldLog(U||Ee)?Au?rf({image:tt,message:tr,scale:Pr}):gf({image:tt,message:tr,scale:Pr}):Bo}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(D){return this._storage.config[D]}},{key:"set",value:function(D,U){this._storage.updateConfiguration(Object(vc.a)({},D,U))}},{key:"time",value:function(D,U){return this._getLogFunction(D,U,console.time?console.time:console.info)}},{key:"timeEnd",value:function(D,U){return this._getLogFunction(D,U,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(D,U){return this._getLogFunction(D,U,console.timeStamp||Bo)}},{key:"group",value:function(D,U){var Ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};Ee=ru({logLevel:D,message:U,opts:Ee});var tt=Ee,Gt=tt.collapsed;return Ee.method=(Gt?console.groupCollapsed:console.group)||console.info,this._getLogFunction(Ee)}},{key:"groupCollapsed",value:function(D,U){var Ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(D,U,Object.assign({},Ee,{collapsed:!0}))}},{key:"groupEnd",value:function(D){return this._getLogFunction(D,"",console.groupEnd||Bo)}},{key:"withGroup",value:function(D,U,Ee){this.group(D,U)();try{Ee()}finally{this.groupEnd(D)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(D){return this.isEnabled()&&this.getLevel()>=Rl(D)}},{key:"_getLogFunction",value:function(D,U,Ee){var tt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],Gt=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(D)){var tr;Gt=ru({logLevel:D,message:U,args:tt,opts:Gt}),Ee=Ee||Gt.method,zc(Ee),Gt.total=this.getTotal(),Gt.delta=this.getDelta(),this._deltaTs=Zu();var er=Gt.tag||Gt.message;if(Gt.once)if(!Jl[er])Jl[er]=Zu();else return Bo;return U=mf(this.id,Gt.message,Gt),(tr=Ee).bind.apply(tr,[console,U].concat(Object(Oc.a)(Gt.args)))}return Bo}},{key:"level",set:function(D){this.setLevel(D)},get:function(){return this.getLevel()}},{key:"priority",set:function(D){this.level=D},get:function(){return this.level}}]),ne}();Nc.VERSION=Qa;function Rl(ne){if(!ne)return 0;var oe;switch(Object(da.a)(ne)){case"number":oe=ne;break;case"object":oe=ne.logLevel||ne.priority||0;break;default:return 0}return zc(Number.isFinite(oe)&&oe>=0),oe}function ru(ne){var oe=ne.logLevel,D=ne.message;ne.logLevel=Rl(oe);for(var U=ne.args?Array.from(ne.args):[];U.length&&U.shift()!==D;);switch(ne.args=U,Object(da.a)(oe)){case"string":case"function":D!==void 0&&U.unshift(D),ne.message=oe;break;case"object":Object.assign(ne,oe);break;default:}typeof ne.message=="function"&&(ne.message=ne.message());var Ee=Object(da.a)(ne.message);return zc(Ee==="string"||Ee==="object"),Object.assign(ne,ne.opts)}function mf(ne,oe,D){if(typeof oe=="string"){var U=D.time?mc(Lc(D.total)):"";oe=D.time?"".concat(ne,": ").concat(U,"  ").concat(oe):"".concat(ne,": ").concat(oe),oe=Kl(oe,D.color,D.background)}return oe}function gf(ne){var oe=ne.image,D=ne.message,U=D===void 0?"":D,Ee=ne.scale,tt=Ee===void 0?1:Ee,Gt=null;try{Gt=o(2)}catch(tr){}return Gt?function(){return Gt(oe,{fit:"box",width:"".concat(Math.round(80*tt),"%")}).then(function(tr){return console.log(tr)})}:Bo}function rf(ne){var oe=ne.image,D=ne.message,U=D===void 0?"":D,Ee=ne.scale,tt=Ee===void 0?1:Ee;if(typeof oe=="string"){var Gt=new Image;return Gt.onload=function(){var Jr,Rn=tu(Gt,U,tt);(Jr=console).log.apply(Jr,Object(Oc.a)(Rn))},Gt.src=oe,Bo}var tr=oe.nodeName||"";if(tr.toLowerCase()==="img"){var er;return(er=console).log.apply(er,Object(Oc.a)(tu(oe,U,tt))),Bo}if(tr.toLowerCase()==="canvas"){var Pr=new Image;return Pr.onload=function(){var Jr;return(Jr=console).log.apply(Jr,Object(Oc.a)(tu(Pr,U,tt)))},Pr.src=oe.toDataURL(),Bo}return Bo}var bl,ja,il=new Nc({id:"L7"}).enable(!1);il.priority=5;var Dl=(bl=Object(F.injectable)(),bl(ja=function(){function ne(){J()(this,ne)}return Ge()(ne,[{key:"error",value:function(D){il.error(D)()}},{key:"warn",value:function(D){il.probe(1,D)()}},{key:"info",value:function(D){il.info(3,D)()}},{key:"debug",value:function(D){il.probe(4,D)()}}]),ne}())||ja),xc=o("xp6e"),Fc=o("iegG"),zl=o.n(Fc),If=window.document.documentElement.style,Of=0;function nf(ne){var oe=ne;if(typeof ne=="string"&&(oe=document.getElementById(ne)),oe){var D=document.createElement("div");return D.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,D.id="l7-scene-".concat(Of++),D.classList.add("l7-scene"),oe.appendChild(D),D}return null}var Sl,Ql,wu,ks,al,Bc,Wu,Ua,du,ol,sl,Ni,pa,Ms,Ea,Zi,ql,yf,as,ul,pu,Xu,oo,os,Nl,ho,In,js,bc,El,Pu,Us,ea,en,kc,Sc;function ll(ne){var oe=vu();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function vu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Is=(Sl=Object(F.injectable)(),Ql=Object(F.inject)(B.a.SceneID),wu=Object(F.inject)(B.a.IIconService),ks=Object(F.inject)(B.a.IFontService),al=Object(F.inject)(B.a.IControlService),Bc=Object(F.inject)(B.a.ILogService),Wu=Object(F.inject)(B.a.IGlobalConfigService),Ua=Object(F.inject)(B.a.IMapService),du=Object(F.inject)(B.a.ICoordinateSystemService),ol=Object(F.inject)(B.a.IRendererService),sl=Object(F.inject)(B.a.ILayerService),Ni=Object(F.inject)(B.a.ICameraService),pa=Object(F.inject)(B.a.IInteractionService),Ms=Object(F.inject)(B.a.IPickingService),Ea=Object(F.inject)(B.a.IShaderModuleService),Zi=Object(F.inject)(B.a.IMarkerService),ql=Object(F.inject)(B.a.IPopupService),Sl(yf=(as=(Sc=function(ne){he()(D,ne);var oe=ll(D);function D(){var U;return J()(this,D),U=oe.call(this),U.destroyed=!1,U.loaded=!1,Ar()(U,"id",ul,Gi()(U)),Ar()(U,"iconService",pu,Gi()(U)),Ar()(U,"fontService",Xu,Gi()(U)),Ar()(U,"controlService",oo,Gi()(U)),Ar()(U,"logger",os,Gi()(U)),Ar()(U,"configService",Nl,Gi()(U)),Ar()(U,"map",ho,Gi()(U)),Ar()(U,"coordinateSystemService",In,Gi()(U)),Ar()(U,"rendererService",js,Gi()(U)),Ar()(U,"layerService",bc,Gi()(U)),Ar()(U,"cameraService",El,Gi()(U)),Ar()(U,"interactionService",Pu,Gi()(U)),Ar()(U,"pickingService",Us,Gi()(U)),Ar()(U,"shaderModuleService",ea,Gi()(U)),Ar()(U,"markerService",en,Gi()(U)),Ar()(U,"popupService",kc,Gi()(U)),U.inited=!1,U.initPromise=void 0,U.rendering=!1,U.$container=void 0,U.canvas=void 0,U.markerContainer=void 0,U.hooks=void 0,U.handleWindowResized=function(){U.emit("resize"),U.$container&&(U.initContainer(),_e.a.triggerResize(),U.coordinateSystemService.needRefresh=!0,U.render())},U.handleMapCameraChanged=function(Ee){U.cameraService.update(Ee),U.render()},U.hooks={init:new xc.a},U}return Ge()(D,[{key:"init",value:function(Ee){var tt=this;this.configService.setSceneConfig(this.id,Ee),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",bn()(fr.a.mark(function Gt(){return fr.a.wrap(function(er){for(;;)switch(er.prev=er.next){case 0:return er.next=2,new Promise(function(Pr){tt.map.onCameraChanged(function(Jr){tt.cameraService.init(),tt.cameraService.update(Jr),Pr()}),tt.map.init()});case 2:tt.map.onCameraChanged(tt.handleMapCameraChanged),tt.map.addMarkerContainer(),tt.markerService.addMarkers(),tt.markerService.addMarkerLayers(),tt.popupService.initPopup(),tt.interactionService.init(),tt.interactionService.on(na.a.Drag,tt.addSceneEvent.bind(tt)),tt.logger.debug("map ".concat(tt.id," loaded"));case 10:case"end":return er.stop()}},Gt)}))),this.hooks.init.tapPromise("initRenderer",bn()(fr.a.mark(function Gt(){var tr;return fr.a.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:if(tr=nf(tt.configService.getSceneConfig(tt.id).id||""),tt.$container=tr,!tr){Pr.next=11;break}return tt.canvas=_e.a.create("canvas","",tr),tt.setCanvas(),Pr.next=7,tt.rendererService.init(tt.canvas,tt.configService.getSceneConfig(tt.id));case 7:zl()(tt.$container,tt.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(tt.handleWindowResized),Pr.next=12;break;case 11:tt.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:tt.pickingService.init(tt.id),tt.logger.debug("scene ".concat(tt.id," renderer loaded"));case 14:case"end":return Pr.stop()}},Gt)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(Ee){this.logger.debug("add layer ".concat(Ee.name," to scene ").concat(this.id)),this.layerService.add(Ee),this.render()}},{key:"render",value:function(){var U=bn()(fr.a.mark(function tt(){return fr.a.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:if(!(this.rendering||this.destroyed)){tr.next=2;break}return tr.abrupt("return");case 2:if(this.rendering=!0,this.inited){tr.next=13;break}return tr.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return tr.stop()}},tt,this)}));function Ee(){return U.apply(this,arguments)}return Ee}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(Ee){var tt,Gt=(tt=this.$container)===null||tt===void 0?void 0:tt.getElementsByTagName("canvas")[0];this.render();var tr=Ee==="jpg"?Gt==null?void 0:Gt.toDataURL("image/jpeg"):Gt==null?void 0:Gt.toDataURL("image/png");return tr}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var Ee=this.$container.parentElement;Ee!==null&&(this.markerContainer=_e.a.create("div","l7-marker-container",Ee))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(Fc.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var Ee,tt,Gt=_e.a.DPR,tr=((Ee=this.$container)===null||Ee===void 0?void 0:Ee.clientWidth)||400,er=((tt=this.$container)===null||tt===void 0?void 0:tt.clientHeight)||300,Pr=this.canvas;Pr&&(Pr.width=tr*Gt,Pr.height=er*Gt,Pr.style.width="".concat(tr,"px"),Pr.style.height="".concat(er,"px")),this.rendererService.viewport({x:0,y:0,width:Gt*tr,height:Gt*er})}},{key:"setCanvas",value:function(){var Ee,tt,Gt=_e.a.DPR,tr=((Ee=this.$container)===null||Ee===void 0?void 0:Ee.clientWidth)||400,er=((tt=this.$container)===null||tt===void 0?void 0:tt.clientHeight)||300,Pr=this.canvas;Pr.width=tr*Gt,Pr.height=er*Gt,Pr.style.width="".concat(tr,"px"),Pr.style.height="".concat(er,"px")}},{key:"addSceneEvent",value:function(Ee){this.emit(Ee.type,Ee)}}]),D}(v.EventEmitter),Sc),ul=Mn()(as.prototype,"id",[Ql],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pu=Mn()(as.prototype,"iconService",[wu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xu=Mn()(as.prototype,"fontService",[ks],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oo=Mn()(as.prototype,"controlService",[al],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),os=Mn()(as.prototype,"logger",[Bc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nl=Mn()(as.prototype,"configService",[Wu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ho=Mn()(as.prototype,"map",[Ua],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=Mn()(as.prototype,"coordinateSystemService",[du],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),js=Mn()(as.prototype,"rendererService",[ol],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bc=Mn()(as.prototype,"layerService",[sl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),El=Mn()(as.prototype,"cameraService",[Ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pu=Mn()(as.prototype,"interactionService",[pa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us=Mn()(as.prototype,"pickingService",[Ms],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ea=Mn()(as.prototype,"shaderModuleService",[Ea],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),en=Mn()(as.prototype,"markerService",[Zi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kc=Mn()(as.prototype,"popupService",[ql],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as))||yf),Os=o("7tbW"),$o=o.n(Os);function ko(ne){var oe=0;switch(ne){case"vec2":case"ivec2":oe=2;break;case"vec3":case"ivec3":oe=3;break;case"vec4":case"ivec4":case"mat2":oe=4;break;case"mat3":oe=9;break;case"mat4":oe=16;break;default:}return oe}var cl=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Tl(ne){var oe={};return ne=ne.replace(cl,function(D,U,Ee){var tt=Ee.split(":"),Gt=tt[0].trim(),tr="";switch(tt.length>1&&(tr=tt[1].trim()),U){case"bool":tr=tr==="true";break;case"float":case"int":tr=Number(tr);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":tr?tr=tr.replace("[","").replace("]","").split(",").reduce(function(er,Pr){return er.push(Number(Pr.trim())),er},[]):tr=new Array(ko(U)).fill(0);break;default:}return oe[Gt]=tr,"uniform ".concat(U," ").concat(Gt,`;
`)}),{content:ne,uniforms:oe}}var Fl,af,Bl;function Ls(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function ss(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?Ls(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):Ls(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}var Oi="#define PI 3.14159265359",Yu=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Va=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,Mo=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Al=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,mu=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}
`,gu=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}
`,Ts=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }
  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

`,Ec=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,$n=/precision\s+(high|low|medium)p\s+float/,Fn=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,Tc=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,ms=(Fl=Object(F.injectable)(),Fl(af=(Bl=function(){function ne(){J()(this,ne),this.moduleCache={},this.rawContentCache={}}return Ge()(ne,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Oi,fs:Oi}),this.registerModule("decode",{vs:Yu,fs:""}),this.registerModule("projection",{vs:Ts,fs:""}),this.registerModule("project",{vs:gu,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:Ec}),this.registerModule("lighting",{vs:Mo,fs:""}),this.registerModule("light",{vs:Va,fs:""}),this.registerModule("picking",{vs:mu,fs:Al})}},{key:"registerModule",value:function(D,U){if(!this.rawContentCache[D]){var Ee=U.vs,tt=U.fs,Gt=U.uniforms,tr=Tl(Ee),er=tr.content,Pr=tr.uniforms,Jr=Tl(tt),Rn=Jr.content,Xn=Jr.uniforms;this.rawContentCache[D]={fs:Rn,uniforms:ss(ss(ss({},Pr),Xn),Gt),vs:er}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(D){var U=this;if(this.moduleCache[D])return this.moduleCache[D];var Ee=this.rawContentCache[D].vs,tt=this.rawContentCache[D].fs,Gt=this.processModule(Ee,[],"vs"),tr=Gt.content,er=Gt.includeList,Pr=this.processModule(tt,[],"fs"),Jr=Pr.content,Rn=Pr.includeList,Xn=Jr,ri=$o()(er.concat(Rn).concat(D)).reduce(function(wi,Pi){return ss(ss({},wi),U.rawContentCache[Pi].uniforms)},{});return $n.test(Jr)||(Xn=Fn+Jr),this.moduleCache[D]={fs:Xn.trim(),uniforms:ri,vs:tr.trim()},this.moduleCache[D]}},{key:"processModule",value:function(D,U,Ee){var tt=this,Gt=D.replace(Tc,function(tr,er){var Pr=er.split(" "),Jr=Pr[0].replace(/"/g,"");if(U.indexOf(Jr)>-1)return"";var Rn=tt.rawContentCache[Jr][Ee];U.push(Jr);var Xn=tt.processModule(Rn,U,Ee),ri=Xn.content;return ri});return{content:Gt,includeList:U}}}]),ne}(),Bl))||af),jo=o("iWIM"),Io=o.n(jo),nu=o("bPkA"),_u,ec,Wi,Wa,fl,hl,tc=(_u=Object(F.injectable)(),ec=Object(F.inject)(B.a.IShaderModuleService),_u(Wi=(Wa=(hl=function(){function ne(){J()(this,ne),Ar()(this,"shaderModuleService",fl,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return Ge()(ne,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return nu.a.Normal}},{key:"init",value:function(D,U){this.config=U,this.rendererService=D.getContainer().get(B.a.IRendererService),this.cameraService=D.getContainer().get(B.a.ICameraService),this.mapService=D.getContainer().get(B.a.IMapService),this.interactionService=D.getContainer().get(B.a.IInteractionService),this.layerService=D.getContainer().get(B.a.ILayerService)}},{key:"render",value:function(D){}}]),ne}(),hl),fl=Mn()(Wa.prototype,"shaderModuleService",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wa))||Wi),Mu,Rs;function kl(ne){var oe=gs();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function gs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var xf=(Mu=Object(F.injectable)(),Mu(Rs=function(ne){he()(D,ne);var oe=kl(D);function D(){return J()(this,D),oe.apply(this,arguments)}return Ge()(D,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(Ee,tt){Io()(it()(D.prototype),"init",this).call(this,Ee,tt)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),D}(tc))||Rs),jl,jc,bf,Vs,Cl,Ul;function Iu(ne,oe){var D;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(D=Ou(ne))||oe&&ne&&typeof ne.length=="number"){D&&(ne=D);var U=0,Ee=function(){};return{s:Ee,n:function(){return U>=ne.length?{done:!0}:{done:!1,value:ne[U++]}},e:function(Pr){throw Pr},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var tt=!0,Gt=!1,tr;return{s:function(){D=ne[Symbol.iterator]()},n:function(){var Pr=D.next();return tt=Pr.done,Pr},e:function(Pr){Gt=!0,tr=Pr},f:function(){try{!tt&&D.return!=null&&D.return()}finally{if(Gt)throw tr}}}}function Ou(ne,oe){if(!!ne){if(typeof ne=="string")return wl(ne,oe);var D=Object.prototype.toString.call(ne).slice(8,-1);if(D==="Object"&&ne.constructor&&(D=ne.constructor.name),D==="Map"||D==="Set")return Array.from(ne);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return wl(ne,oe)}}function wl(ne,oe){(oe==null||oe>ne.length)&&(oe=ne.length);for(var D=0,U=new Array(oe);D<oe;D++)U[D]=ne[D];return U}var Ku=(jl=Object(F.injectable)(),jc=Object(F.inject)(B.a.IPostProcessor),jl(bf=(Vs=(Ul=function(){function ne(){J()(this,ne),this.passes=[],Ar()(this,"postProcessor",Cl,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return Ge()(ne,[{key:"setLayer",value:function(D){this.layer=D}},{key:"setRenderFlag",value:function(D){this.renderFlag=D}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var oe=bn()(fr.a.mark(function U(){var Ee,tt,Gt;return fr.a.wrap(function(er){for(;;)switch(er.prev=er.next){case 0:Ee=Iu(this.passes),er.prev=1,Ee.s();case 3:if((tt=Ee.n()).done){er.next=9;break}return Gt=tt.value,er.next=7,Gt.render(this.layer);case 7:er.next=3;break;case 9:er.next=14;break;case 11:er.prev=11,er.t0=er.catch(1),Ee.e(er.t0);case 14:return er.prev=14,Ee.f(),er.finish(14);case 17:this.layer.renderModels();case 18:case"end":return er.stop()}},U,this,[[1,11,14,17]])}));function D(){return oe.apply(this,arguments)}return D}()},{key:"resize",value:function(D,U){(this.width!==D||this.height!==U)&&(this.width=D,this.height=U)}},{key:"add",value:function(D,U){D.getType()===nu.a.PostProcessing?this.postProcessor.add(D,this.layer,U):(D.init(this.layer,U),this.passes.push(D))}},{key:"insert",value:function(D,U,Ee){D.init(this.layer,U),this.passes.splice(Ee,0,D)}},{key:"destroy",value:function(){this.passes.length=0}}]),ne}(),Ul),Cl=Mn()(Vs.prototype,"postProcessor",[jc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vs))||bf),Ds,Ac,rc,nc,ic,u;function i(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function n(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?i(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):i(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}function c(ne){var oe=y();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function y(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var _=(Ds=Object(F.injectable)(),Ac=Object(F.inject)(B.a.ILogService),Ds(rc=(nc=(u=function(ne){he()(D,ne);var oe=c(D);function D(){var U;J()(this,D);for(var Ee=arguments.length,tt=new Array(Ee),Gt=0;Gt<Ee;Gt++)tt[Gt]=arguments[Gt];return U=oe.call.apply(oe,[this].concat(tt)),Ar()(U,"logger",ic,Gi()(U)),U.pickingFBO=void 0,U.layer=void 0,U.width=0,U.height=0,U.alreadyInRendering=!1,U.pickFromPickingFBO=function(tr){var er=tr.x,Pr=tr.y,Jr=tr.lngLat,Rn=tr.type;if(!(!U.layer.isVisible()||!U.layer.needPick(Rn))){var Xn=U.rendererService,ri=Xn.getViewportSize,wi=Xn.readPixels,Pi=Xn.useFramebuffer,ia=ri(),ra=ia.width,Ia=ia.height,uo=U.layer.getLayerConfig(),eo=uo.enableHighlight,Na=uo.enableSelect,vo=er*_e.a.DPR,Fi=Pr*_e.a.DPR;if(!(vo>ra||vo<0||Fi>Ia||Fi<0)){var to;Pi(U.pickingFBO,function(){var us;if(to=wi({x:Math.round(vo),y:Math.round(Ia-(Pr+1)*_e.a.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:U.pickingFBO}),to[0]!==0||to[1]!==0||to[2]!==0){U.logger.debug("picked");var va=Object(_e.k)(to),Aa=U.layer.getSource().getFeatureById(va),mi={x:er,y:Pr,type:Rn,lngLat:Jr,featureId:va,feature:Aa};Aa&&(U.layer.setCurrentPickId(va),U.triggerHoverOnLayer(mi))}else{var zo={x:er,y:Pr,lngLat:Jr,type:U.layer.getCurrentPickId()===null?"un"+Rn:"mouseout",featureId:null,feature:null};U.triggerHoverOnLayer(n(n({},zo),{},{type:"unpick"})),U.triggerHoverOnLayer(zo),U.layer.setCurrentPickId(null)}eo&&U.highlightPickedFeature(to),Na&&Rn==="click"&&((us=to)===null||us===void 0?void 0:us.toString())!==[0,0,0,0].toString()&&U.selectFeature(to)})}}},U}return Ge()(D,[{key:"getType",value:function(){return nu.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(Ee,tt){Io()(it()(D.prototype),"init",this).call(this,Ee,tt),this.layer=Ee;var Gt=this.rendererService,tr=Gt.createTexture2D,er=Gt.createFramebuffer,Pr=Gt.getViewportSize,Jr=Pr(),Rn=Jr.width,Xn=Jr.height;this.pickingFBO=er({color:tr({width:Rn,height:Xn,wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})}),this.interactionService.on(na.a.Hover,this.pickFromPickingFBO),this.interactionService.on(na.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(na.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(Ee){var tt=this;if(!this.alreadyInRendering){var Gt=this.rendererService,tr=Gt.getViewportSize,er=Gt.useFramebuffer,Pr=Gt.clear,Jr=tr(),Rn=Jr.width,Xn=Jr.height;this.alreadyInRendering=!0,(this.width!==Rn||this.height!==Xn)&&(this.pickingFBO.resize({width:Rn,height:Xn}),this.width=Rn,this.height=Xn),er(this.pickingFBO,function(){Pr({framebuffer:tt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var ri=tt.layer.multiPassRenderer.getRenderFlag();tt.layer.multiPassRenderer.setRenderFlag(!1),Ee.hooks.beforePickingEncode.call(),Ee.render(),Ee.hooks.afterPickingEncode.call(),tt.layer.multiPassRenderer.setRenderFlag(ri),tt.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(Ee){this.layer.emit(Ee.type,Ee)}},{key:"highlightPickedFeature",value:function(Ee){var tt=vt()(Ee,3),Gt=tt[0],tr=tt[1],er=tt[2];this.layer.hooks.beforeHighlight.call([Gt,tr,er]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(Ee){var tt=vt()(Ee,3),Gt=tt[0],tr=tt[1],er=tt[2];this.layer.hooks.beforeSelect.call([Gt,tr,er]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(Ee){var tt=Ee.featureId,Gt=Object(_e.l)(tt);this.selectFeature(new Uint8Array(Gt))}},{key:"highlightFeatureHandle",value:function(Ee){var tt=Ee.featureId,Gt=Object(_e.l)(tt);this.highlightPickedFeature(new Uint8Array(Gt))}}]),D}(tc),u),ic=Mn()(nc.prototype,"logger",[Ac],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nc))||rc),O=o("+em5"),k,ue;function Ae(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function We(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?Ae(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):Ae(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}function Je(ne){var oe=rt();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function rt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ft=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Rt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Yt=(k=Object(F.injectable)(),k(ue=function(ne){he()(D,ne);var oe=Je(D);function D(){return J()(this,D),oe.apply(this,arguments)}return Ge()(D,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Rt,fs:Ft});var Ee=this.shaderModuleService.getModule("blur-pass"),tt=Ee.vs,Gt=Ee.fs,tr=Ee.uniforms,er=this.rendererService.getViewportSize(),Pr=er.width,Jr=er.height;return{vs:tt,fs:Gt,uniforms:We(We({},tr),{},{u_ViewportSize:[Pr,Jr]})}}},{key:"convertOptionsToUniforms",value:function(Ee){var tt={};return _o()(Ee.blurRadius)||(tt.u_BlurDir=[Ee.blurRadius,0]),tt}}]),D}(O.a))||ue),zt,Ut;function nr(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function rr(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?nr(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):nr(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}function Or(ne){var oe=hr();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function hr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Tr=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Cr=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,an=(zt=Object(F.injectable)(),zt(Ut=function(ne){he()(D,ne);var oe=Or(D);function D(){return J()(this,D),oe.apply(this,arguments)}return Ge()(D,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Cr,fs:Tr});var Ee=this.shaderModuleService.getModule("blur-pass"),tt=Ee.vs,Gt=Ee.fs,tr=Ee.uniforms,er=this.rendererService.getViewportSize(),Pr=er.width,Jr=er.height;return{vs:tt,fs:Gt,uniforms:rr(rr({},tr),{},{u_ViewportSize:[Pr,Jr]})}}},{key:"convertOptionsToUniforms",value:function(Ee){var tt={};return _o()(Ee.blurRadius)||(tt.u_BlurDir=[0,Ee.blurRadius]),tt}}]),D}(O.a))||Ut),Yr,yn;function On(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function Qn(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?On(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):On(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}function oi(ne){var oe=xi();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function xi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Xi=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,An=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,si=(Yr=Object(F.injectable)(),Yr(yn=function(ne){he()(D,ne);var oe=oi(D);function D(){return J()(this,D),oe.apply(this,arguments)}return Ge()(D,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:An,fs:Xi});var Ee=this.shaderModuleService.getModule("colorhalftone-pass"),tt=Ee.vs,Gt=Ee.fs,tr=Ee.uniforms,er=this.rendererService.getViewportSize(),Pr=er.width,Jr=er.height;return{vs:tt,fs:Gt,uniforms:Qn(Qn({},tr),{},{u_ViewportSize:[Pr,Jr]})}}}]),D}(O.a))||yn),bi,Wn;function Ti(ne){var oe=ii();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function ii(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Li=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,ji=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,qa=(bi=Object(F.injectable)(),bi(Wn=function(ne){he()(D,ne);var oe=Ti(D);function D(){return J()(this,D),oe.apply(this,arguments)}return Ge()(D,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:ji,fs:Li}),this.shaderModuleService.getModule("copy-pass")}}]),D}(O.a))||Wn),Ma,So;function Ta(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function Xa(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?Ta(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):Ta(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}function zs(ne){var oe=Eo();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function Eo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var yu=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,xu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Uo=(Ma=Object(F.injectable)(),Ma(So=function(ne){he()(D,ne);var oe=zs(D);function D(){return J()(this,D),oe.apply(this,arguments)}return Ge()(D,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:xu,fs:yu});var Ee=this.shaderModuleService.getModule("hexagonalpixelate-pass"),tt=Ee.vs,Gt=Ee.fs,tr=Ee.uniforms,er=this.rendererService.getViewportSize(),Pr=er.width,Jr=er.height;return{vs:tt,fs:Gt,uniforms:Xa(Xa({},tr),{},{u_ViewportSize:[Pr,Jr]})}}}]),D}(O.a))||So),As,Lu;function ac(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function $u(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?ac(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):ac(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}function oc(ne){var oe=sc();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function sc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ru=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,dl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Cs=(As=Object(F.injectable)(),As(Lu=function(ne){he()(D,ne);var oe=oc(D);function D(){return J()(this,D),oe.apply(this,arguments)}return Ge()(D,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:dl,fs:Ru});var Ee=this.shaderModuleService.getModule("ink-pass"),tt=Ee.vs,Gt=Ee.fs,tr=Ee.uniforms,er=this.rendererService.getViewportSize(),Pr=er.width,Jr=er.height;return{vs:tt,fs:Gt,uniforms:$u($u({},tr),{},{u_ViewportSize:[Pr,Jr]})}}}]),D}(O.a))||Lu),po,Du;function bu(ne){var oe=Oo();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function Oo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Lo=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,Ro=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Jo=(po=Object(F.injectable)(),po(Du=function(ne){he()(D,ne);var oe=bu(D);function D(){return J()(this,D),oe.apply(this,arguments)}return Ge()(D,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:Ro,fs:Lo}),this.shaderModuleService.getModule("noise-pass")}}]),D}(O.a))||Du),To,Vo;function Gs(ne){var oe=Pl();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function Pl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Uc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Vl=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,Ju=(To=Object(F.injectable)(),To(Vo=function(ne){he()(D,ne);var oe=Gs(D);function D(){return J()(this,D),oe.apply(this,arguments)}return Ge()(D,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Uc,fs:Vl}),this.shaderModuleService.getModule("sepia-pass")}}]),D}(O.a))||Vo),zu,Nu,Hs,Do,Vc,ys,of,Lf=(zu=Object(F.injectable)(),Nu=Object(F.inject)(B.a.IRendererService),Hs=Object(F.postConstruct)(),zu(Do=(Vc=(of=function(){function ne(){J()(this,ne),Ar()(this,"rendererService",ys,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return Ge()(ne,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var oe=bn()(fr.a.mark(function U(Ee){var tt,Gt;return fr.a.wrap(function(er){for(;;)switch(er.prev=er.next){case 0:tt=0;case 1:if(!(tt<this.passes.length)){er.next=10;break}return Gt=this.passes[tt],Gt.setRenderToScreen(this.isLastEnabledPass(tt)),er.next=6,Gt.render(Ee);case 6:tt!==this.passes.length-1&&this.swap();case 7:tt++,er.next=1;break;case 10:case"end":return er.stop()}},U,this)}));function D(U){return oe.apply(this,arguments)}return D}()},{key:"resize",value:function(D,U){this.readFBO.resize({width:D,height:U}),this.writeFBO.resize({width:D,height:U})}},{key:"add",value:function(D,U,Ee){D.init(U,Ee),this.passes.push(D)}},{key:"insert",value:function(D,U,Ee,tt){D.init(Ee,tt),this.passes.splice(U,0,D)}},{key:"getPostProcessingPassByName",value:function(D){return this.passes.find(function(U){return U.getName()===D})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(D){for(var U=D+1;U<this.passes.length;U++)if(this.passes[U].isEnabled())return!1;return!0}},{key:"swap",value:function(){var D=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=D}}]),ne}(),of),ys=Mn()(Vc.prototype,"rendererService",[Nu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn()(Vc.prototype,"init",[Hs],Object.getOwnPropertyDescriptor(Vc.prototype,"init"),Vc.prototype),Vc))||Do),Rf,Uf;function Qu(ne){var oe=Sf();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function Sf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var sf=(Rf=Object(F.injectable)(),Rf(Uf=function(ne){he()(D,ne);var oe=Qu(D);function D(){return J()(this,D),oe.apply(this,arguments)}return Ge()(D,[{key:"getType",value:function(){return nu.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(Ee,tt){Io()(it()(D.prototype),"init",this).call(this,Ee,tt)}},{key:"render",value:function(Ee){var tt=this.rendererService,Gt=tt.useFramebuffer,tr=tt.clear;Gt(null,function(){tr({color:[0,0,0,0],depth:1,stencil:0}),Ee.multiPassRenderer.setRenderFlag(!1),Ee.render(),Ee.multiPassRenderer.setRenderFlag(!0)})}}]),D}(tc))||Uf),uc,Fu,lc,Vf,Cc,wc,Gf,Hf;function ah(ne,oe){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ne);oe&&(U=U.filter(function(Ee){return Object.getOwnPropertyDescriptor(ne,Ee).enumerable})),D.push.apply(D,U)}return D}function Zf(ne){for(var oe=1;oe<arguments.length;oe++){var D=arguments[oe]!=null?arguments[oe]:{};oe%2?ah(Object(D),!0).forEach(function(U){re()(ne,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):ah(Object(D)).forEach(function(U){Object.defineProperty(ne,U,Object.getOwnPropertyDescriptor(D,U))})}return ne}function Df(ne){var oe=ch();return function(){var U=it()(ne),Ee;if(oe){var tt=it()(this).constructor;Ee=Reflect.construct(U,arguments,tt)}else Ee=U.apply(this,arguments);return Ye()(this,Ee)}}function ch(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var cc=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,uf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,so=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function Gl(ne,oe){for(var D=0,U=1/oe,Ee=ne;Ee>0;)D=D+U*(Ee%oe),Ee=Math.floor(Ee/oe),U=U/oe;return D}var lf=1,Gc=(uc=Object(F.injectable)(),Fu=Object(F.inject)(B.a.IShaderModuleService),lc=Object(F.inject)(B.a.ILogService),uc(Vf=(Cc=(Hf=function(ne){he()(D,ne);var oe=Df(D);function D(){var U;J()(this,D);for(var Ee=arguments.length,tt=new Array(Ee),Gt=0;Gt<Ee;Gt++)tt[Gt]=arguments[Gt];return U=oe.call.apply(oe,[this].concat(tt)),Ar()(U,"shaderModuleService",wc,Gi()(U)),Ar()(U,"logger",Gf,Gi()(U)),U.haltonSequence=[],U.accumulatingId=0,U.frame=0,U.timer=void 0,U.sampleRenderTarget=void 0,U.prevRenderTarget=void 0,U.outputRenderTarget=void 0,U.copyRenderTarget=void 0,U.blendModel=void 0,U.outputModel=void 0,U.copyModel=void 0,U}return Ge()(D,[{key:"getType",value:function(){return nu.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(Ee,tt){Io()(it()(D.prototype),"init",this).call(this,Ee,tt);var Gt=this.rendererService,tr=Gt.createFramebuffer,er=Gt.createTexture2D;this.sampleRenderTarget=tr({color:er({width:1,height:1,wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=tr({color:er({width:1,height:1,wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=tr({color:er({width:1,height:1,wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=tr({color:er({width:1,height:1,wrapS:Un.a.CLAMP_TO_EDGE,wrapT:Un.a.CLAMP_TO_EDGE})});for(var Pr=0;Pr<30;Pr++)this.haltonSequence.push([Gl(Pr,2),Gl(Pr,3)]);this.blendModel=this.createTriangleModel("blend-pass",cc),this.outputModel=this.createTriangleModel("copy-pass",uf,{blend:{enable:!0,func:{srcRGB:Un.a.ONE,dstRGB:Un.a.ONE_MINUS_SRC_ALPHA,srcAlpha:Un.a.ONE,dstAlpha:Un.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:Un.a.FUNC_ADD,alpha:Un.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",uf)}},{key:"render",value:function(Ee){var tt=this,Gt=this.rendererService,tr=Gt.clear,er=Gt.getViewportSize,Pr=Gt.useFramebuffer,Jr=er(),Rn=Jr.width,Xn=Jr.height;this.sampleRenderTarget.resize({width:Rn,height:Xn}),this.prevRenderTarget.resize({width:Rn,height:Xn}),this.outputRenderTarget.resize({width:Rn,height:Xn}),this.copyRenderTarget.resize({width:Rn,height:Xn}),this.resetFrame(),this.stopAccumulating();var ri=Ee.multiPassRenderer.getPostProcessor().getReadFBO();Pr(ri,function(){tr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ri}),Ee.multiPassRenderer.setRenderFlag(!1),Ee.render(),Ee.multiPassRenderer.setRenderFlag(!0)});var wi=function Pi(ia){!tt.accumulatingId||ia!==tt.accumulatingId||tt.isFinished()||(tt.doRender(Ee),requestAnimationFrame(function(){Pi(ia)}))};this.accumulatingId=lf++,this.timer=window.setTimeout(function(){wi(tt.accumulatingId)},50)}},{key:"doRender",value:function(Ee){var tt=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var Gt=this.rendererService,tr=Gt.clear,er=Gt.getViewportSize,Pr=Gt.useFramebuffer,Jr=er(),Rn=Jr.width,Xn=Jr.height,ri=Ee.getLayerConfig(),wi=ri.jitterScale,Pi=wi===void 0?1:wi,ia=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((ia[0]*2-1)/Rn*Pi,(ia[1]*2-1)/Xn*Pi),Ee.multiPassRenderer.setRenderFlag(!1),Ee.hooks.beforeRender.call(),Pr(this.sampleRenderTarget,function(){tr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:tt.sampleRenderTarget}),Ee.render()}),Ee.hooks.afterRender.call(),Ee.multiPassRenderer.setRenderFlag(!0);var ra=Ee.getLayerConfig();Pr(this.outputRenderTarget,function(){tt.blendModel.draw({uniforms:{u_opacity:ra.opacity||1,u_MixRatio:tt.frame===0?1:.9,u_Diffuse1:tt.sampleRenderTarget,u_Diffuse2:tt.frame===0?Ee.multiPassRenderer.getPostProcessor().getReadFBO():tt.prevRenderTarget}})}),this.frame===0&&tr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(Pr(this.copyRenderTarget,function(){tt.outputModel.draw({uniforms:{u_Texture:tt.outputRenderTarget}})}),Pr(Ee.multiPassRenderer.getPostProcessor().getReadFBO(),function(){tt.copyModel.draw({uniforms:{u_Texture:tt.copyRenderTarget}})}),Ee.multiPassRenderer.getPostProcessor().render(Ee));var Ia=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Ia,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(Ee,tt,Gt){this.shaderModuleService.registerModule(Ee,{vs:so,fs:tt});var tr=this.shaderModuleService.getModule(Ee),er=tr.vs,Pr=tr.fs,Jr=tr.uniforms,Rn=this.rendererService,Xn=Rn.createAttribute,ri=Rn.createBuffer,wi=Rn.createModel;return wi(Zf({vs:er,fs:Pr,attributes:{a_Position:Xn({buffer:ri({data:[-4,-4,4,-4,0,4],type:Un.a.FLOAT}),size:2})},uniforms:Zf({},Jr),depth:{enable:!1},count:3},Gt))}}]),D}(tc),Hf),wc=Mn()(Cc.prototype,"shaderModuleService",[Fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gf=Mn()(Cc.prototype,"logger",[lc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc))||Vf),iu=new F.Container;iu.bind(B.a.IGlobalConfigService).to(vn).inSingletonScope(),iu.bind(B.a.IShaderModuleService).to(ms).inSingletonScope(),iu.bind(B.a.ILogService).to(Dl).inSingletonScope(),Object(F.decorate)(Object(F.injectable)(),v.EventEmitter),iu.bind(B.a.IEventEmitter).to(v.EventEmitter);var _l=Y()(iu,!1),Ef=function(oe){var D=_l.lazyInject(oe);return function(U,Ee,tt){D.call(this,U,Ee),tt&&(tt.initializer=function(){return U[Ee]})}},Tf=function(oe){var D=_l.lazyMultiInject(oe);return function(U,Ee,tt){D.call(this,U,Ee),tt&&(tt.initializer=function(){return U[Ee]})}},Hc=x.c=iu,cf=0;function Zc(){var ne=new F.Container;return ne.parent=iu,ne.bind(B.a.SceneID).toConstantValue("".concat(cf++)),ne.bind(B.a.ILayerService).to(Gn).inSingletonScope(),ne.bind(B.a.ISceneService).to(Is).inSingletonScope(),ne.bind(B.a.ICameraService).to(pr).inSingletonScope(),ne.bind(B.a.ICoordinateSystemService).to(Ko).inSingletonScope(),ne.bind(B.a.IInteractionService).to(Fe).inSingletonScope(),ne.bind(B.a.IPickingService).to(lu).inSingletonScope(),ne.bind(B.a.IControlService).to(Zn).inSingletonScope(),ne.bind(B.a.IMarkerService).to(W).inSingletonScope(),ne.bind(B.a.IIconService).to(ht).inSingletonScope(),ne.bind(B.a.IFontService).to(R).inSingletonScope(),ne.bind(B.a.IPopupService).to(wt).inSingletonScope(),ne.bind(B.a.INormalPass).to(xf).whenTargetNamed("clear"),ne.bind(B.a.INormalPass).to(_).whenTargetNamed("pixelPicking"),ne.bind(B.a.INormalPass).to(sf).whenTargetNamed("render"),ne.bind(B.a.INormalPass).to(Gc).whenTargetNamed("taa"),ne.bind(B.a.IFactoryNormalPass).toFactory(function(oe){return function(D){return oe.container.getNamed(B.a.INormalPass,D)}}),ne.bind(B.a.IPostProcessingPass).to(qa).whenTargetNamed("copy"),ne.bind(B.a.IPostProcessingPass).to(Yt).whenTargetNamed("blurH"),ne.bind(B.a.IPostProcessingPass).to(an).whenTargetNamed("blurV"),ne.bind(B.a.IPostProcessingPass).to(Jo).whenTargetNamed("noise"),ne.bind(B.a.IPostProcessingPass).to(Ju).whenTargetNamed("sepia"),ne.bind(B.a.IPostProcessingPass).to(si).whenTargetNamed("colorHalftone"),ne.bind(B.a.IPostProcessingPass).to(Uo).whenTargetNamed("hexagonalPixelate"),ne.bind(B.a.IPostProcessingPass).to(Cs).whenTargetNamed("ink"),ne.bind(B.a.IFactoryPostProcessingPass).toFactory(function(oe){return function(D){var U=oe.container.getNamed(B.a.IPostProcessingPass,D);return U.setName(D),U}}),ne}function Hl(ne){var oe=new F.Container;return oe.parent=ne,oe.bind(B.a.IStyleAttributeService).to(_f).inSingletonScope(),oe.bind(B.a.IMultiPassRenderer).to(Ku).inSingletonScope(),oe.bind(B.a.IPostProcessor).to(Lf).inSingletonScope(),oe}},fbrv:function(Ie,x,o){"use strict";var b=this&&this.__spreadArrays||function(){for(var Re=0,at=0,Oe=arguments.length;at<Oe;at++)Re+=arguments[at].length;for(var xt=Array(Re),Mt=0,at=0;at<Oe;at++)for(var Et=arguments[at],St=0,or=Et.length;St<or;St++,Mt++)xt[Mt]=Et[St];return xt};Object.defineProperty(x,"__esModule",{value:!0}),x.getFunctionName=x.getBaseClassDependencyCount=x.getDependencies=void 0;var v=o("Yk9n"),Z=o("MON2"),F=o("FV85"),a=o("xfSm"),Y=o("ujMp");Object.defineProperty(x,"getFunctionName",{enumerable:!0,get:function(){return Y.getFunctionName}});var B=o("dX1H");function Q(Re,at){var Oe=Y.getFunctionName(at),xt=re(Re,Oe,at,!1);return xt}x.getDependencies=Q;function re(Re,at,Oe,xt){var Mt=Re.getConstructorMetadata(Oe),Et=Mt.compilerGeneratedMetadata;if(Et===void 0){var St=Z.MISSING_INJECTABLE_ANNOTATION+" "+at+".";throw new Error(St)}var or=Mt.userGeneratedMetadata,$t=Object.keys(or),Ht=Oe.length===0&&$t.length>0,mt=Ht?$t.length:Oe.length,Xe=J(xt,at,Et,or,mt),Tt=Ke(Re,Oe),ze=b(Xe,Tt);return ze}function we(Re,at,Oe,xt,Mt){var Et=Mt[Re.toString()]||[],St=_e(Et),or=St.unmanaged!==!0,$t=xt[Re],Ht=St.inject||St.multiInject;if($t=Ht||$t,$t instanceof v.LazyServiceIdentifer&&($t=$t.unwrap()),or){var mt=$t===Object,Xe=$t===Function,Tt=$t===void 0,ze=mt||Xe||Tt;if(!at&&ze){var st=Z.MISSING_INJECT_ANNOTATION+" argument "+Re+" in class "+Oe+".";throw new Error(st)}var Wt=new B.Target(F.TargetTypeEnum.ConstructorArgument,St.targetName,$t);return Wt.metadata=Et,Wt}return null}function J(Re,at,Oe,xt,Mt){for(var Et=[],St=0;St<Mt;St++){var or=St,$t=we(or,Re,at,Oe,xt);$t!==null&&Et.push($t)}return Et}function Ke(Re,at){for(var Oe=Re.getPropertiesMetadata(at),xt=[],Mt=Object.keys(Oe),Et=0,St=Mt;Et<St.length;Et++){var or=St[Et],$t=Oe[or],Ht=_e(Oe[or]),mt=Ht.targetName||or,Xe=Ht.inject||Ht.multiInject,Tt=new B.Target(F.TargetTypeEnum.ClassProperty,mt,Xe);Tt.metadata=$t,xt.push(Tt)}var ze=Object.getPrototypeOf(at.prototype).constructor;if(ze!==Object){var st=Ke(Re,ze);xt=b(xt,st)}return xt}function Ge(Re,at){var Oe=Object.getPrototypeOf(at.prototype).constructor;if(Oe!==Object){var xt=Y.getFunctionName(Oe),Mt=re(Re,xt,Oe,!0),Et=Mt.map(function($t){return $t.metadata.filter(function(Ht){return Ht.key===a.UNMANAGED_TAG})}),St=[].concat.apply([],Et).length,or=Mt.length-St;return or>0?or:Ge(Re,Oe)}else return 0}x.getBaseClassDependencyCount=Ge;function _e(Re){var at={};return Re.forEach(function(Oe){at[Oe.key.toString()]=Oe.value}),{inject:at[a.INJECT_TAG],multiInject:at[a.MULTI_INJECT_TAG],targetName:at[a.NAME_TAG],unmanaged:at[a.UNMANAGED_TAG]}}},fbvF:function(Ie,x,o){(function(b,v){Ie.exports=v()})(this,function(){"use strict";var b=function(je){return je instanceof Uint8Array||je instanceof Uint16Array||je instanceof Uint32Array||je instanceof Int8Array||je instanceof Int16Array||je instanceof Int32Array||je instanceof Float32Array||je instanceof Float64Array||je instanceof Uint8ClampedArray},v=function(je,At){for(var gr=Object.keys(At),Ir=0;Ir<gr.length;++Ir)je[gr[Ir]]=At[gr[Ir]];return je},Z=`
`;function F(xe){return typeof atob!="undefined"?atob(xe):"base64:"+xe}function a(xe){var je=new Error("(regl) "+xe);throw console.error(je),je}function Y(xe,je){xe||a(je)}function B(xe){return xe?": "+xe:""}function Q(xe,je,At){xe in je||a("unknown parameter ("+xe+")"+B(At)+". possible values: "+Object.keys(je).join())}function re(xe,je){b(xe)||a("invalid parameter type"+B(je)+". must be a typed array")}function we(xe,je){switch(je){case"number":return typeof xe=="number";case"object":return typeof xe=="object";case"string":return typeof xe=="string";case"boolean":return typeof xe=="boolean";case"function":return typeof xe=="function";case"undefined":return typeof xe=="undefined";case"symbol":return typeof xe=="symbol"}}function J(xe,je,At){we(xe,je)||a("invalid parameter type"+B(At)+". expected "+je+", got "+typeof xe)}function Ke(xe,je){xe>=0&&(xe|0)===xe||a("invalid parameter type, ("+xe+")"+B(je)+". must be a nonnegative integer")}function Ge(xe,je,At){je.indexOf(xe)<0&&a("invalid value"+B(At)+". must be one of: "+je)}var _e=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Re(xe){Object.keys(xe).forEach(function(je){_e.indexOf(je)<0&&a('invalid regl constructor argument "'+je+'". must be one of '+_e)})}function at(xe,je){for(xe=xe+"";xe.length<je;)xe=" "+xe;return xe}function Oe(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function xt(xe,je){this.number=xe,this.line=je,this.errors=[]}function Mt(xe,je,At){this.file=xe,this.line=je,this.message=At}function Et(){var xe=new Error,je=(xe.stack||xe).toString(),At=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(je);if(At)return At[1];var gr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(je);return gr?gr[1]:"unknown"}function St(){var xe=new Error,je=(xe.stack||xe).toString(),At=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(je);if(At)return At[1];var gr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(je);return gr?gr[1]:"unknown"}function or(xe,je){var At=xe.split(`
`),gr=1,Ir=0,wr={unknown:new Oe,0:new Oe};wr.unknown.name=wr[0].name=je||Et(),wr.unknown.lines.push(new xt(0,""));for(var xr=0;xr<At.length;++xr){var Wr=At[xr],sn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Wr);if(sn)switch(sn[1]){case"line":var tn=/(\d+)(\s+\d+)?/.exec(sn[2]);tn&&(gr=tn[1]|0,tn[2]&&(Ir=tn[2]|0,Ir in wr||(wr[Ir]=new Oe)));break;case"define":var qr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(sn[2]);qr&&(wr[Ir].name=qr[1]?F(qr[2]):qr[2]);break}wr[Ir].lines.push(new xt(gr++,Wr))}return Object.keys(wr).forEach(function(fn){var wn=wr[fn];wn.lines.forEach(function(cn){wn.index[cn.number]=cn})}),wr}function $t(xe){var je=[];return xe.split(`
`).forEach(function(At){if(!(At.length<5)){var gr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(At);gr?je.push(new Mt(gr[1]|0,gr[2]|0,gr[3].trim())):At.length>0&&je.push(new Mt("unknown",0,At))}}),je}function Ht(xe,je){je.forEach(function(At){var gr=xe[At.file];if(gr){var Ir=gr.index[At.line];if(Ir){Ir.errors.push(At),gr.hasErrors=!0;return}}xe.unknown.hasErrors=!0,xe.unknown.lines[0].errors.push(At)})}function mt(xe,je,At,gr,Ir){if(!xe.getShaderParameter(je,xe.COMPILE_STATUS)){var wr=xe.getShaderInfoLog(je),xr=gr===xe.FRAGMENT_SHADER?"fragment":"vertex";dt(At,"string",xr+" shader source must be a string",Ir);var Wr=or(At,Ir),sn=$t(wr);Ht(Wr,sn),Object.keys(Wr).forEach(function(tn){var qr=Wr[tn];if(!qr.hasErrors)return;var fn=[""],wn=[""];function cn(nn,yr){fn.push(nn),wn.push(yr||"")}cn("file number "+tn+": "+qr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),qr.lines.forEach(function(nn){if(nn.errors.length>0){cn(at(nn.number,4)+"|  ","background-color:yellow; font-weight:bold"),cn(nn.line+Z,"color:red; background-color:yellow; font-weight:bold");var yr=0;nn.errors.forEach(function(vr){var Xr=vr.message,_n=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Xr);if(_n){var Lr=_n[1];switch(Xr=_n[2],Lr){case"assign":Lr="=";break}yr=Math.max(nn.line.indexOf(Lr,yr),0)}else yr=0;cn(at("| ",6)),cn(at("^^^",yr+3)+Z,"font-weight:bold"),cn(at("| ",6)),cn(Xr+Z,"font-weight:bold")}),cn(at("| ",6)+Z)}else cn(at(nn.number,4)+"|  "),cn(nn.line+Z,"color:red")}),typeof document!="undefined"&&!window.chrome?(wn[0]=fn.join("%c"),console.log.apply(console,wn)):console.log(fn.join(""))}),Y.raise("Error compiling "+xr+" shader, "+Wr[0].name)}}function Xe(xe,je,At,gr,Ir){if(!xe.getProgramParameter(je,xe.LINK_STATUS)){var wr=xe.getProgramInfoLog(je),xr=or(At,Ir),Wr=or(gr,Ir),sn='Error linking program with vertex shader, "'+Wr[0].name+'", and fragment shader "'+xr[0].name+'"';typeof document!="undefined"?console.log("%c"+sn+Z+"%c"+wr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(sn+Z+wr),Y.raise(sn)}}function Tt(xe){xe._commandRef=Et()}function ze(xe,je,At,gr){Tt(xe);function Ir(sn){return sn?gr.id(sn):0}xe._fragId=Ir(xe.static.frag),xe._vertId=Ir(xe.static.vert);function wr(sn,tn){Object.keys(tn).forEach(function(qr){sn[gr.id(qr)]=!0})}var xr=xe._uniformSet={};wr(xr,je.static),wr(xr,je.dynamic);var Wr=xe._attributeSet={};wr(Wr,At.static),wr(Wr,At.dynamic),xe._hasCount="count"in xe.static||"count"in xe.dynamic||"elements"in xe.static||"elements"in xe.dynamic}function st(xe,je){var At=St();a(xe+" in command "+(je||Et())+(At==="unknown"?"":" called from "+At))}function Wt(xe,je,At){xe||st(je,At||Et())}function bt(xe,je,At,gr){xe in je||st("unknown parameter ("+xe+")"+B(At)+". possible values: "+Object.keys(je).join(),gr||Et())}function dt(xe,je,At,gr){we(xe,je)||st("invalid parameter type"+B(At)+". expected "+je+", got "+typeof xe,gr||Et())}function H(xe){xe()}function z(xe,je,At){xe.texture?Ge(xe.texture._texture.internalformat,je,"unsupported texture format for attachment"):Ge(xe.renderbuffer._renderbuffer.format,At,"unsupported renderbuffer format for attachment")}var V=33071,Se=9728,ve=9984,ce=9985,fe=9986,ke=9987,lt=5120,nt=5121,le=5122,ye=5123,He=5124,ft=5125,De=5126,Ze=32819,w=32820,R=33635,q=34042,he=36193,Ve={};Ve[lt]=Ve[nt]=1,Ve[le]=Ve[ye]=Ve[he]=Ve[R]=Ve[Ze]=Ve[w]=2,Ve[He]=Ve[ft]=Ve[De]=Ve[q]=4;function Ye(xe,je){return xe===w||xe===Ze||xe===R?2:xe===q?4:Ve[xe]*je}function yt(xe){return!(xe&xe-1)&&!!xe}function it(xe,je,At){var gr,Ir=je.width,wr=je.height,xr=je.channels;Y(Ir>0&&Ir<=At.maxTextureSize&&wr>0&&wr<=At.maxTextureSize,"invalid texture shape"),(xe.wrapS!==V||xe.wrapT!==V)&&Y(yt(Ir)&&yt(wr),"incompatible wrap mode for texture, both width and height must be power of 2"),je.mipmask===1?Ir!==1&&wr!==1&&Y(xe.minFilter!==ve&&xe.minFilter!==fe&&xe.minFilter!==ce&&xe.minFilter!==ke,"min filter requires mipmap"):(Y(yt(Ir)&&yt(wr),"texture must be a square power of 2 to support mipmapping"),Y(je.mipmask===(Ir<<1)-1,"missing or incomplete mipmap data")),je.type===De&&(At.extensions.indexOf("oes_texture_float_linear")<0&&Y(xe.minFilter===Se&&xe.magFilter===Se,"filter not supported, must enable oes_texture_float_linear"),Y(!xe.genMipmaps,"mipmap generation not supported with float textures"));var Wr=je.images;for(gr=0;gr<16;++gr)if(Wr[gr]){var sn=Ir>>gr,tn=wr>>gr;Y(je.mipmask&1<<gr,"missing mipmap data");var qr=Wr[gr];if(Y(qr.width===sn&&qr.height===tn,"invalid shape for mip images"),Y(qr.format===je.format&&qr.internalformat===je.internalformat&&qr.type===je.type,"incompatible type for mip image"),!qr.compressed)if(qr.data){var fn=Math.ceil(Ye(qr.type,xr)*sn/qr.unpackAlignment)*qr.unpackAlignment;Y(qr.data.byteLength===fn*tn,"invalid data for image, buffer size is inconsistent with image format")}else qr.element||qr.copy}else xe.genMipmaps||Y((je.mipmask&1<<gr)==0,"extra mipmap data");je.compressed&&Y(!xe.genMipmaps,"mipmap generation for compressed images not supported")}function Nt(xe,je,At,gr){var Ir=xe.width,wr=xe.height,xr=xe.channels;Y(Ir>0&&Ir<=gr.maxTextureSize&&wr>0&&wr<=gr.maxTextureSize,"invalid texture shape"),Y(Ir===wr,"cube map must be square"),Y(je.wrapS===V&&je.wrapT===V,"wrap mode not supported by cube map");for(var Wr=0;Wr<At.length;++Wr){var sn=At[Wr];Y(sn.width===Ir&&sn.height===wr,"inconsistent cube map face shape"),je.genMipmaps&&(Y(!sn.compressed,"can not generate mipmap for compressed textures"),Y(sn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var tn=sn.images,qr=0;qr<16;++qr){var fn=tn[qr];if(fn){var wn=Ir>>qr,cn=wr>>qr;Y(sn.mipmask&1<<qr,"missing mipmap data"),Y(fn.width===wn&&fn.height===cn,"invalid shape for mip images"),Y(fn.format===xe.format&&fn.internalformat===xe.internalformat&&fn.type===xe.type,"incompatible type for mip image"),fn.compressed||(fn.data?Y(fn.data.byteLength===wn*cn*Math.max(Ye(fn.type,xr),fn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):fn.element||fn.copy)}}}}var $=v(Y,{optional:H,raise:a,commandRaise:st,command:Wt,parameter:Q,commandParameter:bt,constructor:Re,type:J,commandType:dt,isTypedArray:re,nni:Ke,oneOf:Ge,shaderError:mt,linkError:Xe,callSite:St,saveCommandRef:Tt,saveDrawInfo:ze,framebufferFormat:z,guessCommand:Et,texture2D:it,textureCube:Nt}),$e=0,ie=0,qe=5,jt=6;function lr(xe,je){this.id=$e++,this.type=xe,this.data=je}function ct(xe){return xe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ht(xe){if(xe.length===0)return[];var je=xe.charAt(0),At=xe.charAt(xe.length-1);if(xe.length>1&&je===At&&(je==='"'||je==="'"))return['"'+ct(xe.substr(1,xe.length-2))+'"'];var gr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(xe);if(gr)return ht(xe.substr(0,gr.index)).concat(ht(gr[1])).concat(ht(xe.substr(gr.index+gr[0].length)));var Ir=xe.split(".");if(Ir.length===1)return['"'+ct(xe)+'"'];for(var wr=[],xr=0;xr<Ir.length;++xr)wr=wr.concat(ht(Ir[xr]));return wr}function Pt(xe){return"["+ht(xe).join("][")+"]"}function vt(xe,je){return new lr(xe,Pt(je+""))}function Pe(xe){return typeof xe=="function"&&!xe._reglType||xe instanceof lr}function ut(xe,je){if(typeof xe=="function")return new lr(ie,xe);if(typeof xe=="number"||typeof xe=="boolean")return new lr(qe,xe);if(Array.isArray(xe))return new lr(jt,xe.map(function(At,gr){return ut(At,je+"["+gr+"]")}));if(xe instanceof lr)return xe;$(!1,"invalid option type in uniform "+je)}var Qe={DynamicVariable:lr,define:vt,isDynamic:Pe,unbox:ut,accessor:Pt},Vt={next:typeof requestAnimationFrame=="function"?function(xe){return requestAnimationFrame(xe)}:function(xe){return setTimeout(xe,16)},cancel:typeof cancelAnimationFrame=="function"?function(xe){return cancelAnimationFrame(xe)}:clearTimeout},pr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Zr(){var xe={"":0},je=[""];return{id:function(gr){var Ir=xe[gr];return Ir||(Ir=xe[gr]=je.length,je.push(gr),Ir)},str:function(gr){return je[gr]}}}function cr(xe,je,At){var gr=document.createElement("canvas");v(gr.style,{border:0,margin:0,padding:0,top:0,left:0}),xe.appendChild(gr),xe===document.body&&(gr.style.position="absolute",v(xe.style,{margin:0,padding:0}));function Ir(){var Wr=window.innerWidth,sn=window.innerHeight;if(xe!==document.body){var tn=xe.getBoundingClientRect();Wr=tn.right-tn.left,sn=tn.bottom-tn.top}gr.width=At*Wr,gr.height=At*sn,v(gr.style,{width:Wr+"px",height:sn+"px"})}var wr;xe!==document.body&&typeof ResizeObserver=="function"?(wr=new ResizeObserver(function(){setTimeout(Ir)}),wr.observe(xe)):window.addEventListener("resize",Ir,!1);function xr(){wr?wr.disconnect():window.removeEventListener("resize",Ir),xe.removeChild(gr)}return Ir(),{canvas:gr,onDestroy:xr}}function jn(xe,je){function At(gr){try{return xe.getContext(gr,je)}catch(Ir){return null}}return At("webgl")||At("experimental-webgl")||At("webgl-experimental")}function En(xe){return typeof xe.nodeName=="string"&&typeof xe.appendChild=="function"&&typeof xe.getBoundingClientRect=="function"}function ni(xe){return typeof xe.drawArrays=="function"||typeof xe.drawElements=="function"}function fi(xe){return typeof xe=="string"?xe.split():($(Array.isArray(xe),"invalid extension array"),xe)}function Zn(xe){return typeof xe=="string"?($(typeof document!="undefined","not supported outside of DOM"),document.querySelector(xe)):xe}function Vn(xe){var je=xe||{},At,gr,Ir,wr,xr={},Wr=[],sn=[],tn=typeof window=="undefined"?1:window.devicePixelRatio,qr=!1,fn=function(yr){yr&&$.raise(yr)},wn=function(){};if(typeof je=="string"?($(typeof document!="undefined","selector queries only supported in DOM enviroments"),At=document.querySelector(je),$(At,"invalid query string for element")):typeof je=="object"?En(je)?At=je:ni(je)?(wr=je,Ir=wr.canvas):($.constructor(je),"gl"in je?wr=je.gl:"canvas"in je?Ir=Zn(je.canvas):"container"in je&&(gr=Zn(je.container)),"attributes"in je&&(xr=je.attributes,$.type(xr,"object","invalid context attributes")),"extensions"in je&&(Wr=fi(je.extensions)),"optionalExtensions"in je&&(sn=fi(je.optionalExtensions)),"onDone"in je&&($.type(je.onDone,"function","invalid or missing onDone callback"),fn=je.onDone),"profile"in je&&(qr=!!je.profile),"pixelRatio"in je&&(tn=+je.pixelRatio,$(tn>0,"invalid pixel ratio"))):$.raise("invalid arguments to regl"),At&&(At.nodeName.toLowerCase()==="canvas"?Ir=At:gr=At),!wr){if(!Ir){$(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var cn=cr(gr||document.body,fn,tn);if(!cn)return null;Ir=cn.canvas,wn=cn.onDestroy}xr.premultipliedAlpha===void 0&&(xr.premultipliedAlpha=!0),wr=jn(Ir,xr)}return wr?{gl:wr,canvas:Ir,container:gr,extensions:Wr,optionalExtensions:sn,pixelRatio:tn,profile:qr,onDone:fn,onDestroy:wn}:(wn(),fn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Te(xe,je){var At={};function gr(xr){$.type(xr,"string","extension name must be string");var Wr=xr.toLowerCase(),sn;try{sn=At[Wr]=xe.getExtension(Wr)}catch(tn){}return!!sn}for(var Ir=0;Ir<je.extensions.length;++Ir){var wr=je.extensions[Ir];if(!gr(wr))return je.onDestroy(),je.onDone('"'+wr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return je.optionalExtensions.forEach(gr),{extensions:At,restore:function(){Object.keys(At).forEach(function(Wr){if(At[Wr]&&!gr(Wr))throw new Error("(regl): error restoring extension "+Wr)})}}}function de(xe,je){for(var At=Array(xe),gr=0;gr<xe;++gr)At[gr]=je(gr);return At}var W=5120,se=5121,Le=5122,et=5123,wt=5124,Ne=5125,gt=5126;function qt(xe){for(var je=16;je<=1<<28;je*=16)if(xe<=je)return je;return 0}function zr(xe){var je,At;return je=(xe>65535)<<4,xe>>>=je,At=(xe>255)<<3,xe>>>=At,je|=At,At=(xe>15)<<2,xe>>>=At,je|=At,At=(xe>3)<<1,xe>>>=At,je|=At,je|xe>>1}function Br(){var xe=de(8,function(){return[]});function je(wr){var xr=qt(wr),Wr=xe[zr(xr)>>2];return Wr.length>0?Wr.pop():new ArrayBuffer(xr)}function At(wr){xe[zr(wr.byteLength)>>2].push(wr)}function gr(wr,xr){var Wr=null;switch(wr){case W:Wr=new Int8Array(je(xr),0,xr);break;case se:Wr=new Uint8Array(je(xr),0,xr);break;case Le:Wr=new Int16Array(je(2*xr),0,xr);break;case et:Wr=new Uint16Array(je(2*xr),0,xr);break;case wt:Wr=new Int32Array(je(4*xr),0,xr);break;case Ne:Wr=new Uint32Array(je(4*xr),0,xr);break;case gt:Wr=new Float32Array(je(4*xr),0,xr);break;default:return null}return Wr.length!==xr?Wr.subarray(0,xr):Wr}function Ir(wr){At(wr.buffer)}return{alloc:je,free:At,allocType:gr,freeType:Ir}}var sr=Br();sr.zero=Br();var kr=3408,Cn=3410,dn=3411,Er=3412,Tn=3413,vn=3414,mn=3415,Ar=33901,$r=33902,Mn=3379,Ki=3386,vi=34921,Mi=36347,zi=36348,Ka=35661,hi=35660,ya=34930,Ii=36349,yi=34076,ci=34024,Ra=7936,xo=7937,$a=7938,Ko=35724,Uu=34047,Gi=36063,Pa=34852,ns=3553,na=34067,Ja=34069,is=33984,Ji=6408,lo=5126,co=5121,Ks=36160,wo=36053,Zl=36064,$s=16384,Po=function(je,At){var gr=1;At.ext_texture_filter_anisotropic&&(gr=je.getParameter(Uu));var Ir=1,wr=1;At.webgl_draw_buffers&&(Ir=je.getParameter(Pa),wr=je.getParameter(Gi));var xr=!!At.oes_texture_float;if(xr){var Wr=je.createTexture();je.bindTexture(ns,Wr),je.texImage2D(ns,0,Ji,1,1,0,Ji,lo,null);var sn=je.createFramebuffer();if(je.bindFramebuffer(Ks,sn),je.framebufferTexture2D(Ks,Zl,ns,Wr,0),je.bindTexture(ns,null),je.checkFramebufferStatus(Ks)!==wo)xr=!1;else{je.viewport(0,0,1,1),je.clearColor(1,0,0,1),je.clear($s);var tn=sr.allocType(lo,4);je.readPixels(0,0,1,1,Ji,lo,tn),je.getError()?xr=!1:(je.deleteFramebuffer(sn),je.deleteTexture(Wr),xr=tn[0]===1),sr.freeType(tn)}}var qr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),fn=!0;if(!qr){var wn=je.createTexture(),cn=sr.allocType(co,36);je.activeTexture(is),je.bindTexture(na,wn),je.texImage2D(Ja,0,Ji,3,3,0,Ji,co,cn),sr.freeType(cn),je.bindTexture(na,null),je.deleteTexture(wn),fn=!je.getError()}return{colorBits:[je.getParameter(Cn),je.getParameter(dn),je.getParameter(Er),je.getParameter(Tn)],depthBits:je.getParameter(vn),stencilBits:je.getParameter(mn),subpixelBits:je.getParameter(kr),extensions:Object.keys(At).filter(function(nn){return!!At[nn]}),maxAnisotropic:gr,maxDrawbuffers:Ir,maxColorAttachments:wr,pointSizeDims:je.getParameter(Ar),lineWidthDims:je.getParameter($r),maxViewportDims:je.getParameter(Ki),maxCombinedTextureUnits:je.getParameter(Ka),maxCubeMapSize:je.getParameter(yi),maxRenderbufferSize:je.getParameter(ci),maxTextureUnits:je.getParameter(ya),maxTextureSize:je.getParameter(Mn),maxAttributes:je.getParameter(vi),maxVertexUniforms:je.getParameter(Mi),maxVertexTextureUnits:je.getParameter(hi),maxVaryingVectors:je.getParameter(zi),maxFragmentUniforms:je.getParameter(Ii),glsl:je.getParameter(Ko),renderer:je.getParameter(xo),vendor:je.getParameter(Ra),version:je.getParameter($a),readFloat:xr,npotTextureCube:fn}};function Bt(xe){return!!xe&&typeof xe=="object"&&Array.isArray(xe.shape)&&Array.isArray(xe.stride)&&typeof xe.offset=="number"&&xe.shape.length===xe.stride.length&&(Array.isArray(xe.data)||b(xe.data))}var Fe=function(je){return Object.keys(je).map(function(At){return je[At]})},Ot={shape:ao,flatten:Da};function fr(xe,je,At){for(var gr=0;gr<je;++gr)At[gr]=xe[gr]}function rn(xe,je,At,gr){for(var Ir=0,wr=0;wr<je;++wr)for(var xr=xe[wr],Wr=0;Wr<At;++Wr)gr[Ir++]=xr[Wr]}function bn(xe,je,At,gr,Ir,wr){for(var xr=wr,Wr=0;Wr<je;++Wr)for(var sn=xe[Wr],tn=0;tn<At;++tn)for(var qr=sn[tn],fn=0;fn<gr;++fn)Ir[xr++]=qr[fn]}function Un(xe,je,At,gr,Ir){for(var wr=1,xr=At+1;xr<je.length;++xr)wr*=je[xr];var Wr=je[At];if(je.length-At==4){var sn=je[At+1],tn=je[At+2],qr=je[At+3];for(xr=0;xr<Wr;++xr)bn(xe[xr],sn,tn,qr,gr,Ir),Ir+=wr}else for(xr=0;xr<Wr;++xr)Un(xe[xr],je,At+1,gr,Ir),Ir+=wr}function Da(xe,je,At,gr){var Ir=1;if(je.length)for(var wr=0;wr<je.length;++wr)Ir*=je[wr];else Ir=0;var xr=gr||sr.allocType(At,Ir);switch(je.length){case 0:break;case 1:fr(xe,je[0],xr);break;case 2:rn(xe,je[0],je[1],xr);break;case 3:bn(xe,je[0],je[1],je[2],xr,0);break;default:Un(xe,je,0,xr,0)}return xr}function ao(xe){for(var je=[],At=xe;At.length;At=At[0])je.push(At.length);return je}var bo={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Fo=5120,Vu=5122,Wl=5124,Js=5121,Ic=5123,Il=5125,hs=5126,Ns=5126,fo={int8:Fo,int16:Vu,int32:Wl,uint8:Js,uint16:Ic,uint32:Il,float:hs,float32:Ns},ds=35048,Qs=35040,lu={dynamic:ds,stream:Qs,static:35044},Xl=Ot.flatten,xa=Ot.shape,ka=35044,ml=35040,Fs=5121,ps=5126,It=[];It[5120]=1,It[5122]=2,It[5124]=4,It[5121]=1,It[5123]=2,It[5125]=4,It[5126]=4;function ir(xe){return bo[Object.prototype.toString.call(xe)]|0}function Mr(xe,je){for(var At=0;At<je.length;++At)xe[At]=je[At]}function Gn(xe,je,At,gr,Ir,wr,xr){for(var Wr=0,sn=0;sn<At;++sn)for(var tn=0;tn<gr;++tn)xe[Wr++]=je[Ir*sn+wr*tn+xr]}function Qi(xe,je,At,gr){var Ir=0,wr={};function xr(yr){this.id=Ir++,this.buffer=xe.createBuffer(),this.type=yr,this.usage=ka,this.byteLength=0,this.dimension=1,this.dtype=Fs,this.persistentData=null,At.profile&&(this.stats={size:0})}xr.prototype.bind=function(){xe.bindBuffer(this.type,this.buffer)},xr.prototype.destroy=function(){wn(this)};var Wr=[];function sn(yr,vr){var Xr=Wr.pop();return Xr||(Xr=new xr(yr)),Xr.bind(),fn(Xr,vr,ml,0,1,!1),Xr}function tn(yr){Wr.push(yr)}function qr(yr,vr,Xr){yr.byteLength=vr.byteLength,xe.bufferData(yr.type,vr,Xr)}function fn(yr,vr,Xr,_n,Lr,qn){var Qr;if(yr.usage=Xr,Array.isArray(vr)){if(yr.dtype=_n||ps,vr.length>0){var jr;if(Array.isArray(vr[0])){Qr=xa(vr);for(var Vr=1,Kr=1;Kr<Qr.length;++Kr)Vr*=Qr[Kr];yr.dimension=Vr,jr=Xl(vr,Qr,yr.dtype),qr(yr,jr,Xr),qn?yr.persistentData=jr:sr.freeType(jr)}else if(typeof vr[0]=="number"){yr.dimension=Lr;var Yn=sr.allocType(yr.dtype,vr.length);Mr(Yn,vr),qr(yr,Yn,Xr),qn?yr.persistentData=Yn:sr.freeType(Yn)}else b(vr[0])?(yr.dimension=vr[0].length,yr.dtype=_n||ir(vr[0])||ps,jr=Xl(vr,[vr.length,vr[0].length],yr.dtype),qr(yr,jr,Xr),qn?yr.persistentData=jr:sr.freeType(jr)):$.raise("invalid buffer data")}}else if(b(vr))yr.dtype=_n||ir(vr),yr.dimension=Lr,qr(yr,vr,Xr),qn&&(yr.persistentData=new Uint8Array(new Uint8Array(vr.buffer)));else if(Bt(vr)){Qr=vr.shape;var ti=vr.stride,un=vr.offset,Gr=0,Fr=0,di=0,pi=0;Qr.length===1?(Gr=Qr[0],Fr=1,di=ti[0],pi=0):Qr.length===2?(Gr=Qr[0],Fr=Qr[1],di=ti[0],pi=ti[1]):$.raise("invalid shape"),yr.dtype=_n||ir(vr.data)||ps,yr.dimension=Fr;var kn=sr.allocType(yr.dtype,Gr*Fr);Gn(kn,vr.data,Gr,Fr,di,pi,un),qr(yr,kn,Xr),qn?yr.persistentData=kn:sr.freeType(kn)}else vr instanceof ArrayBuffer?(yr.dtype=Fs,yr.dimension=Lr,qr(yr,vr,Xr),qn&&(yr.persistentData=new Uint8Array(new Uint8Array(vr)))):$.raise("invalid buffer data")}function wn(yr){je.bufferCount--,gr(yr);var vr=yr.buffer;$(vr,"buffer must not be deleted already"),xe.deleteBuffer(vr),yr.buffer=null,delete wr[yr.id]}function cn(yr,vr,Xr,_n){je.bufferCount++;var Lr=new xr(vr);wr[Lr.id]=Lr;function qn(Vr){var Kr=ka,Yn=null,ti=0,un=0,Gr=1;return Array.isArray(Vr)||b(Vr)||Bt(Vr)||Vr instanceof ArrayBuffer?Yn=Vr:typeof Vr=="number"?ti=Vr|0:Vr&&($.type(Vr,"object","buffer arguments must be an object, a number or an array"),"data"in Vr&&($(Yn===null||Array.isArray(Yn)||b(Yn)||Bt(Yn),"invalid data for buffer"),Yn=Vr.data),"usage"in Vr&&($.parameter(Vr.usage,lu,"invalid buffer usage"),Kr=lu[Vr.usage]),"type"in Vr&&($.parameter(Vr.type,fo,"invalid buffer type"),un=fo[Vr.type]),"dimension"in Vr&&($.type(Vr.dimension,"number","invalid dimension"),Gr=Vr.dimension|0),"length"in Vr&&($.nni(ti,"buffer length must be a nonnegative integer"),ti=Vr.length|0)),Lr.bind(),Yn?fn(Lr,Yn,Kr,un,Gr,_n):(ti&&xe.bufferData(Lr.type,ti,Kr),Lr.dtype=un||Fs,Lr.usage=Kr,Lr.dimension=Gr,Lr.byteLength=ti),At.profile&&(Lr.stats.size=Lr.byteLength*It[Lr.dtype]),qn}function Qr(Vr,Kr){$(Kr+Vr.byteLength<=Lr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Vr.byteLength+" starting from offset "+Kr+" to a buffer of size "+Lr.byteLength),xe.bufferSubData(Lr.type,Kr,Vr)}function jr(Vr,Kr){var Yn=(Kr||0)|0,ti;if(Lr.bind(),b(Vr)||Vr instanceof ArrayBuffer)Qr(Vr,Yn);else if(Array.isArray(Vr)){if(Vr.length>0)if(typeof Vr[0]=="number"){var un=sr.allocType(Lr.dtype,Vr.length);Mr(un,Vr),Qr(un,Yn),sr.freeType(un)}else if(Array.isArray(Vr[0])||b(Vr[0])){ti=xa(Vr);var Gr=Xl(Vr,ti,Lr.dtype);Qr(Gr,Yn),sr.freeType(Gr)}else $.raise("invalid buffer data")}else if(Bt(Vr)){ti=Vr.shape;var Fr=Vr.stride,di=0,pi=0,kn=0,Bi=0;ti.length===1?(di=ti[0],pi=1,kn=Fr[0],Bi=0):ti.length===2?(di=ti[0],pi=ti[1],kn=Fr[0],Bi=Fr[1]):$.raise("invalid shape");var _i=Array.isArray(Vr.data)?Lr.dtype:ir(Vr.data),Ui=sr.allocType(_i,di*pi);Gn(Ui,Vr.data,di,pi,kn,Bi,Vr.offset),Qr(Ui,Yn),sr.freeType(Ui)}else $.raise("invalid data for buffer subdata");return qn}return Xr||qn(yr),qn._reglType="buffer",qn._buffer=Lr,qn.subdata=jr,At.profile&&(qn.stats=Lr.stats),qn.destroy=function(){wn(Lr)},qn}function nn(){Fe(wr).forEach(function(yr){yr.buffer=xe.createBuffer(),xe.bindBuffer(yr.type,yr.buffer),xe.bufferData(yr.type,yr.persistentData||yr.byteLength,yr.usage)})}return At.profile&&(je.getTotalBufferSize=function(){var yr=0;return Object.keys(wr).forEach(function(vr){yr+=wr[vr].stats.size}),yr}),{create:cn,createStream:sn,destroyStream:tn,clear:function(){Fe(wr).forEach(wn),Wr.forEach(wn)},getBuffer:function(vr){return vr&&vr._buffer instanceof xr?vr._buffer:null},restore:nn,_initBuffer:fn}}var za=0,Za=0,qi=1,ba=1,_o=4,Bs=4,ha={points:za,point:Za,lines:qi,line:ba,triangles:_o,triangle:Bs,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Yl=0,cu=1,_s=4,gl=5120,fu=5121,Gu=5122,qs=5123,rl=5124,hu=5125,pc=34963,_f=35040,da=35044;function Oc(xe,je,At,gr){var Ir={},wr=0,xr={uint8:fu,uint16:qs};je.oes_element_index_uint&&(xr.uint32=hu);function Wr(nn){this.id=wr++,Ir[this.id]=this,this.buffer=nn,this.primType=_s,this.vertCount=0,this.type=0}Wr.prototype.bind=function(){this.buffer.bind()};var sn=[];function tn(nn){var yr=sn.pop();return yr||(yr=new Wr(At.create(null,pc,!0,!1)._buffer)),fn(yr,nn,_f,-1,-1,0,0),yr}function qr(nn){sn.push(nn)}function fn(nn,yr,vr,Xr,_n,Lr,qn){nn.buffer.bind();var Qr;if(yr){var jr=qn;!qn&&(!b(yr)||Bt(yr)&&!b(yr.data))&&(jr=je.oes_element_index_uint?hu:qs),At._initBuffer(nn.buffer,yr,vr,jr,3)}else xe.bufferData(pc,Lr,vr),nn.buffer.dtype=Qr||fu,nn.buffer.usage=vr,nn.buffer.dimension=3,nn.buffer.byteLength=Lr;if(Qr=qn,!qn){switch(nn.buffer.dtype){case fu:case gl:Qr=fu;break;case qs:case Gu:Qr=qs;break;case hu:case rl:Qr=hu;break;default:$.raise("unsupported type for element array")}nn.buffer.dtype=Qr}nn.type=Qr,$(Qr!==hu||!!je.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Vr=_n;Vr<0&&(Vr=nn.buffer.byteLength,Qr===qs?Vr>>=1:Qr===hu&&(Vr>>=2)),nn.vertCount=Vr;var Kr=Xr;if(Xr<0){Kr=_s;var Yn=nn.buffer.dimension;Yn===1&&(Kr=Yl),Yn===2&&(Kr=cu),Yn===3&&(Kr=_s)}nn.primType=Kr}function wn(nn){gr.elementsCount--,$(nn.buffer!==null,"must not double destroy elements"),delete Ir[nn.id],nn.buffer.destroy(),nn.buffer=null}function cn(nn,yr){var vr=At.create(null,pc,!0),Xr=new Wr(vr._buffer);gr.elementsCount++;function _n(Lr){if(!Lr)vr(),Xr.primType=_s,Xr.vertCount=0,Xr.type=fu;else if(typeof Lr=="number")vr(Lr),Xr.primType=_s,Xr.vertCount=Lr|0,Xr.type=fu;else{var qn=null,Qr=da,jr=-1,Vr=-1,Kr=0,Yn=0;Array.isArray(Lr)||b(Lr)||Bt(Lr)?qn=Lr:($.type(Lr,"object","invalid arguments for elements"),"data"in Lr&&(qn=Lr.data,$(Array.isArray(qn)||b(qn)||Bt(qn),"invalid data for element buffer")),"usage"in Lr&&($.parameter(Lr.usage,lu,"invalid element buffer usage"),Qr=lu[Lr.usage]),"primitive"in Lr&&($.parameter(Lr.primitive,ha,"invalid element buffer primitive"),jr=ha[Lr.primitive]),"count"in Lr&&($(typeof Lr.count=="number"&&Lr.count>=0,"invalid vertex count for elements"),Vr=Lr.count|0),"type"in Lr&&($.parameter(Lr.type,xr,"invalid buffer type"),Yn=xr[Lr.type]),"length"in Lr?Kr=Lr.length|0:(Kr=Vr,Yn===qs||Yn===Gu?Kr*=2:(Yn===hu||Yn===rl)&&(Kr*=4))),fn(Xr,qn,Qr,jr,Vr,Kr,Yn)}return _n}return _n(nn),_n._reglType="elements",_n._elements=Xr,_n.subdata=function(Lr,qn){return vr.subdata(Lr,qn),_n},_n.destroy=function(){wn(Xr)},_n}return{create:cn,createStream:tn,destroyStream:qr,getElements:function(yr){return typeof yr=="function"&&yr._elements instanceof Wr?yr._elements:null},clear:function(){Fe(Ir).forEach(wn)}}}var vc=new Float32Array(1),qc=new Uint32Array(vc.buffer),ef=5123;function tf(xe){for(var je=sr.allocType(ef,xe.length),At=0;At<xe.length;++At)if(isNaN(xe[At]))je[At]=65535;else if(xe[At]===Infinity)je[At]=31744;else if(xe[At]===-Infinity)je[At]=64512;else{vc[0]=xe[At];var gr=qc[0],Ir=gr>>>31<<15,wr=(gr<<1>>>24)-127,xr=gr>>13&(1<<10)-1;if(wr<-24)je[At]=Ir;else if(wr<-14){var Wr=-14-wr;je[At]=Ir+(xr+(1<<10)>>Wr)}else wr>15?je[At]=Ir+31744:je[At]=Ir+(wr+15<<10)+xr}return je}function Qa(xe){return Array.isArray(xe)||b(xe)}var Au=function(je){return!(je&je-1)&&!!je},eu=34467,vs=3553,Lc=34067,mc=34069,yl=6408,nl=6406,gc=6407,tu=6409,Hu=6410,Rc=32854,Kl=32855,_a=36194,Dc=32819,Mf=32820,yc=33635,zc=34042,$l=6402,Zu=34041,Cu=35904,Ol=35906,Bo=36193,Jl=33776,Ll=33777,xl=33778,Nc=33779,Rl=35986,ru=35987,mf=34798,gf=35840,rf=35841,bl=35842,ja=35843,il=36196,Dl=5121,xc=5123,Fc=5125,zl=5126,If=10242,Of=10243,nf=10497,Sl=33071,Ql=33648,wu=10240,ks=10241,al=9728,Bc=9729,Wu=9984,Ua=9985,du=9986,ol=9987,sl=33170,Ni=4352,pa=4353,Ms=4354,Ea=34046,Zi=3317,ql=37440,yf=37441,as=37443,ul=37444,pu=33984,Xu=[Wu,du,Ua,ol],oo=[0,tu,Hu,gc,yl],os={};os[tu]=os[nl]=os[$l]=1,os[Zu]=os[Hu]=2,os[gc]=os[Cu]=3,os[yl]=os[Ol]=4;function Nl(xe){return"[object "+xe+"]"}var ho=Nl("HTMLCanvasElement"),In=Nl("OffscreenCanvas"),js=Nl("CanvasRenderingContext2D"),bc=Nl("ImageBitmap"),El=Nl("HTMLImageElement"),Pu=Nl("HTMLVideoElement"),Us=Object.keys(bo).concat([ho,In,js,bc,El,Pu]),ea=[];ea[Dl]=1,ea[zl]=4,ea[Bo]=2,ea[xc]=2,ea[Fc]=4;var en=[];en[Rc]=2,en[Kl]=2,en[_a]=2,en[Zu]=4,en[Jl]=.5,en[Ll]=.5,en[xl]=1,en[Nc]=1,en[Rl]=.5,en[ru]=1,en[mf]=1,en[gf]=.5,en[rf]=.25,en[bl]=.5,en[ja]=.25,en[il]=.5;function kc(xe){return Array.isArray(xe)&&(xe.length===0||typeof xe[0]=="number")}function Sc(xe){if(!Array.isArray(xe))return!1;var je=xe.length;return!(je===0||!Qa(xe[0]))}function ll(xe){return Object.prototype.toString.call(xe)}function vu(xe){return ll(xe)===ho}function Is(xe){return ll(xe)===In}function Os(xe){return ll(xe)===js}function $o(xe){return ll(xe)===bc}function ko(xe){return ll(xe)===El}function cl(xe){return ll(xe)===Pu}function Tl(xe){if(!xe)return!1;var je=ll(xe);return Us.indexOf(je)>=0?!0:kc(xe)||Sc(xe)||Bt(xe)}function Fl(xe){return bo[Object.prototype.toString.call(xe)]|0}function af(xe,je){var At=je.length;switch(xe.type){case Dl:case xc:case Fc:case zl:var gr=sr.allocType(xe.type,At);gr.set(je),xe.data=gr;break;case Bo:xe.data=tf(je);break;default:$.raise("unsupported texture type, must specify a typed array")}}function Bl(xe,je){return sr.allocType(xe.type===Bo?zl:xe.type,je)}function Ls(xe,je){xe.type===Bo?(xe.data=tf(je),sr.freeType(je)):xe.data=je}function ss(xe,je,At,gr,Ir,wr){for(var xr=xe.width,Wr=xe.height,sn=xe.channels,tn=xr*Wr*sn,qr=Bl(xe,tn),fn=0,wn=0;wn<Wr;++wn)for(var cn=0;cn<xr;++cn)for(var nn=0;nn<sn;++nn)qr[fn++]=je[At*cn+gr*wn+Ir*nn+wr];Ls(xe,qr)}function Oi(xe,je,At,gr,Ir,wr){var xr;if(typeof en[xe]!="undefined"?xr=en[xe]:xr=os[xe]*ea[je],wr&&(xr*=6),Ir){for(var Wr=0,sn=At;sn>=1;)Wr+=xr*sn*sn,sn/=2;return Wr}else return xr*At*gr}function Yu(xe,je,At,gr,Ir,wr,xr){var Wr={"don't care":Ni,"dont care":Ni,nice:Ms,fast:pa},sn={repeat:nf,clamp:Sl,mirror:Ql},tn={nearest:al,linear:Bc},qr=v({mipmap:ol,"nearest mipmap nearest":Wu,"linear mipmap nearest":Ua,"nearest mipmap linear":du,"linear mipmap linear":ol},tn),fn={none:0,browser:ul},wn={uint8:Dl,rgba4:Dc,rgb565:yc,"rgb5 a1":Mf},cn={alpha:nl,luminance:tu,"luminance alpha":Hu,rgb:gc,rgba:yl,rgba4:Rc,"rgb5 a1":Kl,rgb565:_a},nn={};je.ext_srgb&&(cn.srgb=Cu,cn.srgba=Ol),je.oes_texture_float&&(wn.float32=wn.float=zl),je.oes_texture_half_float&&(wn.float16=wn["half float"]=Bo),je.webgl_depth_texture&&(v(cn,{depth:$l,"depth stencil":Zu}),v(wn,{uint16:xc,uint32:Fc,"depth stencil":zc})),je.webgl_compressed_texture_s3tc&&v(nn,{"rgb s3tc dxt1":Jl,"rgba s3tc dxt1":Ll,"rgba s3tc dxt3":xl,"rgba s3tc dxt5":Nc}),je.webgl_compressed_texture_atc&&v(nn,{"rgb atc":Rl,"rgba atc explicit alpha":ru,"rgba atc interpolated alpha":mf}),je.webgl_compressed_texture_pvrtc&&v(nn,{"rgb pvrtc 4bppv1":gf,"rgb pvrtc 2bppv1":rf,"rgba pvrtc 4bppv1":bl,"rgba pvrtc 2bppv1":ja}),je.webgl_compressed_texture_etc1&&(nn["rgb etc1"]=il);var yr=Array.prototype.slice.call(xe.getParameter(eu));Object.keys(nn).forEach(function(Lt){var Sr=nn[Lt];yr.indexOf(Sr)>=0&&(cn[Lt]=Sr)});var vr=Object.keys(cn);At.textureFormats=vr;var Xr=[];Object.keys(cn).forEach(function(Lt){var Sr=cn[Lt];Xr[Sr]=Lt});var _n=[];Object.keys(wn).forEach(function(Lt){var Sr=wn[Lt];_n[Sr]=Lt});var Lr=[];Object.keys(tn).forEach(function(Lt){var Sr=tn[Lt];Lr[Sr]=Lt});var qn=[];Object.keys(qr).forEach(function(Lt){var Sr=qr[Lt];qn[Sr]=Lt});var Qr=[];Object.keys(sn).forEach(function(Lt){var Sr=sn[Lt];Qr[Sr]=Lt});var jr=vr.reduce(function(Lt,Sr){var mr=cn[Sr];return mr===tu||mr===nl||mr===tu||mr===Hu||mr===$l||mr===Zu||je.ext_srgb&&(mr===Cu||mr===Ol)?Lt[mr]=mr:mr===Kl||Sr.indexOf("rgba")>=0?Lt[mr]=yl:Lt[mr]=gc,Lt},{});function Vr(){this.internalformat=yl,this.format=yl,this.type=Dl,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=ul,this.width=0,this.height=0,this.channels=0}function Kr(Lt,Sr){Lt.internalformat=Sr.internalformat,Lt.format=Sr.format,Lt.type=Sr.type,Lt.compressed=Sr.compressed,Lt.premultiplyAlpha=Sr.premultiplyAlpha,Lt.flipY=Sr.flipY,Lt.unpackAlignment=Sr.unpackAlignment,Lt.colorSpace=Sr.colorSpace,Lt.width=Sr.width,Lt.height=Sr.height,Lt.channels=Sr.channels}function Yn(Lt,Sr){if(!(typeof Sr!="object"||!Sr)){if("premultiplyAlpha"in Sr&&($.type(Sr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Lt.premultiplyAlpha=Sr.premultiplyAlpha),"flipY"in Sr&&($.type(Sr.flipY,"boolean","invalid texture flip"),Lt.flipY=Sr.flipY),"alignment"in Sr&&($.oneOf(Sr.alignment,[1,2,4,8],"invalid texture unpack alignment"),Lt.unpackAlignment=Sr.alignment),"colorSpace"in Sr&&($.parameter(Sr.colorSpace,fn,"invalid colorSpace"),Lt.colorSpace=fn[Sr.colorSpace]),"type"in Sr){var mr=Sr.type;$(je.oes_texture_float||!(mr==="float"||mr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),$(je.oes_texture_half_float||!(mr==="half float"||mr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),$(je.webgl_depth_texture||!(mr==="uint16"||mr==="uint32"||mr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(mr,wn,"invalid texture type"),Lt.type=wn[mr]}var Dn=Lt.width,P=Lt.height,p=Lt.channels,s=!1;"shape"in Sr?($(Array.isArray(Sr.shape)&&Sr.shape.length>=2,"shape must be an array"),Dn=Sr.shape[0],P=Sr.shape[1],Sr.shape.length===3&&(p=Sr.shape[2],$(p>0&&p<=4,"invalid number of channels"),s=!0),$(Dn>=0&&Dn<=At.maxTextureSize,"invalid width"),$(P>=0&&P<=At.maxTextureSize,"invalid height")):("radius"in Sr&&(Dn=P=Sr.radius,$(Dn>=0&&Dn<=At.maxTextureSize,"invalid radius")),"width"in Sr&&(Dn=Sr.width,$(Dn>=0&&Dn<=At.maxTextureSize,"invalid width")),"height"in Sr&&(P=Sr.height,$(P>=0&&P<=At.maxTextureSize,"invalid height")),"channels"in Sr&&(p=Sr.channels,$(p>0&&p<=4,"invalid number of channels"),s=!0)),Lt.width=Dn|0,Lt.height=P|0,Lt.channels=p|0;var d=!1;if("format"in Sr){var g=Sr.format;$(je.webgl_depth_texture||!(g==="depth"||g==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),$.parameter(g,cn,"invalid texture format");var L=Lt.internalformat=cn[g];Lt.format=jr[L],g in wn&&("type"in Sr||(Lt.type=wn[g])),g in nn&&(Lt.compressed=!0),d=!0}!s&&d?Lt.channels=os[Lt.format]:s&&!d?Lt.channels!==oo[Lt.format]&&(Lt.format=Lt.internalformat=oo[Lt.channels]):d&&s&&$(Lt.channels===os[Lt.format],"number of channels inconsistent with specified format")}}function ti(Lt){xe.pixelStorei(ql,Lt.flipY),xe.pixelStorei(yf,Lt.premultiplyAlpha),xe.pixelStorei(as,Lt.colorSpace),xe.pixelStorei(Zi,Lt.unpackAlignment)}function un(){Vr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Gr(Lt,Sr){var mr=null;if(Tl(Sr)?mr=Sr:Sr&&($.type(Sr,"object","invalid pixel data type"),Yn(Lt,Sr),"x"in Sr&&(Lt.xOffset=Sr.x|0),"y"in Sr&&(Lt.yOffset=Sr.y|0),Tl(Sr.data)&&(mr=Sr.data)),$(!Lt.compressed||mr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Sr.copy){$(!mr,"can not specify copy and data field for the same texture");var Dn=Ir.viewportWidth,P=Ir.viewportHeight;Lt.width=Lt.width||Dn-Lt.xOffset,Lt.height=Lt.height||P-Lt.yOffset,Lt.needsCopy=!0,$(Lt.xOffset>=0&&Lt.xOffset<Dn&&Lt.yOffset>=0&&Lt.yOffset<P&&Lt.width>0&&Lt.width<=Dn&&Lt.height>0&&Lt.height<=P,"copy texture read out of bounds")}else if(!mr)Lt.width=Lt.width||1,Lt.height=Lt.height||1,Lt.channels=Lt.channels||4;else if(b(mr))Lt.channels=Lt.channels||4,Lt.data=mr,!("type"in Sr)&&Lt.type===Dl&&(Lt.type=Fl(mr));else if(kc(mr))Lt.channels=Lt.channels||4,af(Lt,mr),Lt.alignment=1,Lt.needsFree=!0;else if(Bt(mr)){var p=mr.data;!Array.isArray(p)&&Lt.type===Dl&&(Lt.type=Fl(p));var s=mr.shape,d=mr.stride,g,L,N,K,ee,X;s.length===3?(N=s[2],X=d[2]):($(s.length===2,"invalid ndarray pixel data, must be 2 or 3D"),N=1,X=1),g=s[0],L=s[1],K=d[0],ee=d[1],Lt.alignment=1,Lt.width=g,Lt.height=L,Lt.channels=N,Lt.format=Lt.internalformat=oo[N],Lt.needsFree=!0,ss(Lt,p,K,ee,X,mr.offset)}else if(vu(mr)||Is(mr)||Os(mr))vu(mr)||Is(mr)?Lt.element=mr:Lt.element=mr.canvas,Lt.width=Lt.element.width,Lt.height=Lt.element.height,Lt.channels=4;else if($o(mr))Lt.element=mr,Lt.width=mr.width,Lt.height=mr.height,Lt.channels=4;else if(ko(mr))Lt.element=mr,Lt.width=mr.naturalWidth,Lt.height=mr.naturalHeight,Lt.channels=4;else if(cl(mr))Lt.element=mr,Lt.width=mr.videoWidth,Lt.height=mr.videoHeight,Lt.channels=4;else if(Sc(mr)){var be=Lt.width||mr[0].length,me=Lt.height||mr.length,Be=Lt.channels;Qa(mr[0][0])?Be=Be||mr[0][0].length:Be=Be||1;for(var pt=Ot.shape(mr),Kt=1,kt=0;kt<pt.length;++kt)Kt*=pt[kt];var Qt=Bl(Lt,Kt);Ot.flatten(mr,pt,"",Qt),Ls(Lt,Qt),Lt.alignment=1,Lt.width=be,Lt.height=me,Lt.channels=Be,Lt.format=Lt.internalformat=oo[Be],Lt.needsFree=!0}Lt.type===zl?$(At.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Lt.type===Bo&&$(At.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Fr(Lt,Sr,mr){var Dn=Lt.element,P=Lt.data,p=Lt.internalformat,s=Lt.format,d=Lt.type,g=Lt.width,L=Lt.height;ti(Lt),Dn?xe.texImage2D(Sr,mr,s,s,d,Dn):Lt.compressed?xe.compressedTexImage2D(Sr,mr,p,g,L,0,P):Lt.needsCopy?(gr(),xe.copyTexImage2D(Sr,mr,s,Lt.xOffset,Lt.yOffset,g,L,0)):xe.texImage2D(Sr,mr,s,g,L,0,s,d,P||null)}function di(Lt,Sr,mr,Dn,P){var p=Lt.element,s=Lt.data,d=Lt.internalformat,g=Lt.format,L=Lt.type,N=Lt.width,K=Lt.height;ti(Lt),p?xe.texSubImage2D(Sr,P,mr,Dn,g,L,p):Lt.compressed?xe.compressedTexSubImage2D(Sr,P,mr,Dn,d,N,K,s):Lt.needsCopy?(gr(),xe.copyTexSubImage2D(Sr,P,mr,Dn,Lt.xOffset,Lt.yOffset,N,K)):xe.texSubImage2D(Sr,P,mr,Dn,N,K,g,L,s)}var pi=[];function kn(){return pi.pop()||new un}function Bi(Lt){Lt.needsFree&&sr.freeType(Lt.data),un.call(Lt),pi.push(Lt)}function _i(){Vr.call(this),this.genMipmaps=!1,this.mipmapHint=Ni,this.mipmask=0,this.images=Array(16)}function Ui(Lt,Sr,mr){var Dn=Lt.images[0]=kn();Lt.mipmask=1,Dn.width=Lt.width=Sr,Dn.height=Lt.height=mr,Dn.channels=Lt.channels=4}function ca(Lt,Sr){var mr=null;if(Tl(Sr))mr=Lt.images[0]=kn(),Kr(mr,Lt),Gr(mr,Sr),Lt.mipmask=1;else if(Yn(Lt,Sr),Array.isArray(Sr.mipmap))for(var Dn=Sr.mipmap,P=0;P<Dn.length;++P)mr=Lt.images[P]=kn(),Kr(mr,Lt),mr.width>>=P,mr.height>>=P,Gr(mr,Dn[P]),Lt.mipmask|=1<<P;else mr=Lt.images[0]=kn(),Kr(mr,Lt),Gr(mr,Sr),Lt.mipmask=1;Kr(Lt,Lt.images[0]),Lt.compressed&&(Lt.internalformat===Jl||Lt.internalformat===Ll||Lt.internalformat===xl||Lt.internalformat===Nc)&&$(Lt.width%4==0&&Lt.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Go(Lt,Sr){for(var mr=Lt.images,Dn=0;Dn<mr.length;++Dn){if(!mr[Dn])return;Fr(mr[Dn],Sr,Dn)}}var Ho=[];function ta(){var Lt=Ho.pop()||new _i;Vr.call(Lt),Lt.mipmask=0;for(var Sr=0;Sr<16;++Sr)Lt.images[Sr]=null;return Lt}function mo(Lt){for(var Sr=Lt.images,mr=0;mr<Sr.length;++mr)Sr[mr]&&Bi(Sr[mr]),Sr[mr]=null;Ho.push(Lt)}function Oa(){this.minFilter=al,this.magFilter=al,this.wrapS=Sl,this.wrapT=Sl,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ni}function ws(Lt,Sr){if("min"in Sr){var mr=Sr.min;$.parameter(mr,qr),Lt.minFilter=qr[mr],Xu.indexOf(Lt.minFilter)>=0&&!("faces"in Sr)&&(Lt.genMipmaps=!0)}if("mag"in Sr){var Dn=Sr.mag;$.parameter(Dn,tn),Lt.magFilter=tn[Dn]}var P=Lt.wrapS,p=Lt.wrapT;if("wrap"in Sr){var s=Sr.wrap;typeof s=="string"?($.parameter(s,sn),P=p=sn[s]):Array.isArray(s)&&($.parameter(s[0],sn),$.parameter(s[1],sn),P=sn[s[0]],p=sn[s[1]])}else{if("wrapS"in Sr){var d=Sr.wrapS;$.parameter(d,sn),P=sn[d]}if("wrapT"in Sr){var g=Sr.wrapT;$.parameter(g,sn),p=sn[g]}}if(Lt.wrapS=P,Lt.wrapT=p,"anisotropic"in Sr){var L=Sr.anisotropic;$(typeof L=="number"&&L>=1&&L<=At.maxAnisotropic,"aniso samples must be between 1 and "),Lt.anisotropic=Sr.anisotropic}if("mipmap"in Sr){var N=!1;switch(typeof Sr.mipmap){case"string":$.parameter(Sr.mipmap,Wr,"invalid mipmap hint"),Lt.mipmapHint=Wr[Sr.mipmap],Lt.genMipmaps=!0,N=!0;break;case"boolean":N=Lt.genMipmaps=Sr.mipmap;break;case"object":$(Array.isArray(Sr.mipmap),"invalid mipmap type"),Lt.genMipmaps=!1,N=!0;break;default:$.raise("invalid mipmap type")}N&&!("min"in Sr)&&(Lt.minFilter=Wu)}}function Qo(Lt,Sr){xe.texParameteri(Sr,ks,Lt.minFilter),xe.texParameteri(Sr,wu,Lt.magFilter),xe.texParameteri(Sr,If,Lt.wrapS),xe.texParameteri(Sr,Of,Lt.wrapT),je.ext_texture_filter_anisotropic&&xe.texParameteri(Sr,Ea,Lt.anisotropic),Lt.genMipmaps&&(xe.hint(sl,Lt.mipmapHint),xe.generateMipmap(Sr))}var xs=0,qo={},Zs=At.maxTextureUnits,No=Array(Zs).map(function(){return null});function ui(Lt){Vr.call(this),this.mipmask=0,this.internalformat=yl,this.id=xs++,this.refCount=1,this.target=Lt,this.texture=xe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Oa,xr.profile&&(this.stats={size:0})}function Ws(Lt){xe.activeTexture(pu),xe.bindTexture(Lt.target,Lt.texture)}function Ca(){var Lt=No[0];Lt?xe.bindTexture(Lt.target,Lt.texture):xe.bindTexture(vs,null)}function Sn(Lt){var Sr=Lt.texture;$(Sr,"must not double destroy texture");var mr=Lt.unit,Dn=Lt.target;mr>=0&&(xe.activeTexture(pu+mr),xe.bindTexture(Dn,null),No[mr]=null),xe.deleteTexture(Sr),Lt.texture=null,Lt.params=null,Lt.pixels=null,Lt.refCount=0,delete qo[Lt.id],wr.textureCount--}v(ui.prototype,{bind:function(){var Sr=this;Sr.bindCount+=1;var mr=Sr.unit;if(mr<0){for(var Dn=0;Dn<Zs;++Dn){var P=No[Dn];if(P){if(P.bindCount>0)continue;P.unit=-1}No[Dn]=Sr,mr=Dn;break}mr>=Zs&&$.raise("insufficient number of texture units"),xr.profile&&wr.maxTextureUnits<mr+1&&(wr.maxTextureUnits=mr+1),Sr.unit=mr,xe.activeTexture(pu+mr),xe.bindTexture(Sr.target,Sr.texture)}return mr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Sn(this)}});function Ri(Lt,Sr){var mr=new ui(vs);qo[mr.id]=mr,wr.textureCount++;function Dn(s,d){var g=mr.texInfo;Oa.call(g);var L=ta();return typeof s=="number"?typeof d=="number"?Ui(L,s|0,d|0):Ui(L,s|0,s|0):s?($.type(s,"object","invalid arguments to regl.texture"),ws(g,s),ca(L,s)):Ui(L,1,1),g.genMipmaps&&(L.mipmask=(L.width<<1)-1),mr.mipmask=L.mipmask,Kr(mr,L),$.texture2D(g,L,At),mr.internalformat=L.internalformat,Dn.width=L.width,Dn.height=L.height,Ws(mr),Go(L,vs),Qo(g,vs),Ca(),mo(L),xr.profile&&(mr.stats.size=Oi(mr.internalformat,mr.type,L.width,L.height,g.genMipmaps,!1)),Dn.format=Xr[mr.internalformat],Dn.type=_n[mr.type],Dn.mag=Lr[g.magFilter],Dn.min=qn[g.minFilter],Dn.wrapS=Qr[g.wrapS],Dn.wrapT=Qr[g.wrapT],Dn}function P(s,d,g,L){$(!!s,"must specify image data");var N=d|0,K=g|0,ee=L|0,X=kn();return Kr(X,mr),X.width=0,X.height=0,Gr(X,s),X.width=X.width||(mr.width>>ee)-N,X.height=X.height||(mr.height>>ee)-K,$(mr.type===X.type&&mr.format===X.format&&mr.internalformat===X.internalformat,"incompatible format for texture.subimage"),$(N>=0&&K>=0&&N+X.width<=mr.width&&K+X.height<=mr.height,"texture.subimage write out of bounds"),$(mr.mipmask&1<<ee,"missing mipmap data"),$(X.data||X.element||X.needsCopy,"missing image data"),Ws(mr),di(X,vs,N,K,ee),Ca(),Bi(X),Dn}function p(s,d){var g=s|0,L=d|0||g;if(g===mr.width&&L===mr.height)return Dn;Dn.width=mr.width=g,Dn.height=mr.height=L,Ws(mr);for(var N=0;mr.mipmask>>N;++N){var K=g>>N,ee=L>>N;if(!K||!ee)break;xe.texImage2D(vs,N,mr.format,K,ee,0,mr.format,mr.type,null)}return Ca(),xr.profile&&(mr.stats.size=Oi(mr.internalformat,mr.type,g,L,!1,!1)),Dn}return Dn(Lt,Sr),Dn.subimage=P,Dn.resize=p,Dn._reglType="texture2d",Dn._texture=mr,xr.profile&&(Dn.stats=mr.stats),Dn.destroy=function(){mr.decRef()},Dn}function Vi(Lt,Sr,mr,Dn,P,p){var s=new ui(Lc);qo[s.id]=s,wr.cubeCount++;var d=new Array(6);function g(K,ee,X,be,me,Be){var pt,Kt=s.texInfo;for(Oa.call(Kt),pt=0;pt<6;++pt)d[pt]=ta();if(typeof K=="number"||!K){var kt=K|0||1;for(pt=0;pt<6;++pt)Ui(d[pt],kt,kt)}else if(typeof K=="object")if(ee)ca(d[0],K),ca(d[1],ee),ca(d[2],X),ca(d[3],be),ca(d[4],me),ca(d[5],Be);else if(ws(Kt,K),Yn(s,K),"faces"in K){var Qt=K.faces;for($(Array.isArray(Qt)&&Qt.length===6,"cube faces must be a length 6 array"),pt=0;pt<6;++pt)$(typeof Qt[pt]=="object"&&!!Qt[pt],"invalid input for cube map face"),Kr(d[pt],s),ca(d[pt],Qt[pt])}else for(pt=0;pt<6;++pt)ca(d[pt],K);else $.raise("invalid arguments to cube map");for(Kr(s,d[0]),At.npotTextureCube||$(Au(s.width)&&Au(s.height),"your browser does not support non power or two texture dimensions"),Kt.genMipmaps?s.mipmask=(d[0].width<<1)-1:s.mipmask=d[0].mipmask,$.textureCube(s,Kt,d,At),s.internalformat=d[0].internalformat,g.width=d[0].width,g.height=d[0].height,Ws(s),pt=0;pt<6;++pt)Go(d[pt],mc+pt);for(Qo(Kt,Lc),Ca(),xr.profile&&(s.stats.size=Oi(s.internalformat,s.type,g.width,g.height,Kt.genMipmaps,!0)),g.format=Xr[s.internalformat],g.type=_n[s.type],g.mag=Lr[Kt.magFilter],g.min=qn[Kt.minFilter],g.wrapS=Qr[Kt.wrapS],g.wrapT=Qr[Kt.wrapT],pt=0;pt<6;++pt)mo(d[pt]);return g}function L(K,ee,X,be,me){$(!!ee,"must specify image data"),$(typeof K=="number"&&K===(K|0)&&K>=0&&K<6,"invalid face");var Be=X|0,pt=be|0,Kt=me|0,kt=kn();return Kr(kt,s),kt.width=0,kt.height=0,Gr(kt,ee),kt.width=kt.width||(s.width>>Kt)-Be,kt.height=kt.height||(s.height>>Kt)-pt,$(s.type===kt.type&&s.format===kt.format&&s.internalformat===kt.internalformat,"incompatible format for texture.subimage"),$(Be>=0&&pt>=0&&Be+kt.width<=s.width&&pt+kt.height<=s.height,"texture.subimage write out of bounds"),$(s.mipmask&1<<Kt,"missing mipmap data"),$(kt.data||kt.element||kt.needsCopy,"missing image data"),Ws(s),di(kt,mc+K,Be,pt,Kt),Ca(),Bi(kt),g}function N(K){var ee=K|0;if(ee!==s.width){g.width=s.width=ee,g.height=s.height=ee,Ws(s);for(var X=0;X<6;++X)for(var be=0;s.mipmask>>be;++be)xe.texImage2D(mc+X,be,s.format,ee>>be,ee>>be,0,s.format,s.type,null);return Ca(),xr.profile&&(s.stats.size=Oi(s.internalformat,s.type,g.width,g.height,!1,!0)),g}}return g(Lt,Sr,mr,Dn,P,p),g.subimage=L,g.resize=N,g._reglType="textureCube",g._texture=s,xr.profile&&(g.stats=s.stats),g.destroy=function(){s.decRef()},g}function es(){for(var Lt=0;Lt<Zs;++Lt)xe.activeTexture(pu+Lt),xe.bindTexture(vs,null),No[Lt]=null;Fe(qo).forEach(Sn),wr.cubeCount=0,wr.textureCount=0}xr.profile&&(wr.getTotalTextureSize=function(){var Lt=0;return Object.keys(qo).forEach(function(Sr){Lt+=qo[Sr].stats.size}),Lt});function au(){for(var Lt=0;Lt<Zs;++Lt){var Sr=No[Lt];Sr&&(Sr.bindCount=0,Sr.unit=-1,No[Lt]=null)}Fe(qo).forEach(function(mr){mr.texture=xe.createTexture(),xe.bindTexture(mr.target,mr.texture);for(var Dn=0;Dn<32;++Dn)if((mr.mipmask&1<<Dn)!=0)if(mr.target===vs)xe.texImage2D(vs,Dn,mr.internalformat,mr.width>>Dn,mr.height>>Dn,0,mr.internalformat,mr.type,null);else for(var P=0;P<6;++P)xe.texImage2D(mc+P,Dn,mr.internalformat,mr.width>>Dn,mr.height>>Dn,0,mr.internalformat,mr.type,null);Qo(mr.texInfo,mr.target)})}function hc(){for(var Lt=0;Lt<Zs;++Lt){var Sr=No[Lt];Sr&&(Sr.bindCount=0,Sr.unit=-1,No[Lt]=null),xe.activeTexture(pu+Lt),xe.bindTexture(vs,null),xe.bindTexture(Lc,null)}}return{create2D:Ri,createCube:Vi,clear:es,getTexture:function(Sr){return null},restore:au,refresh:hc}}var Va=36161,Mo=32854,Al=32855,mu=36194,gu=33189,Ts=36168,Ec=34041,$n=35907,Fn=34836,Tc=34842,ms=34843,jo=[];jo[Mo]=2,jo[Al]=2,jo[mu]=2,jo[gu]=2,jo[Ts]=1,jo[Ec]=4,jo[$n]=4,jo[Fn]=16,jo[Tc]=8,jo[ms]=6;function Io(xe,je,At){return jo[xe]*je*At}var nu=function(je,At,gr,Ir,wr){var xr={rgba4:Mo,rgb565:mu,"rgb5 a1":Al,depth:gu,stencil:Ts,"depth stencil":Ec};At.ext_srgb&&(xr.srgba=$n),At.ext_color_buffer_half_float&&(xr.rgba16f=Tc,xr.rgb16f=ms),At.webgl_color_buffer_float&&(xr.rgba32f=Fn);var Wr=[];Object.keys(xr).forEach(function(nn){var yr=xr[nn];Wr[yr]=nn});var sn=0,tn={};function qr(nn){this.id=sn++,this.refCount=1,this.renderbuffer=nn,this.format=Mo,this.width=0,this.height=0,wr.profile&&(this.stats={size:0})}qr.prototype.decRef=function(){--this.refCount<=0&&fn(this)};function fn(nn){var yr=nn.renderbuffer;$(yr,"must not double destroy renderbuffer"),je.bindRenderbuffer(Va,null),je.deleteRenderbuffer(yr),nn.renderbuffer=null,nn.refCount=0,delete tn[nn.id],Ir.renderbufferCount--}function wn(nn,yr){var vr=new qr(je.createRenderbuffer());tn[vr.id]=vr,Ir.renderbufferCount++;function Xr(Lr,qn){var Qr=0,jr=0,Vr=Mo;if(typeof Lr=="object"&&Lr){var Kr=Lr;if("shape"in Kr){var Yn=Kr.shape;$(Array.isArray(Yn)&&Yn.length>=2,"invalid renderbuffer shape"),Qr=Yn[0]|0,jr=Yn[1]|0}else"radius"in Kr&&(Qr=jr=Kr.radius|0),"width"in Kr&&(Qr=Kr.width|0),"height"in Kr&&(jr=Kr.height|0);"format"in Kr&&($.parameter(Kr.format,xr,"invalid renderbuffer format"),Vr=xr[Kr.format])}else typeof Lr=="number"?(Qr=Lr|0,typeof qn=="number"?jr=qn|0:jr=Qr):Lr?$.raise("invalid arguments to renderbuffer constructor"):Qr=jr=1;if($(Qr>0&&jr>0&&Qr<=gr.maxRenderbufferSize&&jr<=gr.maxRenderbufferSize,"invalid renderbuffer size"),!(Qr===vr.width&&jr===vr.height&&Vr===vr.format))return Xr.width=vr.width=Qr,Xr.height=vr.height=jr,vr.format=Vr,je.bindRenderbuffer(Va,vr.renderbuffer),je.renderbufferStorage(Va,Vr,Qr,jr),$(je.getError()===0,"invalid render buffer format"),wr.profile&&(vr.stats.size=Io(vr.format,vr.width,vr.height)),Xr.format=Wr[vr.format],Xr}function _n(Lr,qn){var Qr=Lr|0,jr=qn|0||Qr;return Qr===vr.width&&jr===vr.height||($(Qr>0&&jr>0&&Qr<=gr.maxRenderbufferSize&&jr<=gr.maxRenderbufferSize,"invalid renderbuffer size"),Xr.width=vr.width=Qr,Xr.height=vr.height=jr,je.bindRenderbuffer(Va,vr.renderbuffer),je.renderbufferStorage(Va,vr.format,Qr,jr),$(je.getError()===0,"invalid render buffer format"),wr.profile&&(vr.stats.size=Io(vr.format,vr.width,vr.height))),Xr}return Xr(nn,yr),Xr.resize=_n,Xr._reglType="renderbuffer",Xr._renderbuffer=vr,wr.profile&&(Xr.stats=vr.stats),Xr.destroy=function(){vr.decRef()},Xr}wr.profile&&(Ir.getTotalRenderbufferSize=function(){var nn=0;return Object.keys(tn).forEach(function(yr){nn+=tn[yr].stats.size}),nn});function cn(){Fe(tn).forEach(function(nn){nn.renderbuffer=je.createRenderbuffer(),je.bindRenderbuffer(Va,nn.renderbuffer),je.renderbufferStorage(Va,nn.format,nn.width,nn.height)}),je.bindRenderbuffer(Va,null)}return{create:wn,clear:function(){Fe(tn).forEach(fn)},restore:cn}},_u=36160,ec=36161,Wi=3553,Wa=34069,fl=36064,hl=36096,tc=36128,Mu=33306,Rs=36053,kl=36054,gs=36055,xf=36057,jl=36061,jc=36193,bf=5121,Vs=5126,Cl=6407,Ul=6408,Iu=6402,Ou=[Cl,Ul],wl=[];wl[Ul]=4,wl[Cl]=3;var Ku=[];Ku[bf]=1,Ku[Vs]=4,Ku[jc]=2;var Ds=32854,Ac=32855,rc=36194,nc=33189,ic=36168,u=34041,i=35907,n=34836,c=34842,y=34843,_=[Ds,Ac,rc,i,c,y,n],O={};O[Rs]="complete",O[kl]="incomplete attachment",O[xf]="incomplete dimensions",O[gs]="incomplete, missing attachment",O[jl]="unsupported";function k(xe,je,At,gr,Ir,wr){var xr={cur:null,next:null,dirty:!1,setFBO:null},Wr=["rgba"],sn=["rgba4","rgb565","rgb5 a1"];je.ext_srgb&&sn.push("srgba"),je.ext_color_buffer_half_float&&sn.push("rgba16f","rgb16f"),je.webgl_color_buffer_float&&sn.push("rgba32f");var tn=["uint8"];je.oes_texture_half_float&&tn.push("half float","float16"),je.oes_texture_float&&tn.push("float","float32");function qr(un,Gr,Fr){this.target=un,this.texture=Gr,this.renderbuffer=Fr;var di=0,pi=0;Gr?(di=Gr.width,pi=Gr.height):Fr&&(di=Fr.width,pi=Fr.height),this.width=di,this.height=pi}function fn(un){un&&(un.texture&&un.texture._texture.decRef(),un.renderbuffer&&un.renderbuffer._renderbuffer.decRef())}function wn(un,Gr,Fr){if(!!un)if(un.texture){var di=un.texture._texture,pi=Math.max(1,di.width),kn=Math.max(1,di.height);$(pi===Gr&&kn===Fr,"inconsistent width/height for supplied texture"),di.refCount+=1}else{var Bi=un.renderbuffer._renderbuffer;$(Bi.width===Gr&&Bi.height===Fr,"inconsistent width/height for renderbuffer"),Bi.refCount+=1}}function cn(un,Gr){Gr&&(Gr.texture?xe.framebufferTexture2D(_u,un,Gr.target,Gr.texture._texture.texture,0):xe.framebufferRenderbuffer(_u,un,ec,Gr.renderbuffer._renderbuffer.renderbuffer))}function nn(un){var Gr=Wi,Fr=null,di=null,pi=un;typeof un=="object"&&(pi=un.data,"target"in un&&(Gr=un.target|0)),$.type(pi,"function","invalid attachment data");var kn=pi._reglType;return kn==="texture2d"?(Fr=pi,$(Gr===Wi)):kn==="textureCube"?(Fr=pi,$(Gr>=Wa&&Gr<Wa+6,"invalid cube map target")):kn==="renderbuffer"?(di=pi,Gr=ec):$.raise("invalid regl object for attachment"),new qr(Gr,Fr,di)}function yr(un,Gr,Fr,di,pi){if(Fr){var kn=gr.create2D({width:un,height:Gr,format:di,type:pi});return kn._texture.refCount=0,new qr(Wi,kn,null)}else{var Bi=Ir.create({width:un,height:Gr,format:di});return Bi._renderbuffer.refCount=0,new qr(ec,null,Bi)}}function vr(un){return un&&(un.texture||un.renderbuffer)}function Xr(un,Gr,Fr){un&&(un.texture?un.texture.resize(Gr,Fr):un.renderbuffer&&un.renderbuffer.resize(Gr,Fr),un.width=Gr,un.height=Fr)}var _n=0,Lr={};function qn(){this.id=_n++,Lr[this.id]=this,this.framebuffer=xe.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Qr(un){un.colorAttachments.forEach(fn),fn(un.depthAttachment),fn(un.stencilAttachment),fn(un.depthStencilAttachment)}function jr(un){var Gr=un.framebuffer;$(Gr,"must not double destroy framebuffer"),xe.deleteFramebuffer(Gr),un.framebuffer=null,wr.framebufferCount--,delete Lr[un.id]}function Vr(un){var Gr;xe.bindFramebuffer(_u,un.framebuffer);var Fr=un.colorAttachments;for(Gr=0;Gr<Fr.length;++Gr)cn(fl+Gr,Fr[Gr]);for(Gr=Fr.length;Gr<At.maxColorAttachments;++Gr)xe.framebufferTexture2D(_u,fl+Gr,Wi,null,0);xe.framebufferTexture2D(_u,Mu,Wi,null,0),xe.framebufferTexture2D(_u,hl,Wi,null,0),xe.framebufferTexture2D(_u,tc,Wi,null,0),cn(hl,un.depthAttachment),cn(tc,un.stencilAttachment),cn(Mu,un.depthStencilAttachment);var di=xe.checkFramebufferStatus(_u);!xe.isContextLost()&&di!==Rs&&$.raise("framebuffer configuration not supported, status = "+O[di]),xe.bindFramebuffer(_u,xr.next?xr.next.framebuffer:null),xr.cur=xr.next,xe.getError()}function Kr(un,Gr){var Fr=new qn;wr.framebufferCount++;function di(kn,Bi){var _i;$(xr.next!==Fr,"can not update framebuffer which is currently in use");var Ui=0,ca=0,Go=!0,Ho=!0,ta=null,mo=!0,Oa="rgba",ws="uint8",Qo=1,xs=null,qo=null,Zs=null,No=!1;if(typeof kn=="number")Ui=kn|0,ca=Bi|0||Ui;else if(!kn)Ui=ca=1;else{$.type(kn,"object","invalid arguments for framebuffer");var ui=kn;if("shape"in ui){var Ws=ui.shape;$(Array.isArray(Ws)&&Ws.length>=2,"invalid shape for framebuffer"),Ui=Ws[0],ca=Ws[1]}else"radius"in ui&&(Ui=ca=ui.radius),"width"in ui&&(Ui=ui.width),"height"in ui&&(ca=ui.height);("color"in ui||"colors"in ui)&&(ta=ui.color||ui.colors,Array.isArray(ta)&&$(ta.length===1||je.webgl_draw_buffers,"multiple render targets not supported")),ta||("colorCount"in ui&&(Qo=ui.colorCount|0,$(Qo>0,"invalid color buffer count")),"colorTexture"in ui&&(mo=!!ui.colorTexture,Oa="rgba4"),"colorType"in ui&&(ws=ui.colorType,mo?($(je.oes_texture_float||!(ws==="float"||ws==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),$(je.oes_texture_half_float||!(ws==="half float"||ws==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):ws==="half float"||ws==="float16"?($(je.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Oa="rgba16f"):(ws==="float"||ws==="float32")&&($(je.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Oa="rgba32f"),$.oneOf(ws,tn,"invalid color type")),"colorFormat"in ui&&(Oa=ui.colorFormat,Wr.indexOf(Oa)>=0?mo=!0:sn.indexOf(Oa)>=0?mo=!1:mo?$.oneOf(ui.colorFormat,Wr,"invalid color format for texture"):$.oneOf(ui.colorFormat,sn,"invalid color format for renderbuffer"))),("depthTexture"in ui||"depthStencilTexture"in ui)&&(No=!!(ui.depthTexture||ui.depthStencilTexture),$(!No||je.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ui&&(typeof ui.depth=="boolean"?Go=ui.depth:(xs=ui.depth,Ho=!1)),"stencil"in ui&&(typeof ui.stencil=="boolean"?Ho=ui.stencil:(qo=ui.stencil,Go=!1)),"depthStencil"in ui&&(typeof ui.depthStencil=="boolean"?Go=Ho=ui.depthStencil:(Zs=ui.depthStencil,Go=!1,Ho=!1))}var Ca=null,Sn=null,Ri=null,Vi=null;if(Array.isArray(ta))Ca=ta.map(nn);else if(ta)Ca=[nn(ta)];else for(Ca=new Array(Qo),_i=0;_i<Qo;++_i)Ca[_i]=yr(Ui,ca,mo,Oa,ws);$(je.webgl_draw_buffers||Ca.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),$(Ca.length<=At.maxColorAttachments,"too many color attachments, not supported"),Ui=Ui||Ca[0].width,ca=ca||Ca[0].height,xs?Sn=nn(xs):Go&&!Ho&&(Sn=yr(Ui,ca,No,"depth","uint32")),qo?Ri=nn(qo):Ho&&!Go&&(Ri=yr(Ui,ca,!1,"stencil","uint8")),Zs?Vi=nn(Zs):!xs&&!qo&&Ho&&Go&&(Vi=yr(Ui,ca,No,"depth stencil","depth stencil")),$(!!xs+!!qo+!!Zs<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var es=null;for(_i=0;_i<Ca.length;++_i)if(wn(Ca[_i],Ui,ca),$(!Ca[_i]||Ca[_i].texture&&Ou.indexOf(Ca[_i].texture._texture.format)>=0||Ca[_i].renderbuffer&&_.indexOf(Ca[_i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+_i+" is invalid"),Ca[_i]&&Ca[_i].texture){var au=wl[Ca[_i].texture._texture.format]*Ku[Ca[_i].texture._texture.type];es===null?es=au:$(es===au,"all color attachments much have the same number of bits per pixel.")}return wn(Sn,Ui,ca),$(!Sn||Sn.texture&&Sn.texture._texture.format===Iu||Sn.renderbuffer&&Sn.renderbuffer._renderbuffer.format===nc,"invalid depth attachment for framebuffer object"),wn(Ri,Ui,ca),$(!Ri||Ri.renderbuffer&&Ri.renderbuffer._renderbuffer.format===ic,"invalid stencil attachment for framebuffer object"),wn(Vi,Ui,ca),$(!Vi||Vi.texture&&Vi.texture._texture.format===u||Vi.renderbuffer&&Vi.renderbuffer._renderbuffer.format===u,"invalid depth-stencil attachment for framebuffer object"),Qr(Fr),Fr.width=Ui,Fr.height=ca,Fr.colorAttachments=Ca,Fr.depthAttachment=Sn,Fr.stencilAttachment=Ri,Fr.depthStencilAttachment=Vi,di.color=Ca.map(vr),di.depth=vr(Sn),di.stencil=vr(Ri),di.depthStencil=vr(Vi),di.width=Fr.width,di.height=Fr.height,Vr(Fr),di}function pi(kn,Bi){$(xr.next!==Fr,"can not resize a framebuffer which is currently in use");var _i=Math.max(kn|0,1),Ui=Math.max(Bi|0||_i,1);if(_i===Fr.width&&Ui===Fr.height)return di;for(var ca=Fr.colorAttachments,Go=0;Go<ca.length;++Go)Xr(ca[Go],_i,Ui);return Xr(Fr.depthAttachment,_i,Ui),Xr(Fr.stencilAttachment,_i,Ui),Xr(Fr.depthStencilAttachment,_i,Ui),Fr.width=di.width=_i,Fr.height=di.height=Ui,Vr(Fr),di}return di(un,Gr),v(di,{resize:pi,_reglType:"framebuffer",_framebuffer:Fr,destroy:function(){jr(Fr),Qr(Fr)},use:function(Bi){xr.setFBO({framebuffer:di},Bi)}})}function Yn(un){var Gr=Array(6);function Fr(pi){var kn;$(Gr.indexOf(xr.next)<0,"can not update framebuffer which is currently in use");var Bi={color:null},_i=0,Ui=null,ca="rgba",Go="uint8",Ho=1;if(typeof pi=="number")_i=pi|0;else if(!pi)_i=1;else{$.type(pi,"object","invalid arguments for framebuffer");var ta=pi;if("shape"in ta){var mo=ta.shape;$(Array.isArray(mo)&&mo.length>=2,"invalid shape for framebuffer"),$(mo[0]===mo[1],"cube framebuffer must be square"),_i=mo[0]}else"radius"in ta&&(_i=ta.radius|0),"width"in ta?(_i=ta.width|0,"height"in ta&&$(ta.height===_i,"must be square")):"height"in ta&&(_i=ta.height|0);("color"in ta||"colors"in ta)&&(Ui=ta.color||ta.colors,Array.isArray(Ui)&&$(Ui.length===1||je.webgl_draw_buffers,"multiple render targets not supported")),Ui||("colorCount"in ta&&(Ho=ta.colorCount|0,$(Ho>0,"invalid color buffer count")),"colorType"in ta&&($.oneOf(ta.colorType,tn,"invalid color type"),Go=ta.colorType),"colorFormat"in ta&&(ca=ta.colorFormat,$.oneOf(ta.colorFormat,Wr,"invalid color format for texture"))),"depth"in ta&&(Bi.depth=ta.depth),"stencil"in ta&&(Bi.stencil=ta.stencil),"depthStencil"in ta&&(Bi.depthStencil=ta.depthStencil)}var Oa;if(Ui)if(Array.isArray(Ui))for(Oa=[],kn=0;kn<Ui.length;++kn)Oa[kn]=Ui[kn];else Oa=[Ui];else{Oa=Array(Ho);var ws={radius:_i,format:ca,type:Go};for(kn=0;kn<Ho;++kn)Oa[kn]=gr.createCube(ws)}for(Bi.color=Array(Oa.length),kn=0;kn<Oa.length;++kn){var Qo=Oa[kn];$(typeof Qo=="function"&&Qo._reglType==="textureCube","invalid cube map"),_i=_i||Qo.width,$(Qo.width===_i&&Qo.height===_i,"invalid cube map shape"),Bi.color[kn]={target:Wa,data:Oa[kn]}}for(kn=0;kn<6;++kn){for(var xs=0;xs<Oa.length;++xs)Bi.color[xs].target=Wa+kn;kn>0&&(Bi.depth=Gr[0].depth,Bi.stencil=Gr[0].stencil,Bi.depthStencil=Gr[0].depthStencil),Gr[kn]?Gr[kn](Bi):Gr[kn]=Kr(Bi)}return v(Fr,{width:_i,height:_i,color:Oa})}function di(pi){var kn,Bi=pi|0;if($(Bi>0&&Bi<=At.maxCubeMapSize,"invalid radius for cube fbo"),Bi===Fr.width)return Fr;var _i=Fr.color;for(kn=0;kn<_i.length;++kn)_i[kn].resize(Bi);for(kn=0;kn<6;++kn)Gr[kn].resize(Bi);return Fr.width=Fr.height=Bi,Fr}return Fr(un),v(Fr,{faces:Gr,resize:di,_reglType:"framebufferCube",destroy:function(){Gr.forEach(function(kn){kn.destroy()})}})}function ti(){xr.cur=null,xr.next=null,xr.dirty=!0,Fe(Lr).forEach(function(un){un.framebuffer=xe.createFramebuffer(),Vr(un)})}return v(xr,{getFramebuffer:function(Gr){if(typeof Gr=="function"&&Gr._reglType==="framebuffer"){var Fr=Gr._framebuffer;if(Fr instanceof qn)return Fr}return null},create:Kr,createCube:Yn,clear:function(){Fe(Lr).forEach(jr)},restore:ti})}var ue=5126,Ae=34962;function We(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ue,this.offset=0,this.stride=0,this.divisor=0}function Je(xe,je,At,gr,Ir){for(var wr=At.maxAttributes,xr=new Array(wr),Wr=0;Wr<wr;++Wr)xr[Wr]=new We;var sn=0,tn={},qr={Record:We,scope:{},state:xr,currentVAO:null,targetVAO:null,restore:wn()?Lr:function(){},createVAO:qn,getVAO:nn,destroyBuffer:fn,setVAO:wn()?yr:vr,clear:wn()?Xr:function(){}};function fn(Qr){for(var jr=0;jr<xr.length;++jr){var Vr=xr[jr];Vr.buffer===Qr&&(xe.disableVertexAttribArray(jr),Vr.buffer=null)}}function wn(){return je.oes_vertex_array_object}function cn(){return je.angle_instanced_arrays}function nn(Qr){return typeof Qr=="function"&&Qr._vao?Qr._vao:null}function yr(Qr){if(Qr!==qr.currentVAO){var jr=wn();Qr?jr.bindVertexArrayOES(Qr.vao):jr.bindVertexArrayOES(null),qr.currentVAO=Qr}}function vr(Qr){if(Qr!==qr.currentVAO){if(Qr)Qr.bindAttrs();else for(var jr=cn(),Vr=0;Vr<xr.length;++Vr){var Kr=xr[Vr];Kr.buffer?(xe.enableVertexAttribArray(Vr),xe.vertexAttribPointer(Vr,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offfset),jr&&Kr.divisor&&jr.vertexAttribDivisorANGLE(Vr,Kr.divisor)):(xe.disableVertexAttribArray(Vr),xe.vertexAttrib4f(Vr,Kr.x,Kr.y,Kr.z,Kr.w))}qr.currentVAO=Qr}}function Xr(){Fe(tn).forEach(function(Qr){Qr.destroy()})}function _n(){this.id=++sn,this.attributes=[];var Qr=wn();Qr?this.vao=Qr.createVertexArrayOES():this.vao=null,tn[this.id]=this,this.buffers=[]}_n.prototype.bindAttrs=function(){for(var Qr=cn(),jr=this.attributes,Vr=0;Vr<jr.length;++Vr){var Kr=jr[Vr];Kr.buffer?(xe.enableVertexAttribArray(Vr),xe.bindBuffer(Ae,Kr.buffer.buffer),xe.vertexAttribPointer(Vr,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offset),Qr&&Kr.divisor&&Qr.vertexAttribDivisorANGLE(Vr,Kr.divisor)):(xe.disableVertexAttribArray(Vr),xe.vertexAttrib4f(Vr,Kr.x,Kr.y,Kr.z,Kr.w))}for(var Yn=jr.length;Yn<wr;++Yn)xe.disableVertexAttribArray(Yn)},_n.prototype.refresh=function(){var Qr=wn();Qr&&(Qr.bindVertexArrayOES(this.vao),this.bindAttrs(),qr.currentVAO=this)},_n.prototype.destroy=function(){if(this.vao){var Qr=wn();this===qr.currentVAO&&(qr.currentVAO=null,Qr.bindVertexArrayOES(null)),Qr.deleteVertexArrayOES(this.vao),this.vao=null}tn[this.id]&&(delete tn[this.id],gr.vaoCount-=1)};function Lr(){var Qr=wn();Qr&&Fe(tn).forEach(function(jr){jr.refresh()})}function qn(Qr){var jr=new _n;gr.vaoCount+=1;function Vr(Kr){$(Array.isArray(Kr),"arguments to vertex array constructor must be an array"),$(Kr.length<wr,"too many attributes"),$(Kr.length>0,"must specify at least one attribute");var Yn={},ti=jr.attributes;ti.length=Kr.length;for(var un=0;un<Kr.length;++un){var Gr=Kr[un],Fr=ti[un]=new We,di=Gr.data||Gr;if(Array.isArray(di)||b(di)||Bt(di)){var pi;jr.buffers[un]&&(pi=jr.buffers[un],b(di)&&pi._buffer.byteLength>=di.byteLength?pi.subdata(di):(pi.destroy(),jr.buffers[un]=null)),jr.buffers[un]||(pi=jr.buffers[un]=Ir.create(Gr,Ae,!1,!0)),Fr.buffer=Ir.getBuffer(pi),Fr.size=Fr.buffer.dimension|0,Fr.normalized=!1,Fr.type=Fr.buffer.dtype,Fr.offset=0,Fr.stride=0,Fr.divisor=0,Fr.state=1,Yn[un]=1}else Ir.getBuffer(Gr)?(Fr.buffer=Ir.getBuffer(Gr),Fr.size=Fr.buffer.dimension|0,Fr.normalized=!1,Fr.type=Fr.buffer.dtype,Fr.offset=0,Fr.stride=0,Fr.divisor=0,Fr.state=1):Ir.getBuffer(Gr.buffer)?(Fr.buffer=Ir.getBuffer(Gr.buffer),Fr.size=(+Gr.size||Fr.buffer.dimension)|0,Fr.normalized=!!Gr.normalized||!1,"type"in Gr?($.parameter(Gr.type,fo,"invalid buffer type"),Fr.type=fo[Gr.type]):Fr.type=Fr.buffer.dtype,Fr.offset=(Gr.offset||0)|0,Fr.stride=(Gr.stride||0)|0,Fr.divisor=(Gr.divisor||0)|0,Fr.state=1,$(Fr.size>=1&&Fr.size<=4,"size must be between 1 and 4"),$(Fr.offset>=0,"invalid offset"),$(Fr.stride>=0&&Fr.stride<=255,"stride must be between 0 and 255"),$(Fr.divisor>=0,"divisor must be positive"),$(!Fr.divisor||!!je.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Gr?($(un>0,"first attribute must not be a constant"),Fr.x=+Gr.x||0,Fr.y=+Gr.y||0,Fr.z=+Gr.z||0,Fr.w=+Gr.w||0,Fr.state=2):$(!1,"invalid attribute spec for location "+un)}for(var kn=0;kn<jr.buffers.length;++kn)!Yn[kn]&&jr.buffers[kn]&&(jr.buffers[kn].destroy(),jr.buffers[kn]=null);return jr.refresh(),Vr}return Vr.destroy=function(){for(var Kr=0;Kr<jr.buffers.length;++Kr)jr.buffers[Kr]&&jr.buffers[Kr].destroy();jr.buffers.length=0,jr.destroy()},Vr._vao=jr,Vr._reglType="vao",Vr(Qr)}return qr}var rt=35632,Ft=35633,Rt=35718,Yt=35721;function zt(xe,je,At,gr){var Ir={},wr={};function xr(yr,vr,Xr,_n){this.name=yr,this.id=vr,this.location=Xr,this.info=_n}function Wr(yr,vr){for(var Xr=0;Xr<yr.length;++Xr)if(yr[Xr].id===vr.id){yr[Xr].location=vr.location;return}yr.push(vr)}function sn(yr,vr,Xr){var _n=yr===rt?Ir:wr,Lr=_n[vr];if(!Lr){var qn=je.str(vr);Lr=xe.createShader(yr),xe.shaderSource(Lr,qn),xe.compileShader(Lr),$.shaderError(xe,Lr,qn,yr,Xr),_n[vr]=Lr}return Lr}var tn={},qr=[],fn=0;function wn(yr,vr){this.id=fn++,this.fragId=yr,this.vertId=vr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,gr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function cn(yr,vr,Xr){var _n,Lr,qn=sn(rt,yr.fragId),Qr=sn(Ft,yr.vertId),jr=yr.program=xe.createProgram();if(xe.attachShader(jr,qn),xe.attachShader(jr,Qr),Xr)for(_n=0;_n<Xr.length;++_n){var Vr=Xr[_n];xe.bindAttribLocation(jr,Vr[0],Vr[1])}xe.linkProgram(jr),$.linkError(xe,jr,je.str(yr.fragId),je.str(yr.vertId),vr);var Kr=xe.getProgramParameter(jr,Rt);gr.profile&&(yr.stats.uniformsCount=Kr);var Yn=yr.uniforms;for(_n=0;_n<Kr;++_n)if(Lr=xe.getActiveUniform(jr,_n),Lr)if(Lr.size>1)for(var ti=0;ti<Lr.size;++ti){var un=Lr.name.replace("[0]","["+ti+"]");Wr(Yn,new xr(un,je.id(un),xe.getUniformLocation(jr,un),Lr))}else Wr(Yn,new xr(Lr.name,je.id(Lr.name),xe.getUniformLocation(jr,Lr.name),Lr));var Gr=xe.getProgramParameter(jr,Yt);gr.profile&&(yr.stats.attributesCount=Gr);var Fr=yr.attributes;for(_n=0;_n<Gr;++_n)Lr=xe.getActiveAttrib(jr,_n),Lr&&Wr(Fr,new xr(Lr.name,je.id(Lr.name),xe.getAttribLocation(jr,Lr.name),Lr))}gr.profile&&(At.getMaxUniformsCount=function(){var yr=0;return qr.forEach(function(vr){vr.stats.uniformsCount>yr&&(yr=vr.stats.uniformsCount)}),yr},At.getMaxAttributesCount=function(){var yr=0;return qr.forEach(function(vr){vr.stats.attributesCount>yr&&(yr=vr.stats.attributesCount)}),yr});function nn(){Ir={},wr={};for(var yr=0;yr<qr.length;++yr)cn(qr[yr],null,qr[yr].attributes.map(function(vr){return[vr.location,vr.name]}))}return{clear:function(){var vr=xe.deleteShader.bind(xe);Fe(Ir).forEach(vr),Ir={},Fe(wr).forEach(vr),wr={},qr.forEach(function(Xr){xe.deleteProgram(Xr.program)}),qr.length=0,tn={},At.shaderCount=0},program:function(vr,Xr,_n,Lr){$.command(vr>=0,"missing vertex shader",_n),$.command(Xr>=0,"missing fragment shader",_n);var qn=tn[Xr];qn||(qn=tn[Xr]={});var Qr=qn[vr];if(Qr&&(Qr.refCount++,!Lr))return Qr;var jr=new wn(Xr,vr);return At.shaderCount++,cn(jr,_n,Lr),Qr||(qn[vr]=jr),qr.push(jr),v(jr,{destroy:function(){if(jr.refCount--,jr.refCount<=0){xe.deleteProgram(jr.program);var Kr=qr.indexOf(jr);qr.splice(Kr,1),At.shaderCount--}qn[jr.vertId].refCount<=0&&(xe.deleteShader(wr[jr.vertId]),delete wr[jr.vertId],delete tn[jr.fragId][jr.vertId]),Object.keys(tn[jr.fragId]).length||(xe.deleteShader(Ir[jr.fragId]),delete Ir[jr.fragId],delete tn[jr.fragId])}})},restore:nn,shader:sn,frag:-1,vert:-1}}var Ut=6408,nr=5121,rr=3333,Or=5126;function hr(xe,je,At,gr,Ir,wr,xr){function Wr(qr){var fn;je.next===null?($(Ir.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),fn=nr):($(je.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),fn=je.next.colorAttachments[0].texture._texture.type,wr.oes_texture_float?($(fn===nr||fn===Or,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),fn===Or&&$(xr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):$(fn===nr,"Reading from a framebuffer is only allowed for the type 'uint8'"));var wn=0,cn=0,nn=gr.framebufferWidth,yr=gr.framebufferHeight,vr=null;b(qr)?vr=qr:qr&&($.type(qr,"object","invalid arguments to regl.read()"),wn=qr.x|0,cn=qr.y|0,$(wn>=0&&wn<gr.framebufferWidth,"invalid x offset for regl.read"),$(cn>=0&&cn<gr.framebufferHeight,"invalid y offset for regl.read"),nn=(qr.width||gr.framebufferWidth-wn)|0,yr=(qr.height||gr.framebufferHeight-cn)|0,vr=qr.data||null),vr&&(fn===nr?$(vr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):fn===Or&&$(vr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),$(nn>0&&nn+wn<=gr.framebufferWidth,"invalid width for read pixels"),$(yr>0&&yr+cn<=gr.framebufferHeight,"invalid height for read pixels"),At();var Xr=nn*yr*4;return vr||(fn===nr?vr=new Uint8Array(Xr):fn===Or&&(vr=vr||new Float32Array(Xr))),$.isTypedArray(vr,"data buffer for regl.read() must be a typedarray"),$(vr.byteLength>=Xr,"data buffer for regl.read() too small"),xe.pixelStorei(rr,4),xe.readPixels(wn,cn,nn,yr,Ut,fn,vr),vr}function sn(qr){var fn;return je.setFBO({framebuffer:qr.framebuffer},function(){fn=Wr(qr)}),fn}function tn(qr){return!qr||!("framebuffer"in qr)?Wr(qr):sn(qr)}return tn}function Tr(xe){return Array.prototype.slice.call(xe)}function Cr(xe){return Tr(xe).join("")}function an(){var xe=0,je=[],At=[];function gr(fn){for(var wn=0;wn<At.length;++wn)if(At[wn]===fn)return je[wn];var cn="g"+xe++;return je.push(cn),At.push(fn),cn}function Ir(){var fn=[];function wn(){fn.push.apply(fn,Tr(arguments))}var cn=[];function nn(){var yr="v"+xe++;return cn.push(yr),arguments.length>0&&(fn.push(yr,"="),fn.push.apply(fn,Tr(arguments)),fn.push(";")),yr}return v(wn,{def:nn,toString:function(){return Cr([cn.length>0?"var "+cn.join(",")+";":"",Cr(fn)])}})}function wr(){var fn=Ir(),wn=Ir(),cn=fn.toString,nn=wn.toString;function yr(vr,Xr){wn(vr,Xr,"=",fn.def(vr,Xr),";")}return v(function(){fn.apply(fn,Tr(arguments))},{def:fn.def,entry:fn,exit:wn,save:yr,set:function(Xr,_n,Lr){yr(Xr,_n),fn(Xr,_n,"=",Lr,";")},toString:function(){return cn()+nn()}})}function xr(){var fn=Cr(arguments),wn=wr(),cn=wr(),nn=wn.toString,yr=cn.toString;return v(wn,{then:function(){return wn.apply(wn,Tr(arguments)),this},else:function(){return cn.apply(cn,Tr(arguments)),this},toString:function(){var Xr=yr();return Xr&&(Xr="else{"+Xr+"}"),Cr(["if(",fn,"){",nn(),"}",Xr])}})}var Wr=Ir(),sn={};function tn(fn,wn){var cn=[];function nn(){var Lr="a"+cn.length;return cn.push(Lr),Lr}wn=wn||0;for(var yr=0;yr<wn;++yr)nn();var vr=wr(),Xr=vr.toString,_n=sn[fn]=v(vr,{arg:nn,toString:function(){return Cr(["function(",cn.join(),"){",Xr(),"}"])}});return _n}function qr(){var fn=['"use strict";',Wr,"return {"];Object.keys(sn).forEach(function(nn){fn.push('"',nn,'":',sn[nn].toString(),",")}),fn.push("}");var wn=Cr(fn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),cn=Function.apply(null,je.concat(wn));return cn.apply(null,At)}return{global:Wr,link:gr,block:Ir,proc:tn,scope:wr,cond:xr,compile:qr}}var Yr="xyzw".split(""),yn=5121,On=1,Qn=2,oi=0,xi=1,Xi=2,An=3,si=4,bi=5,Wn=6,Ti="dither",ii="blend.enable",Li="blend.color",ji="blend.equation",qa="blend.func",Ma="depth.enable",So="depth.func",Ta="depth.range",Xa="depth.mask",zs="colorMask",Eo="cull.enable",yu="cull.face",xu="frontFace",Uo="lineWidth",As="polygonOffset.enable",Lu="polygonOffset.offset",ac="sample.alpha",$u="sample.enable",oc="sample.coverage",sc="stencil.enable",Ru="stencil.mask",dl="stencil.func",Cs="stencil.opFront",po="stencil.opBack",Du="scissor.enable",bu="scissor.box",Oo="viewport",Lo="profile",Ro="framebuffer",Jo="vert",To="frag",Vo="elements",Gs="primitive",Pl="count",Uc="offset",Vl="instances",Ju="vao",zu="Width",Nu="Height",Hs=Ro+zu,Do=Ro+Nu,Vc=Oo+zu,ys=Oo+Nu,of="drawingBuffer",Lf=of+zu,Rf=of+Nu,Uf=[qa,ji,dl,Cs,po,oc,Oo,bu,Lu],Qu=34962,Sf=34963,sf=35632,uc=35633,Fu=3553,lc=34067,Vf=2884,Cc=3042,wc=3024,Gf=2960,Hf=2929,ah=3089,Zf=32823,Df=32926,ch=32928,cc=5126,uf=35664,so=35665,Gl=35666,lf=5124,Gc=35667,iu=35668,_l=35669,Ef=35670,Tf=35671,Hc=35672,cf=35673,Zc=35674,Hl=35675,ne=35676,oe=35678,D=35680,U=4,Ee=1028,tt=1029,Gt=2304,tr=2305,er=32775,Pr=32776,Jr=519,Rn=7680,Xn=0,ri=1,wi=32774,Pi=513,ia=36160,ra=36064,Ia={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},uo=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],eo={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Na={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},vo={frag:sf,vert:uc},Fi={cw:Gt,ccw:tr};function to(xe){return Array.isArray(xe)||b(xe)||Bt(xe)}function us(xe){return xe.sort(function(je,At){return je===Oo?-1:At===Oo?1:je<At?-1:1})}function va(xe,je,At,gr){this.thisDep=xe,this.contextDep=je,this.propDep=At,this.append=gr}function Aa(xe){return xe&&!(xe.thisDep||xe.contextDep||xe.propDep)}function mi(xe){return new va(!1,!1,!1,xe)}function zo(xe,je){var At=xe.type;if(At===oi){var gr=xe.data.length;return new va(!0,gr>=1,gr>=2,je)}else if(At===si){var Ir=xe.data;return new va(Ir.thisDep,Ir.contextDep,Ir.propDep,je)}else{if(At===bi)return new va(!1,!1,!1,je);if(At===Wn){for(var wr=!1,xr=!1,Wr=!1,sn=0;sn<xe.data.length;++sn){var tn=xe.data[sn];if(tn.type===xi)Wr=!0;else if(tn.type===Xi)xr=!0;else if(tn.type===An)wr=!0;else if(tn.type===oi){wr=!0;var qr=tn.data;qr>=1&&(xr=!0),qr>=2&&(Wr=!0)}else tn.type===si&&(wr=wr||tn.data.thisDep,xr=xr||tn.data.contextDep,Wr=Wr||tn.data.propDep)}return new va(wr,xr,Wr,je)}else return new va(At===An,At===Xi,At===xi,je)}}var fc=new va(!1,!1,!1,function(){});function Wf(xe,je,At,gr,Ir,wr,xr,Wr,sn,tn,qr,fn,wn,cn,nn){var yr=tn.Record,vr={add:32774,subtract:32778,"reverse subtract":32779};At.ext_blend_minmax&&(vr.min=er,vr.max=Pr);var Xr=At.angle_instanced_arrays,_n=At.webgl_draw_buffers,Lr={dirty:!0,profile:nn.profile},qn={},Qr=[],jr={},Vr={};function Kr(p){return p.replace(".","_")}function Yn(p,s,d){var g=Kr(p);Qr.push(p),qn[g]=Lr[g]=!!d,jr[g]=s}function ti(p,s,d){var g=Kr(p);Qr.push(p),Array.isArray(d)?(Lr[g]=d.slice(),qn[g]=d.slice()):Lr[g]=qn[g]=d,Vr[g]=s}Yn(Ti,wc),Yn(ii,Cc),ti(Li,"blendColor",[0,0,0,0]),ti(ji,"blendEquationSeparate",[wi,wi]),ti(qa,"blendFuncSeparate",[ri,Xn,ri,Xn]),Yn(Ma,Hf,!0),ti(So,"depthFunc",Pi),ti(Ta,"depthRange",[0,1]),ti(Xa,"depthMask",!0),ti(zs,zs,[!0,!0,!0,!0]),Yn(Eo,Vf),ti(yu,"cullFace",tt),ti(xu,xu,tr),ti(Uo,Uo,1),Yn(As,Zf),ti(Lu,"polygonOffset",[0,0]),Yn(ac,Df),Yn($u,ch),ti(oc,"sampleCoverage",[1,!1]),Yn(sc,Gf),ti(Ru,"stencilMask",-1),ti(dl,"stencilFunc",[Jr,0,-1]),ti(Cs,"stencilOpSeparate",[Ee,Rn,Rn,Rn]),ti(po,"stencilOpSeparate",[tt,Rn,Rn,Rn]),Yn(Du,ah),ti(bu,"scissor",[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]),ti(Oo,Oo,[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]);var un={gl:xe,context:wn,strings:je,next:qn,current:Lr,draw:fn,elements:wr,buffer:Ir,shader:qr,attributes:tn.state,vao:tn,uniforms:sn,framebuffer:Wr,extensions:At,timer:cn,isBufferArgs:to},Gr={primTypes:ha,compareFuncs:eo,blendFuncs:Ia,blendEquations:vr,stencilOps:Na,glTypes:fo,orientationType:Fi};$.optional(function(){un.isArrayLike=Qa}),_n&&(Gr.backBuffer=[tt],Gr.drawBuffer=de(gr.maxDrawbuffers,function(p){return p===0?[0]:de(p,function(s){return ra+s})}));var Fr=0;function di(){var p=an(),s=p.link,d=p.global;p.id=Fr++,p.batchId="0";var g=s(un),L=p.shared={props:"a0"};Object.keys(un).forEach(function(be){L[be]=d.def(g,".",be)}),$.optional(function(){p.CHECK=s($),p.commandStr=$.guessCommand(),p.command=s(p.commandStr),p.assert=function(be,me,Be){be("if(!(",me,"))",this.CHECK,".commandRaise(",s(Be),",",this.command,");")},Gr.invalidBlendCombinations=uo});var N=p.next={},K=p.current={};Object.keys(Vr).forEach(function(be){Array.isArray(Lr[be])&&(N[be]=d.def(L.next,".",be),K[be]=d.def(L.current,".",be))});var ee=p.constants={};Object.keys(Gr).forEach(function(be){ee[be]=d.def(JSON.stringify(Gr[be]))}),p.invoke=function(be,me){switch(me.type){case oi:var Be=["this",L.context,L.props,p.batchId];return be.def(s(me.data),".call(",Be.slice(0,Math.max(me.data.length+1,4)),")");case xi:return be.def(L.props,me.data);case Xi:return be.def(L.context,me.data);case An:return be.def("this",me.data);case si:return me.data.append(p,be),me.data.ref;case bi:return me.data.toString();case Wn:return me.data.map(function(pt){return p.invoke(be,pt)})}},p.attribCache={};var X={};return p.scopeAttrib=function(be){var me=je.id(be);if(me in X)return X[me];var Be=tn.scope[me];Be||(Be=tn.scope[me]=new yr);var pt=X[me]=s(Be);return pt},p}function pi(p){var s=p.static,d=p.dynamic,g;if(Lo in s){var L=!!s[Lo];g=mi(function(K,ee){return L}),g.enable=L}else if(Lo in d){var N=d[Lo];g=zo(N,function(K,ee){return K.invoke(ee,N)})}return g}function kn(p,s){var d=p.static,g=p.dynamic;if(Ro in d){var L=d[Ro];return L?(L=Wr.getFramebuffer(L),$.command(L,"invalid framebuffer object"),mi(function(K,ee){var X=K.link(L),be=K.shared;ee.set(be.framebuffer,".next",X);var me=be.context;return ee.set(me,"."+Hs,X+".width"),ee.set(me,"."+Do,X+".height"),X})):mi(function(K,ee){var X=K.shared;ee.set(X.framebuffer,".next","null");var be=X.context;return ee.set(be,"."+Hs,be+"."+Lf),ee.set(be,"."+Do,be+"."+Rf),"null"})}else if(Ro in g){var N=g[Ro];return zo(N,function(K,ee){var X=K.invoke(ee,N),be=K.shared,me=be.framebuffer,Be=ee.def(me,".getFramebuffer(",X,")");$.optional(function(){K.assert(ee,"!"+X+"||"+Be,"invalid framebuffer object")}),ee.set(me,".next",Be);var pt=be.context;return ee.set(pt,"."+Hs,Be+"?"+Be+".width:"+pt+"."+Lf),ee.set(pt,"."+Do,Be+"?"+Be+".height:"+pt+"."+Rf),Be})}else return null}function Bi(p,s,d){var g=p.static,L=p.dynamic;function N(X){if(X in g){var be=g[X];$.commandType(be,"object","invalid "+X,d.commandStr);var me=!0,Be=be.x|0,pt=be.y|0,Kt,kt;return"width"in be?(Kt=be.width|0,$.command(Kt>=0,"invalid "+X,d.commandStr)):me=!1,"height"in be?(kt=be.height|0,$.command(kt>=0,"invalid "+X,d.commandStr)):me=!1,new va(!me&&s&&s.thisDep,!me&&s&&s.contextDep,!me&&s&&s.propDep,function(Ur,on){var Hr=Ur.shared.context,ln=Kt;"width"in be||(ln=on.def(Hr,".",Hs,"-",Be));var Pn=kt;return"height"in be||(Pn=on.def(Hr,".",Do,"-",pt)),[Be,pt,ln,Pn]})}else if(X in L){var Qt=L[X],ur=zo(Qt,function(Ur,on){var Hr=Ur.invoke(on,Qt);$.optional(function(){Ur.assert(on,Hr+"&&typeof "+Hr+'==="object"',"invalid "+X)});var ln=Ur.shared.context,Pn=on.def(Hr,".x|0"),Hn=on.def(Hr,".y|0"),ai=on.def('"width" in ',Hr,"?",Hr,".width|0:","(",ln,".",Hs,"-",Pn,")"),Hi=on.def('"height" in ',Hr,"?",Hr,".height|0:","(",ln,".",Do,"-",Hn,")");return $.optional(function(){Ur.assert(on,ai+">=0&&"+Hi+">=0","invalid "+X)}),[Pn,Hn,ai,Hi]});return s&&(ur.thisDep=ur.thisDep||s.thisDep,ur.contextDep=ur.contextDep||s.contextDep,ur.propDep=ur.propDep||s.propDep),ur}else return s?new va(s.thisDep,s.contextDep,s.propDep,function(Ur,on){var Hr=Ur.shared.context;return[0,0,on.def(Hr,".",Hs),on.def(Hr,".",Do)]}):null}var K=N(Oo);if(K){var ee=K;K=new va(K.thisDep,K.contextDep,K.propDep,function(X,be){var me=ee.append(X,be),Be=X.shared.context;return be.set(Be,"."+Vc,me[2]),be.set(Be,"."+ys,me[3]),me})}return{viewport:K,scissor_box:N(bu)}}function _i(p,s){var d=p.static,g=typeof d[To]=="string"&&typeof d[Jo]=="string";if(g){if(Object.keys(s.dynamic).length>0)return null;var L=s.static,N=Object.keys(L);if(N.length>0&&typeof L[N[0]]=="number"){for(var K=[],ee=0;ee<N.length;++ee)$(typeof L[N[ee]]=="number","must specify all vertex attribute locations when using vaos"),K.push([L[N[ee]]|0,N[ee]]);return K}}return null}function Ui(p,s,d){var g=p.static,L=p.dynamic;function N(me){if(me in g){var Be=je.id(g[me]);$.optional(function(){qr.shader(vo[me],Be,$.guessCommand())});var pt=mi(function(){return Be});return pt.id=Be,pt}else if(me in L){var Kt=L[me];return zo(Kt,function(kt,Qt){var ur=kt.invoke(Qt,Kt),Ur=Qt.def(kt.shared.strings,".id(",ur,")");return $.optional(function(){Qt(kt.shared.shader,".shader(",vo[me],",",Ur,",",kt.command,");")}),Ur})}return null}var K=N(To),ee=N(Jo),X=null,be;return Aa(K)&&Aa(ee)?(X=qr.program(ee.id,K.id,null,d),be=mi(function(me,Be){return me.link(X)})):be=new va(K&&K.thisDep||ee&&ee.thisDep,K&&K.contextDep||ee&&ee.contextDep,K&&K.propDep||ee&&ee.propDep,function(me,Be){var pt=me.shared.shader,Kt;K?Kt=K.append(me,Be):Kt=Be.def(pt,".",To);var kt;ee?kt=ee.append(me,Be):kt=Be.def(pt,".",Jo);var Qt=pt+".program("+kt+","+Kt;return $.optional(function(){Qt+=","+me.command}),Be.def(Qt+")")}),{frag:K,vert:ee,progVar:be,program:X}}function ca(p,s){var d=p.static,g=p.dynamic;function L(){if(Vo in d){var me=d[Vo];to(me)?me=wr.getElements(wr.create(me,!0)):me&&(me=wr.getElements(me),$.command(me,"invalid elements",s.commandStr));var Be=mi(function(Kt,kt){if(me){var Qt=Kt.link(me);return Kt.ELEMENTS=Qt,Qt}return Kt.ELEMENTS=null,null});return Be.value=me,Be}else if(Vo in g){var pt=g[Vo];return zo(pt,function(Kt,kt){var Qt=Kt.shared,ur=Qt.isBufferArgs,Ur=Qt.elements,on=Kt.invoke(kt,pt),Hr=kt.def("null"),ln=kt.def(ur,"(",on,")"),Pn=Kt.cond(ln).then(Hr,"=",Ur,".createStream(",on,");").else(Hr,"=",Ur,".getElements(",on,");");return $.optional(function(){Kt.assert(Pn.else,"!"+on+"||"+Hr,"invalid elements")}),kt.entry(Pn),kt.exit(Kt.cond(ln).then(Ur,".destroyStream(",Hr,");")),Kt.ELEMENTS=Hr,Hr})}return null}var N=L();function K(){if(Gs in d){var me=d[Gs];return $.commandParameter(me,ha,"invalid primitve",s.commandStr),mi(function(pt,Kt){return ha[me]})}else if(Gs in g){var Be=g[Gs];return zo(Be,function(pt,Kt){var kt=pt.constants.primTypes,Qt=pt.invoke(Kt,Be);return $.optional(function(){pt.assert(Kt,Qt+" in "+kt,"invalid primitive, must be one of "+Object.keys(ha))}),Kt.def(kt,"[",Qt,"]")})}else if(N)return Aa(N)?N.value?mi(function(pt,Kt){return Kt.def(pt.ELEMENTS,".primType")}):mi(function(){return U}):new va(N.thisDep,N.contextDep,N.propDep,function(pt,Kt){var kt=pt.ELEMENTS;return Kt.def(kt,"?",kt,".primType:",U)});return null}function ee(me,Be){if(me in d){var pt=d[me]|0;return $.command(!Be||pt>=0,"invalid "+me,s.commandStr),mi(function(kt,Qt){return Be&&(kt.OFFSET=pt),pt})}else if(me in g){var Kt=g[me];return zo(Kt,function(kt,Qt){var ur=kt.invoke(Qt,Kt);return Be&&(kt.OFFSET=ur,$.optional(function(){kt.assert(Qt,ur+">=0","invalid "+me)})),ur})}else if(Be&&N)return mi(function(kt,Qt){return kt.OFFSET="0",0});return null}var X=ee(Uc,!0);function be(){if(Pl in d){var me=d[Pl]|0;return $.command(typeof me=="number"&&me>=0,"invalid vertex count",s.commandStr),mi(function(){return me})}else if(Pl in g){var Be=g[Pl];return zo(Be,function(kt,Qt){var ur=kt.invoke(Qt,Be);return $.optional(function(){kt.assert(Qt,"typeof "+ur+'==="number"&&'+ur+">=0&&"+ur+"===("+ur+"|0)","invalid vertex count")}),ur})}else if(N)if(Aa(N)){if(N)return X?new va(X.thisDep,X.contextDep,X.propDep,function(kt,Qt){var ur=Qt.def(kt.ELEMENTS,".vertCount-",kt.OFFSET);return $.optional(function(){kt.assert(Qt,ur+">=0","invalid vertex offset/element buffer too small")}),ur}):mi(function(kt,Qt){return Qt.def(kt.ELEMENTS,".vertCount")});var pt=mi(function(){return-1});return $.optional(function(){pt.MISSING=!0}),pt}else{var Kt=new va(N.thisDep||X.thisDep,N.contextDep||X.contextDep,N.propDep||X.propDep,function(kt,Qt){var ur=kt.ELEMENTS;return kt.OFFSET?Qt.def(ur,"?",ur,".vertCount-",kt.OFFSET,":-1"):Qt.def(ur,"?",ur,".vertCount:-1")});return $.optional(function(){Kt.DYNAMIC=!0}),Kt}return null}return{elements:N,primitive:K(),count:be(),instances:ee(Vl,!1),offset:X}}function Go(p,s){var d=p.static,g=p.dynamic,L={};return Qr.forEach(function(N){var K=Kr(N);function ee(X,be){if(N in d){var me=X(d[N]);L[K]=mi(function(){return me})}else if(N in g){var Be=g[N];L[K]=zo(Be,function(pt,Kt){return be(pt,Kt,pt.invoke(Kt,Be))})}}switch(N){case Eo:case ii:case Ti:case sc:case Ma:case Du:case As:case ac:case $u:case Xa:return ee(function(X){return $.commandType(X,"boolean",N,s.commandStr),X},function(X,be,me){return $.optional(function(){X.assert(be,"typeof "+me+'==="boolean"',"invalid flag "+N,X.commandStr)}),me});case So:return ee(function(X){return $.commandParameter(X,eo,"invalid "+N,s.commandStr),eo[X]},function(X,be,me){var Be=X.constants.compareFuncs;return $.optional(function(){X.assert(be,me+" in "+Be,"invalid "+N+", must be one of "+Object.keys(eo))}),be.def(Be,"[",me,"]")});case Ta:return ee(function(X){return $.command(Qa(X)&&X.length===2&&typeof X[0]=="number"&&typeof X[1]=="number"&&X[0]<=X[1],"depth range is 2d array",s.commandStr),X},function(X,be,me){$.optional(function(){X.assert(be,X.shared.isArrayLike+"("+me+")&&"+me+".length===2&&typeof "+me+'[0]==="number"&&typeof '+me+'[1]==="number"&&'+me+"[0]<="+me+"[1]","depth range must be a 2d array")});var Be=be.def("+",me,"[0]"),pt=be.def("+",me,"[1]");return[Be,pt]});case qa:return ee(function(X){$.commandType(X,"object","blend.func",s.commandStr);var be="srcRGB"in X?X.srcRGB:X.src,me="srcAlpha"in X?X.srcAlpha:X.src,Be="dstRGB"in X?X.dstRGB:X.dst,pt="dstAlpha"in X?X.dstAlpha:X.dst;return $.commandParameter(be,Ia,K+".srcRGB",s.commandStr),$.commandParameter(me,Ia,K+".srcAlpha",s.commandStr),$.commandParameter(Be,Ia,K+".dstRGB",s.commandStr),$.commandParameter(pt,Ia,K+".dstAlpha",s.commandStr),$.command(uo.indexOf(be+", "+Be)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+be+", "+Be+")",s.commandStr),[Ia[be],Ia[Be],Ia[me],Ia[pt]]},function(X,be,me){var Be=X.constants.blendFuncs;$.optional(function(){X.assert(be,me+"&&typeof "+me+'==="object"',"invalid blend func, must be an object")});function pt(Hr,ln){var Pn=be.def('"',Hr,ln,'" in ',me,"?",me,".",Hr,ln,":",me,".",Hr);return $.optional(function(){X.assert(be,Pn+" in "+Be,"invalid "+N+"."+Hr+ln+", must be one of "+Object.keys(Ia))}),Pn}var Kt=pt("src","RGB"),kt=pt("dst","RGB");$.optional(function(){var Hr=X.constants.invalidBlendCombinations;X.assert(be,Hr+".indexOf("+Kt+'+", "+'+kt+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Qt=be.def(Be,"[",Kt,"]"),ur=be.def(Be,"[",pt("src","Alpha"),"]"),Ur=be.def(Be,"[",kt,"]"),on=be.def(Be,"[",pt("dst","Alpha"),"]");return[Qt,Ur,ur,on]});case ji:return ee(function(X){if(typeof X=="string")return $.commandParameter(X,vr,"invalid "+N,s.commandStr),[vr[X],vr[X]];if(typeof X=="object")return $.commandParameter(X.rgb,vr,N+".rgb",s.commandStr),$.commandParameter(X.alpha,vr,N+".alpha",s.commandStr),[vr[X.rgb],vr[X.alpha]];$.commandRaise("invalid blend.equation",s.commandStr)},function(X,be,me){var Be=X.constants.blendEquations,pt=be.def(),Kt=be.def(),kt=X.cond("typeof ",me,'==="string"');return $.optional(function(){function Qt(ur,Ur,on){X.assert(ur,on+" in "+Be,"invalid "+Ur+", must be one of "+Object.keys(vr))}Qt(kt.then,N,me),X.assert(kt.else,me+"&&typeof "+me+'==="object"',"invalid "+N),Qt(kt.else,N+".rgb",me+".rgb"),Qt(kt.else,N+".alpha",me+".alpha")}),kt.then(pt,"=",Kt,"=",Be,"[",me,"];"),kt.else(pt,"=",Be,"[",me,".rgb];",Kt,"=",Be,"[",me,".alpha];"),be(kt),[pt,Kt]});case Li:return ee(function(X){return $.command(Qa(X)&&X.length===4,"blend.color must be a 4d array",s.commandStr),de(4,function(be){return+X[be]})},function(X,be,me){return $.optional(function(){X.assert(be,X.shared.isArrayLike+"("+me+")&&"+me+".length===4","blend.color must be a 4d array")}),de(4,function(Be){return be.def("+",me,"[",Be,"]")})});case Ru:return ee(function(X){return $.commandType(X,"number",K,s.commandStr),X|0},function(X,be,me){return $.optional(function(){X.assert(be,"typeof "+me+'==="number"',"invalid stencil.mask")}),be.def(me,"|0")});case dl:return ee(function(X){$.commandType(X,"object",K,s.commandStr);var be=X.cmp||"keep",me=X.ref||0,Be="mask"in X?X.mask:-1;return $.commandParameter(be,eo,N+".cmp",s.commandStr),$.commandType(me,"number",N+".ref",s.commandStr),$.commandType(Be,"number",N+".mask",s.commandStr),[eo[be],me,Be]},function(X,be,me){var Be=X.constants.compareFuncs;$.optional(function(){function Qt(){X.assert(be,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Qt(me+"&&typeof ",me,'==="object"'),Qt('!("cmp" in ',me,")||(",me,".cmp in ",Be,")")});var pt=be.def('"cmp" in ',me,"?",Be,"[",me,".cmp]",":",Rn),Kt=be.def(me,".ref|0"),kt=be.def('"mask" in ',me,"?",me,".mask|0:-1");return[pt,Kt,kt]});case Cs:case po:return ee(function(X){$.commandType(X,"object",K,s.commandStr);var be=X.fail||"keep",me=X.zfail||"keep",Be=X.zpass||"keep";return $.commandParameter(be,Na,N+".fail",s.commandStr),$.commandParameter(me,Na,N+".zfail",s.commandStr),$.commandParameter(Be,Na,N+".zpass",s.commandStr),[N===po?tt:Ee,Na[be],Na[me],Na[Be]]},function(X,be,me){var Be=X.constants.stencilOps;$.optional(function(){X.assert(be,me+"&&typeof "+me+'==="object"',"invalid "+N)});function pt(Kt){return $.optional(function(){X.assert(be,'!("'+Kt+'" in '+me+")||("+me+"."+Kt+" in "+Be+")","invalid "+N+"."+Kt+", must be one of "+Object.keys(Na))}),be.def('"',Kt,'" in ',me,"?",Be,"[",me,".",Kt,"]:",Rn)}return[N===po?tt:Ee,pt("fail"),pt("zfail"),pt("zpass")]});case Lu:return ee(function(X){$.commandType(X,"object",K,s.commandStr);var be=X.factor|0,me=X.units|0;return $.commandType(be,"number",K+".factor",s.commandStr),$.commandType(me,"number",K+".units",s.commandStr),[be,me]},function(X,be,me){$.optional(function(){X.assert(be,me+"&&typeof "+me+'==="object"',"invalid "+N)});var Be=be.def(me,".factor|0"),pt=be.def(me,".units|0");return[Be,pt]});case yu:return ee(function(X){var be=0;return X==="front"?be=Ee:X==="back"&&(be=tt),$.command(!!be,K,s.commandStr),be},function(X,be,me){return $.optional(function(){X.assert(be,me+'==="front"||'+me+'==="back"',"invalid cull.face")}),be.def(me,'==="front"?',Ee,":",tt)});case Uo:return ee(function(X){return $.command(typeof X=="number"&&X>=gr.lineWidthDims[0]&&X<=gr.lineWidthDims[1],"invalid line width, must be a positive number between "+gr.lineWidthDims[0]+" and "+gr.lineWidthDims[1],s.commandStr),X},function(X,be,me){return $.optional(function(){X.assert(be,"typeof "+me+'==="number"&&'+me+">="+gr.lineWidthDims[0]+"&&"+me+"<="+gr.lineWidthDims[1],"invalid line width")}),me});case xu:return ee(function(X){return $.commandParameter(X,Fi,K,s.commandStr),Fi[X]},function(X,be,me){return $.optional(function(){X.assert(be,me+'==="cw"||'+me+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),be.def(me+'==="cw"?'+Gt+":"+tr)});case zs:return ee(function(X){return $.command(Qa(X)&&X.length===4,"color.mask must be length 4 array",s.commandStr),X.map(function(be){return!!be})},function(X,be,me){return $.optional(function(){X.assert(be,X.shared.isArrayLike+"("+me+")&&"+me+".length===4","invalid color.mask")}),de(4,function(Be){return"!!"+me+"["+Be+"]"})});case oc:return ee(function(X){$.command(typeof X=="object"&&X,K,s.commandStr);var be="value"in X?X.value:1,me=!!X.invert;return $.command(typeof be=="number"&&be>=0&&be<=1,"sample.coverage.value must be a number between 0 and 1",s.commandStr),[be,me]},function(X,be,me){$.optional(function(){X.assert(be,me+"&&typeof "+me+'==="object"',"invalid sample.coverage")});var Be=be.def('"value" in ',me,"?+",me,".value:1"),pt=be.def("!!",me,".invert");return[Be,pt]})}}),L}function Ho(p,s){var d=p.static,g=p.dynamic,L={};return Object.keys(d).forEach(function(N){var K=d[N],ee;if(typeof K=="number"||typeof K=="boolean")ee=mi(function(){return K});else if(typeof K=="function"){var X=K._reglType;X==="texture2d"||X==="textureCube"?ee=mi(function(be){return be.link(K)}):X==="framebuffer"||X==="framebufferCube"?($.command(K.color.length>0,'missing color attachment for framebuffer sent to uniform "'+N+'"',s.commandStr),ee=mi(function(be){return be.link(K.color[0])})):$.commandRaise('invalid data for uniform "'+N+'"',s.commandStr)}else Qa(K)?ee=mi(function(be){var me=be.global.def("[",de(K.length,function(Be){return $.command(typeof K[Be]=="number"||typeof K[Be]=="boolean","invalid uniform "+N,be.commandStr),K[Be]}),"]");return me}):$.commandRaise('invalid or missing data for uniform "'+N+'"',s.commandStr);ee.value=K,L[N]=ee}),Object.keys(g).forEach(function(N){var K=g[N];L[N]=zo(K,function(ee,X){return ee.invoke(X,K)})}),L}function ta(p,s){var d=p.static,g=p.dynamic,L={};return Object.keys(d).forEach(function(N){var K=d[N],ee=je.id(N),X=new yr;if(to(K))X.state=On,X.buffer=Ir.getBuffer(Ir.create(K,Qu,!1,!0)),X.type=0;else{var be=Ir.getBuffer(K);if(be)X.state=On,X.buffer=be,X.type=0;else if($.command(typeof K=="object"&&K,"invalid data for attribute "+N,s.commandStr),"constant"in K){var me=K.constant;X.buffer="null",X.state=Qn,typeof me=="number"?X.x=me:($.command(Qa(me)&&me.length>0&&me.length<=4,"invalid constant for attribute "+N,s.commandStr),Yr.forEach(function(Ur,on){on<me.length&&(X[Ur]=me[on])}))}else{to(K.buffer)?be=Ir.getBuffer(Ir.create(K.buffer,Qu,!1,!0)):be=Ir.getBuffer(K.buffer),$.command(!!be,'missing buffer for attribute "'+N+'"',s.commandStr);var Be=K.offset|0;$.command(Be>=0,'invalid offset for attribute "'+N+'"',s.commandStr);var pt=K.stride|0;$.command(pt>=0&&pt<256,'invalid stride for attribute "'+N+'", must be integer betweeen [0, 255]',s.commandStr);var Kt=K.size|0;$.command(!("size"in K)||Kt>0&&Kt<=4,'invalid size for attribute "'+N+'", must be 1,2,3,4',s.commandStr);var kt=!!K.normalized,Qt=0;"type"in K&&($.commandParameter(K.type,fo,"invalid type for attribute "+N,s.commandStr),Qt=fo[K.type]);var ur=K.divisor|0;"divisor"in K&&($.command(ur===0||Xr,'cannot specify divisor for attribute "'+N+'", instancing not supported',s.commandStr),$.command(ur>=0,'invalid divisor for attribute "'+N+'"',s.commandStr)),$.optional(function(){var Ur=s.commandStr,on=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(K).forEach(function(Hr){$.command(on.indexOf(Hr)>=0,'unknown parameter "'+Hr+'" for attribute pointer "'+N+'" (valid parameters are '+on+")",Ur)})}),X.buffer=be,X.state=On,X.size=Kt,X.normalized=kt,X.type=Qt||be.dtype,X.offset=Be,X.stride=pt,X.divisor=ur}}L[N]=mi(function(Ur,on){var Hr=Ur.attribCache;if(ee in Hr)return Hr[ee];var ln={isStream:!1};return Object.keys(X).forEach(function(Pn){ln[Pn]=X[Pn]}),X.buffer&&(ln.buffer=Ur.link(X.buffer),ln.type=ln.type||ln.buffer+".dtype"),Hr[ee]=ln,ln})}),Object.keys(g).forEach(function(N){var K=g[N];function ee(X,be){var me=X.invoke(be,K),Be=X.shared,pt=X.constants,Kt=Be.isBufferArgs,kt=Be.buffer;$.optional(function(){X.assert(be,me+"&&(typeof "+me+'==="object"||typeof '+me+'==="function")&&('+Kt+"("+me+")||"+kt+".getBuffer("+me+")||"+kt+".getBuffer("+me+".buffer)||"+Kt+"("+me+'.buffer)||("constant" in '+me+"&&(typeof "+me+'.constant==="number"||'+Be.isArrayLike+"("+me+".constant))))",'invalid dynamic attribute "'+N+'"')});var Qt={isStream:be.def(!1)},ur=new yr;ur.state=On,Object.keys(ur).forEach(function(ln){Qt[ln]=be.def(""+ur[ln])});var Ur=Qt.buffer,on=Qt.type;be("if(",Kt,"(",me,")){",Qt.isStream,"=true;",Ur,"=",kt,".createStream(",Qu,",",me,");",on,"=",Ur,".dtype;","}else{",Ur,"=",kt,".getBuffer(",me,");","if(",Ur,"){",on,"=",Ur,".dtype;",'}else if("constant" in ',me,"){",Qt.state,"=",Qn,";","if(typeof "+me+'.constant === "number"){',Qt[Yr[0]],"=",me,".constant;",Yr.slice(1).map(function(ln){return Qt[ln]}).join("="),"=0;","}else{",Yr.map(function(ln,Pn){return Qt[ln]+"="+me+".constant.length>"+Pn+"?"+me+".constant["+Pn+"]:0;"}).join(""),"}}else{","if(",Kt,"(",me,".buffer)){",Ur,"=",kt,".createStream(",Qu,",",me,".buffer);","}else{",Ur,"=",kt,".getBuffer(",me,".buffer);","}",on,'="type" in ',me,"?",pt.glTypes,"[",me,".type]:",Ur,".dtype;",Qt.normalized,"=!!",me,".normalized;");function Hr(ln){be(Qt[ln],"=",me,".",ln,"|0;")}return Hr("size"),Hr("offset"),Hr("stride"),Hr("divisor"),be("}}"),be.exit("if(",Qt.isStream,"){",kt,".destroyStream(",Ur,");","}"),Qt}L[N]=zo(K,ee)}),L}function mo(p,s){var d=p.static,g=p.dynamic;if(Ju in d){var L=d[Ju];return L!==null&&tn.getVAO(L)===null&&(L=tn.createVAO(L)),mi(function(K){return K.link(tn.getVAO(L))})}else if(Ju in g){var N=g[Ju];return zo(N,function(K,ee){var X=K.invoke(ee,N);return ee.def(K.shared.vao+".getVAO("+X+")")})}return null}function Oa(p){var s=p.static,d=p.dynamic,g={};return Object.keys(s).forEach(function(L){var N=s[L];g[L]=mi(function(K,ee){return typeof N=="number"||typeof N=="boolean"?""+N:K.link(N)})}),Object.keys(d).forEach(function(L){var N=d[L];g[L]=zo(N,function(K,ee){return K.invoke(ee,N)})}),g}function ws(p,s,d,g,L){var N=p.static,K=p.dynamic;$.optional(function(){var Hr=[Ro,Jo,To,Vo,Gs,Uc,Pl,Vl,Lo,Ju].concat(Qr);function ln(Pn){Object.keys(Pn).forEach(function(Hn){$.command(Hr.indexOf(Hn)>=0,'unknown parameter "'+Hn+'"',L.commandStr)})}ln(N),ln(K)});var ee=_i(p,s),X=kn(p,L),be=Bi(p,X,L),me=ca(p,L),Be=Go(p,L),pt=Ui(p,L,ee);function Kt(Hr){var ln=be[Hr];ln&&(Be[Hr]=ln)}Kt(Oo),Kt(Kr(bu));var kt=Object.keys(Be).length>0,Qt={framebuffer:X,draw:me,shader:pt,state:Be,dirty:kt,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Qt.profile=pi(p,L),Qt.uniforms=Ho(d,L),Qt.drawVAO=Qt.scopeVAO=mo(p,L),!Qt.drawVAO&&pt.program&&!ee&&At.angle_instanced_arrays){var ur=!0,Ur=pt.program.attributes.map(function(Hr){var ln=s.static[Hr];return ur=ur&&!!ln,ln});if(ur&&Ur.length>0){var on=tn.getVAO(tn.createVAO(Ur));Qt.drawVAO=new va(null,null,null,function(Hr,ln){return Hr.link(on)}),Qt.useVAO=!0}}return ee?Qt.useVAO=!0:Qt.attributes=ta(s,L),Qt.context=Oa(g,L),Qt}function Qo(p,s,d){var g=p.shared,L=g.context,N=p.scope();Object.keys(d).forEach(function(K){s.save(L,"."+K);var ee=d[K],X=ee.append(p,s);Array.isArray(X)?N(L,".",K,"=[",X.join(),"];"):N(L,".",K,"=",X,";")}),s(N)}function xs(p,s,d,g){var L=p.shared,N=L.gl,K=L.framebuffer,ee;_n&&(ee=s.def(L.extensions,".webgl_draw_buffers"));var X=p.constants,be=X.drawBuffer,me=X.backBuffer,Be;d?Be=d.append(p,s):Be=s.def(K,".next"),g||s("if(",Be,"!==",K,".cur){"),s("if(",Be,"){",N,".bindFramebuffer(",ia,",",Be,".framebuffer);"),_n&&s(ee,".drawBuffersWEBGL(",be,"[",Be,".colorAttachments.length]);"),s("}else{",N,".bindFramebuffer(",ia,",null);"),_n&&s(ee,".drawBuffersWEBGL(",me,");"),s("}",K,".cur=",Be,";"),g||s("}")}function qo(p,s,d){var g=p.shared,L=g.gl,N=p.current,K=p.next,ee=g.current,X=g.next,be=p.cond(ee,".dirty");Qr.forEach(function(me){var Be=Kr(me);if(!(Be in d.state)){var pt,Kt;if(Be in K){pt=K[Be],Kt=N[Be];var kt=de(Lr[Be].length,function(ur){return be.def(pt,"[",ur,"]")});be(p.cond(kt.map(function(ur,Ur){return ur+"!=="+Kt+"["+Ur+"]"}).join("||")).then(L,".",Vr[Be],"(",kt,");",kt.map(function(ur,Ur){return Kt+"["+Ur+"]="+ur}).join(";"),";"))}else{pt=be.def(X,".",Be);var Qt=p.cond(pt,"!==",ee,".",Be);be(Qt),Be in jr?Qt(p.cond(pt).then(L,".enable(",jr[Be],");").else(L,".disable(",jr[Be],");"),ee,".",Be,"=",pt,";"):Qt(L,".",Vr[Be],"(",pt,");",ee,".",Be,"=",pt,";")}}}),Object.keys(d.state).length===0&&be(ee,".dirty=false;"),s(be)}function Zs(p,s,d,g){var L=p.shared,N=p.current,K=L.current,ee=L.gl;us(Object.keys(d)).forEach(function(X){var be=d[X];if(!(g&&!g(be))){var me=be.append(p,s);if(jr[X]){var Be=jr[X];Aa(be)?me?s(ee,".enable(",Be,");"):s(ee,".disable(",Be,");"):s(p.cond(me).then(ee,".enable(",Be,");").else(ee,".disable(",Be,");")),s(K,".",X,"=",me,";")}else if(Qa(me)){var pt=N[X];s(ee,".",Vr[X],"(",me,");",me.map(function(Kt,kt){return pt+"["+kt+"]="+Kt}).join(";"),";")}else s(ee,".",Vr[X],"(",me,");",K,".",X,"=",me,";")}})}function No(p,s){Xr&&(p.instancing=s.def(p.shared.extensions,".angle_instanced_arrays"))}function ui(p,s,d,g,L){var N=p.shared,K=p.stats,ee=N.current,X=N.timer,be=d.profile;function me(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Be,pt;function Kt(Hr){Be=s.def(),Hr(Be,"=",me(),";"),typeof L=="string"?Hr(K,".count+=",L,";"):Hr(K,".count++;"),cn&&(g?(pt=s.def(),Hr(pt,"=",X,".getNumPendingQueries();")):Hr(X,".beginQuery(",K,");"))}function kt(Hr){Hr(K,".cpuTime+=",me(),"-",Be,";"),cn&&(g?Hr(X,".pushScopeStats(",pt,",",X,".getNumPendingQueries(),",K,");"):Hr(X,".endQuery();"))}function Qt(Hr){var ln=s.def(ee,".profile");s(ee,".profile=",Hr,";"),s.exit(ee,".profile=",ln,";")}var ur;if(be){if(Aa(be)){be.enable?(Kt(s),kt(s.exit),Qt("true")):Qt("false");return}ur=be.append(p,s),Qt(ur)}else ur=s.def(ee,".profile");var Ur=p.block();Kt(Ur),s("if(",ur,"){",Ur,"}");var on=p.block();kt(on),s.exit("if(",ur,"){",on,"}")}function Ws(p,s,d,g,L){var N=p.shared;function K(X){switch(X){case uf:case Gc:case Tf:return 2;case so:case iu:case Hc:return 3;case Gl:case _l:case cf:return 4;default:return 1}}function ee(X,be,me){var Be=N.gl,pt=s.def(X,".location"),Kt=s.def(N.attributes,"[",pt,"]"),kt=me.state,Qt=me.buffer,ur=[me.x,me.y,me.z,me.w],Ur=["buffer","normalized","offset","stride"];function on(){s("if(!",Kt,".buffer){",Be,".enableVertexAttribArray(",pt,");}");var ln=me.type,Pn;if(me.size?Pn=s.def(me.size,"||",be):Pn=be,s("if(",Kt,".type!==",ln,"||",Kt,".size!==",Pn,"||",Ur.map(function(ai){return Kt+"."+ai+"!=="+me[ai]}).join("||"),"){",Be,".bindBuffer(",Qu,",",Qt,".buffer);",Be,".vertexAttribPointer(",[pt,Pn,ln,me.normalized,me.stride,me.offset],");",Kt,".type=",ln,";",Kt,".size=",Pn,";",Ur.map(function(ai){return Kt+"."+ai+"="+me[ai]+";"}).join(""),"}"),Xr){var Hn=me.divisor;s("if(",Kt,".divisor!==",Hn,"){",p.instancing,".vertexAttribDivisorANGLE(",[pt,Hn],");",Kt,".divisor=",Hn,";}")}}function Hr(){s("if(",Kt,".buffer){",Be,".disableVertexAttribArray(",pt,");",Kt,".buffer=null;","}if(",Yr.map(function(ln,Pn){return Kt+"."+ln+"!=="+ur[Pn]}).join("||"),"){",Be,".vertexAttrib4f(",pt,",",ur,");",Yr.map(function(ln,Pn){return Kt+"."+ln+"="+ur[Pn]+";"}).join(""),"}")}kt===On?on():kt===Qn?Hr():(s("if(",kt,"===",On,"){"),on(),s("}else{"),Hr(),s("}"))}g.forEach(function(X){var be=X.name,me=d.attributes[be],Be;if(me){if(!L(me))return;Be=me.append(p,s)}else{if(!L(fc))return;var pt=p.scopeAttrib(be);$.optional(function(){p.assert(s,pt+".state","missing attribute "+be)}),Be={},Object.keys(new yr).forEach(function(Kt){Be[Kt]=s.def(pt,".",Kt)})}ee(p.link(X),K(X.info.type),Be)})}function Ca(p,s,d,g,L){for(var N=p.shared,K=N.gl,ee,X=0;X<g.length;++X){var be=g[X],me=be.name,Be=be.info.type,pt=d.uniforms[me],Kt=p.link(be),kt=Kt+".location",Qt;if(pt){if(!L(pt))continue;if(Aa(pt)){var ur=pt.value;if($.command(ur!==null&&typeof ur!="undefined",'missing uniform "'+me+'"',p.commandStr),Be===oe||Be===D){$.command(typeof ur=="function"&&(Be===oe&&(ur._reglType==="texture2d"||ur._reglType==="framebuffer")||Be===D&&(ur._reglType==="textureCube"||ur._reglType==="framebufferCube")),"invalid texture for uniform "+me,p.commandStr);var Ur=p.link(ur._texture||ur.color[0]._texture);s(K,".uniform1i(",kt,",",Ur+".bind());"),s.exit(Ur,".unbind();")}else if(Be===Zc||Be===Hl||Be===ne){$.optional(function(){$.command(Qa(ur),"invalid matrix for uniform "+me,p.commandStr),$.command(Be===Zc&&ur.length===4||Be===Hl&&ur.length===9||Be===ne&&ur.length===16,"invalid length for matrix uniform "+me,p.commandStr)});var on=p.global.def("new Float32Array(["+Array.prototype.slice.call(ur)+"])"),Hr=2;Be===Hl?Hr=3:Be===ne&&(Hr=4),s(K,".uniformMatrix",Hr,"fv(",kt,",false,",on,");")}else{switch(Be){case cc:$.commandType(ur,"number","uniform "+me,p.commandStr),ee="1f";break;case uf:$.command(Qa(ur)&&ur.length===2,"uniform "+me,p.commandStr),ee="2f";break;case so:$.command(Qa(ur)&&ur.length===3,"uniform "+me,p.commandStr),ee="3f";break;case Gl:$.command(Qa(ur)&&ur.length===4,"uniform "+me,p.commandStr),ee="4f";break;case Ef:$.commandType(ur,"boolean","uniform "+me,p.commandStr),ee="1i";break;case lf:$.commandType(ur,"number","uniform "+me,p.commandStr),ee="1i";break;case Tf:$.command(Qa(ur)&&ur.length===2,"uniform "+me,p.commandStr),ee="2i";break;case Gc:$.command(Qa(ur)&&ur.length===2,"uniform "+me,p.commandStr),ee="2i";break;case Hc:$.command(Qa(ur)&&ur.length===3,"uniform "+me,p.commandStr),ee="3i";break;case iu:$.command(Qa(ur)&&ur.length===3,"uniform "+me,p.commandStr),ee="3i";break;case cf:$.command(Qa(ur)&&ur.length===4,"uniform "+me,p.commandStr),ee="4i";break;case _l:$.command(Qa(ur)&&ur.length===4,"uniform "+me,p.commandStr),ee="4i";break}s(K,".uniform",ee,"(",kt,",",Qa(ur)?Array.prototype.slice.call(ur):ur,");")}continue}else Qt=pt.append(p,s)}else{if(!L(fc))continue;Qt=s.def(N.uniforms,"[",je.id(me),"]")}Be===oe?($(!Array.isArray(Qt),"must specify a scalar prop for textures"),s("if(",Qt,"&&",Qt,'._reglType==="framebuffer"){',Qt,"=",Qt,".color[0];","}")):Be===D&&($(!Array.isArray(Qt),"must specify a scalar prop for cube maps"),s("if(",Qt,"&&",Qt,'._reglType==="framebufferCube"){',Qt,"=",Qt,".color[0];","}")),$.optional(function(){function Hi(ts,ls){p.assert(s,ts,'bad data or missing for uniform "'+me+'".  '+ls)}function ma(ts){$(!Array.isArray(Qt),"must not specify an array type for uniform"),Hi("typeof "+Qt+'==="'+ts+'"',"invalid type, expected "+ts)}function La(ts,ls){Array.isArray(Qt)?$(Qt.length===ts,"must have length "+ts):Hi(N.isArrayLike+"("+Qt+")&&"+Qt+".length==="+ts,"invalid vector, should have length "+ts,p.commandStr)}function qu(ts){$(!Array.isArray(Qt),"must not specify a value type"),Hi("typeof "+Qt+'==="function"&&'+Qt+'._reglType==="texture'+(ts===Fu?"2d":"Cube")+'"',"invalid texture type",p.commandStr)}switch(Be){case lf:ma("number");break;case Gc:La(2,"number");break;case iu:La(3,"number");break;case _l:La(4,"number");break;case cc:ma("number");break;case uf:La(2,"number");break;case so:La(3,"number");break;case Gl:La(4,"number");break;case Ef:ma("boolean");break;case Tf:La(2,"boolean");break;case Hc:La(3,"boolean");break;case cf:La(4,"boolean");break;case Zc:La(4,"number");break;case Hl:La(9,"number");break;case ne:La(16,"number");break;case oe:qu(Fu);break;case D:qu(lc);break}});var ln=1;switch(Be){case oe:case D:var Pn=s.def(Qt,"._texture");s(K,".uniform1i(",kt,",",Pn,".bind());"),s.exit(Pn,".unbind();");continue;case lf:case Ef:ee="1i";break;case Gc:case Tf:ee="2i",ln=2;break;case iu:case Hc:ee="3i",ln=3;break;case _l:case cf:ee="4i",ln=4;break;case cc:ee="1f";break;case uf:ee="2f",ln=2;break;case so:ee="3f",ln=3;break;case Gl:ee="4f",ln=4;break;case Zc:ee="Matrix2fv";break;case Hl:ee="Matrix3fv";break;case ne:ee="Matrix4fv";break}if(s(K,".uniform",ee,"(",kt,","),ee.charAt(0)==="M"){var Hn=Math.pow(Be-Zc+2,2),ai=p.global.def("new Float32Array(",Hn,")");Array.isArray(Qt)?s("false,(",de(Hn,function(Hi){return ai+"["+Hi+"]="+Qt[Hi]}),",",ai,")"):s("false,(Array.isArray(",Qt,")||",Qt," instanceof Float32Array)?",Qt,":(",de(Hn,function(Hi){return ai+"["+Hi+"]="+Qt+"["+Hi+"]"}),",",ai,")")}else ln>1?s(de(ln,function(Hi){return Array.isArray(Qt)?Qt[Hi]:Qt+"["+Hi+"]"})):($(!Array.isArray(Qt),"uniform value must not be an array"),s(Qt));s(");")}}function Sn(p,s,d,g){var L=p.shared,N=L.gl,K=L.draw,ee=g.draw;function X(){var Pn=ee.elements,Hn,ai=s;return Pn?((Pn.contextDep&&g.contextDynamic||Pn.propDep)&&(ai=d),Hn=Pn.append(p,ai)):Hn=ai.def(K,".",Vo),Hn&&ai("if("+Hn+")"+N+".bindBuffer("+Sf+","+Hn+".buffer.buffer);"),Hn}function be(){var Pn=ee.count,Hn,ai=s;return Pn?((Pn.contextDep&&g.contextDynamic||Pn.propDep)&&(ai=d),Hn=Pn.append(p,ai),$.optional(function(){Pn.MISSING&&p.assert(s,"false","missing vertex count"),Pn.DYNAMIC&&p.assert(ai,Hn+">=0","missing vertex count")})):(Hn=ai.def(K,".",Pl),$.optional(function(){p.assert(ai,Hn+">=0","missing vertex count")})),Hn}var me=X();function Be(Pn){var Hn=ee[Pn];return Hn?Hn.contextDep&&g.contextDynamic||Hn.propDep?Hn.append(p,d):Hn.append(p,s):s.def(K,".",Pn)}var pt=Be(Gs),Kt=Be(Uc),kt=be();if(typeof kt=="number"){if(kt===0)return}else d("if(",kt,"){"),d.exit("}");var Qt,ur;Xr&&(Qt=Be(Vl),ur=p.instancing);var Ur=me+".type",on=ee.elements&&Aa(ee.elements);function Hr(){function Pn(){d(ur,".drawElementsInstancedANGLE(",[pt,kt,Ur,Kt+"<<(("+Ur+"-"+yn+")>>1)",Qt],");")}function Hn(){d(ur,".drawArraysInstancedANGLE(",[pt,Kt,kt,Qt],");")}me?on?Pn():(d("if(",me,"){"),Pn(),d("}else{"),Hn(),d("}")):Hn()}function ln(){function Pn(){d(N+".drawElements("+[pt,kt,Ur,Kt+"<<(("+Ur+"-"+yn+")>>1)"]+");")}function Hn(){d(N+".drawArrays("+[pt,Kt,kt]+");")}me?on?Pn():(d("if(",me,"){"),Pn(),d("}else{"),Hn(),d("}")):Hn()}Xr&&(typeof Qt!="number"||Qt>=0)?typeof Qt=="string"?(d("if(",Qt,">0){"),Hr(),d("}else if(",Qt,"<0){"),ln(),d("}")):Hr():ln()}function Ri(p,s,d,g,L){var N=di(),K=N.proc("body",L);return $.optional(function(){N.commandStr=s.commandStr,N.command=N.link(s.commandStr)}),Xr&&(N.instancing=K.def(N.shared.extensions,".angle_instanced_arrays")),p(N,K,d,g),N.compile().body}function Vi(p,s,d,g){No(p,s),d.useVAO?d.drawVAO?s(p.shared.vao,".setVAO(",d.drawVAO.append(p,s),");"):s(p.shared.vao,".setVAO(",p.shared.vao,".targetVAO);"):(s(p.shared.vao,".setVAO(null);"),Ws(p,s,d,g.attributes,function(){return!0})),Ca(p,s,d,g.uniforms,function(){return!0}),Sn(p,s,s,d)}function es(p,s){var d=p.proc("draw",1);No(p,d),Qo(p,d,s.context),xs(p,d,s.framebuffer),qo(p,d,s),Zs(p,d,s.state),ui(p,d,s,!1,!0);var g=s.shader.progVar.append(p,d);if(d(p.shared.gl,".useProgram(",g,".program);"),s.shader.program)Vi(p,d,s,s.shader.program);else{d(p.shared.vao,".setVAO(null);");var L=p.global.def("{}"),N=d.def(g,".id"),K=d.def(L,"[",N,"]");d(p.cond(K).then(K,".call(this,a0);").else(K,"=",L,"[",N,"]=",p.link(function(ee){return Ri(Vi,p,s,ee,1)}),"(",g,");",K,".call(this,a0);"))}Object.keys(s.state).length>0&&d(p.shared.current,".dirty=true;")}function au(p,s,d,g){p.batchId="a1",No(p,s);function L(){return!0}Ws(p,s,d,g.attributes,L),Ca(p,s,d,g.uniforms,L),Sn(p,s,s,d)}function hc(p,s,d,g){No(p,s);var L=d.contextDep,N=s.def(),K="a0",ee="a1",X=s.def();p.shared.props=X,p.batchId=N;var be=p.scope(),me=p.scope();s(be.entry,"for(",N,"=0;",N,"<",ee,";++",N,"){",X,"=",K,"[",N,"];",me,"}",be.exit);function Be(Ur){return Ur.contextDep&&L||Ur.propDep}function pt(Ur){return!Be(Ur)}if(d.needsContext&&Qo(p,me,d.context),d.needsFramebuffer&&xs(p,me,d.framebuffer),Zs(p,me,d.state,Be),d.profile&&Be(d.profile)&&ui(p,me,d,!1,!0),g)d.useVAO?d.drawVAO?Be(d.drawVAO)?me(p.shared.vao,".setVAO(",d.drawVAO.append(p,me),");"):be(p.shared.vao,".setVAO(",d.drawVAO.append(p,be),");"):be(p.shared.vao,".setVAO(",p.shared.vao,".targetVAO);"):(be(p.shared.vao,".setVAO(null);"),Ws(p,be,d,g.attributes,pt),Ws(p,me,d,g.attributes,Be)),Ca(p,be,d,g.uniforms,pt),Ca(p,me,d,g.uniforms,Be),Sn(p,be,me,d);else{var Kt=p.global.def("{}"),kt=d.shader.progVar.append(p,me),Qt=me.def(kt,".id"),ur=me.def(Kt,"[",Qt,"]");me(p.shared.gl,".useProgram(",kt,".program);","if(!",ur,"){",ur,"=",Kt,"[",Qt,"]=",p.link(function(Ur){return Ri(au,p,d,Ur,2)}),"(",kt,");}",ur,".call(this,a0[",N,"],",N,");")}}function Lt(p,s){var d=p.proc("batch",2);p.batchId="0",No(p,d);var g=!1,L=!0;Object.keys(s.context).forEach(function(Kt){g=g||s.context[Kt].propDep}),g||(Qo(p,d,s.context),L=!1);var N=s.framebuffer,K=!1;N?(N.propDep?g=K=!0:N.contextDep&&g&&(K=!0),K||xs(p,d,N)):xs(p,d,null),s.state.viewport&&s.state.viewport.propDep&&(g=!0);function ee(Kt){return Kt.contextDep&&g||Kt.propDep}qo(p,d,s),Zs(p,d,s.state,function(Kt){return!ee(Kt)}),(!s.profile||!ee(s.profile))&&ui(p,d,s,!1,"a1"),s.contextDep=g,s.needsContext=L,s.needsFramebuffer=K;var X=s.shader.progVar;if(X.contextDep&&g||X.propDep)hc(p,d,s,null);else{var be=X.append(p,d);if(d(p.shared.gl,".useProgram(",be,".program);"),s.shader.program)hc(p,d,s,s.shader.program);else{d(p.shared.vao,".setVAO(null);");var me=p.global.def("{}"),Be=d.def(be,".id"),pt=d.def(me,"[",Be,"]");d(p.cond(pt).then(pt,".call(this,a0,a1);").else(pt,"=",me,"[",Be,"]=",p.link(function(Kt){return Ri(hc,p,s,Kt,2)}),"(",be,");",pt,".call(this,a0,a1);"))}}Object.keys(s.state).length>0&&d(p.shared.current,".dirty=true;")}function Sr(p,s){var d=p.proc("scope",3);p.batchId="a2";var g=p.shared,L=g.current;Qo(p,d,s.context),s.framebuffer&&s.framebuffer.append(p,d),us(Object.keys(s.state)).forEach(function(K){var ee=s.state[K],X=ee.append(p,d);Qa(X)?X.forEach(function(be,me){d.set(p.next[K],"["+me+"]",be)}):d.set(g.next,"."+K,X)}),ui(p,d,s,!0,!0),[Vo,Uc,Pl,Vl,Gs].forEach(function(K){var ee=s.draw[K];!ee||d.set(g.draw,"."+K,""+ee.append(p,d))}),Object.keys(s.uniforms).forEach(function(K){var ee=s.uniforms[K].append(p,d);Array.isArray(ee)&&(ee="["+ee.join()+"]"),d.set(g.uniforms,"["+je.id(K)+"]",ee)}),Object.keys(s.attributes).forEach(function(K){var ee=s.attributes[K].append(p,d),X=p.scopeAttrib(K);Object.keys(new yr).forEach(function(be){d.set(X,"."+be,ee[be])})}),s.scopeVAO&&d.set(g.vao,".targetVAO",s.scopeVAO.append(p,d));function N(K){var ee=s.shader[K];ee&&d.set(g.shader,"."+K,ee.append(p,d))}N(Jo),N(To),Object.keys(s.state).length>0&&(d(L,".dirty=true;"),d.exit(L,".dirty=true;")),d("a1(",p.shared.context,",a0,",p.batchId,");")}function mr(p){if(!(typeof p!="object"||Qa(p))){for(var s=Object.keys(p),d=0;d<s.length;++d)if(Qe.isDynamic(p[s[d]]))return!0;return!1}}function Dn(p,s,d){var g=s.static[d];if(!g||!mr(g))return;var L=p.global,N=Object.keys(g),K=!1,ee=!1,X=!1,be=p.global.def("{}");N.forEach(function(Be){var pt=g[Be];if(Qe.isDynamic(pt)){typeof pt=="function"&&(pt=g[Be]=Qe.unbox(pt));var Kt=zo(pt,null);K=K||Kt.thisDep,X=X||Kt.propDep,ee=ee||Kt.contextDep}else{switch(L(be,".",Be,"="),typeof pt){case"number":L(pt);break;case"string":L('"',pt,'"');break;case"object":Array.isArray(pt)&&L("[",pt.join(),"]");break;default:L(p.link(pt));break}L(";")}});function me(Be,pt){N.forEach(function(Kt){var kt=g[Kt];if(!!Qe.isDynamic(kt)){var Qt=Be.invoke(pt,kt);pt(be,".",Kt,"=",Qt,";")}})}s.dynamic[d]=new Qe.DynamicVariable(si,{thisDep:K,contextDep:ee,propDep:X,ref:be,append:me}),delete s.static[d]}function P(p,s,d,g,L){var N=di();N.stats=N.link(L),Object.keys(s.static).forEach(function(ee){Dn(N,s,ee)}),Uf.forEach(function(ee){Dn(N,p,ee)});var K=ws(p,s,d,g,N);return es(N,K),Sr(N,K),Lt(N,K),v(N.compile(),{destroy:function(){K.shader.program.destroy()}})}return{next:qn,current:Lr,procs:function(){var p=di(),s=p.proc("poll"),d=p.proc("refresh"),g=p.block();s(g),d(g);var L=p.shared,N=L.gl,K=L.next,ee=L.current;g(ee,".dirty=false;"),xs(p,s),xs(p,d,null,!0);var X;Xr&&(X=p.link(Xr)),At.oes_vertex_array_object&&d(p.link(At.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var be=0;be<gr.maxAttributes;++be){var me=d.def(L.attributes,"[",be,"]"),Be=p.cond(me,".buffer");Be.then(N,".enableVertexAttribArray(",be,");",N,".bindBuffer(",Qu,",",me,".buffer.buffer);",N,".vertexAttribPointer(",be,",",me,".size,",me,".type,",me,".normalized,",me,".stride,",me,".offset);").else(N,".disableVertexAttribArray(",be,");",N,".vertexAttrib4f(",be,",",me,".x,",me,".y,",me,".z,",me,".w);",me,".buffer=null;"),d(Be),Xr&&d(X,".vertexAttribDivisorANGLE(",be,",",me,".divisor);")}return d(p.shared.vao,".currentVAO=null;",p.shared.vao,".setVAO(",p.shared.vao,".targetVAO);"),Object.keys(jr).forEach(function(pt){var Kt=jr[pt],kt=g.def(K,".",pt),Qt=p.block();Qt("if(",kt,"){",N,".enable(",Kt,")}else{",N,".disable(",Kt,")}",ee,".",pt,"=",kt,";"),d(Qt),s("if(",kt,"!==",ee,".",pt,"){",Qt,"}")}),Object.keys(Vr).forEach(function(pt){var Kt=Vr[pt],kt=Lr[pt],Qt,ur,Ur=p.block();if(Ur(N,".",Kt,"("),Qa(kt)){var on=kt.length;Qt=p.global.def(K,".",pt),ur=p.global.def(ee,".",pt),Ur(de(on,function(Hr){return Qt+"["+Hr+"]"}),");",de(on,function(Hr){return ur+"["+Hr+"]="+Qt+"["+Hr+"];"}).join("")),s("if(",de(on,function(Hr){return Qt+"["+Hr+"]!=="+ur+"["+Hr+"]"}).join("||"),"){",Ur,"}")}else Qt=g.def(K,".",pt),ur=g.def(ee,".",pt),Ur(Qt,");",ee,".",pt,"=",Qt,";"),s("if(",Qt,"!==",ur,"){",Ur,"}");d(Ur)}),p.compile()}(),compile:P}}function fh(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Xf=34918,Bu=34919,Yf=35007,ff=function(je,At){if(!At.ext_disjoint_timer_query)return null;var gr=[];function Ir(){return gr.pop()||At.ext_disjoint_timer_query.createQueryEXT()}function wr(_n){gr.push(_n)}var xr=[];function Wr(_n){var Lr=Ir();At.ext_disjoint_timer_query.beginQueryEXT(Yf,Lr),xr.push(Lr),nn(xr.length-1,xr.length,_n)}function sn(){At.ext_disjoint_timer_query.endQueryEXT(Yf)}function tn(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var qr=[];function fn(){return qr.pop()||new tn}function wn(_n){qr.push(_n)}var cn=[];function nn(_n,Lr,qn){var Qr=fn();Qr.startQueryIndex=_n,Qr.endQueryIndex=Lr,Qr.sum=0,Qr.stats=qn,cn.push(Qr)}var yr=[],vr=[];function Xr(){var _n,Lr,qn=xr.length;if(qn!==0){vr.length=Math.max(vr.length,qn+1),yr.length=Math.max(yr.length,qn+1),yr[0]=0,vr[0]=0;var Qr=0;for(_n=0,Lr=0;Lr<xr.length;++Lr){var jr=xr[Lr];At.ext_disjoint_timer_query.getQueryObjectEXT(jr,Bu)?(Qr+=At.ext_disjoint_timer_query.getQueryObjectEXT(jr,Xf),wr(jr)):xr[_n++]=jr,yr[Lr+1]=Qr,vr[Lr+1]=_n}for(xr.length=_n,_n=0,Lr=0;Lr<cn.length;++Lr){var Vr=cn[Lr],Kr=Vr.startQueryIndex,Yn=Vr.endQueryIndex;Vr.sum+=yr[Yn]-yr[Kr];var ti=vr[Kr],un=vr[Yn];un===ti?(Vr.stats.gpuTime+=Vr.sum/1e6,wn(Vr)):(Vr.startQueryIndex=ti,Vr.endQueryIndex=un,cn[_n++]=Vr)}cn.length=_n}}return{beginQuery:Wr,endQuery:sn,pushScopeStats:nn,update:Xr,getNumPendingQueries:function(){return xr.length},clear:function(){gr.push.apply(gr,xr);for(var Lr=0;Lr<gr.length;Lr++)At.ext_disjoint_timer_query.deleteQueryEXT(gr[Lr]);xr.length=0,gr.length=0},restore:function(){xr.length=0,gr.length=0}}},Kf=16384,Th=256,hh=1024,Af=34962,oh="webglcontextlost",$f="webglcontextrestored",dh=1,Fh=2,Cf=3;function zf(xe,je){for(var At=0;At<xe.length;++At)if(xe[At]===je)return At;return-1}function Ah(xe){var je=Vn(xe);if(!je)return null;var At=je.gl,gr=At.getContextAttributes(),Ir=At.isContextLost(),wr=Te(At,je);if(!wr)return null;var xr=Zr(),Wr=fh(),sn=wr.extensions,tn=ff(At,sn),qr=pr(),fn=At.drawingBufferWidth,wn=At.drawingBufferHeight,cn={tick:0,time:0,viewportWidth:fn,viewportHeight:wn,framebufferWidth:fn,framebufferHeight:wn,drawingBufferWidth:fn,drawingBufferHeight:wn,pixelRatio:je.pixelRatio},nn={},yr={elements:null,primitive:4,count:-1,offset:0,instances:-1},vr=Po(At,sn),Xr=Qi(At,Wr,je,Lr),_n=Je(At,sn,vr,Wr,Xr);function Lr(Sn){return _n.destroyBuffer(Sn)}var qn=Oc(At,sn,Xr,Wr),Qr=zt(At,xr,Wr,je),jr=Yu(At,sn,vr,function(){Yn.procs.poll()},cn,Wr,je),Vr=nu(At,sn,vr,Wr,je),Kr=k(At,sn,vr,jr,Vr,Wr),Yn=Wf(At,xr,sn,vr,Xr,qn,jr,Kr,nn,_n,Qr,yr,cn,tn,je),ti=hr(At,Kr,Yn.procs.poll,cn,gr,sn,vr),un=Yn.next,Gr=At.canvas,Fr=[],di=[],pi=[],kn=[je.onDestroy],Bi=null;function _i(){if(Fr.length===0){tn&&tn.update(),Bi=null;return}Bi=Vt.next(_i),Zs();for(var Sn=Fr.length-1;Sn>=0;--Sn){var Ri=Fr[Sn];Ri&&Ri(cn,null,0)}At.flush(),tn&&tn.update()}function Ui(){!Bi&&Fr.length>0&&(Bi=Vt.next(_i))}function ca(){Bi&&(Vt.cancel(_i),Bi=null)}function Go(Sn){Sn.preventDefault(),Ir=!0,ca(),di.forEach(function(Ri){Ri()})}function Ho(Sn){At.getError(),Ir=!1,wr.restore(),Qr.restore(),Xr.restore(),jr.restore(),Vr.restore(),Kr.restore(),_n.restore(),tn&&tn.restore(),Yn.procs.refresh(),Ui(),pi.forEach(function(Ri){Ri()})}Gr&&(Gr.addEventListener(oh,Go,!1),Gr.addEventListener($f,Ho,!1));function ta(){Fr.length=0,ca(),Gr&&(Gr.removeEventListener(oh,Go),Gr.removeEventListener($f,Ho)),Qr.clear(),Kr.clear(),Vr.clear(),jr.clear(),qn.clear(),Xr.clear(),_n.clear(),tn&&tn.clear(),kn.forEach(function(Sn){Sn()})}function mo(Sn){$(!!Sn,"invalid args to regl({...})"),$.type(Sn,"object","invalid args to regl({...})");function Ri(L){var N=v({},L);delete N.uniforms,delete N.attributes,delete N.context,delete N.vao,"stencil"in N&&N.stencil.op&&(N.stencil.opBack=N.stencil.opFront=N.stencil.op,delete N.stencil.op);function K(ee){if(ee in N){var X=N[ee];delete N[ee],Object.keys(X).forEach(function(be){N[ee+"."+be]=X[be]})}}return K("blend"),K("depth"),K("cull"),K("stencil"),K("polygonOffset"),K("scissor"),K("sample"),"vao"in L&&(N.vao=L.vao),N}function Vi(L,N){var K={},ee={};return Object.keys(L).forEach(function(X){var be=L[X];if(Qe.isDynamic(be)){ee[X]=Qe.unbox(be,X);return}else if(N&&Array.isArray(be)){for(var me=0;me<be.length;++me)if(Qe.isDynamic(be[me])){ee[X]=Qe.unbox(be,X);return}}K[X]=be}),{dynamic:ee,static:K}}var es=Vi(Sn.context||{},!0),au=Vi(Sn.uniforms||{},!0),hc=Vi(Sn.attributes||{},!1),Lt=Vi(Ri(Sn),!1),Sr={gpuTime:0,cpuTime:0,count:0},mr=Yn.compile(Lt,hc,au,es,Sr),Dn=mr.draw,P=mr.batch,p=mr.scope,s=[];function d(L){for(;s.length<L;)s.push(null);return s}function g(L,N){var K;if(Ir&&$.raise("context lost"),typeof L=="function")return p.call(this,null,L,0);if(typeof N=="function")if(typeof L=="number")for(K=0;K<L;++K)p.call(this,null,N,K);else if(Array.isArray(L))for(K=0;K<L.length;++K)p.call(this,L[K],N,K);else return p.call(this,L,N,0);else if(typeof L=="number"){if(L>0)return P.call(this,d(L|0),L|0)}else if(Array.isArray(L)){if(L.length)return P.call(this,L,L.length)}else return Dn.call(this,L)}return v(g,{stats:Sr,destroy:function(){mr.destroy()}})}var Oa=Kr.setFBO=mo({framebuffer:Qe.define.call(null,dh,"framebuffer")});function ws(Sn,Ri){var Vi=0;Yn.procs.poll();var es=Ri.color;es&&(At.clearColor(+es[0]||0,+es[1]||0,+es[2]||0,+es[3]||0),Vi|=Kf),"depth"in Ri&&(At.clearDepth(+Ri.depth),Vi|=Th),"stencil"in Ri&&(At.clearStencil(Ri.stencil|0),Vi|=hh),$(!!Vi,"called regl.clear with no buffer specified"),At.clear(Vi)}function Qo(Sn){if($(typeof Sn=="object"&&Sn,"regl.clear() takes an object as input"),"framebuffer"in Sn)if(Sn.framebuffer&&Sn.framebuffer_reglType==="framebufferCube")for(var Ri=0;Ri<6;++Ri)Oa(v({framebuffer:Sn.framebuffer.faces[Ri]},Sn),ws);else Oa(Sn,ws);else ws(null,Sn)}function xs(Sn){$.type(Sn,"function","regl.frame() callback must be a function"),Fr.push(Sn);function Ri(){var Vi=zf(Fr,Sn);$(Vi>=0,"cannot cancel a frame twice");function es(){var au=zf(Fr,es);Fr[au]=Fr[Fr.length-1],Fr.length-=1,Fr.length<=0&&ca()}Fr[Vi]=es}return Ui(),{cancel:Ri}}function qo(){var Sn=un.viewport,Ri=un.scissor_box;Sn[0]=Sn[1]=Ri[0]=Ri[1]=0,cn.viewportWidth=cn.framebufferWidth=cn.drawingBufferWidth=Sn[2]=Ri[2]=At.drawingBufferWidth,cn.viewportHeight=cn.framebufferHeight=cn.drawingBufferHeight=Sn[3]=Ri[3]=At.drawingBufferHeight}function Zs(){cn.tick+=1,cn.time=ui(),qo(),Yn.procs.poll()}function No(){jr.refresh(),qo(),Yn.procs.refresh(),tn&&tn.update()}function ui(){return(pr()-qr)/1e3}No();function Ws(Sn,Ri){$.type(Ri,"function","listener callback must be a function");var Vi;switch(Sn){case"frame":return xs(Ri);case"lost":Vi=di;break;case"restore":Vi=pi;break;case"destroy":Vi=kn;break;default:$.raise("invalid event, must be one of frame,lost,restore,destroy")}return Vi.push(Ri),{cancel:function(){for(var au=0;au<Vi.length;++au)if(Vi[au]===Ri){Vi[au]=Vi[Vi.length-1],Vi.pop();return}}}}var Ca=v(mo,{clear:Qo,prop:Qe.define.bind(null,dh),context:Qe.define.bind(null,Fh),this:Qe.define.bind(null,Cf),draw:mo({}),buffer:function(Ri){return Xr.create(Ri,Af,!1,!1)},elements:function(Ri){return qn.create(Ri,!1)},texture:jr.create2D,cube:jr.createCube,renderbuffer:Vr.create,framebuffer:Kr.create,framebufferCube:Kr.createCube,vao:_n.createVAO,attributes:gr,frame:xs,on:Ws,limits:vr,hasExtension:function(Ri){return vr.extensions.indexOf(Ri.toLowerCase())>=0},read:ti,destroy:ta,_gl:At,_refresh:No,poll:function(){Zs(),tn&&tn.update()},now:ui,stats:Wr});return je.onDone(null,Ca),Ca}return Ah})},fdMe:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});function b(v,Z){var F=Z.callback;return F&&(v.dataArray=v.dataArray.map(F)),v}},fo6e:function(Ie,x){var o=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function b(v){return o.test(v)}Ie.exports=b},g4R6:function(Ie,x){function o(b,v,Z){return b===b&&(Z!==void 0&&(b=b<=Z?b:Z),v!==void 0&&(b=b>=v?b:v)),b}Ie.exports=o},gFfm:function(Ie,x){function o(b,v){for(var Z=-1,F=b==null?0:b.length;++Z<F&&v(b[Z],Z,b)!==!1;);return b}Ie.exports=o},gMG2:function(Ie,x,o){"use strict";o.d(x,"a",function(){return or});var b={},v={},Z=34,F=10,a=13;function Y($t){return new Function("d","return {"+$t.map(function(Ht,mt){return JSON.stringify(Ht)+": d["+mt+'] || ""'}).join(",")+"}")}function B($t,Ht){var mt=Y($t);return function(Xe,Tt){return Ht(mt(Xe),Tt,$t)}}function Q($t){var Ht=Object.create(null),mt=[];return $t.forEach(function(Xe){for(var Tt in Xe)Tt in Ht||mt.push(Ht[Tt]=Tt)}),mt}function re($t,Ht){var mt=$t+"",Xe=mt.length;return Xe<Ht?new Array(Ht-Xe+1).join(0)+mt:mt}function we($t){return $t<0?"-"+re(-$t,6):$t>9999?"+"+re($t,6):re($t,4)}function J($t){var Ht=$t.getUTCHours(),mt=$t.getUTCMinutes(),Xe=$t.getUTCSeconds(),Tt=$t.getUTCMilliseconds();return isNaN($t)?"Invalid Date":we($t.getUTCFullYear(),4)+"-"+re($t.getUTCMonth()+1,2)+"-"+re($t.getUTCDate(),2)+(Tt?"T"+re(Ht,2)+":"+re(mt,2)+":"+re(Xe,2)+"."+re(Tt,3)+"Z":Xe?"T"+re(Ht,2)+":"+re(mt,2)+":"+re(Xe,2)+"Z":mt||Ht?"T"+re(Ht,2)+":"+re(mt,2)+"Z":"")}var Ke=function($t){var Ht=new RegExp('["'+$t+`
\r]`),mt=$t.charCodeAt(0);function Xe(z,V){var Se,ve,ce=Tt(z,function(fe,ke){if(Se)return Se(fe,ke-1);ve=fe,Se=V?B(fe,V):Y(fe)});return ce.columns=ve||[],ce}function Tt(z,V){var Se=[],ve=z.length,ce=0,fe=0,ke,lt=ve<=0,nt=!1;z.charCodeAt(ve-1)===F&&--ve,z.charCodeAt(ve-1)===a&&--ve;function le(){if(lt)return v;if(nt)return nt=!1,b;var He,ft=ce,De;if(z.charCodeAt(ft)===Z){for(;ce++<ve&&z.charCodeAt(ce)!==Z||z.charCodeAt(++ce)===Z;);return(He=ce)>=ve?lt=!0:(De=z.charCodeAt(ce++))===F?nt=!0:De===a&&(nt=!0,z.charCodeAt(ce)===F&&++ce),z.slice(ft+1,He-1).replace(/""/g,'"')}for(;ce<ve;){if((De=z.charCodeAt(He=ce++))===F)nt=!0;else if(De===a)nt=!0,z.charCodeAt(ce)===F&&++ce;else if(De!==mt)continue;return z.slice(ft,He)}return lt=!0,z.slice(ft,ve)}for(;(ke=le())!==v;){for(var ye=[];ke!==b&&ke!==v;)ye.push(ke),ke=le();V&&(ye=V(ye,fe++))==null||Se.push(ye)}return Se}function ze(z,V){return z.map(function(Se){return V.map(function(ve){return H(Se[ve])}).join($t)})}function st(z,V){return V==null&&(V=Q(z)),[V.map(H).join($t)].concat(ze(z,V)).join(`
`)}function Wt(z,V){return V==null&&(V=Q(z)),ze(z,V).join(`
`)}function bt(z){return z.map(dt).join(`
`)}function dt(z){return z.map(H).join($t)}function H(z){return z==null?"":z instanceof Date?J(z):Ht.test(z+="")?'"'+z.replace(/"/g,'""')+'"':z}return{parse:Xe,parseRows:Tt,format:st,formatBody:Wt,formatRows:bt,formatRow:dt,formatValue:H}},Ge=Ke(","),_e=Ge.parse,Re=Ge.parseRows,at=Ge.format,Oe=Ge.formatBody,xt=Ge.formatRows,Mt=Ge.formatRow,Et=Ge.formatValue,St=o("5zYK");function or($t,Ht){var mt=_e($t);return Object(St.a)(mt,Ht)}},gQMU:function(Ie,x,o){var b=o("0ZTe"),v=b("toUpperCase");Ie.exports=v},gzZq:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingToSyntax=void 0;var b=o("MON2"),v=o("FV85"),Z=o("D9lx"),F=o("LKzl"),a=function(){function Y(B){this._binding=B}return Y.prototype.to=function(B){return this._binding.type=v.BindingTypeEnum.Instance,this._binding.implementationType=B,new Z.BindingInWhenOnSyntax(this._binding)},Y.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+b.INVALID_TO_SELF_VALUE);var B=this._binding.serviceIdentifier;return this.to(B)},Y.prototype.toConstantValue=function(B){return this._binding.type=v.BindingTypeEnum.ConstantValue,this._binding.cache=B,this._binding.dynamicValue=null,this._binding.implementationType=null,new F.BindingWhenOnSyntax(this._binding)},Y.prototype.toDynamicValue=function(B){return this._binding.type=v.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=B,this._binding.implementationType=null,new Z.BindingInWhenOnSyntax(this._binding)},Y.prototype.toConstructor=function(B){return this._binding.type=v.BindingTypeEnum.Constructor,this._binding.implementationType=B,new F.BindingWhenOnSyntax(this._binding)},Y.prototype.toFactory=function(B){return this._binding.type=v.BindingTypeEnum.Factory,this._binding.factory=B,new F.BindingWhenOnSyntax(this._binding)},Y.prototype.toFunction=function(B){if(typeof B!="function")throw new Error(b.INVALID_FUNCTION_BINDING);var Q=this.toConstantValue(B);return this._binding.type=v.BindingTypeEnum.Function,Q},Y.prototype.toAutoFactory=function(B){return this._binding.type=v.BindingTypeEnum.Factory,this._binding.factory=function(Q){var re=function(){return Q.container.get(B)};return re},new F.BindingWhenOnSyntax(this._binding)},Y.prototype.toProvider=function(B){return this._binding.type=v.BindingTypeEnum.Provider,this._binding.provider=B,new F.BindingWhenOnSyntax(this._binding)},Y.prototype.toService=function(B){this.toDynamicValue(function(Q){return Q.container.get(B)})},Y}();x.BindingToSyntax=a},h1nZ:function(Ie,x,o){"use strict";var b=o("fX6N");o.d(x,"container",function(){return b.c}),o.d(x,"createSceneContainer",function(){return b.b}),o.d(x,"createLayerContainer",function(){return b.a}),o.d(x,"lazyInject",function(){return b.d});var v=o("+em5"),Z=o("bB6j");o.d(x,"TYPES",function(){return Z.a});var F=o("8/Fi"),a=o("PUg6");o.d(x,"BlendType",function(){return a.a});var Y=o("cZlC");o.d(x,"AttributeType",function(){return Y.a}),o.d(x,"ScaleTypes",function(){return Y.b}),o.d(x,"StyleScaleType",function(){return Y.c});var B=o("O1je"),Q=o.n(B);o.o(B,"CameraUniform")&&o.d(x,"CameraUniform",function(){return B.CameraUniform}),o.o(B,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return B.CityBuildingLayer}),o.o(B,"Control")&&o.d(x,"Control",function(){return B.Control}),o.o(B,"CoordinateSystem")&&o.d(x,"CoordinateSystem",function(){return B.CoordinateSystem}),o.o(B,"CoordinateUniform")&&o.d(x,"CoordinateUniform",function(){return B.CoordinateUniform}),o.o(B,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return B.HeatmapLayer}),o.o(B,"ImageLayer")&&o.d(x,"ImageLayer",function(){return B.ImageLayer}),o.o(B,"LineLayer")&&o.d(x,"LineLayer",function(){return B.LineLayer}),o.o(B,"Logo")&&o.d(x,"Logo",function(){return B.Logo}),o.o(B,"MapServiceEvent")&&o.d(x,"MapServiceEvent",function(){return B.MapServiceEvent}),o.o(B,"Marker")&&o.d(x,"Marker",function(){return B.Marker}),o.o(B,"PointLayer")&&o.d(x,"PointLayer",function(){return B.PointLayer}),o.o(B,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return B.PolygonLayer}),o.o(B,"Popup")&&o.d(x,"Popup",function(){return B.Popup}),o.o(B,"PositionType")&&o.d(x,"PositionType",function(){return B.PositionType}),o.o(B,"RasterLayer")&&o.d(x,"RasterLayer",function(){return B.RasterLayer}),o.o(B,"Scale")&&o.d(x,"Scale",function(){return B.Scale}),o.o(B,"Scene")&&o.d(x,"Scene",function(){return B.Scene}),o.o(B,"SceneEventList")&&o.d(x,"SceneEventList",function(){return B.SceneEventList}),o.o(B,"Zoom")&&o.d(x,"Zoom",function(){return B.Zoom}),o.o(B,"gl")&&o.d(x,"gl",function(){return B.gl});var re=o("L56e");o.d(x,"MapServiceEvent",function(){return re.a});var we=o("HthE");o.d(x,"CoordinateSystem",function(){return we.a}),o.d(x,"CoordinateUniform",function(){return we.b});var J=o("/33/"),Ke=o.n(J);o.o(J,"CameraUniform")&&o.d(x,"CameraUniform",function(){return J.CameraUniform}),o.o(J,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return J.CityBuildingLayer}),o.o(J,"Control")&&o.d(x,"Control",function(){return J.Control}),o.o(J,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return J.HeatmapLayer}),o.o(J,"ImageLayer")&&o.d(x,"ImageLayer",function(){return J.ImageLayer}),o.o(J,"LineLayer")&&o.d(x,"LineLayer",function(){return J.LineLayer}),o.o(J,"Logo")&&o.d(x,"Logo",function(){return J.Logo}),o.o(J,"Marker")&&o.d(x,"Marker",function(){return J.Marker}),o.o(J,"PointLayer")&&o.d(x,"PointLayer",function(){return J.PointLayer}),o.o(J,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return J.PolygonLayer}),o.o(J,"Popup")&&o.d(x,"Popup",function(){return J.Popup}),o.o(J,"PositionType")&&o.d(x,"PositionType",function(){return J.PositionType}),o.o(J,"RasterLayer")&&o.d(x,"RasterLayer",function(){return J.RasterLayer}),o.o(J,"Scale")&&o.d(x,"Scale",function(){return J.Scale}),o.o(J,"Scene")&&o.d(x,"Scene",function(){return J.Scene}),o.o(J,"SceneEventList")&&o.d(x,"SceneEventList",function(){return J.SceneEventList}),o.o(J,"Zoom")&&o.d(x,"Zoom",function(){return J.Zoom}),o.o(J,"gl")&&o.d(x,"gl",function(){return J.gl});var Ge=o("EfZ0");o.d(x,"CameraUniform",function(){return Ge.a});var _e=o("riiI"),Re=o.n(_e);o.o(_e,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return _e.CityBuildingLayer}),o.o(_e,"Control")&&o.d(x,"Control",function(){return _e.Control}),o.o(_e,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return _e.HeatmapLayer}),o.o(_e,"ImageLayer")&&o.d(x,"ImageLayer",function(){return _e.ImageLayer}),o.o(_e,"LineLayer")&&o.d(x,"LineLayer",function(){return _e.LineLayer}),o.o(_e,"Logo")&&o.d(x,"Logo",function(){return _e.Logo}),o.o(_e,"Marker")&&o.d(x,"Marker",function(){return _e.Marker}),o.o(_e,"PointLayer")&&o.d(x,"PointLayer",function(){return _e.PointLayer}),o.o(_e,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return _e.PolygonLayer}),o.o(_e,"Popup")&&o.d(x,"Popup",function(){return _e.Popup}),o.o(_e,"PositionType")&&o.d(x,"PositionType",function(){return _e.PositionType}),o.o(_e,"RasterLayer")&&o.d(x,"RasterLayer",function(){return _e.RasterLayer}),o.o(_e,"Scale")&&o.d(x,"Scale",function(){return _e.Scale}),o.o(_e,"Scene")&&o.d(x,"Scene",function(){return _e.Scene}),o.o(_e,"SceneEventList")&&o.d(x,"SceneEventList",function(){return _e.SceneEventList}),o.o(_e,"Zoom")&&o.d(x,"Zoom",function(){return _e.Zoom}),o.o(_e,"gl")&&o.d(x,"gl",function(){return _e.gl});var at=o("eg+a");o.d(x,"SceneEventList",function(){return at.a});var Oe=o("bYl4"),xt=o.n(Oe);o.o(Oe,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return Oe.CityBuildingLayer}),o.o(Oe,"Control")&&o.d(x,"Control",function(){return Oe.Control}),o.o(Oe,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return Oe.HeatmapLayer}),o.o(Oe,"ImageLayer")&&o.d(x,"ImageLayer",function(){return Oe.ImageLayer}),o.o(Oe,"LineLayer")&&o.d(x,"LineLayer",function(){return Oe.LineLayer}),o.o(Oe,"Logo")&&o.d(x,"Logo",function(){return Oe.Logo}),o.o(Oe,"Marker")&&o.d(x,"Marker",function(){return Oe.Marker}),o.o(Oe,"PointLayer")&&o.d(x,"PointLayer",function(){return Oe.PointLayer}),o.o(Oe,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return Oe.PolygonLayer}),o.o(Oe,"Popup")&&o.d(x,"Popup",function(){return Oe.Popup}),o.o(Oe,"PositionType")&&o.d(x,"PositionType",function(){return Oe.PositionType}),o.o(Oe,"RasterLayer")&&o.d(x,"RasterLayer",function(){return Oe.RasterLayer}),o.o(Oe,"Scale")&&o.d(x,"Scale",function(){return Oe.Scale}),o.o(Oe,"Scene")&&o.d(x,"Scene",function(){return Oe.Scene}),o.o(Oe,"Zoom")&&o.d(x,"Zoom",function(){return Oe.Zoom}),o.o(Oe,"gl")&&o.d(x,"gl",function(){return Oe.gl});var Mt=o("FI6e"),Et=o.n(Mt);o.o(Mt,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return Mt.CityBuildingLayer}),o.o(Mt,"Control")&&o.d(x,"Control",function(){return Mt.Control}),o.o(Mt,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return Mt.HeatmapLayer}),o.o(Mt,"ImageLayer")&&o.d(x,"ImageLayer",function(){return Mt.ImageLayer}),o.o(Mt,"LineLayer")&&o.d(x,"LineLayer",function(){return Mt.LineLayer}),o.o(Mt,"Logo")&&o.d(x,"Logo",function(){return Mt.Logo}),o.o(Mt,"Marker")&&o.d(x,"Marker",function(){return Mt.Marker}),o.o(Mt,"PointLayer")&&o.d(x,"PointLayer",function(){return Mt.PointLayer}),o.o(Mt,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return Mt.PolygonLayer}),o.o(Mt,"Popup")&&o.d(x,"Popup",function(){return Mt.Popup}),o.o(Mt,"PositionType")&&o.d(x,"PositionType",function(){return Mt.PositionType}),o.o(Mt,"RasterLayer")&&o.d(x,"RasterLayer",function(){return Mt.RasterLayer}),o.o(Mt,"Scale")&&o.d(x,"Scale",function(){return Mt.Scale}),o.o(Mt,"Scene")&&o.d(x,"Scene",function(){return Mt.Scene}),o.o(Mt,"Zoom")&&o.d(x,"Zoom",function(){return Mt.Zoom}),o.o(Mt,"gl")&&o.d(x,"gl",function(){return Mt.gl});var St=o("D+ow"),or=o.n(St);o.o(St,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return St.CityBuildingLayer}),o.o(St,"Control")&&o.d(x,"Control",function(){return St.Control}),o.o(St,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return St.HeatmapLayer}),o.o(St,"ImageLayer")&&o.d(x,"ImageLayer",function(){return St.ImageLayer}),o.o(St,"LineLayer")&&o.d(x,"LineLayer",function(){return St.LineLayer}),o.o(St,"Logo")&&o.d(x,"Logo",function(){return St.Logo}),o.o(St,"Marker")&&o.d(x,"Marker",function(){return St.Marker}),o.o(St,"PointLayer")&&o.d(x,"PointLayer",function(){return St.PointLayer}),o.o(St,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return St.PolygonLayer}),o.o(St,"Popup")&&o.d(x,"Popup",function(){return St.Popup}),o.o(St,"PositionType")&&o.d(x,"PositionType",function(){return St.PositionType}),o.o(St,"RasterLayer")&&o.d(x,"RasterLayer",function(){return St.RasterLayer}),o.o(St,"Scale")&&o.d(x,"Scale",function(){return St.Scale}),o.o(St,"Scene")&&o.d(x,"Scene",function(){return St.Scene}),o.o(St,"Zoom")&&o.d(x,"Zoom",function(){return St.Zoom}),o.o(St,"gl")&&o.d(x,"gl",function(){return St.gl});var $t=o("AFH1");o.d(x,"PositionType",function(){return $t.a});var Ht=o("8uyu"),mt=o.n(Ht);o.o(Ht,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return Ht.CityBuildingLayer}),o.o(Ht,"Control")&&o.d(x,"Control",function(){return Ht.Control}),o.o(Ht,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return Ht.HeatmapLayer}),o.o(Ht,"ImageLayer")&&o.d(x,"ImageLayer",function(){return Ht.ImageLayer}),o.o(Ht,"LineLayer")&&o.d(x,"LineLayer",function(){return Ht.LineLayer}),o.o(Ht,"Logo")&&o.d(x,"Logo",function(){return Ht.Logo}),o.o(Ht,"Marker")&&o.d(x,"Marker",function(){return Ht.Marker}),o.o(Ht,"PointLayer")&&o.d(x,"PointLayer",function(){return Ht.PointLayer}),o.o(Ht,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return Ht.PolygonLayer}),o.o(Ht,"Popup")&&o.d(x,"Popup",function(){return Ht.Popup}),o.o(Ht,"RasterLayer")&&o.d(x,"RasterLayer",function(){return Ht.RasterLayer}),o.o(Ht,"Scale")&&o.d(x,"Scale",function(){return Ht.Scale}),o.o(Ht,"Scene")&&o.d(x,"Scene",function(){return Ht.Scene}),o.o(Ht,"Zoom")&&o.d(x,"Zoom",function(){return Ht.Zoom}),o.o(Ht,"gl")&&o.d(x,"gl",function(){return Ht.gl});var Xe=o("J7lC"),Tt=o.n(Xe);o.o(Xe,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return Xe.CityBuildingLayer}),o.o(Xe,"Control")&&o.d(x,"Control",function(){return Xe.Control}),o.o(Xe,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return Xe.HeatmapLayer}),o.o(Xe,"ImageLayer")&&o.d(x,"ImageLayer",function(){return Xe.ImageLayer}),o.o(Xe,"LineLayer")&&o.d(x,"LineLayer",function(){return Xe.LineLayer}),o.o(Xe,"Logo")&&o.d(x,"Logo",function(){return Xe.Logo}),o.o(Xe,"Marker")&&o.d(x,"Marker",function(){return Xe.Marker}),o.o(Xe,"PointLayer")&&o.d(x,"PointLayer",function(){return Xe.PointLayer}),o.o(Xe,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return Xe.PolygonLayer}),o.o(Xe,"Popup")&&o.d(x,"Popup",function(){return Xe.Popup}),o.o(Xe,"RasterLayer")&&o.d(x,"RasterLayer",function(){return Xe.RasterLayer}),o.o(Xe,"Scale")&&o.d(x,"Scale",function(){return Xe.Scale}),o.o(Xe,"Scene")&&o.d(x,"Scene",function(){return Xe.Scene}),o.o(Xe,"Zoom")&&o.d(x,"Zoom",function(){return Xe.Zoom}),o.o(Xe,"gl")&&o.d(x,"gl",function(){return Xe.gl});var ze=o("QGbF"),st=o.n(ze);o.o(ze,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return ze.CityBuildingLayer}),o.o(ze,"Control")&&o.d(x,"Control",function(){return ze.Control}),o.o(ze,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return ze.HeatmapLayer}),o.o(ze,"ImageLayer")&&o.d(x,"ImageLayer",function(){return ze.ImageLayer}),o.o(ze,"LineLayer")&&o.d(x,"LineLayer",function(){return ze.LineLayer}),o.o(ze,"Logo")&&o.d(x,"Logo",function(){return ze.Logo}),o.o(ze,"Marker")&&o.d(x,"Marker",function(){return ze.Marker}),o.o(ze,"PointLayer")&&o.d(x,"PointLayer",function(){return ze.PointLayer}),o.o(ze,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return ze.PolygonLayer}),o.o(ze,"Popup")&&o.d(x,"Popup",function(){return ze.Popup}),o.o(ze,"RasterLayer")&&o.d(x,"RasterLayer",function(){return ze.RasterLayer}),o.o(ze,"Scale")&&o.d(x,"Scale",function(){return ze.Scale}),o.o(ze,"Scene")&&o.d(x,"Scene",function(){return ze.Scene}),o.o(ze,"Zoom")&&o.d(x,"Zoom",function(){return ze.Zoom}),o.o(ze,"gl")&&o.d(x,"gl",function(){return ze.gl});var Wt=o("V1cb"),bt=o("4kj+"),dt=o.n(bt);o.o(bt,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return bt.CityBuildingLayer}),o.o(bt,"Control")&&o.d(x,"Control",function(){return bt.Control}),o.o(bt,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return bt.HeatmapLayer}),o.o(bt,"ImageLayer")&&o.d(x,"ImageLayer",function(){return bt.ImageLayer}),o.o(bt,"LineLayer")&&o.d(x,"LineLayer",function(){return bt.LineLayer}),o.o(bt,"Logo")&&o.d(x,"Logo",function(){return bt.Logo}),o.o(bt,"Marker")&&o.d(x,"Marker",function(){return bt.Marker}),o.o(bt,"PointLayer")&&o.d(x,"PointLayer",function(){return bt.PointLayer}),o.o(bt,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return bt.PolygonLayer}),o.o(bt,"Popup")&&o.d(x,"Popup",function(){return bt.Popup}),o.o(bt,"RasterLayer")&&o.d(x,"RasterLayer",function(){return bt.RasterLayer}),o.o(bt,"Scale")&&o.d(x,"Scale",function(){return bt.Scale}),o.o(bt,"Scene")&&o.d(x,"Scene",function(){return bt.Scene}),o.o(bt,"Zoom")&&o.d(x,"Zoom",function(){return bt.Zoom}),o.o(bt,"gl")&&o.d(x,"gl",function(){return bt.gl});var H=o("bzyH"),z=o.n(H);o.o(H,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return H.CityBuildingLayer}),o.o(H,"Control")&&o.d(x,"Control",function(){return H.Control}),o.o(H,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return H.HeatmapLayer}),o.o(H,"ImageLayer")&&o.d(x,"ImageLayer",function(){return H.ImageLayer}),o.o(H,"LineLayer")&&o.d(x,"LineLayer",function(){return H.LineLayer}),o.o(H,"Logo")&&o.d(x,"Logo",function(){return H.Logo}),o.o(H,"Marker")&&o.d(x,"Marker",function(){return H.Marker}),o.o(H,"PointLayer")&&o.d(x,"PointLayer",function(){return H.PointLayer}),o.o(H,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return H.PolygonLayer}),o.o(H,"Popup")&&o.d(x,"Popup",function(){return H.Popup}),o.o(H,"RasterLayer")&&o.d(x,"RasterLayer",function(){return H.RasterLayer}),o.o(H,"Scale")&&o.d(x,"Scale",function(){return H.Scale}),o.o(H,"Scene")&&o.d(x,"Scene",function(){return H.Scene}),o.o(H,"Zoom")&&o.d(x,"Zoom",function(){return H.Zoom}),o.o(H,"gl")&&o.d(x,"gl",function(){return H.gl});var V=o("0eqD"),Se=o.n(V);o.o(V,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return V.CityBuildingLayer}),o.o(V,"Control")&&o.d(x,"Control",function(){return V.Control}),o.o(V,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return V.HeatmapLayer}),o.o(V,"ImageLayer")&&o.d(x,"ImageLayer",function(){return V.ImageLayer}),o.o(V,"LineLayer")&&o.d(x,"LineLayer",function(){return V.LineLayer}),o.o(V,"Logo")&&o.d(x,"Logo",function(){return V.Logo}),o.o(V,"Marker")&&o.d(x,"Marker",function(){return V.Marker}),o.o(V,"PointLayer")&&o.d(x,"PointLayer",function(){return V.PointLayer}),o.o(V,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return V.PolygonLayer}),o.o(V,"Popup")&&o.d(x,"Popup",function(){return V.Popup}),o.o(V,"RasterLayer")&&o.d(x,"RasterLayer",function(){return V.RasterLayer}),o.o(V,"Scale")&&o.d(x,"Scale",function(){return V.Scale}),o.o(V,"Scene")&&o.d(x,"Scene",function(){return V.Scene}),o.o(V,"Zoom")&&o.d(x,"Zoom",function(){return V.Zoom}),o.o(V,"gl")&&o.d(x,"gl",function(){return V.gl});var ve=o("/Uc5"),ce=o.n(ve);o.o(ve,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return ve.CityBuildingLayer}),o.o(ve,"Control")&&o.d(x,"Control",function(){return ve.Control}),o.o(ve,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return ve.HeatmapLayer}),o.o(ve,"ImageLayer")&&o.d(x,"ImageLayer",function(){return ve.ImageLayer}),o.o(ve,"LineLayer")&&o.d(x,"LineLayer",function(){return ve.LineLayer}),o.o(ve,"Logo")&&o.d(x,"Logo",function(){return ve.Logo}),o.o(ve,"Marker")&&o.d(x,"Marker",function(){return ve.Marker}),o.o(ve,"PointLayer")&&o.d(x,"PointLayer",function(){return ve.PointLayer}),o.o(ve,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return ve.PolygonLayer}),o.o(ve,"Popup")&&o.d(x,"Popup",function(){return ve.Popup}),o.o(ve,"RasterLayer")&&o.d(x,"RasterLayer",function(){return ve.RasterLayer}),o.o(ve,"Scale")&&o.d(x,"Scale",function(){return ve.Scale}),o.o(ve,"Scene")&&o.d(x,"Scene",function(){return ve.Scene}),o.o(ve,"Zoom")&&o.d(x,"Zoom",function(){return ve.Zoom}),o.o(ve,"gl")&&o.d(x,"gl",function(){return ve.gl});var fe=o("RMtq"),ke=o.n(fe);o.o(fe,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return fe.CityBuildingLayer}),o.o(fe,"Control")&&o.d(x,"Control",function(){return fe.Control}),o.o(fe,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return fe.HeatmapLayer}),o.o(fe,"ImageLayer")&&o.d(x,"ImageLayer",function(){return fe.ImageLayer}),o.o(fe,"LineLayer")&&o.d(x,"LineLayer",function(){return fe.LineLayer}),o.o(fe,"Logo")&&o.d(x,"Logo",function(){return fe.Logo}),o.o(fe,"Marker")&&o.d(x,"Marker",function(){return fe.Marker}),o.o(fe,"PointLayer")&&o.d(x,"PointLayer",function(){return fe.PointLayer}),o.o(fe,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return fe.PolygonLayer}),o.o(fe,"Popup")&&o.d(x,"Popup",function(){return fe.Popup}),o.o(fe,"RasterLayer")&&o.d(x,"RasterLayer",function(){return fe.RasterLayer}),o.o(fe,"Scale")&&o.d(x,"Scale",function(){return fe.Scale}),o.o(fe,"Scene")&&o.d(x,"Scene",function(){return fe.Scene}),o.o(fe,"Zoom")&&o.d(x,"Zoom",function(){return fe.Zoom}),o.o(fe,"gl")&&o.d(x,"gl",function(){return fe.gl});var lt=o("1jvM"),nt=o.n(lt);o.o(lt,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return lt.CityBuildingLayer}),o.o(lt,"Control")&&o.d(x,"Control",function(){return lt.Control}),o.o(lt,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return lt.HeatmapLayer}),o.o(lt,"ImageLayer")&&o.d(x,"ImageLayer",function(){return lt.ImageLayer}),o.o(lt,"LineLayer")&&o.d(x,"LineLayer",function(){return lt.LineLayer}),o.o(lt,"Logo")&&o.d(x,"Logo",function(){return lt.Logo}),o.o(lt,"Marker")&&o.d(x,"Marker",function(){return lt.Marker}),o.o(lt,"PointLayer")&&o.d(x,"PointLayer",function(){return lt.PointLayer}),o.o(lt,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return lt.PolygonLayer}),o.o(lt,"Popup")&&o.d(x,"Popup",function(){return lt.Popup}),o.o(lt,"RasterLayer")&&o.d(x,"RasterLayer",function(){return lt.RasterLayer}),o.o(lt,"Scale")&&o.d(x,"Scale",function(){return lt.Scale}),o.o(lt,"Scene")&&o.d(x,"Scene",function(){return lt.Scene}),o.o(lt,"Zoom")&&o.d(x,"Zoom",function(){return lt.Zoom}),o.o(lt,"gl")&&o.d(x,"gl",function(){return lt.gl});var le=o("bPkA"),ye=o("PSsN"),He=o.n(ye);o.o(ye,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return ye.CityBuildingLayer}),o.o(ye,"Control")&&o.d(x,"Control",function(){return ye.Control}),o.o(ye,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return ye.HeatmapLayer}),o.o(ye,"ImageLayer")&&o.d(x,"ImageLayer",function(){return ye.ImageLayer}),o.o(ye,"LineLayer")&&o.d(x,"LineLayer",function(){return ye.LineLayer}),o.o(ye,"Logo")&&o.d(x,"Logo",function(){return ye.Logo}),o.o(ye,"Marker")&&o.d(x,"Marker",function(){return ye.Marker}),o.o(ye,"PointLayer")&&o.d(x,"PointLayer",function(){return ye.PointLayer}),o.o(ye,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return ye.PolygonLayer}),o.o(ye,"Popup")&&o.d(x,"Popup",function(){return ye.Popup}),o.o(ye,"RasterLayer")&&o.d(x,"RasterLayer",function(){return ye.RasterLayer}),o.o(ye,"Scale")&&o.d(x,"Scale",function(){return ye.Scale}),o.o(ye,"Scene")&&o.d(x,"Scene",function(){return ye.Scene}),o.o(ye,"Zoom")&&o.d(x,"Zoom",function(){return ye.Zoom}),o.o(ye,"gl")&&o.d(x,"gl",function(){return ye.gl});var ft=o("6NqC"),De=o.n(ft);o.o(ft,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return ft.CityBuildingLayer}),o.o(ft,"Control")&&o.d(x,"Control",function(){return ft.Control}),o.o(ft,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return ft.HeatmapLayer}),o.o(ft,"ImageLayer")&&o.d(x,"ImageLayer",function(){return ft.ImageLayer}),o.o(ft,"LineLayer")&&o.d(x,"LineLayer",function(){return ft.LineLayer}),o.o(ft,"Logo")&&o.d(x,"Logo",function(){return ft.Logo}),o.o(ft,"Marker")&&o.d(x,"Marker",function(){return ft.Marker}),o.o(ft,"PointLayer")&&o.d(x,"PointLayer",function(){return ft.PointLayer}),o.o(ft,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return ft.PolygonLayer}),o.o(ft,"Popup")&&o.d(x,"Popup",function(){return ft.Popup}),o.o(ft,"RasterLayer")&&o.d(x,"RasterLayer",function(){return ft.RasterLayer}),o.o(ft,"Scale")&&o.d(x,"Scale",function(){return ft.Scale}),o.o(ft,"Scene")&&o.d(x,"Scene",function(){return ft.Scene}),o.o(ft,"Zoom")&&o.d(x,"Zoom",function(){return ft.Zoom}),o.o(ft,"gl")&&o.d(x,"gl",function(){return ft.gl});var Ze=o("bTtR"),w=o.n(Ze);o.o(Ze,"CityBuildingLayer")&&o.d(x,"CityBuildingLayer",function(){return Ze.CityBuildingLayer}),o.o(Ze,"Control")&&o.d(x,"Control",function(){return Ze.Control}),o.o(Ze,"HeatmapLayer")&&o.d(x,"HeatmapLayer",function(){return Ze.HeatmapLayer}),o.o(Ze,"ImageLayer")&&o.d(x,"ImageLayer",function(){return Ze.ImageLayer}),o.o(Ze,"LineLayer")&&o.d(x,"LineLayer",function(){return Ze.LineLayer}),o.o(Ze,"Logo")&&o.d(x,"Logo",function(){return Ze.Logo}),o.o(Ze,"Marker")&&o.d(x,"Marker",function(){return Ze.Marker}),o.o(Ze,"PointLayer")&&o.d(x,"PointLayer",function(){return Ze.PointLayer}),o.o(Ze,"PolygonLayer")&&o.d(x,"PolygonLayer",function(){return Ze.PolygonLayer}),o.o(Ze,"Popup")&&o.d(x,"Popup",function(){return Ze.Popup}),o.o(Ze,"RasterLayer")&&o.d(x,"RasterLayer",function(){return Ze.RasterLayer}),o.o(Ze,"Scale")&&o.d(x,"Scale",function(){return Ze.Scale}),o.o(Ze,"Scene")&&o.d(x,"Scene",function(){return Ze.Scene}),o.o(Ze,"Zoom")&&o.d(x,"Zoom",function(){return Ze.Zoom}),o.o(Ze,"gl")&&o.d(x,"gl",function(){return Ze.gl});var R=o("o+pz");o.d(x,"gl",function(){return R.a})},h7MG:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.getBindingDictionary=x.createMockRequest=x.plan=void 0;var b=o("doU7"),v=o("MON2"),Z=o("FV85"),F=o("xfSm"),a=o("qK8v"),Y=o("ujMp"),B=o("oy+k"),Q=o("GXnB"),re=o("yMAV"),we=o("fbrv"),J=o("xiII"),Ke=o("dX1H");function Ge(St){return St._bindingDictionary}x.getBindingDictionary=Ge;function _e(St,or,$t,Ht,mt,Xe){var Tt=St?F.MULTI_INJECT_TAG:F.INJECT_TAG,ze=new Q.Metadata(Tt,$t),st=new Ke.Target(or,Ht,$t,ze);if(mt!==void 0){var Wt=new Q.Metadata(mt,Xe);st.metadata.push(Wt)}return st}function Re(St,or,$t,Ht,mt){var Xe=xt($t.container,mt.serviceIdentifier),Tt=[];return Xe.length===b.BindingCount.NoBindingsAvailable&&$t.container.options.autoBindInjectable&&typeof mt.serviceIdentifier=="function"&&St.getConstructorMetadata(mt.serviceIdentifier).compilerGeneratedMetadata&&($t.container.bind(mt.serviceIdentifier).toSelf(),Xe=xt($t.container,mt.serviceIdentifier)),or?Tt=Xe:Tt=Xe.filter(function(ze){var st=new J.Request(ze.serviceIdentifier,$t,Ht,ze,mt);return ze.constraint(st)}),at(mt.serviceIdentifier,Tt,mt,$t.container),Tt}function at(St,or,$t,Ht){switch(or.length){case b.BindingCount.NoBindingsAvailable:if($t.isOptional())return or;var mt=Y.getServiceIdentifierAsString(St),Xe=v.NOT_REGISTERED;throw Xe+=Y.listMetadataForTarget(mt,$t),Xe+=Y.listRegisteredBindingsForServiceIdentifier(Ht,mt,xt),new Error(Xe);case b.BindingCount.OnlyOneBindingAvailable:if(!$t.isArray())return or;case b.BindingCount.MultipleBindingsAvailable:default:if($t.isArray())return or;var mt=Y.getServiceIdentifierAsString(St),Xe=v.AMBIGUOUS_MATCH+" "+mt;throw Xe+=Y.listRegisteredBindingsForServiceIdentifier(Ht,mt,xt),new Error(Xe)}}function Oe(St,or,$t,Ht,mt,Xe){var Tt,ze;if(mt===null){Tt=Re(St,or,Ht,null,Xe),ze=new J.Request($t,Ht,null,Tt,Xe);var st=new re.Plan(Ht,ze);Ht.addPlan(st)}else Tt=Re(St,or,Ht,mt,Xe),ze=mt.addChildRequest(Xe.serviceIdentifier,Tt,Xe);Tt.forEach(function(Wt){var bt=null;if(Xe.isArray())bt=ze.addChildRequest(Wt.serviceIdentifier,Wt,Xe);else{if(Wt.cache)return;bt=ze}if(Wt.type===Z.BindingTypeEnum.Instance&&Wt.implementationType!==null){var dt=we.getDependencies(St,Wt.implementationType);if(!Ht.container.options.skipBaseClassChecks){var H=we.getBaseClassDependencyCount(St,Wt.implementationType);if(dt.length<H){var z=v.ARGUMENTS_LENGTH_MISMATCH(we.getFunctionName(Wt.implementationType));throw new Error(z)}}dt.forEach(function(V){Oe(St,!1,V.serviceIdentifier,Ht,bt,V)})}})}function xt(St,or){var $t=[],Ht=Ge(St);return Ht.hasKey(or)?$t=Ht.get(or):St.parent!==null&&($t=xt(St.parent,or)),$t}function Mt(St,or,$t,Ht,mt,Xe,Tt,ze){ze===void 0&&(ze=!1);var st=new B.Context(or),Wt=_e($t,Ht,mt,"",Xe,Tt);try{return Oe(St,ze,mt,st,null,Wt),st}catch(bt){throw a.isStackOverflowExeption(bt)&&st.plan&&Y.circularDependencyToException(st.plan.rootRequest),bt}}x.plan=Mt;function Et(St,or,$t,Ht){var mt=new Ke.Target(Z.TargetTypeEnum.Variable,"",or,new Q.Metadata($t,Ht)),Xe=new B.Context(St),Tt=new J.Request(or,Xe,null,[],mt);return Tt}x.createMockRequest=Et},heNW:function(Ie,x){function o(b,v,Z){switch(Z.length){case 0:return b.call(v);case 1:return b.call(v,Z[0]);case 2:return b.call(v,Z[0],Z[1]);case 3:return b.call(v,Z[0],Z[1],Z[2])}return b.apply(v,Z)}Ie.exports=o},hi0z:function(Ie,x,o){"use strict";(function(b,v){Ie.exports=v()})(this,function(){function b(we){var J=[];return we.AMapUI&&J.push(v(we.AMapUI)),we.Loca&&J.push(Z(we.Loca)),Promise.all(J)}function v(we){return new Promise(function(J,Ke){var Ge=[];if(we.plugins)for(var _e=0;_e<we.plugins.length;_e+=1)a.AMapUI.plugins.indexOf(we.plugins[_e])==-1&&Ge.push(we.plugins[_e]);if(Y.AMapUI===F.failed)Ke("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(Y.AMapUI===F.notload){Y.AMapUI=F.loading,a.AMapUI.version=we.version||a.AMapUI.version,_e=a.AMapUI.version;var Re=document.body||document.head,at=document.createElement("script");at.type="text/javascript",at.src="https://webapi.amap.com/ui/"+_e+"/main.js",at.onerror=function(Oe){Y.AMapUI=F.failed,Ke("\u8BF7\u6C42 AMapUI \u5931\u8D25")},at.onload=function(){if(Y.AMapUI=F.loaded,Ge.length)window.AMapUI.loadUI(Ge,function(){for(var Oe=0,xt=Ge.length;Oe<xt;Oe++){var Mt=Ge[Oe].split("/").slice(-1)[0];window.AMapUI[Mt]=arguments[Oe]}for(J();B.AMapUI.length;)B.AMapUI.splice(0,1)[0]()});else for(J();B.AMapUI.length;)B.AMapUI.splice(0,1)[0]()},Re.appendChild(at)}else Y.AMapUI===F.loaded?we.version&&we.version!==a.AMapUI.version?Ke("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Ge.length?window.AMapUI.loadUI(Ge,function(){for(var Oe=0,xt=Ge.length;Oe<xt;Oe++){var Mt=Ge[Oe].split("/").slice(-1)[0];window.AMapUI[Mt]=arguments[Oe]}J()}):J():we.version&&we.version!==a.AMapUI.version?Ke("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):B.AMapUI.push(function(Oe){Oe?Ke(Oe):Ge.length?window.AMapUI.loadUI(Ge,function(){for(var xt=0,Mt=Ge.length;xt<Mt;xt++){var Et=Ge[xt].split("/").slice(-1)[0];window.AMapUI[Et]=arguments[xt]}J()}):J()})})}function Z(we){return new Promise(function(J,Ke){if(a.AMap.version.startsWith("2.0"))Ke("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(Y.Loca===F.failed)Ke("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(Y.Loca===F.notload){Y.Loca=F.loading,a.Loca.version=we.version||a.Loca.version;var Ge=a.Loca.version,_e=a.key,Re=document.body||document.head,at=document.createElement("script");at.type="text/javascript",at.src="https://webapi.amap.com/loca?v="+Ge+"&key="+_e,at.onerror=function(Oe){Y.Loca=F.failed,Ke("\u8BF7\u6C42 AMapUI \u5931\u8D25")},at.onload=function(){for(Y.Loca=F.loaded,J();B.Loca.length;)B.Loca.splice(0,1)[0]()},Re.appendChild(at)}else Y.Loca===F.loaded?we.version&&we.version!==a.Loca.version?Ke("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):J():we.version&&we.version!==a.Loca.version?Ke("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):B.Loca.push(function(Oe){Oe?Ke(Oe):Ke()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var F;(function(we){we.notload="notload",we.loading="loading",we.loaded="loaded",we.failed="failed"})(F||(F={}));var a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Y={AMap:F.notload,AMapUI:F.notload,Loca:F.notload},B={AMap:[],AMapUI:[],Loca:[]},Q=[],re=function(J){typeof J=="function"&&(Y.AMap===F.loaded?J(window.AMap):Q.push(J))};return{load:function(J){return new Promise(function(Ke,Ge){if(Y.AMap==F.failed)Ge("");else if(Y.AMap==F.notload){var _e=J.key,Re=J.version,at=J.plugins;_e?(window.AMap&&location.host!=="lbs.amap.com"&&Ge("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),a.key=_e,a.AMap.version=Re||a.AMap.version,a.AMap.plugins=at||a.AMap.plugins,Y.AMap=F.loading,Re=document.body||document.head,window.___onAPILoaded=function(xt){if(delete window.___onAPILoaded,xt)Y.AMap=F.failed,Ge(xt);else for(Y.AMap=F.loaded,b(J).then(function(){Ke(window.AMap)}).catch(Ge);Q.length;)Q.splice(0,1)[0]()},at=document.createElement("script"),at.type="text/javascript",at.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+a.AMap.version+"&key="+_e+"&plugin="+a.AMap.plugins.join(","),at.onerror=function(xt){Y.AMap=F.failed,Ge(xt)},Re.appendChild(at)):Ge("\u8BF7\u586B\u5199key")}else if(Y.AMap==F.loaded)if(J.key&&J.key!==a.key)Ge("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(J.version&&J.version!==a.AMap.version)Ge("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(_e=[],J.plugins)for(Re=0;Re<J.plugins.length;Re+=1)a.AMap.plugins.indexOf(J.plugins[Re])==-1&&_e.push(J.plugins[Re]);_e.length?window.AMap.plugin(_e,function(){b(J).then(function(){Ke(window.AMap)}).catch(Ge)}):b(J).then(function(){Ke(window.AMap)}).catch(Ge)}else if(J.key&&J.key!==a.key)Ge("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(J.version&&J.version!==a.AMap.version)Ge("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var Oe=[];if(J.plugins)for(Re=0;Re<J.plugins.length;Re+=1)a.AMap.plugins.indexOf(J.plugins[Re])==-1&&Oe.push(J.plugins[Re]);re(function(){Oe.length?window.AMap.plugin(Oe,function(){b(J).then(function(){Ke(window.AMap)}).catch(Ge)}):b(J).then(function(){Ke(window.AMap)}).catch(Ge)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Y={AMap:F.notload,AMapUI:F.notload,Loca:F.notload},B={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(Ie,x,o){var b=o("O0oS");function v(Z,F,a){F=="__proto__"&&b?b(Z,F,{configurable:!0,enumerable:!0,value:a,writable:!0}):Z[F]=a}Ie.exports=v},iWIM:function(Ie,x,o){var b=o("n3AX");function v(Z,F,a){return typeof Reflect!="undefined"&&Reflect.get?Ie.exports=v=Reflect.get:Ie.exports=v=function(B,Q,re){var we=b(B,Q);if(!!we){var J=Object.getOwnPropertyDescriptor(we,Q);return J.get?J.get.call(re):J.value}},v(Z,F,a||Z)}Ie.exports=v},iegG:function(Ie,x){function o(b){var v=b.target||b.srcElement;v.__resizeRAF__&&cancelAnimationFrame(v.__resizeRAF__),v.__resizeRAF__=requestAnimationFrame(function(){var Z=v.__resizeTrigger__,F=Z&&Z.__resizeListeners__;F&&F.forEach(function(a){a.call(Z,b)})})}var x=function(v,Z){var F=this,a=F.document,Y,B=a.attachEvent;typeof navigator!="undefined"&&(Y=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function Q(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",o)}if(!v.__resizeListeners__)if(v.__resizeListeners__=[],B)v.__resizeTrigger__=v,v.attachEvent("onresize",o);else{getComputedStyle(v).position==="static"&&(v.style.position="relative");var re=v.__resizeTrigger__=a.createElement("object");re.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),re.setAttribute("class","resize-sensor"),re.setAttribute("tabindex","-1"),re.__resizeElement__=v,re.onload=Q,re.type="text/html",Y&&v.appendChild(re),re.data="about:blank",Y||v.appendChild(re)}v.__resizeListeners__.push(Z)};Ie.exports=typeof window=="undefined"?x:x.bind(window),Ie.exports.unbind=function(b,v){var Z=document.attachEvent,F=b.__resizeListeners__||[];if(v){var a=F.indexOf(v);a!==-1&&F.splice(a,1)}else F=b.__resizeListeners__=[];if(!F.length){if(Z)b.detachEvent("onresize",o);else if(b.__resizeTrigger__){var Y=b.__resizeTrigger__.contentDocument,B=Y&&Y.defaultView;B&&(B.removeEventListener("resize",o),delete B.__resizeTrigger__),b.__resizeTrigger__=!b.removeChild(b.__resizeTrigger__)}delete b.__resizeListeners__}}},itsj:function(Ie,x){function o(b,v){if(!(v==="constructor"&&typeof b[v]=="function")&&v!="__proto__")return b[v]}Ie.exports=o},"iz+Y":function(Ie,x,o){Ie.exports={miniChart:"antd-pro-pages-dashboard-monitor-components-charts-index-miniChart",chartContent:"antd-pro-pages-dashboard-monitor-components-charts-index-chartContent",chartLoading:"antd-pro-pages-dashboard-monitor-components-charts-index-chartLoading"}},jCWc:function(Ie,x,o){"use strict";var b=o("cIOH"),v=o.n(b),Z=o("1GLa")},"jIg/":function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.multiInject=void 0;var b=o("xfSm"),v=o("GXnB"),Z=o("Ztfv");function F(a){return function(Y,B,Q){var re=new v.Metadata(b.MULTI_INJECT_TAG,a);typeof Q=="number"?Z.tagParameter(Y,B,Q,re):Z.tagProperty(Y,B,re)}}x.multiInject=F},jYQm:function(Ie,x,o){"use strict";var b=o("q1tI"),v=o.n(b),Z=Object(b.createContext)({});x.a=Z},jYx5:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.optional=void 0;var b=o("xfSm"),v=o("GXnB"),Z=o("Ztfv");function F(){return function(a,Y,B){var Q=new v.Metadata(b.OPTIONAL_TAG,!0);typeof B=="number"?Z.tagParameter(a,Y,B,Q):Z.tagProperty(a,Y,Q)}}x.optional=F},"jbM+":function(Ie,x,o){var b=o("R/W3");function v(Z,F){var a=Z==null?0:Z.length;return!!a&&b(Z,F,0)>-1}Ie.exports=v},jeLo:function(Ie,x,o){var b=o("juv8"),v=o("mTTR");function Z(F){return b(F,v(F))}Ie.exports=Z},juv8:function(Ie,x,o){var b=o("MrPd"),v=o("hypo");function Z(F,a,Y,B){var Q=!Y;Y||(Y={});for(var re=-1,we=a.length;++re<we;){var J=a[re],Ke=B?B(Y[J],F[J],J,Y,F):void 0;Ke===void 0&&(Ke=F[J]),Q?v(Y,J,Ke):b(Y,J,Ke)}return Y}Ie.exports=Z},"k5/I":function(Ie,x,o){"use strict";o.d(x,"a",function(){return or}),o.d(x,"b",function(){return Wt}),o.d(x,"e",function(){return H}),o.d(x,"f",function(){return Se}),o.d(x,"c",function(){return lt}),o.d(x,"d",function(){return yt});var b=o("lSNA"),v=o.n(b),Z=o("lwsE"),F=o.n(Z),a=o("W8MJ"),Y=o.n(a),B=o("7W2i"),Q=o.n(B),re=o("a1gu"),we=o.n(re),J=o("Nsbk"),Ke=o.n(J),Ge=o("h1nZ"),_e=o("Hel2"),Re=o("uhBA");function at(it,Nt){var $=Object.keys(it);if(Object.getOwnPropertySymbols){var $e=Object.getOwnPropertySymbols(it);Nt&&($e=$e.filter(function(ie){return Object.getOwnPropertyDescriptor(it,ie).enumerable})),$.push.apply($,$e)}return $}function Oe(it){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?at(Object($),!0).forEach(function($e){v()(it,$e,$[$e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(it,Object.getOwnPropertyDescriptors($)):at(Object($)).forEach(function($e){Object.defineProperty(it,$e,Object.getOwnPropertyDescriptor($,$e))})}return it}function xt(it){var Nt=Mt();return function(){var $e=Ke()(it),ie;if(Nt){var qe=Ke()(this).constructor;ie=Reflect.construct($e,arguments,qe)}else ie=$e.apply(this,arguments);return we()(this,ie)}}function Mt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var Et;(function(it){it.TOPRIGHT="topright",it.TOPLEFT="topleft",it.BOTTOMRIGHT="bottomright",it.BOTTOMLEFT="bottomleft"})(Et||(Et={}));var St=0,or=function(it){Q()($,it);var Nt=xt($);function $($e){var ie;return F()(this,$),ie=Nt.call(this),ie.controlOption=void 0,ie.container=void 0,ie.sceneContainer=void 0,ie.mapsService=void 0,ie.renderService=void 0,ie.layerService=void 0,ie.controlService=void 0,ie.isShow=void 0,ie.controlOption=Oe(Oe({},ie.getDefault()),$e||{}),ie}return Y()($,[{key:"getDefault",value:function(){return{position:Et.TOPRIGHT,name:"".concat(St++)}}},{key:"setPosition",value:function(ie){var qe=this.controlService;return qe&&qe.removeControl(this),this.controlOption.position=ie,qe&&qe.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(ie){this.mapsService=ie.get(Ge.TYPES.IMapService),this.renderService=ie.get(Ge.TYPES.IRendererService),this.layerService=ie.get(Ge.TYPES.ILayerService),this.controlService=ie.get(Ge.TYPES.IControlService),this.sceneContainer=ie,this.isShow=!0,this.container=this.onAdd();var qe=this.container,jt=this.controlOption.position,lr=this.controlService.controlCorners[jt];return _e.a.addClass(qe,"l7-control"),jt.indexOf("bottom")!==-1?lr.insertBefore(qe,lr.firstChild):lr.appendChild(qe),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var ie=this.container;_e.a.addClass(ie,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var ie=this.container;_e.a.removeClass(ie,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;_e.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(ie){if(this.mapsService&&ie&&ie.screenX>0&&ie.screenY>0){var qe=this.mapsService.getContainer();qe!==null&&qe.focus()}}}]),$}(Re.EventEmitter),$t=o("PJYZ"),Ht=o.n($t);function mt(it){var Nt=Xe();return function(){var $e=Ke()(it),ie;if(Nt){var qe=Ke()(this).constructor;ie=Reflect.construct($e,arguments,qe)}else ie=$e.apply(this,arguments);return we()(this,ie)}}function Xe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var Tt=function(it){Q()($,it);var Nt=mt($);function $($e){var ie;return F()(this,$),ie=Nt.call(this,$e),ie.layerControlInputs=void 0,ie.layers=void 0,ie.lastZIndex=void 0,ie.handlingClick=void 0,ie.layersLink=void 0,ie.baseLayersList=void 0,ie.separator=void 0,ie.overlaysList=void 0,ie.form=void 0,ie.layerControlInputs=[],ie.layers=[],ie.lastZIndex=0,ie.handlingClick=!1,ie.initLayers(),Object(_e.i)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],Ht()(ie)),ie}return Y()($,[{key:"getDefault",value:function(){return{collapsed:!0,position:Ge.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var ie=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(qe){qe.layer.on("remove",ie.onLayerChange),qe.layer.on("add",ie.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(ie,qe){return this.addLayer(ie,qe,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var ie=this.renderService.getViewportSize(),qe=ie.height;_e.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var jt=qe-(this.container.offsetTop+50);return jt<this.form.clientHeight?(_e.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=jt+"px"):_e.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return _e.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var ie=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(qe){qe.layer.off("remove",ie.onLayerChange),qe.layer.off("add",ie.onLayerChange)}))}},{key:"initLayout",value:function(){var ie="l7-control-layers",qe=this.container=_e.a.create("div",ie),jt=this.controlOption.collapsed;qe.setAttribute("aria-haspopup","true");var lr=this.form=_e.a.create("form",ie+"-list");jt&&(this.mapsService.on("click",this.collapse),qe.addEventListener("mouseenter",this.expand),qe.addEventListener("mouseleave",this.collapse)),this.layersLink=_e.a.create("a",ie+"-toggle",qe);var ct=this.layersLink;ct.title="Layers",jt||this.expand(),this.baseLayersList=_e.a.create("div",ie+"-base",lr),this.separator=_e.a.create("div",ie+"-separator",lr),this.overlaysList=_e.a.create("div",ie+"-overlays",lr),qe.appendChild(lr)}},{key:"initLayers",value:function(){var ie=this,qe=this.controlOption,jt=qe.baseLayers,lr=jt===void 0?{}:jt,ct=qe.overlayers,ht=ct===void 0?{}:ct;Object.keys(lr).forEach(function(Pt,vt){ie.addLayer(lr[Pt],Pt,!1)}),Object.keys(ht).forEach(function(Pt,vt){ie.addLayer(ht[Pt],Pt,!0)})}},{key:"update",value:function(){if(!this.container)return this;_e.a.empty(this.baseLayersList),_e.a.empty(this.overlaysList),this.layerControlInputs=[];var ie,qe,jt,lr,ct=0;for(jt=0;jt<this.layers.length;jt++)lr=this.layers[jt],this.addItem(lr),qe=qe||lr.overlay,ie=ie||!lr.overlay,ct+=lr.overlay?0:1;return this.controlOption.hideSingleBase&&(ie=ie&&ct>1,this.baseLayersList.style.display=ie?"":"none"),this.separator.style.display=qe&&ie?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var ie=this.layerControlInputs,qe,jt,lr=this.mapsService.getZoom(),ct=ie.length-1;ct>=0;ct--)if(qe=ie[ct],jt=this.layerService.getLayer(qe.layerId),jt&&jt.inited){var ht=jt.getMinZoom(),Pt=jt.getMaxZoom();qe.disabled=lr<ht||lr>Pt}}},{key:"addLayer",value:function(ie,qe,jt){this.mapsService&&(ie.on("add",this.onLayerChange),ie.on("remove",this.onLayerChange)),this.layers.push({layer:ie,name:qe,overlay:jt});var lr=this.controlOption,ct=lr.sortLayers,ht=lr.sortFunction,Pt=lr.autoZIndex;ct&&this.layers.sort(function(vt,Pe){return ht(vt.layer,Pe.layer,vt.name,Pe.name)}),Pt&&ie.setZIndex&&(this.lastZIndex++,ie.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(ie){this.handlingClick||this.update();var qe=this.layerService.getLayer(ie.target.layerId),jt=(qe==null?void 0:qe.overlay)?ie.type==="add"?"overlayadd":"overlayremove":ie.type==="add"?"baselayerchange":null;jt&&this.emit(jt,qe)}},{key:"createRadioElement",value:function(ie,qe){var jt='<input type="radio" class="l7-control-layers-selector" name="'+ie+'"'+(qe?' checked="checked"':"")+"/>",lr=document.createElement("div");return lr.innerHTML=jt,lr.firstChild}},{key:"addItem",value:function(ie){var qe=document.createElement("label"),jt=this.layerService.getLayer(ie.layer.id),lr=jt&&jt.inited&&ie.layer.isVisible(),ct;ie.overlay?(ct=document.createElement("input"),ct.type="checkbox",ct.className="l7-control-layers-selector",ct.defaultChecked=lr):ct=this.createRadioElement("l7-base-layers",lr),this.layerControlInputs.push(ct),ct.layerId=ie.layer.id,ct.addEventListener("click",this.onInputClick);var ht=document.createElement("span");ht.innerHTML=" "+ie.name;var Pt=document.createElement("div");qe.appendChild(Pt),Pt.appendChild(ct),Pt.appendChild(ht);var vt=ie.overlay?this.overlaysList:this.baseLayersList;return vt.appendChild(qe),this.checkDisabledLayers(),qe}},{key:"onInputClick",value:function(){var ie=this.layerControlInputs,qe,jt,lr=[],ct=[];this.handlingClick=!0;for(var ht=ie.length-1;ht>=0;ht--)qe=ie[ht],jt=this.layerService.getLayer(qe.layerId),qe.checked?lr.push(jt):qe.checked||ct.push(jt);ct.forEach(function(Pt){Pt.hide()}),lr.forEach(function(Pt){Pt.show()}),this.handlingClick=!1}}]),$}(or);function ze(it){var Nt=st();return function(){var $e=Ke()(it),ie;if(Nt){var qe=Ke()(this).constructor;ie=Reflect.construct($e,arguments,qe)}else ie=$e.apply(this,arguments);return we()(this,ie)}}function st(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var Wt=function(it){Q()($,it);var Nt=ze($);function $(){return F()(this,$),Nt.apply(this,arguments)}return Y()($,[{key:"getDefault",value:function(){return{position:Et.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var ie="l7-control-logo",qe=_e.a.create("div",ie),jt=_e.a.create("a","l7-ctrl-logo");return jt.target="_blank",jt.rel="noopener nofollow",jt.href="https://antv.alipay.com/l7",jt.setAttribute("aria-label","AntV logo"),jt.setAttribute("rel","noopener nofollow"),qe.appendChild(jt),qe}},{key:"onRemove",value:function(){return null}}]),$}(or);function bt(it){var Nt=dt();return function(){var $e=Ke()(it),ie;if(Nt){var qe=Ke()(this).constructor;ie=Reflect.construct($e,arguments,qe)}else ie=$e.apply(this,arguments);return we()(this,ie)}}function dt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var H=function(it){Q()($,it);var Nt=bt($);function $($e){var ie;return F()(this,$),ie=Nt.call(this,$e),ie.mScale=void 0,ie.iScale=void 0,Object(_e.i)(["update"],Ht()(ie)),ie}return Y()($,[{key:"getDefault",value:function(){return{position:Et.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var ie="l7-control-scale",qe=_e.a.create("div",ie);this.addScales(ie+"-line",qe);var jt=this.controlOption.updateWhenIdle;return this.mapsService.on(jt?"moveend":"mapmove",this.update),this.mapsService.on(jt?"zoomend":"zoomchange",this.update),this.update(),qe}},{key:"onRemove",value:function(){var ie=this.controlOption.updateWhenIdle;this.mapsService.off(ie?"zoomend":"zoomchange",this.update),this.mapsService.off(ie?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var ie=this.mapsService,qe=this.controlOption.maxWidth,jt=ie.getSize()[1]/2,lr=ie.containerToLngLat([0,jt]),ct=ie.containerToLngLat([qe,jt]),ht=Object(_e.q)([lr.lng,lr.lat],[ct.lng,ct.lat]);this.updateScales(ht)}},{key:"updateScales",value:function(ie){var qe=this.controlOption,jt=qe.metric,lr=qe.imperial;jt&&ie&&this.updateMetric(ie),lr&&ie&&this.updateImperial(ie)}},{key:"updateMetric",value:function(ie){var qe=this.getRoundNum(ie),jt=qe<1e3?qe+" m":qe/1e3+" km";this.updateScale(this.mScale,jt,qe/ie)}},{key:"updateImperial",value:function(ie){var qe=ie*3.2808399,jt,lr,ct;qe>5280?(jt=qe/5280,lr=this.getRoundNum(jt),this.updateScale(this.iScale,lr+" mi",lr/jt)):(ct=this.getRoundNum(qe),this.updateScale(this.iScale,ct+" ft",ct/qe))}},{key:"updateScale",value:function(ie,qe,jt){var lr=this.controlOption.maxWidth;ie.style.width=Math.round(lr*jt)+"px",ie.innerHTML=qe}},{key:"getRoundNum",value:function(ie){var qe=Math.pow(10,(Math.floor(ie)+"").length-1),jt=ie/qe;return jt=jt>=10?10:jt>=5?5:jt>=3?3:jt>=2?2:1,qe*jt}},{key:"addScales",value:function(ie,qe){var jt=this.controlOption,lr=jt.metric,ct=jt.imperial;lr&&(this.mScale=_e.a.create("div",ie,qe)),ct&&(this.iScale=_e.a.create("div",ie,qe))}}]),$}(or);function z(it){var Nt=V();return function(){var $e=Ke()(it),ie;if(Nt){var qe=Ke()(this).constructor;ie=Reflect.construct($e,arguments,qe)}else ie=$e.apply(this,arguments);return we()(this,ie)}}function V(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var Se=function(it){Q()($,it);var Nt=z($);function $($e){var ie;return F()(this,$),ie=Nt.call(this,$e),ie.disabled=void 0,ie.zoomInButton=void 0,ie.zoomOutButton=void 0,Object(_e.i)(["updateDisabled","zoomIn","zoomOut"],Ht()(ie)),ie}return Y()($,[{key:"getDefault",value:function(){return{position:Et.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var ie="l7-control-zoom",qe=_e.a.create("div",ie+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,ie+"-in",qe,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,ie+"-out",qe,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),qe}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(ie,qe,jt,lr,ct){var ht=_e.a.create("a",jt,lr);return ht.innerHTML=ie,ht.title=qe,ht.href="javascript:void(0)",ht.addEventListener("click",ct),ht}},{key:"updateDisabled",value:function(){var ie=this.mapsService,qe="l7-disabled";_e.a.removeClass(this.zoomInButton,qe),_e.a.removeClass(this.zoomOutButton,qe),(this.disabled||ie.getZoom()<=ie.getMinZoom())&&_e.a.addClass(this.zoomOutButton,qe),(this.disabled||ie.getZoom()>=ie.getMaxZoom())&&_e.a.addClass(this.zoomInButton,qe)}}]),$}(or);function ve(it,Nt){var $=Object.keys(it);if(Object.getOwnPropertySymbols){var $e=Object.getOwnPropertySymbols(it);Nt&&($e=$e.filter(function(ie){return Object.getOwnPropertyDescriptor(it,ie).enumerable})),$.push.apply($,$e)}return $}function ce(it){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?ve(Object($),!0).forEach(function($e){v()(it,$e,$[$e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(it,Object.getOwnPropertyDescriptors($)):ve(Object($)).forEach(function($e){Object.defineProperty(it,$e,Object.getOwnPropertyDescriptor($,$e))})}return it}function fe(it){var Nt=ke();return function(){var $e=Ke()(it),ie;if(Nt){var qe=Ke()(this).constructor;ie=Reflect.construct($e,arguments,qe)}else ie=$e.apply(this,arguments);return we()(this,ie)}}function ke(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var lt=function(it){Q()($,it);var Nt=fe($);function $($e){var ie;return F()(this,$),ie=Nt.call(this),ie.markerOption=void 0,ie.defaultMarker=void 0,ie.popup=void 0,ie.mapsService=void 0,ie.sceneSerive=void 0,ie.lngLat=void 0,ie.scene=void 0,ie.added=!1,ie.eventHandle=function(qe){ie.emit(qe.type,{target:qe,data:ie.markerOption.extData,lngLat:ie.lngLat})},ie.markerOption=ce(ce({},ie.getDefault()),$e),Object(_e.i)(["update","onMove","onUp","addDragHandler","onMapClick"],Ht()(ie)),ie.init(),ie}return Y()($,[{key:"getDefault",value:function(){return{element:void 0,anchor:_e.f.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(ie){this.scene=ie,this.mapsService=ie.get(Ge.TYPES.IMapService),this.sceneSerive=ie.get(Ge.TYPES.ISceneService);var qe=this.markerOption,jt=qe.element,lr=qe.draggable;return this.mapsService.getMarkerContainer().appendChild(jt),this.registerMarkerEvent(jt),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var ie=this.markerOption.element;return ie&&_e.a.remove(ie),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(ie){return this.lngLat=ie,Array.isArray(ie)&&(this.lngLat={lng:ie[0],lat:ie[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(ie){var qe=this;if(!this.added)return this.once("added",function(){qe.setElement(ie)}),this;var jt=this.markerOption.element;return jt&&_e.a.remove(jt),this.markerOption.element=ie,this.init(),this.mapsService.getMarkerContainer().appendChild(ie),this.registerMarkerEvent(ie),this.update(),this}},{key:"openPopup",value:function(){var ie=this;if(!this.added)return this.once("added",function(){ie.openPopup()}),this;var qe=this.popup;return qe?(qe.isOpen()||qe.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var ie=this;this.added||this.once("added",function(){ie.closePopup()});var qe=this.popup;return qe&&qe.remove(),this}},{key:"setPopup",value:function(ie){return this.popup=ie,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var ie=this.popup;if(ie)ie.isOpen()?ie.remove():ie.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(ie){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(ie){this.markerOption.extData=ie}},{key:"update",value:function(){if(!!this.mapsService){var ie=this.markerOption,qe=ie.element,jt=ie.anchor;this.updatePosition(),_e.a.setTransform(qe,"".concat(_e.e[jt]))}}},{key:"onMapClick",value:function(ie){var qe=this.markerOption.element;this.popup&&qe&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!!this.mapsService){var ie=this.markerOption,qe=ie.element,jt=ie.offsets,lr=this.lngLat,ct=lr.lng,ht=lr.lat,Pt=this.mapsService.getBounds(),vt=this.mapsService.getZoom();if((ct<Pt[0][0]||ct>Pt[1][0]||ht<Pt[0][1]||ht>Pt[1][1])&&vt>3){qe&&(qe.style.display="none");return}var Pe=this.mapsService.lngLatToContainer([ct,ht]);qe&&(qe.style.display="block",qe.style.left=Pe.x+jt[0]+"px",qe.style.top=Pe.y-jt[1]+"px")}}},{key:"init",value:function(){var ie=this,qe=this.markerOption.element,jt=this.markerOption,lr=jt.color,ct=jt.anchor;if(!qe){this.defaultMarker=!0,qe=_e.a.create("div"),this.markerOption.element=qe;var ht=document.createElementNS("http://www.w3.org/2000/svg","svg");ht.setAttributeNS(null,"display","block"),ht.setAttributeNS(null,"height","48px"),ht.setAttributeNS(null,"width","48px"),ht.setAttributeNS(null,"viewBox","0 0 1024 1024");var Pt=document.createElementNS("http://www.w3.org/2000/svg","path");Pt.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),Pt.setAttributeNS(null,"fill",lr),ht.appendChild(Pt),qe.appendChild(ht)}_e.a.addClass(qe,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(vt){var Pe,ut,Qe=((Pe=ie.markerOption)===null||Pe===void 0?void 0:Pe.style)&&((ut=ie.markerOption)===null||ut===void 0?void 0:ut.style[vt]);qe&&(qe.style[vt]=Qe)}),qe.addEventListener("click",function(vt){ie.onMapClick(vt)}),qe.addEventListener("click",this.eventHandle),Object(_e.g)(qe,ct,"marker")}},{key:"registerMarkerEvent",value:function(ie){ie.addEventListener("mousemove",this.eventHandle),ie.addEventListener("click",this.eventHandle),ie.addEventListener("mousedown",this.eventHandle),ie.addEventListener("mouseup",this.eventHandle),ie.addEventListener("dblclick",this.eventHandle),ie.addEventListener("contextmenu",this.eventHandle),ie.addEventListener("mouseover",this.eventHandle),ie.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var ie=this.getElement();ie.removeEventListener("mousemove",this.eventHandle),ie.removeEventListener("click",this.eventHandle),ie.removeEventListener("mousedown",this.eventHandle),ie.removeEventListener("mouseup",this.eventHandle),ie.removeEventListener("dblclick",this.eventHandle),ie.removeEventListener("contextmenu",this.eventHandle),ie.removeEventListener("mouseover",this.eventHandle),ie.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(ie){throw new Error("Method not implemented.")}},{key:"onUp",value:function(ie){throw new Error("Method not implemented.")}}]),$}(Re.EventEmitter),nt=o("QkVN"),le=o.n(nt),ye=o("mpbz"),He=o.n(ye);function ft(it,Nt){var $=Object.keys(it);if(Object.getOwnPropertySymbols){var $e=Object.getOwnPropertySymbols(it);Nt&&($e=$e.filter(function(ie){return Object.getOwnPropertyDescriptor(it,ie).enumerable})),$.push.apply($,$e)}return $}function De(it){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?ft(Object($),!0).forEach(function($e){v()(it,$e,$[$e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(it,Object.getOwnPropertyDescriptors($)):ft(Object($)).forEach(function($e){Object.defineProperty(it,$e,Object.getOwnPropertyDescriptor($,$e))})}return it}function Ze(it){var Nt=w();return function(){var $e=Ke()(it),ie;if(Nt){var qe=Ke()(this).constructor;ie=Reflect.construct($e,arguments,qe)}else ie=$e.apply(this,arguments);return we()(this,ie)}}function w(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var R=function(it){Q()($,it);var Nt=Ze($);function $($e){var ie,qe;return F()(this,$),qe=Nt.call(this),qe.markers=[],qe.markerLayerOption=void 0,qe.clusterIndex=void 0,qe.points=[],qe.clusterMarkers=[],qe.mapsService=void 0,qe.scene=void 0,qe.zoom=void 0,qe.bbox=void 0,qe.markerLayerOption=le()(qe.getDefault(),$e),Object(_e.i)(["update"],Ht()(qe)),qe.zoom=((ie=qe.markerLayerOption.clusterOption)===null||ie===void 0?void 0:ie.zoom)||-99,qe}return Y()($,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(ie){return this.scene=ie,this.mapsService=ie.get(Ge.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(ie){var qe=this.markerLayerOption.cluster;qe&&this.addPoint(ie,this.markers.length),this.markers.push(ie)}},{key:"removeMarker",value:function(ie){this.markers.indexOf(ie);var qe=this.markers.indexOf(ie);qe>-1&&this.markers.splice(qe,1)}},{key:"getMarkers",value:function(){var ie=this.markerLayerOption.cluster;return ie?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var ie=this;this.getMarkers().forEach(function(qe){qe.addTo(ie.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(ie){ie.remove()}),this.clusterMarkers.forEach(function(ie){ie.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(ie,qe){var jt=ie.getLnglat(),lr=jt.lng,ct=jt.lat,ht={geometry:{type:"Point",coordinates:[lr,ct]},properties:De(De({},ie.getExtData()),{},{marker_id:qe})};this.points.push(ht)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var ie=this.markerLayerOption.clusterOption,qe=ie.radius,jt=ie.minZoom,lr=jt===void 0?0:jt,ct=ie.maxZoom;this.clusterIndex=new He.a({radius:qe,minZoom:lr,maxZoom:ct}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(ie,qe){var jt=this,lr=ie[0].concat(ie[1]),ct=this.clusterIndex.getClusters(lr,qe);this.clusterMarkers.forEach(function(ht){ht.remove()}),this.clusterMarkers=[],ct.forEach(function(ht){var Pt,vt=jt.markerLayerOption.clusterOption,Pe=vt.field,ut=vt.method;if(ht.properties&&((Pt=ht.properties)===null||Pt===void 0?void 0:Pt.cluster_id)){var Qe,Vt=jt.getLeaves((Qe=ht.properties)===null||Qe===void 0?void 0:Qe.cluster_id);if(ht.properties.clusterData=Vt,Pe&&ut){var pr=Vt==null?void 0:Vt.map(function(ni){var fi=v()({},Pe,ni.properties[Pe]);return fi}),Zr=_e.c.getColumn(pr,Pe),cr=_e.c.getSatByColumn(ut,Zr),jn="point_"+ut;ht.properties[jn]=cr.toFixed(2)}}var En=jt.clusterMarker(ht);jt.clusterMarkers.push(En),En.addTo(jt.scene)})}},{key:"getLeaves",value:function(ie){var qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,jt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ie?this.clusterIndex.getLeaves(ie,qe,jt):null}},{key:"clusterMarker",value:function(ie){var qe=this.markerLayerOption.clusterOption,jt=qe,lr=jt.element,ct=lr===void 0?this.generateElement.bind(this):lr,ht=new lt({element:ct(ie)}).setLnglat({lng:ie.geometry.coordinates[0],lat:ie.geometry.coordinates[1]});return ht}},{key:"normalMarker",value:function(ie){var qe=ie.properties.marker_id;return this.markers[qe]}},{key:"update",value:function(){var ie=this.mapsService.getZoom(),qe=this.mapsService.getBounds();(!this.bbox||Math.abs(ie-this.zoom)>=1||!Object(_e.j)(this.bbox,qe))&&(this.bbox=Object(_e.r)(qe,.5),this.zoom=Math.floor(ie),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(ie){var qe=_e.a.create("div","l7-marker-cluster"),jt=_e.a.create("div","",qe),lr=_e.a.create("span","",jt),ct=this.markerLayerOption.clusterOption,ht=ct.field,Pt=ct.method;ie.properties.point_count=ie.properties.point_count||1;var vt=ht&&Pt?ie.properties["point_"+Pt]||ie.properties[ht]:ie.properties.point_count;return lr.textContent=vt,qe}}]),$}(Re.EventEmitter);function q(it,Nt){var $=Object.keys(it);if(Object.getOwnPropertySymbols){var $e=Object.getOwnPropertySymbols(it);Nt&&($e=$e.filter(function(ie){return Object.getOwnPropertyDescriptor(it,ie).enumerable})),$.push.apply($,$e)}return $}function he(it){for(var Nt=1;Nt<arguments.length;Nt++){var $=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?q(Object($),!0).forEach(function($e){v()(it,$e,$[$e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(it,Object.getOwnPropertyDescriptors($)):q(Object($)).forEach(function($e){Object.defineProperty(it,$e,Object.getOwnPropertyDescriptor($,$e))})}return it}function Ve(it){var Nt=Ye();return function(){var $e=Ke()(it),ie;if(Nt){var qe=Ke()(this).constructor;ie=Reflect.construct($e,arguments,qe)}else ie=$e.apply(this,arguments);return we()(this,ie)}}function Ye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(it){return!1}}var yt=function(it){Q()($,it);var Nt=Ve($);function $($e){var ie;return F()(this,$),ie=Nt.call(this),ie.popupOption=void 0,ie.mapsService=void 0,ie.sceneSerive=void 0,ie.lngLat=void 0,ie.content=void 0,ie.closeButton=void 0,ie.timeoutInstance=void 0,ie.container=void 0,ie.tip=void 0,ie.scene=void 0,ie.popupOption=he(he({},ie.getdefault()),$e),Object(_e.i)(["update","onClickClose","remove"],Ht()(ie)),ie}return Y()($,[{key:"addTo",value:function(ie){var qe=this;return this.mapsService=ie.get(Ge.TYPES.IMapService),this.sceneSerive=ie.get(Ge.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=ie,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){qe.mapsService.on("click",qe.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(ie){var qe=window.document.createDocumentFragment(),jt=window.document.createElement("body"),lr;for(jt.innerHTML=ie;lr=jt.firstChild,!!lr;)qe.appendChild(lr);return this.setDOMContent(qe)}},{key:"setLnglat",value:function(ie){return this.lngLat=ie,Array.isArray(ie)&&(this.lngLat={lng:ie[0],lat:ie[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(ie){return this.setDOMContent(window.document.createTextNode(ie))}},{key:"setMaxWidth",value:function(ie){return this.popupOption.maxWidth=ie,this.update(),this}},{key:"setDOMContent",value:function(ie){return this.createContent(),this.content.appendChild(ie),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&_e.a.remove(this.content),this.content=_e.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=_e.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(ie,qe,jt){var lr=window.document.createElement(ie);return qe!==void 0&&(lr.className=qe),jt&&jt.appendChild(lr),lr}},{key:"removeDom",value:function(ie){ie.parentNode&&ie.parentNode.removeChild(ie)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:_e.f.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(ie){ie.stopPropagation&&ie.stopPropagation(),this.remove()}},{key:"update",value:function(){var ie=this,qe=this.lngLat,jt=this.popupOption,lr=jt.className,ct=jt.maxWidth,ht=jt.anchor;if(!(!this.mapsService||!qe||!this.content)){var Pt=this.mapsService.getMarkerContainer();if(!this.container&&Pt){this.container=this.creatDom("div","l7-popup",Pt),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),lr&&lr.split(" ").forEach(function(Pe){return ie.container.classList.add(Pe)});var vt=this.popupOption.stopPropagation;vt&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Pe){ie.container.addEventListener(Pe,function(ut){ut.stopPropagation()})})}ct&&this.container.style.maxWidth!==ct&&(this.container.style.maxWidth=ct),this.updatePosition(),_e.a.setTransform(this.container,"".concat(_e.e[ht])),Object(_e.g)(this.container,ht,"popup")}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var ie=this.lngLat,qe=ie.lng,jt=ie.lat,lr=this.popupOption.offsets,ct=this.mapsService.lngLatToContainer([qe,jt]);this.container.style.left=ct.x+lr[0]+"px",this.container.style.top=ct.y-lr[1]+"px"}}}]),$}(Re.EventEmitter);o("BGjm")(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }


`)},kPKH:function(Ie,x,o){"use strict";var b=o("/kpp");x.a=b.a},"kQ+U":function(Ie,x,o){"use strict";o.d(x,"a",function(){return ht});var b=o("lSNA"),v=o.n(b),Z=o("lwsE"),F=o.n(Z),a=o("W8MJ"),Y=o.n(a),B=o("k5/I"),Q=o("h1nZ"),re=o("o0o1"),we=o.n(re),J=o("yXPU"),Ke=o.n(J),Ge=o("4cb6"),_e=o("fbvF"),Re=o.n(_e),at=function(){function Pt(vt,Pe){F()(this,Pt),this.attribute=void 0,this.buffer=void 0;var ut=Pe.buffer,Qe=Pe.offset,Vt=Pe.stride,pr=Pe.normalized,Zr=Pe.size,cr=Pe.divisor;this.buffer=ut,this.attribute={buffer:ut.get(),offset:Qe||0,stride:Vt||0,normalized:pr||!1,divisor:cr||0},Zr&&(this.attribute.size=Zr)}return Y()(Pt,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(Pe){this.buffer.subData(Pe)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),Pt}(),Oe,xt,Mt,Et,St,or,$t,Ht,mt,Xe,Tt,ze,st,Wt,bt=(Oe={},v()(Oe,Q.gl.POINTS,"points"),v()(Oe,Q.gl.LINES,"lines"),v()(Oe,Q.gl.LINE_LOOP,"line loop"),v()(Oe,Q.gl.LINE_STRIP,"line strip"),v()(Oe,Q.gl.TRIANGLES,"triangles"),v()(Oe,Q.gl.TRIANGLE_FAN,"triangle fan"),v()(Oe,Q.gl.TRIANGLE_STRIP,"triangle strip"),Oe),dt=(xt={},v()(xt,Q.gl.STATIC_DRAW,"static"),v()(xt,Q.gl.DYNAMIC_DRAW,"dynamic"),v()(xt,Q.gl.STREAM_DRAW,"stream"),xt),H=(Mt={},v()(Mt,Q.gl.BYTE,"int8"),v()(Mt,Q.gl.UNSIGNED_INT,"int16"),v()(Mt,Q.gl.INT,"int32"),v()(Mt,Q.gl.UNSIGNED_BYTE,"uint8"),v()(Mt,Q.gl.UNSIGNED_SHORT,"uint16"),v()(Mt,Q.gl.UNSIGNED_INT,"uint32"),v()(Mt,Q.gl.FLOAT,"float"),Mt),z=(Et={},v()(Et,Q.gl.ALPHA,"alpha"),v()(Et,Q.gl.LUMINANCE,"luminance"),v()(Et,Q.gl.LUMINANCE_ALPHA,"luminance alpha"),v()(Et,Q.gl.RGB,"rgb"),v()(Et,Q.gl.RGBA,"rgba"),v()(Et,Q.gl.RGBA4,"rgba4"),v()(Et,Q.gl.RGB5_A1,"rgb5 a1"),v()(Et,Q.gl.RGB565,"rgb565"),v()(Et,Q.gl.DEPTH_COMPONENT,"depth"),v()(Et,Q.gl.DEPTH_STENCIL,"depth stencil"),Et),V=(St={},v()(St,Q.gl.DONT_CARE,"dont care"),v()(St,Q.gl.NICEST,"nice"),v()(St,Q.gl.FASTEST,"fast"),St),Se=(or={},v()(or,Q.gl.NEAREST,"nearest"),v()(or,Q.gl.LINEAR,"linear"),v()(or,Q.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),v()(or,Q.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),v()(or,Q.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),v()(or,Q.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),or),ve=($t={},v()($t,Q.gl.REPEAT,"repeat"),v()($t,Q.gl.CLAMP_TO_EDGE,"clamp"),v()($t,Q.gl.MIRRORED_REPEAT,"mirror"),$t),ce=(Ht={},v()(Ht,Q.gl.NONE,"none"),v()(Ht,Q.gl.BROWSER_DEFAULT_WEBGL,"browser"),Ht),fe=(mt={},v()(mt,Q.gl.NEVER,"never"),v()(mt,Q.gl.ALWAYS,"always"),v()(mt,Q.gl.LESS,"less"),v()(mt,Q.gl.LEQUAL,"lequal"),v()(mt,Q.gl.GREATER,"greater"),v()(mt,Q.gl.GEQUAL,"gequal"),v()(mt,Q.gl.EQUAL,"equal"),v()(mt,Q.gl.NOTEQUAL,"notequal"),mt),ke=(Xe={},v()(Xe,Q.gl.FUNC_ADD,"add"),v()(Xe,Q.gl.MIN_EXT,"min"),v()(Xe,Q.gl.MAX_EXT,"max"),v()(Xe,Q.gl.FUNC_SUBTRACT,"subtract"),v()(Xe,Q.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Xe),lt=(Tt={},v()(Tt,Q.gl.ZERO,"zero"),v()(Tt,Q.gl.ONE,"one"),v()(Tt,Q.gl.SRC_COLOR,"src color"),v()(Tt,Q.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),v()(Tt,Q.gl.SRC_ALPHA,"src alpha"),v()(Tt,Q.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),v()(Tt,Q.gl.DST_COLOR,"dst color"),v()(Tt,Q.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),v()(Tt,Q.gl.DST_ALPHA,"dst alpha"),v()(Tt,Q.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),v()(Tt,Q.gl.CONSTANT_COLOR,"constant color"),v()(Tt,Q.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),v()(Tt,Q.gl.CONSTANT_ALPHA,"constant alpha"),v()(Tt,Q.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),v()(Tt,Q.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),Tt),nt=(ze={},v()(ze,Q.gl.NEVER,"never"),v()(ze,Q.gl.ALWAYS,"always"),v()(ze,Q.gl.LESS,"less"),v()(ze,Q.gl.LEQUAL,"lequal"),v()(ze,Q.gl.GREATER,"greater"),v()(ze,Q.gl.GEQUAL,"gequal"),v()(ze,Q.gl.EQUAL,"equal"),v()(ze,Q.gl.NOTEQUAL,"notequal"),ze),le=(st={},v()(st,Q.gl.ZERO,"zero"),v()(st,Q.gl.KEEP,"keep"),v()(st,Q.gl.REPLACE,"replace"),v()(st,Q.gl.INVERT,"invert"),v()(st,Q.gl.INCR,"increment"),v()(st,Q.gl.DECR,"decrement"),v()(st,Q.gl.INCR_WRAP,"increment wrap"),v()(st,Q.gl.DECR_WRAP,"decrement wrap"),st),ye=(Wt={},v()(Wt,Q.gl.FRONT,"front"),v()(Wt,Q.gl.BACK,"back"),Wt),He=function(){function Pt(vt,Pe){F()(this,Pt),this.buffer=void 0;var ut=Pe.data,Qe=Pe.usage,Vt=Pe.type;this.buffer=vt.buffer({data:ut,usage:dt[Qe||Q.gl.STATIC_DRAW],type:H[Vt||Q.gl.UNSIGNED_BYTE]})}return Y()(Pt,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(Pe){var ut=Pe.data,Qe=Pe.offset;this.buffer.subdata(ut,Qe)}}]),Pt}(),ft=function(){function Pt(vt,Pe){F()(this,Pt),this.elements=void 0;var ut=Pe.data,Qe=Pe.usage,Vt=Pe.type,pr=Pe.count;this.elements=vt.elements({data:ut,usage:dt[Qe||Q.gl.STATIC_DRAW],type:H[Vt||Q.gl.UNSIGNED_BYTE],count:pr})}return Y()(Pt,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(Pe){var ut=Pe.data;this.elements.subdata(ut)}},{key:"destroy",value:function(){}}]),Pt}(),De=function(){function Pt(vt,Pe){F()(this,Pt),this.framebuffer=void 0;var ut=Pe.width,Qe=Pe.height,Vt=Pe.color,pr=Pe.colors,Zr=Pe.depth,cr=Pe.stencil,jn={width:ut,height:Qe};Array.isArray(pr)&&(jn.colors=pr.map(function(En){return En.get()})),Vt&&typeof Vt!="boolean"&&(jn.color=Vt.get()),this.framebuffer=vt.framebuffer(jn)}return Y()(Pt,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(Pe){var ut=Pe.width,Qe=Pe.height;this.framebuffer.resize(ut,Qe)}}]),Pt}(),Ze=o("cDf5"),w=o.n(Ze),R=o("c6wG"),q=o.n(R),he=o("YO3V"),Ve=o.n(he);function Ye(Pt,vt){var Pe=Object.keys(Pt);if(Object.getOwnPropertySymbols){var ut=Object.getOwnPropertySymbols(Pt);vt&&(ut=ut.filter(function(Qe){return Object.getOwnPropertyDescriptor(Pt,Qe).enumerable})),Pe.push.apply(Pe,ut)}return Pe}function yt(Pt){for(var vt=1;vt<arguments.length;vt++){var Pe=arguments[vt]!=null?arguments[vt]:{};vt%2?Ye(Object(Pe),!0).forEach(function(ut){v()(Pt,ut,Pe[ut])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Pt,Object.getOwnPropertyDescriptors(Pe)):Ye(Object(Pe)).forEach(function(ut){Object.defineProperty(Pt,ut,Object.getOwnPropertyDescriptor(Pe,ut))})}return Pt}var it=function(){function Pt(vt,Pe){F()(this,Pt),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=vt;var ut=Pe.vs,Qe=Pe.fs,Vt=Pe.attributes,pr=Pe.uniforms,Zr=Pe.primitive,cr=Pe.count,jn=Pe.elements,En=Pe.depth,ni=Pe.blend,fi=Pe.stencil,Zn=Pe.cull,Vn=Pe.instances,Te={};this.options=Pe,pr&&(this.uniforms=this.extractUniforms(pr),Object.keys(pr).forEach(function(se){Te[se]=vt.prop(se)}));var de={};Object.keys(Vt).forEach(function(se){de[se]=Vt[se].get()});var W={attributes:de,frag:Qe,uniforms:Te,vert:ut,primitive:bt[Zr===void 0?Q.gl.TRIANGLES:Zr]};Vn&&(W.instances=Vn),cr&&(W.count=cr),jn&&(W.elements=jn.get()),this.initDepthDrawParams({depth:En},W),this.initBlendDrawParams({blend:ni},W),this.initStencilDrawParams({stencil:fi},W),this.initCullDrawParams({cull:Zn},W),this.drawCommand=vt(W),this.drawParams=W}return Y()(Pt,[{key:"addUniforms",value:function(Pe){this.uniforms=yt(yt({},this.uniforms),this.extractUniforms(Pe))}},{key:"draw",value:function(Pe){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var ut=yt(yt({},this.uniforms),this.extractUniforms(Pe.uniforms||{})),Qe={};Object.keys(ut).forEach(function(Vt){var pr=w()(ut[Vt]);pr==="boolean"||pr==="number"||Array.isArray(ut[Vt])||ut[Vt].BYTES_PER_ELEMENT?Qe[Vt]=ut[Vt]:Qe[Vt]=ut[Vt].get()}),this.drawCommand(Qe)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(Pe){Pe.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(Pe,ut){var Qe=Pe.depth;Qe&&(ut.depth={enable:Qe.enable===void 0?!0:!!Qe.enable,mask:Qe.mask===void 0?!0:!!Qe.mask,func:fe[Qe.func||Q.gl.LESS],range:Qe.range||[0,1]})}},{key:"initBlendDrawParams",value:function(Pe,ut){var Qe=Pe.blend;if(Qe){var Vt=Qe.enable,pr=Qe.func,Zr=Qe.equation,cr=Qe.color,jn=cr===void 0?[0,0,0,0]:cr;ut.blend={enable:!!Vt,func:{srcRGB:lt[pr&&pr.srcRGB||Q.gl.SRC_ALPHA],srcAlpha:lt[pr&&pr.srcAlpha||Q.gl.SRC_ALPHA],dstRGB:lt[pr&&pr.dstRGB||Q.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:lt[pr&&pr.dstAlpha||Q.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:ke[Zr&&Zr.rgb||Q.gl.FUNC_ADD],alpha:ke[Zr&&Zr.alpha||Q.gl.FUNC_ADD]},color:jn}}}},{key:"initStencilDrawParams",value:function(Pe,ut){var Qe=Pe.stencil;if(Qe){var Vt=Qe.enable,pr=Qe.mask,Zr=pr===void 0?-1:pr,cr=Qe.func,jn=cr===void 0?{cmp:Q.gl.ALWAYS,ref:0,mask:-1}:cr,En=Qe.opFront,ni=En===void 0?{fail:Q.gl.KEEP,zfail:Q.gl.KEEP,zpass:Q.gl.KEEP}:En,fi=Qe.opBack,Zn=fi===void 0?{fail:Q.gl.KEEP,zfail:Q.gl.KEEP,zpass:Q.gl.KEEP}:fi;ut.stencil={enable:!!Vt,mask:Zr,func:yt(yt({},jn),{},{cmp:nt[jn.cmp]}),opFront:{fail:le[ni.fail],zfail:le[ni.zfail],zpass:le[ni.zpass]},opBack:{fail:le[Zn.fail],zfail:le[Zn.zfail],zpass:le[Zn.zpass]}}}}},{key:"initCullDrawParams",value:function(Pe,ut){var Qe=Pe.cull;if(Qe){var Vt=Qe.enable,pr=Qe.face,Zr=pr===void 0?Q.gl.BACK:pr;ut.cull={enable:!!Vt,face:ye[Zr]}}}},{key:"extractUniforms",value:function(Pe){var ut=this,Qe={};return Object.keys(Pe).forEach(function(Vt){ut.extractUniformsRecursively(Vt,Pe[Vt],Qe,"")}),Qe}},{key:"extractUniformsRecursively",value:function(Pe,ut,Qe,Vt){var pr=this;if(ut===null||typeof ut=="number"||typeof ut=="boolean"||Array.isArray(ut)&&typeof ut[0]=="number"||q()(ut)||ut===""||"resize"in ut){Qe["".concat(Vt&&Vt+".").concat(Pe)]=ut;return}Ve()(ut)&&Object.keys(ut).forEach(function(Zr){pr.extractUniformsRecursively(Zr,ut[Zr],Qe,"".concat(Vt&&Vt+".").concat(Pe))}),Array.isArray(ut)&&ut.forEach(function(Zr,cr){Object.keys(Zr).forEach(function(jn){pr.extractUniformsRecursively(jn,Zr[jn],Qe,"".concat(Vt&&Vt+".").concat(Pe,"[").concat(cr,"]"))})})}}]),Pt}(),Nt=function(){function Pt(vt,Pe){F()(this,Pt),this.texture=void 0,this.width=void 0,this.height=void 0;var ut=Pe.data,Qe=Pe.type,Vt=Qe===void 0?Q.gl.UNSIGNED_BYTE:Qe,pr=Pe.width,Zr=Pe.height,cr=Pe.flipY,jn=cr===void 0?!1:cr,En=Pe.format,ni=En===void 0?Q.gl.RGBA:En,fi=Pe.mipmap,Zn=fi===void 0?!1:fi,Vn=Pe.wrapS,Te=Vn===void 0?Q.gl.CLAMP_TO_EDGE:Vn,de=Pe.wrapT,W=de===void 0?Q.gl.CLAMP_TO_EDGE:de,se=Pe.aniso,Le=se===void 0?0:se,et=Pe.alignment,wt=et===void 0?1:et,Ne=Pe.premultiplyAlpha,gt=Ne===void 0?!1:Ne,qt=Pe.mag,zr=qt===void 0?Q.gl.NEAREST:qt,Br=Pe.min,sr=Br===void 0?Q.gl.NEAREST:Br,kr=Pe.colorSpace,Cn=kr===void 0?Q.gl.BROWSER_DEFAULT_WEBGL:kr;this.width=pr,this.height=Zr;var dn={width:pr,height:Zr,type:H[Vt],format:z[ni],wrapS:ve[Te],wrapT:ve[W],mag:Se[zr],min:Se[sr],alignment:wt,flipY:jn,colorSpace:ce[Cn],premultiplyAlpha:gt,aniso:Le};ut&&(dn.data=ut),typeof Zn=="number"?dn.mipmap=V[Zn]:typeof Zn=="boolean"&&(dn.mipmap=Zn),this.texture=vt.texture(dn)}return Y()(Pt,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(Pe)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(Pe){var ut=Pe.width,Qe=Pe.height;this.texture.resize(ut,Qe),this.width=ut,this.height=Qe}},{key:"destroy",value:function(){this.texture.destroy()}}]),Pt}(),$,$e,ie,qe=($=Object(Ge.injectable)(),$($e=(ie=function(){function Pt(){var vt=this;F()(this,Pt),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(Pe){return new it(vt.gl,Pe)},this.createAttribute=function(Pe){return new at(vt.gl,Pe)},this.createBuffer=function(Pe){return new He(vt.gl,Pe)},this.createElements=function(Pe){return new ft(vt.gl,Pe)},this.createTexture2D=function(Pe){return new Nt(vt.gl,Pe)},this.createFramebuffer=function(Pe){return new De(vt.gl,Pe)},this.useFramebuffer=function(Pe,ut){vt.gl({framebuffer:Pe?Pe.get():null})(ut)},this.clear=function(Pe){var ut=Pe.color,Qe=Pe.depth,Vt=Pe.stencil,pr=Pe.framebuffer,Zr=pr===void 0?null:pr,cr={color:ut,depth:Qe,stencil:Vt};cr.framebuffer=Zr===null?Zr:Zr.get(),vt.gl.clear(cr)},this.viewport=function(Pe){var ut=Pe.x,Qe=Pe.y,Vt=Pe.width,pr=Pe.height;vt.gl._gl.viewport(ut,Qe,Vt,pr),vt.width=Vt,vt.height=pr,vt.gl._refresh()},this.readPixels=function(Pe){var ut=Pe.framebuffer,Qe=Pe.x,Vt=Pe.y,pr=Pe.width,Zr=Pe.height,cr={x:Qe,y:Vt,width:pr,height:Zr};return ut&&(cr.framebuffer=ut.get()),vt.gl.read(cr)},this.getViewportSize=function(){return{width:vt.gl._gl.drawingBufferWidth,height:vt.gl._gl.drawingBufferHeight}},this.getContainer=function(){var Pe;return(Pe=vt.canvas)===null||Pe===void 0?void 0:Pe.parentElement},this.getCanvas=function(){return vt.canvas},this.getGLContext=function(){return vt.gl._gl},this.destroy=function(){vt.gl.destroy()}}return Y()(Pt,[{key:"init",value:function(){var vt=Ke()(we.a.mark(function ut(Qe,Vt){var pr=this;return we.a.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:return this.canvas=Qe,cr.next=3,new Promise(function(jn,En){Re()({canvas:pr.canvas,attributes:{alpha:!0,antialias:Vt.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:Vt.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(fi,Zn){(fi||!Zn)&&En(fi),jn(Zn)}})});case 3:this.gl=cr.sent;case 4:case"end":return cr.stop()}},ut,this)}));function Pe(ut,Qe){return vt.apply(this,arguments)}return Pe}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var Pe=this.getGLContext();Pe.disable(Pe.CULL_FACE)}},{key:"setDirty",value:function(Pe){this.isDirty=Pe}},{key:"getDirty",value:function(){return this.isDirty}}]),Pt}(),ie))||$e),jt=o("Hel2");function lr(Pt,vt){var Pe=Object.keys(Pt);if(Object.getOwnPropertySymbols){var ut=Object.getOwnPropertySymbols(Pt);vt&&(ut=ut.filter(function(Qe){return Object.getOwnPropertyDescriptor(Pt,Qe).enumerable})),Pe.push.apply(Pe,ut)}return Pe}function ct(Pt){for(var vt=1;vt<arguments.length;vt++){var Pe=arguments[vt]!=null?arguments[vt]:{};vt%2?lr(Object(Pe),!0).forEach(function(ut){v()(Pt,ut,Pe[ut])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Pt,Object.getOwnPropertyDescriptors(Pe)):lr(Object(Pe)).forEach(function(ut){Object.defineProperty(Pt,ut,Object.getOwnPropertyDescriptor(Pe,ut))})}return Pt}var ht=function(){function Pt(vt){F()(this,Pt),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var Pe=vt.id,ut=vt.map,Qe=Object(Q.createSceneContainer)();this.container=Qe,ut.setContainer(Qe,Pe),Qe.bind(Q.TYPES.IRendererService).to(qe).inSingletonScope(),this.sceneService=Qe.get(Q.TYPES.ISceneService),this.mapService=Qe.get(Q.TYPES.IMapService),this.iconService=Qe.get(Q.TYPES.IIconService),this.fontService=Qe.get(Q.TYPES.IFontService),this.controlService=Qe.get(Q.TYPES.IControlService),this.layerService=Qe.get(Q.TYPES.ILayerService),this.markerService=Qe.get(Q.TYPES.IMarkerService),this.interactionService=Qe.get(Q.TYPES.IInteractionService),this.popupService=Qe.get(Q.TYPES.IPopupService),this.initComponent(Pe),this.sceneService.init(vt),this.initControl()}return Y()(Pt,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(Pe){return this.sceneService.exportPng(Pe)}},{key:"exportMap",value:function(Pe){return this.sceneService.exportPng(Pe)}},{key:"registerRenderService",value:function(Pe){var ut=this;if(this.sceneService.loaded){var Qe=new Pe(this);Qe.init()}else this.on("loaded",function(){var Vt=new Pe(ut);Vt.init()})}},{key:"addLayer",value:function(Pe){var ut=Object(Q.createLayerContainer)(this.container);Pe.setContainer(ut),this.sceneService.addLayer(Pe)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(Pe){return this.layerService.getLayer(Pe)}},{key:"getLayerByName",value:function(Pe){return this.layerService.getLayerByName(Pe)}},{key:"removeLayer",value:function(Pe){this.layerService.remove(Pe)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(Pe,ut){this.iconService.addImage(Pe,ut)}},{key:"hasImage",value:function(Pe){return this.iconService.hasImage(Pe)}},{key:"removeImage",value:function(Pe){this.iconService.removeImage(Pe)}},{key:"addIconFontGlyphs",value:function(Pe,ut){this.fontService.addIconGlyphs(ut)}},{key:"addControl",value:function(Pe){this.controlService.addControl(Pe,this.container)}},{key:"removeControl",value:function(Pe){this.controlService.removeControl(Pe)}},{key:"getControlByName",value:function(Pe){return this.controlService.getControlByName(Pe)}},{key:"addMarker",value:function(Pe){this.markerService.addMarker(Pe)}},{key:"addMarkerLayer",value:function(Pe){this.markerService.addMarkerLayer(Pe)}},{key:"removeMarkerLayer",value:function(Pe){this.markerService.removeMarkerLayer(Pe)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(Pe){this.popupService.addPopup(Pe)}},{key:"on",value:function(Pe,ut){Q.SceneEventList.indexOf(Pe)===-1?this.mapService.on(Pe,ut):this.sceneService.on(Pe,ut)}},{key:"off",value:function(Pe,ut){Q.SceneEventList.indexOf(Pe)===-1?this.mapService.off(Pe,ut):this.sceneService.off(Pe,ut)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(Pe){return this.mapService.setCenter(Pe)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(Pe){return this.mapService.setPitch(Pe)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(Pe){this.mapService.setRotation(Pe)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(Pe){this.mapService.panTo(Pe)}},{key:"panBy",value:function(Pe){this.mapService.panBy(Pe)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(Pe){this.mapService.setZoom(Pe)}},{key:"fitBounds",value:function(Pe,ut){var Qe=this.sceneService.getSceneConfig(),Vt=Qe.fitBoundsOptions,pr=Qe.animate;this.mapService.fitBounds(Pe,ut||ct(ct({},Vt),{},{animate:pr}))}},{key:"setZoomAndCenter",value:function(Pe,ut){this.mapService.setZoomAndCenter(Pe,ut)}},{key:"setMapStyle",value:function(Pe){this.mapService.setMapStyle(Pe)}},{key:"setMapStatus",value:function(Pe){this.mapService.setMapStatus(Pe)}},{key:"pixelToLngLat",value:function(Pe){return this.mapService.pixelToLngLat(Pe)}},{key:"lngLatToPixel",value:function(Pe){return this.mapService.lngLatToPixel(Pe)}},{key:"containerToLngLat",value:function(Pe){return this.mapService.containerToLngLat(Pe)}},{key:"lngLatToContainer",value:function(Pe){return this.mapService.lngLatToContainer(Pe)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(Pe,ut){this.container.bind(Q.TYPES.IPostProcessingPass).to(Pe).whenTargetNamed(ut)}},{key:"initComponent",value:function(Pe){this.controlService.init({container:jt.a.getContainer(Pe)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var Pe=this.sceneService.getSceneConfig(),ut=Pe.logoVisible,Qe=Pe.logoPosition;ut&&this.addControl(new B.b({position:Qe}))}},{key:"map",get:function(){return this.mapService.map}}]),Pt}()},l94r:function(Ie,x,o){"use strict";o.d(x,"a",function(){return ve});var b=o("lSNA"),v=o.n(b),Z=o("lwsE"),F=o.n(Z),a=o("W8MJ"),Y=o.n(a),B=o("7W2i"),Q=o.n(B),re=o("a1gu"),we=o.n(re),J=o("Nsbk"),Ke=o.n(J),Ge=o("JBE3"),_e=o.n(Ge),Re=o("4qC0"),at=o.n(Re),Oe=o("lSCD"),xt=o.n(Oe),Mt=o("BkRI"),Et=o.n(Mt),St=o("xp6e"),or=o("Hel2"),$t=o("uhBA"),Ht=o("rlAn"),mt=o("qxNg");function Xe(ce){if(ce.length===0)throw new Error("max requires at least one data point");for(var fe=ce[0],ke=1;ke<ce.length;ke++)ce[ke]>fe&&(fe=ce[ke]);return fe}function Tt(ce){if(ce.length===0)throw new Error("min requires at least one data point");for(var fe=ce[0],ke=1;ke<ce.length;ke++)ce[ke]<fe&&(fe=ce[ke]);return fe}function ze(ce){if(ce.length===0)return 0;for(var fe=ce[0],ke=0,lt,nt=1;nt<ce.length;nt++)lt=fe+ce[nt]*1,Math.abs(fe)>=Math.abs(ce[nt])?ke+=fe-lt+ce[nt]:ke+=ce[nt]-lt+fe,fe=lt;return fe+ke*1}function st(ce){if(ce.length===0)throw new Error("mean requires at least one data point");return ze(ce)/ce.length}var Wt={min:Tt,max:Xe,mean:st,sum:ze};function bt(ce,fe){return ce.map(function(ke){return ke[fe]*1})}function dt(ce,fe){var ke=Object.keys(ce);if(Object.getOwnPropertySymbols){var lt=Object.getOwnPropertySymbols(ce);fe&&(lt=lt.filter(function(nt){return Object.getOwnPropertyDescriptor(ce,nt).enumerable})),ke.push.apply(ke,lt)}return ke}function H(ce){for(var fe=1;fe<arguments.length;fe++){var ke=arguments[fe]!=null?arguments[fe]:{};fe%2?dt(Object(ke),!0).forEach(function(lt){v()(ce,lt,ke[lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ce,Object.getOwnPropertyDescriptors(ke)):dt(Object(ke)).forEach(function(lt){Object.defineProperty(ce,lt,Object.getOwnPropertyDescriptor(ke,lt))})}return ce}function z(ce){var fe=V();return function(){var lt=Ke()(ce),nt;if(fe){var le=Ke()(this).constructor;nt=Reflect.construct(lt,arguments,le)}else nt=lt.apply(this,arguments);return we()(this,nt)}}function V(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ce){return!1}}function Se(ce,fe){if(Array.isArray(fe))return fe}var ve=function(ce){Q()(ke,ce);var fe=z(ke);function ke(lt,nt){var le;return F()(this,ke),le=fe.call(this),le.data=void 0,le.extent=void 0,le.hooks={init:new St.c},le.parser={type:"geojson"},le.transforms=[],le.cluster=!1,le.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},le.originData=void 0,le.rawData=void 0,le.cfg={},le.clusterIndex=void 0,le.originData=lt,le.initCfg(nt),le.hooks.init.tap("parser",function(){le.excuteParser()}),le.hooks.init.tap("cluster",function(){le.initCluster()}),le.hooks.init.tap("transform",function(){le.executeTrans()}),le.init(),le}return Y()(ke,[{key:"setData",value:function(nt,le){this.rawData=nt,this.originData=nt,this.initCfg(le),this.init(),this.emit("update")}},{key:"getClusters",value:function(nt){return this.clusterIndex.getClusters(this.extent,nt)}},{key:"getClustersLeaves",value:function(nt){return this.clusterIndex.getLeaves(nt,Infinity)}},{key:"updateClusterData",value:function(nt){var le=this,ye=this.clusterOptions,He=ye.method,ft=He===void 0?"sum":He,De=ye.field,Ze=Object(or.r)(Object(or.h)(this.extent),2),w=this.clusterIndex.getClusters(Ze[0].concat(Ze[1]),Math.floor(nt));this.clusterOptions.zoom=nt,w.forEach(function(R){R.id||(R.properties.point_count=1)}),(De||xt()(ft))&&(w=w.map(function(R){var q=R.id;if(q){var he=le.clusterIndex.getLeaves(q,Infinity),Ve=he.map(function(it){return it.properties}),Ye;if(at()(ft)&&De){var yt=bt(Ve,De);Ye=Wt[ft](yt)}xt()(ft)&&(Ye=ft(Ve)),R.properties.stat=Ye}else R.properties.point_count=1;return R})),this.data=Object(Ht.getParser)("geojson")({type:"FeatureCollection",features:w}),this.executeTrans()}},{key:"getFeatureById",value:function(nt){var le=this.parser.type,ye=le===void 0?"geojson":le;if(ye==="geojson"&&!this.cluster){var He=nt<this.originData.features.length?this.originData.features[nt]:"null",ft=Et()(He);if(this.transforms.length!==0){var De=this.data.dataArray.find(function(Ze){return Ze._id===nt});ft.properties=De}return ft}else return nt<this.data.dataArray.length?this.data.dataArray[nt]:"null"}},{key:"getFeatureId",value:function(nt,le){var ye=this.data.dataArray.find(function(He){return He[nt]===name});return ye==null?void 0:ye._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(nt){this.cfg=_e()(this.cfg,nt,Se);var le=this.cfg;le&&(le.parser&&(this.parser=le.parser),le.transforms&&(this.transforms=le.transforms),this.cluster=le.cluster||!1,le.clusterOptions&&(this.cluster=!0,this.clusterOptions=H(H({},this.clusterOptions),le.clusterOptions)))}},{key:"excuteParser",value:function(){var nt=this.parser,le=nt.type||"geojson",ye=Object(Ht.getParser)(le);this.data=ye(this.originData,nt),this.extent=Object(or.m)(this.data.dataArray)}},{key:"executeTrans",value:function(){var nt=this,le=this.transforms;le.forEach(function(ye){var He=ye.type,ft=Object(Ht.getTransform)(He)(nt.data,ye);Object.assign(nt.data,ft)})}},{key:"initCluster",value:function(){if(!!this.cluster){var nt=this.clusterOptions||{};this.clusterIndex=Object(mt.a)(this.data,nt)}}},{key:"init",value:function(){this.hooks.init.call(this)}}]),ke}($t.EventEmitter)},lJbI:function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});function b(v,Z){var F=Z.extent,a=Z.width,Y=Z.height,B=Z.min,Q=Z.max,re={_id:1,dataArray:[{_id:1,data:Array.from(v),width:a,height:Y,min:B,max:Q,coordinates:[[F[0],F[1]],[F[2],F[3]]]}]};return re}},lwsE:function(Ie,x){function o(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")}Ie.exports=o},mNvP:function(Ie,x,o){(function(b,v){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Z;(function(F){(function(a){var Y=typeof v=="object"?v:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),B=Q(F);typeof Y.Reflect=="undefined"?Y.Reflect=F:B=Q(Y.Reflect,B),a(B);function Q(re,we){return function(J,Ke){typeof re[J]!="function"&&Object.defineProperty(re,J,{configurable:!0,writable:!0,value:Ke}),we&&we(J,Ke)}}})(function(a){var Y=Object.prototype.hasOwnProperty,B=typeof Symbol=="function",Q=B&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",re=B&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",we=typeof Object.create=="function",J={__proto__:[]}instanceof Array,Ke=!we&&!J,Ge={create:we?function(){return lr(Object.create(null))}:J?function(){return lr({__proto__:null})}:function(){return lr({})},has:Ke?function(ct,ht){return Y.call(ct,ht)}:function(ct,ht){return ht in ct},get:Ke?function(ct,ht){return Y.call(ct,ht)?ct[ht]:void 0}:function(ct,ht){return ct[ht]}},_e=Object.getPrototypeOf(Function),Re=typeof b=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",at=!Re&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ie(),Oe=!Re&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:qe(),xt=!Re&&typeof WeakMap=="function"?WeakMap:jt(),Mt=new xt;function Et(ct,ht,Pt,vt){if(lt(Pt)){if(!R(ct))throw new TypeError;if(!he(ht))throw new TypeError;return Wt(ct,ht)}else{if(!R(ct))throw new TypeError;if(!ye(ht))throw new TypeError;if(!ye(vt)&&!lt(vt)&&!nt(vt))throw new TypeError;return nt(vt)&&(vt=void 0),Pt=w(Pt),bt(ct,ht,Pt,vt)}}a("decorate",Et);function St(ct,ht){function Pt(vt,Pe){if(!ye(vt))throw new TypeError;if(!lt(Pe)&&!Ve(Pe))throw new TypeError;ve(ct,ht,vt,Pe)}return Pt}a("metadata",St);function or(ct,ht,Pt,vt){if(!ye(Pt))throw new TypeError;return lt(vt)||(vt=w(vt)),ve(ct,ht,Pt,vt)}a("defineMetadata",or);function $t(ct,ht,Pt){if(!ye(ht))throw new TypeError;return lt(Pt)||(Pt=w(Pt)),H(ct,ht,Pt)}a("hasMetadata",$t);function Ht(ct,ht,Pt){if(!ye(ht))throw new TypeError;return lt(Pt)||(Pt=w(Pt)),z(ct,ht,Pt)}a("hasOwnMetadata",Ht);function mt(ct,ht,Pt){if(!ye(ht))throw new TypeError;return lt(Pt)||(Pt=w(Pt)),V(ct,ht,Pt)}a("getMetadata",mt);function Xe(ct,ht,Pt){if(!ye(ht))throw new TypeError;return lt(Pt)||(Pt=w(Pt)),Se(ct,ht,Pt)}a("getOwnMetadata",Xe);function Tt(ct,ht){if(!ye(ct))throw new TypeError;return lt(ht)||(ht=w(ht)),ce(ct,ht)}a("getMetadataKeys",Tt);function ze(ct,ht){if(!ye(ct))throw new TypeError;return lt(ht)||(ht=w(ht)),fe(ct,ht)}a("getOwnMetadataKeys",ze);function st(ct,ht,Pt){if(!ye(ht))throw new TypeError;lt(Pt)||(Pt=w(Pt));var vt=dt(ht,Pt,!1);if(lt(vt)||!vt.delete(ct))return!1;if(vt.size>0)return!0;var Pe=Mt.get(ht);return Pe.delete(Pt),Pe.size>0||Mt.delete(ht),!0}a("deleteMetadata",st);function Wt(ct,ht){for(var Pt=ct.length-1;Pt>=0;--Pt){var vt=ct[Pt],Pe=vt(ht);if(!lt(Pe)&&!nt(Pe)){if(!he(Pe))throw new TypeError;ht=Pe}}return ht}function bt(ct,ht,Pt,vt){for(var Pe=ct.length-1;Pe>=0;--Pe){var ut=ct[Pe],Qe=ut(ht,Pt,vt);if(!lt(Qe)&&!nt(Qe)){if(!ye(Qe))throw new TypeError;vt=Qe}}return vt}function dt(ct,ht,Pt){var vt=Mt.get(ct);if(lt(vt)){if(!Pt)return;vt=new at,Mt.set(ct,vt)}var Pe=vt.get(ht);if(lt(Pe)){if(!Pt)return;Pe=new at,vt.set(ht,Pe)}return Pe}function H(ct,ht,Pt){var vt=z(ct,ht,Pt);if(vt)return!0;var Pe=$e(ht);return nt(Pe)?!1:H(ct,Pe,Pt)}function z(ct,ht,Pt){var vt=dt(ht,Pt,!1);return lt(vt)?!1:De(vt.has(ct))}function V(ct,ht,Pt){var vt=z(ct,ht,Pt);if(vt)return Se(ct,ht,Pt);var Pe=$e(ht);if(!nt(Pe))return V(ct,Pe,Pt)}function Se(ct,ht,Pt){var vt=dt(ht,Pt,!1);if(!lt(vt))return vt.get(ct)}function ve(ct,ht,Pt,vt){var Pe=dt(Pt,vt,!0);Pe.set(ct,ht)}function ce(ct,ht){var Pt=fe(ct,ht),vt=$e(ct);if(vt===null)return Pt;var Pe=ce(vt,ht);if(Pe.length<=0)return Pt;if(Pt.length<=0)return Pe;for(var ut=new Oe,Qe=[],Vt=0,pr=Pt;Vt<pr.length;Vt++){var Zr=pr[Vt],cr=ut.has(Zr);cr||(ut.add(Zr),Qe.push(Zr))}for(var jn=0,En=Pe;jn<En.length;jn++){var Zr=En[jn],cr=ut.has(Zr);cr||(ut.add(Zr),Qe.push(Zr))}return Qe}function fe(ct,ht){var Pt=[],vt=dt(ct,ht,!1);if(lt(vt))return Pt;for(var Pe=vt.keys(),ut=yt(Pe),Qe=0;;){var Vt=Nt(ut);if(!Vt)return Pt.length=Qe,Pt;var pr=it(Vt);try{Pt[Qe]=pr}catch(Zr){try{$(ut)}finally{throw Zr}}Qe++}}function ke(ct){if(ct===null)return 1;switch(typeof ct){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return ct===null?1:6;default:return 6}}function lt(ct){return ct===void 0}function nt(ct){return ct===null}function le(ct){return typeof ct=="symbol"}function ye(ct){return typeof ct=="object"?ct!==null:typeof ct=="function"}function He(ct,ht){switch(ke(ct)){case 0:return ct;case 1:return ct;case 2:return ct;case 3:return ct;case 4:return ct;case 5:return ct}var Pt=ht===3?"string":ht===5?"number":"default",vt=Ye(ct,Q);if(vt!==void 0){var Pe=vt.call(ct,Pt);if(ye(Pe))throw new TypeError;return Pe}return ft(ct,Pt==="default"?"number":Pt)}function ft(ct,ht){if(ht==="string"){var Pt=ct.toString;if(q(Pt)){var vt=Pt.call(ct);if(!ye(vt))return vt}var Pe=ct.valueOf;if(q(Pe)){var vt=Pe.call(ct);if(!ye(vt))return vt}}else{var Pe=ct.valueOf;if(q(Pe)){var vt=Pe.call(ct);if(!ye(vt))return vt}var ut=ct.toString;if(q(ut)){var vt=ut.call(ct);if(!ye(vt))return vt}}throw new TypeError}function De(ct){return!!ct}function Ze(ct){return""+ct}function w(ct){var ht=He(ct,3);return le(ht)?ht:Ze(ht)}function R(ct){return Array.isArray?Array.isArray(ct):ct instanceof Object?ct instanceof Array:Object.prototype.toString.call(ct)==="[object Array]"}function q(ct){return typeof ct=="function"}function he(ct){return typeof ct=="function"}function Ve(ct){switch(ke(ct)){case 3:return!0;case 4:return!0;default:return!1}}function Ye(ct,ht){var Pt=ct[ht];if(Pt!=null){if(!q(Pt))throw new TypeError;return Pt}}function yt(ct){var ht=Ye(ct,re);if(!q(ht))throw new TypeError;var Pt=ht.call(ct);if(!ye(Pt))throw new TypeError;return Pt}function it(ct){return ct.value}function Nt(ct){var ht=ct.next();return ht.done?!1:ht}function $(ct){var ht=ct.return;ht&&ht.call(ct)}function $e(ct){var ht=Object.getPrototypeOf(ct);if(typeof ct!="function"||ct===_e||ht!==_e)return ht;var Pt=ct.prototype,vt=Pt&&Object.getPrototypeOf(Pt);if(vt==null||vt===Object.prototype)return ht;var Pe=vt.constructor;return typeof Pe!="function"||Pe===ct?ht:Pe}function ie(){var ct={},ht=[],Pt=function(){function Qe(Vt,pr,Zr){this._index=0,this._keys=Vt,this._values=pr,this._selector=Zr}return Qe.prototype["@@iterator"]=function(){return this},Qe.prototype[re]=function(){return this},Qe.prototype.next=function(){var Vt=this._index;if(Vt>=0&&Vt<this._keys.length){var pr=this._selector(this._keys[Vt],this._values[Vt]);return Vt+1>=this._keys.length?(this._index=-1,this._keys=ht,this._values=ht):this._index++,{value:pr,done:!1}}return{value:void 0,done:!0}},Qe.prototype.throw=function(Vt){throw this._index>=0&&(this._index=-1,this._keys=ht,this._values=ht),Vt},Qe.prototype.return=function(Vt){return this._index>=0&&(this._index=-1,this._keys=ht,this._values=ht),{value:Vt,done:!0}},Qe}();return function(){function Qe(){this._keys=[],this._values=[],this._cacheKey=ct,this._cacheIndex=-2}return Object.defineProperty(Qe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Qe.prototype.has=function(Vt){return this._find(Vt,!1)>=0},Qe.prototype.get=function(Vt){var pr=this._find(Vt,!1);return pr>=0?this._values[pr]:void 0},Qe.prototype.set=function(Vt,pr){var Zr=this._find(Vt,!0);return this._values[Zr]=pr,this},Qe.prototype.delete=function(Vt){var pr=this._find(Vt,!1);if(pr>=0){for(var Zr=this._keys.length,cr=pr+1;cr<Zr;cr++)this._keys[cr-1]=this._keys[cr],this._values[cr-1]=this._values[cr];return this._keys.length--,this._values.length--,Vt===this._cacheKey&&(this._cacheKey=ct,this._cacheIndex=-2),!0}return!1},Qe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=ct,this._cacheIndex=-2},Qe.prototype.keys=function(){return new Pt(this._keys,this._values,vt)},Qe.prototype.values=function(){return new Pt(this._keys,this._values,Pe)},Qe.prototype.entries=function(){return new Pt(this._keys,this._values,ut)},Qe.prototype["@@iterator"]=function(){return this.entries()},Qe.prototype[re]=function(){return this.entries()},Qe.prototype._find=function(Vt,pr){return this._cacheKey!==Vt&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Vt)),this._cacheIndex<0&&pr&&(this._cacheIndex=this._keys.length,this._keys.push(Vt),this._values.push(void 0)),this._cacheIndex},Qe}();function vt(Qe,Vt){return Qe}function Pe(Qe,Vt){return Vt}function ut(Qe,Vt){return[Qe,Vt]}}function qe(){return function(){function ct(){this._map=new at}return Object.defineProperty(ct.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ct.prototype.has=function(ht){return this._map.has(ht)},ct.prototype.add=function(ht){return this._map.set(ht,ht),this},ct.prototype.delete=function(ht){return this._map.delete(ht)},ct.prototype.clear=function(){this._map.clear()},ct.prototype.keys=function(){return this._map.keys()},ct.prototype.values=function(){return this._map.values()},ct.prototype.entries=function(){return this._map.entries()},ct.prototype["@@iterator"]=function(){return this.keys()},ct.prototype[re]=function(){return this.keys()},ct}()}function jt(){var ct=16,ht=Ge.create(),Pt=vt();return function(){function pr(){this._key=vt()}return pr.prototype.has=function(Zr){var cr=Pe(Zr,!1);return cr!==void 0?Ge.has(cr,this._key):!1},pr.prototype.get=function(Zr){var cr=Pe(Zr,!1);return cr!==void 0?Ge.get(cr,this._key):void 0},pr.prototype.set=function(Zr,cr){var jn=Pe(Zr,!0);return jn[this._key]=cr,this},pr.prototype.delete=function(Zr){var cr=Pe(Zr,!1);return cr!==void 0?delete cr[this._key]:!1},pr.prototype.clear=function(){this._key=vt()},pr}();function vt(){var pr;do pr="@@WeakMap@@"+Vt();while(Ge.has(ht,pr));return ht[pr]=!0,pr}function Pe(pr,Zr){if(!Y.call(pr,Pt)){if(!Zr)return;Object.defineProperty(pr,Pt,{value:Ge.create()})}return pr[Pt]}function ut(pr,Zr){for(var cr=0;cr<Zr;++cr)pr[cr]=Math.random()*255|0;return pr}function Qe(pr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(pr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(pr)):ut(new Uint8Array(pr),pr):ut(new Array(pr),pr)}function Vt(){var pr=Qe(ct);pr[6]=pr[6]&79|64,pr[8]=pr[8]&191|128;for(var Zr="",cr=0;cr<ct;++cr){var jn=pr[cr];(cr===4||cr===6||cr===8)&&(Zr+="-"),jn<16&&(Zr+="0"),Zr+=jn.toString(16).toLowerCase()}return Zr}}function lr(ct){return ct.__=void 0,delete ct.__,ct}})})(Z||(Z={}))}).call(this,o("Q2Ig"),o("yLpj"))},mTTR:function(Ie,x,o){var b=o("b80T"),v=o("QcOe"),Z=o("MMmD");function F(a){return Z(a)?b(a,!0):v(a)}Ie.exports=F},mc0g:function(Ie,x){function o(b){return function(v,Z,F){for(var a=-1,Y=Object(v),B=F(v),Q=B.length;Q--;){var re=B[b?Q:++a];if(Z(Y[re],re,Y)===!1)break}return v}}Ie.exports=o},mhV4:function(Ie,x,o){var b=o("ZK94");Ie.exports.geometry=v,Ie.exports.ring=F;function v(Y){var B=0,Q;switch(Y.type){case"Polygon":return Z(Y.coordinates);case"MultiPolygon":for(Q=0;Q<Y.coordinates.length;Q++)B+=Z(Y.coordinates[Q]);return B;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(Q=0;Q<Y.geometries.length;Q++)B+=v(Y.geometries[Q]);return B}}function Z(Y){var B=0;if(Y&&Y.length>0){B+=Math.abs(F(Y[0]));for(var Q=1;Q<Y.length;Q++)B-=Math.abs(F(Y[Q]))}return B}function F(Y){var B,Q,re,we,J,Ke,Ge,_e=0,Re=Y.length;if(Re>2){for(Ge=0;Ge<Re;Ge++)Ge===Re-2?(we=Re-2,J=Re-1,Ke=0):Ge===Re-1?(we=Re-1,J=0,Ke=1):(we=Ge,J=Ge+1,Ke=Ge+2),B=Y[we],Q=Y[J],re=Y[Ke],_e+=(a(re[0])-a(B[0]))*Math.sin(a(Q[1]));_e=_e*b.RADIUS*b.RADIUS/2}return _e}function a(Y){return Y*Math.PI/180}},mpbz:function(Ie,x,o){(function(b,v){Ie.exports=v()})(this,function(){"use strict";function b(mt,Xe,Tt,ze,st,Wt){if(!(st-ze<=Tt)){var bt=ze+st>>1;v(mt,Xe,bt,ze,st,Wt%2),b(mt,Xe,Tt,ze,bt-1,Wt+1),b(mt,Xe,Tt,bt+1,st,Wt+1)}}function v(mt,Xe,Tt,ze,st,Wt){for(;st>ze;){if(st-ze>600){var bt=st-ze+1,dt=Tt-ze+1,H=Math.log(bt),z=.5*Math.exp(2*H/3),V=.5*Math.sqrt(H*z*(bt-z)/bt)*(dt-bt/2<0?-1:1),Se=Math.max(ze,Math.floor(Tt-dt*z/bt+V)),ve=Math.min(st,Math.floor(Tt+(bt-dt)*z/bt+V));v(mt,Xe,Tt,Se,ve,Wt)}var ce=Xe[2*Tt+Wt],fe=ze,ke=st;for(Z(mt,Xe,ze,Tt),Xe[2*st+Wt]>ce&&Z(mt,Xe,ze,st);fe<ke;){for(Z(mt,Xe,fe,ke),fe++,ke--;Xe[2*fe+Wt]<ce;)fe++;for(;Xe[2*ke+Wt]>ce;)ke--}Xe[2*ze+Wt]===ce?Z(mt,Xe,ze,ke):(ke++,Z(mt,Xe,ke,st)),ke<=Tt&&(ze=ke+1),Tt<=ke&&(st=ke-1)}}function Z(mt,Xe,Tt,ze){F(mt,Tt,ze),F(Xe,2*Tt,2*ze),F(Xe,2*Tt+1,2*ze+1)}function F(mt,Xe,Tt){var ze=mt[Xe];mt[Xe]=mt[Tt],mt[Tt]=ze}function a(mt,Xe,Tt,ze,st,Wt,bt){for(var dt=[0,mt.length-1,0],H=[],z,V;dt.length;){var Se=dt.pop(),ve=dt.pop(),ce=dt.pop();if(ve-ce<=bt){for(var fe=ce;fe<=ve;fe++)z=Xe[2*fe],V=Xe[2*fe+1],z>=Tt&&z<=st&&V>=ze&&V<=Wt&&H.push(mt[fe]);continue}var ke=Math.floor((ce+ve)/2);z=Xe[2*ke],V=Xe[2*ke+1],z>=Tt&&z<=st&&V>=ze&&V<=Wt&&H.push(mt[ke]);var lt=(Se+1)%2;(Se===0?Tt<=z:ze<=V)&&(dt.push(ce),dt.push(ke-1),dt.push(lt)),(Se===0?st>=z:Wt>=V)&&(dt.push(ke+1),dt.push(ve),dt.push(lt))}return H}function Y(mt,Xe,Tt,ze,st,Wt){for(var bt=[0,mt.length-1,0],dt=[],H=st*st;bt.length;){var z=bt.pop(),V=bt.pop(),Se=bt.pop();if(V-Se<=Wt){for(var ve=Se;ve<=V;ve++)B(Xe[2*ve],Xe[2*ve+1],Tt,ze)<=H&&dt.push(mt[ve]);continue}var ce=Math.floor((Se+V)/2),fe=Xe[2*ce],ke=Xe[2*ce+1];B(fe,ke,Tt,ze)<=H&&dt.push(mt[ce]);var lt=(z+1)%2;(z===0?Tt-st<=fe:ze-st<=ke)&&(bt.push(Se),bt.push(ce-1),bt.push(lt)),(z===0?Tt+st>=fe:ze+st>=ke)&&(bt.push(ce+1),bt.push(V),bt.push(lt))}return dt}function B(mt,Xe,Tt,ze){var st=mt-Tt,Wt=Xe-ze;return st*st+Wt*Wt}var Q=function(Xe){return Xe[0]},re=function(Xe){return Xe[1]},we=function(Xe,Tt,ze,st,Wt){Tt===void 0&&(Tt=Q),ze===void 0&&(ze=re),st===void 0&&(st=64),Wt===void 0&&(Wt=Float64Array),this.nodeSize=st,this.points=Xe;for(var bt=Xe.length<65536?Uint16Array:Uint32Array,dt=this.ids=new bt(Xe.length),H=this.coords=new Wt(Xe.length*2),z=0;z<Xe.length;z++)dt[z]=z,H[2*z]=Tt(Xe[z]),H[2*z+1]=ze(Xe[z]);b(dt,H,st,0,dt.length-1,0)};we.prototype.range=function(Xe,Tt,ze,st){return a(this.ids,this.coords,Xe,Tt,ze,st,this.nodeSize)},we.prototype.within=function(Xe,Tt,ze){return Y(this.ids,this.coords,Xe,Tt,ze,this.nodeSize)};var J={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Xe){return Xe}},Ke=Math.fround||function(mt){return function(Xe){return mt[0]=+Xe,mt[0]}}(new Float32Array(1)),Ge=function(Xe){this.options=or(Object.create(J),Xe),this.trees=new Array(this.options.maxZoom+1)};Ge.prototype.load=function(Xe){var Tt=this.options,ze=Tt.log,st=Tt.minZoom,Wt=Tt.maxZoom,bt=Tt.nodeSize;ze&&console.time("total time");var dt="prepare "+Xe.length+" points";ze&&console.time(dt),this.points=Xe;for(var H=[],z=0;z<Xe.length;z++)!Xe[z].geometry||H.push(Re(Xe[z],z));this.trees[Wt+1]=new we(H,$t,Ht,bt,Float32Array),ze&&console.timeEnd(dt);for(var V=Wt;V>=st;V--){var Se=+Date.now();H=this._cluster(H,V),this.trees[V]=new we(H,$t,Ht,bt,Float32Array),ze&&console.log("z%d: %d clusters in %dms",V,H.length,+Date.now()-Se)}return ze&&console.timeEnd("total time"),this},Ge.prototype.getClusters=function(Xe,Tt){var ze=((Xe[0]+180)%360+360)%360-180,st=Math.max(-90,Math.min(90,Xe[1])),Wt=Xe[2]===180?180:((Xe[2]+180)%360+360)%360-180,bt=Math.max(-90,Math.min(90,Xe[3]));if(Xe[2]-Xe[0]>=360)ze=-180,Wt=180;else if(ze>Wt){var dt=this.getClusters([ze,st,180,bt],Tt),H=this.getClusters([-180,st,Wt,bt],Tt);return dt.concat(H)}for(var z=this.trees[this._limitZoom(Tt)],V=z.range(xt(ze),Mt(bt),xt(Wt),Mt(st)),Se=[],ve=0,ce=V;ve<ce.length;ve+=1){var fe=ce[ve],ke=z.points[fe];Se.push(ke.numPoints?at(ke):this.points[ke.index])}return Se},Ge.prototype.getChildren=function(Xe){var Tt=this._getOriginId(Xe),ze=this._getOriginZoom(Xe),st="No cluster with the specified id.",Wt=this.trees[ze];if(!Wt)throw new Error(st);var bt=Wt.points[Tt];if(!bt)throw new Error(st);for(var dt=this.options.radius/(this.options.extent*Math.pow(2,ze-1)),H=Wt.within(bt.x,bt.y,dt),z=[],V=0,Se=H;V<Se.length;V+=1){var ve=Se[V],ce=Wt.points[ve];ce.parentId===Xe&&z.push(ce.numPoints?at(ce):this.points[ce.index])}if(z.length===0)throw new Error(st);return z},Ge.prototype.getLeaves=function(Xe,Tt,ze){Tt=Tt||10,ze=ze||0;var st=[];return this._appendLeaves(st,Xe,Tt,ze,0),st},Ge.prototype.getTile=function(Xe,Tt,ze){var st=this.trees[this._limitZoom(Xe)],Wt=Math.pow(2,Xe),bt=this.options,dt=bt.extent,H=bt.radius,z=H/dt,V=(ze-z)/Wt,Se=(ze+1+z)/Wt,ve={features:[]};return this._addTileFeatures(st.range((Tt-z)/Wt,V,(Tt+1+z)/Wt,Se),st.points,Tt,ze,Wt,ve),Tt===0&&this._addTileFeatures(st.range(1-z/Wt,V,1,Se),st.points,Wt,ze,Wt,ve),Tt===Wt-1&&this._addTileFeatures(st.range(0,V,z/Wt,Se),st.points,-1,ze,Wt,ve),ve.features.length?ve:null},Ge.prototype.getClusterExpansionZoom=function(Xe){for(var Tt=this._getOriginZoom(Xe)-1;Tt<=this.options.maxZoom;){var ze=this.getChildren(Xe);if(Tt++,ze.length!==1)break;Xe=ze[0].properties.cluster_id}return Tt},Ge.prototype._appendLeaves=function(Xe,Tt,ze,st,Wt){for(var bt=this.getChildren(Tt),dt=0,H=bt;dt<H.length;dt+=1){var z=H[dt],V=z.properties;if(V&&V.cluster?Wt+V.point_count<=st?Wt+=V.point_count:Wt=this._appendLeaves(Xe,V.cluster_id,ze,st,Wt):Wt<st?Wt++:Xe.push(z),Xe.length===ze)break}return Wt},Ge.prototype._addTileFeatures=function(Xe,Tt,ze,st,Wt,bt){for(var dt=0,H=Xe;dt<H.length;dt+=1){var z=H[dt],V=Tt[z],Se=V.numPoints,ve={type:1,geometry:[[Math.round(this.options.extent*(V.x*Wt-ze)),Math.round(this.options.extent*(V.y*Wt-st))]],tags:Se?Oe(V):this.points[V.index].properties},ce=void 0;Se?ce=V.id:this.options.generateId?ce=V.index:this.points[V.index].id&&(ce=this.points[V.index].id),ce!==void 0&&(ve.id=ce),bt.features.push(ve)}},Ge.prototype._limitZoom=function(Xe){return Math.max(this.options.minZoom,Math.min(+Xe,this.options.maxZoom+1))},Ge.prototype._cluster=function(Xe,Tt){for(var ze=[],st=this.options,Wt=st.radius,bt=st.extent,dt=st.reduce,H=st.minPoints,z=Wt/(bt*Math.pow(2,Tt)),V=0;V<Xe.length;V++){var Se=Xe[V];if(!(Se.zoom<=Tt)){Se.zoom=Tt;for(var ve=this.trees[Tt+1],ce=ve.within(Se.x,Se.y,z),fe=Se.numPoints||1,ke=fe,lt=0,nt=ce;lt<nt.length;lt+=1){var le=nt[lt],ye=ve.points[le];ye.zoom>Tt&&(ke+=ye.numPoints||1)}if(ke>=H){for(var He=Se.x*fe,ft=Se.y*fe,De=dt&&fe>1?this._map(Se,!0):null,Ze=(V<<5)+(Tt+1)+this.points.length,w=0,R=ce;w<R.length;w+=1){var q=R[w],he=ve.points[q];if(!(he.zoom<=Tt)){he.zoom=Tt;var Ve=he.numPoints||1;He+=he.x*Ve,ft+=he.y*Ve,he.parentId=Ze,dt&&(De||(De=this._map(Se,!0)),dt(De,this._map(he)))}}Se.parentId=Ze,ze.push(_e(He/ke,ft/ke,Ze,ke,De))}else if(ze.push(Se),ke>1)for(var Ye=0,yt=ce;Ye<yt.length;Ye+=1){var it=yt[Ye],Nt=ve.points[it];Nt.zoom<=Tt||(Nt.zoom=Tt,ze.push(Nt))}}}return ze},Ge.prototype._getOriginId=function(Xe){return Xe-this.points.length>>5},Ge.prototype._getOriginZoom=function(Xe){return(Xe-this.points.length)%32},Ge.prototype._map=function(Xe,Tt){if(Xe.numPoints)return Tt?or({},Xe.properties):Xe.properties;var ze=this.points[Xe.index].properties,st=this.options.map(ze);return Tt&&st===ze?or({},st):st};function _e(mt,Xe,Tt,ze,st){return{x:Ke(mt),y:Ke(Xe),zoom:Infinity,id:Tt,parentId:-1,numPoints:ze,properties:st}}function Re(mt,Xe){var Tt=mt.geometry.coordinates,ze=Tt[0],st=Tt[1];return{x:Ke(xt(ze)),y:Ke(Mt(st)),zoom:Infinity,index:Xe,parentId:-1}}function at(mt){return{type:"Feature",id:mt.id,properties:Oe(mt),geometry:{type:"Point",coordinates:[Et(mt.x),St(mt.y)]}}}function Oe(mt){var Xe=mt.numPoints,Tt=Xe>=1e4?Math.round(Xe/1e3)+"k":Xe>=1e3?Math.round(Xe/100)/10+"k":Xe;return or(or({},mt.properties),{cluster:!0,cluster_id:mt.id,point_count:Xe,point_count_abbreviated:Tt})}function xt(mt){return mt/360+.5}function Mt(mt){var Xe=Math.sin(mt*Math.PI/180),Tt=.5-.25*Math.log((1+Xe)/(1-Xe))/Math.PI;return Tt<0?0:Tt>1?1:Tt}function Et(mt){return(mt-.5)*360}function St(mt){var Xe=(180-mt*360)*Math.PI/180;return 360*Math.atan(Math.exp(Xe))/Math.PI-90}function or(mt,Xe){for(var Tt in Xe)mt[Tt]=Xe[Tt];return mt}function $t(mt){return mt.x}function Ht(mt){return mt.y}return Ge})},"mv/X":function(Ie,x,o){var b=o("ljhN"),v=o("MMmD"),Z=o("wJg7"),F=o("GoyQ");function a(Y,B,Q){if(!F(Q))return!1;var re=typeof B;return(re=="number"?v(Q)&&Z(B,Q.length):re=="string"&&B in Q)?b(Q[B],Y):!1}Ie.exports=a},"n+fv":function(Ie,x,o){"use strict";o.r(x),o.d(x,"create",function(){return v}),o.d(x,"clone",function(){return Z}),o.d(x,"length",function(){return F}),o.d(x,"fromValues",function(){return a}),o.d(x,"copy",function(){return Y}),o.d(x,"set",function(){return B}),o.d(x,"add",function(){return Q}),o.d(x,"subtract",function(){return re}),o.d(x,"multiply",function(){return we}),o.d(x,"divide",function(){return J}),o.d(x,"ceil",function(){return Ke}),o.d(x,"floor",function(){return Ge}),o.d(x,"min",function(){return _e}),o.d(x,"max",function(){return Re}),o.d(x,"round",function(){return at}),o.d(x,"scale",function(){return Oe}),o.d(x,"scaleAndAdd",function(){return xt}),o.d(x,"distance",function(){return Mt}),o.d(x,"squaredDistance",function(){return Et}),o.d(x,"squaredLength",function(){return St}),o.d(x,"negate",function(){return or}),o.d(x,"inverse",function(){return $t}),o.d(x,"normalize",function(){return Ht}),o.d(x,"dot",function(){return mt}),o.d(x,"cross",function(){return Xe}),o.d(x,"lerp",function(){return Tt}),o.d(x,"hermite",function(){return ze}),o.d(x,"bezier",function(){return st}),o.d(x,"random",function(){return Wt}),o.d(x,"transformMat4",function(){return bt}),o.d(x,"transformMat3",function(){return dt}),o.d(x,"transformQuat",function(){return H}),o.d(x,"rotateX",function(){return z}),o.d(x,"rotateY",function(){return V}),o.d(x,"rotateZ",function(){return Se}),o.d(x,"angle",function(){return ve}),o.d(x,"zero",function(){return ce}),o.d(x,"str",function(){return fe}),o.d(x,"exactEquals",function(){return ke}),o.d(x,"equals",function(){return lt}),o.d(x,"sub",function(){return nt}),o.d(x,"mul",function(){return le}),o.d(x,"div",function(){return ye}),o.d(x,"dist",function(){return He}),o.d(x,"sqrDist",function(){return ft}),o.d(x,"len",function(){return De}),o.d(x,"sqrLen",function(){return Ze}),o.d(x,"forEach",function(){return w});var b=o("yU0y");function v(){var R=new b.a(3);return b.a!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function Z(R){var q=new b.a(3);return q[0]=R[0],q[1]=R[1],q[2]=R[2],q}function F(R){var q=R[0],he=R[1],Ve=R[2];return Math.hypot(q,he,Ve)}function a(R,q,he){var Ve=new b.a(3);return Ve[0]=R,Ve[1]=q,Ve[2]=he,Ve}function Y(R,q){return R[0]=q[0],R[1]=q[1],R[2]=q[2],R}function B(R,q,he,Ve){return R[0]=q,R[1]=he,R[2]=Ve,R}function Q(R,q,he){return R[0]=q[0]+he[0],R[1]=q[1]+he[1],R[2]=q[2]+he[2],R}function re(R,q,he){return R[0]=q[0]-he[0],R[1]=q[1]-he[1],R[2]=q[2]-he[2],R}function we(R,q,he){return R[0]=q[0]*he[0],R[1]=q[1]*he[1],R[2]=q[2]*he[2],R}function J(R,q,he){return R[0]=q[0]/he[0],R[1]=q[1]/he[1],R[2]=q[2]/he[2],R}function Ke(R,q){return R[0]=Math.ceil(q[0]),R[1]=Math.ceil(q[1]),R[2]=Math.ceil(q[2]),R}function Ge(R,q){return R[0]=Math.floor(q[0]),R[1]=Math.floor(q[1]),R[2]=Math.floor(q[2]),R}function _e(R,q,he){return R[0]=Math.min(q[0],he[0]),R[1]=Math.min(q[1],he[1]),R[2]=Math.min(q[2],he[2]),R}function Re(R,q,he){return R[0]=Math.max(q[0],he[0]),R[1]=Math.max(q[1],he[1]),R[2]=Math.max(q[2],he[2]),R}function at(R,q){return R[0]=Math.round(q[0]),R[1]=Math.round(q[1]),R[2]=Math.round(q[2]),R}function Oe(R,q,he){return R[0]=q[0]*he,R[1]=q[1]*he,R[2]=q[2]*he,R}function xt(R,q,he,Ve){return R[0]=q[0]+he[0]*Ve,R[1]=q[1]+he[1]*Ve,R[2]=q[2]+he[2]*Ve,R}function Mt(R,q){var he=q[0]-R[0],Ve=q[1]-R[1],Ye=q[2]-R[2];return Math.hypot(he,Ve,Ye)}function Et(R,q){var he=q[0]-R[0],Ve=q[1]-R[1],Ye=q[2]-R[2];return he*he+Ve*Ve+Ye*Ye}function St(R){var q=R[0],he=R[1],Ve=R[2];return q*q+he*he+Ve*Ve}function or(R,q){return R[0]=-q[0],R[1]=-q[1],R[2]=-q[2],R}function $t(R,q){return R[0]=1/q[0],R[1]=1/q[1],R[2]=1/q[2],R}function Ht(R,q){var he=q[0],Ve=q[1],Ye=q[2],yt=he*he+Ve*Ve+Ye*Ye;return yt>0&&(yt=1/Math.sqrt(yt)),R[0]=q[0]*yt,R[1]=q[1]*yt,R[2]=q[2]*yt,R}function mt(R,q){return R[0]*q[0]+R[1]*q[1]+R[2]*q[2]}function Xe(R,q,he){var Ve=q[0],Ye=q[1],yt=q[2],it=he[0],Nt=he[1],$=he[2];return R[0]=Ye*$-yt*Nt,R[1]=yt*it-Ve*$,R[2]=Ve*Nt-Ye*it,R}function Tt(R,q,he,Ve){var Ye=q[0],yt=q[1],it=q[2];return R[0]=Ye+Ve*(he[0]-Ye),R[1]=yt+Ve*(he[1]-yt),R[2]=it+Ve*(he[2]-it),R}function ze(R,q,he,Ve,Ye,yt){var it=yt*yt,Nt=it*(2*yt-3)+1,$=it*(yt-2)+yt,$e=it*(yt-1),ie=it*(3-2*yt);return R[0]=q[0]*Nt+he[0]*$+Ve[0]*$e+Ye[0]*ie,R[1]=q[1]*Nt+he[1]*$+Ve[1]*$e+Ye[1]*ie,R[2]=q[2]*Nt+he[2]*$+Ve[2]*$e+Ye[2]*ie,R}function st(R,q,he,Ve,Ye,yt){var it=1-yt,Nt=it*it,$=yt*yt,$e=Nt*it,ie=3*yt*Nt,qe=3*$*it,jt=$*yt;return R[0]=q[0]*$e+he[0]*ie+Ve[0]*qe+Ye[0]*jt,R[1]=q[1]*$e+he[1]*ie+Ve[1]*qe+Ye[1]*jt,R[2]=q[2]*$e+he[2]*ie+Ve[2]*qe+Ye[2]*jt,R}function Wt(R,q){q=q||1;var he=b.c()*2*Math.PI,Ve=b.c()*2-1,Ye=Math.sqrt(1-Ve*Ve)*q;return R[0]=Math.cos(he)*Ye,R[1]=Math.sin(he)*Ye,R[2]=Ve*q,R}function bt(R,q,he){var Ve=q[0],Ye=q[1],yt=q[2],it=he[3]*Ve+he[7]*Ye+he[11]*yt+he[15];return it=it||1,R[0]=(he[0]*Ve+he[4]*Ye+he[8]*yt+he[12])/it,R[1]=(he[1]*Ve+he[5]*Ye+he[9]*yt+he[13])/it,R[2]=(he[2]*Ve+he[6]*Ye+he[10]*yt+he[14])/it,R}function dt(R,q,he){var Ve=q[0],Ye=q[1],yt=q[2];return R[0]=Ve*he[0]+Ye*he[3]+yt*he[6],R[1]=Ve*he[1]+Ye*he[4]+yt*he[7],R[2]=Ve*he[2]+Ye*he[5]+yt*he[8],R}function H(R,q,he){var Ve=he[0],Ye=he[1],yt=he[2],it=he[3],Nt=q[0],$=q[1],$e=q[2],ie=Ye*$e-yt*$,qe=yt*Nt-Ve*$e,jt=Ve*$-Ye*Nt,lr=Ye*jt-yt*qe,ct=yt*ie-Ve*jt,ht=Ve*qe-Ye*ie,Pt=it*2;return ie*=Pt,qe*=Pt,jt*=Pt,lr*=2,ct*=2,ht*=2,R[0]=Nt+ie+lr,R[1]=$+qe+ct,R[2]=$e+jt+ht,R}function z(R,q,he,Ve){var Ye=[],yt=[];return Ye[0]=q[0]-he[0],Ye[1]=q[1]-he[1],Ye[2]=q[2]-he[2],yt[0]=Ye[0],yt[1]=Ye[1]*Math.cos(Ve)-Ye[2]*Math.sin(Ve),yt[2]=Ye[1]*Math.sin(Ve)+Ye[2]*Math.cos(Ve),R[0]=yt[0]+he[0],R[1]=yt[1]+he[1],R[2]=yt[2]+he[2],R}function V(R,q,he,Ve){var Ye=[],yt=[];return Ye[0]=q[0]-he[0],Ye[1]=q[1]-he[1],Ye[2]=q[2]-he[2],yt[0]=Ye[2]*Math.sin(Ve)+Ye[0]*Math.cos(Ve),yt[1]=Ye[1],yt[2]=Ye[2]*Math.cos(Ve)-Ye[0]*Math.sin(Ve),R[0]=yt[0]+he[0],R[1]=yt[1]+he[1],R[2]=yt[2]+he[2],R}function Se(R,q,he,Ve){var Ye=[],yt=[];return Ye[0]=q[0]-he[0],Ye[1]=q[1]-he[1],Ye[2]=q[2]-he[2],yt[0]=Ye[0]*Math.cos(Ve)-Ye[1]*Math.sin(Ve),yt[1]=Ye[0]*Math.sin(Ve)+Ye[1]*Math.cos(Ve),yt[2]=Ye[2],R[0]=yt[0]+he[0],R[1]=yt[1]+he[1],R[2]=yt[2]+he[2],R}function ve(R,q){var he=R[0],Ve=R[1],Ye=R[2],yt=q[0],it=q[1],Nt=q[2],$=Math.sqrt(he*he+Ve*Ve+Ye*Ye),$e=Math.sqrt(yt*yt+it*it+Nt*Nt),ie=$*$e,qe=ie&&mt(R,q)/ie;return Math.acos(Math.min(Math.max(qe,-1),1))}function ce(R){return R[0]=0,R[1]=0,R[2]=0,R}function fe(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"}function ke(R,q){return R[0]===q[0]&&R[1]===q[1]&&R[2]===q[2]}function lt(R,q){var he=R[0],Ve=R[1],Ye=R[2],yt=q[0],it=q[1],Nt=q[2];return Math.abs(he-yt)<=b.b*Math.max(1,Math.abs(he),Math.abs(yt))&&Math.abs(Ve-it)<=b.b*Math.max(1,Math.abs(Ve),Math.abs(it))&&Math.abs(Ye-Nt)<=b.b*Math.max(1,Math.abs(Ye),Math.abs(Nt))}var nt=re,le=we,ye=J,He=Mt,ft=Et,De=F,Ze=St,w=function(){var R=v();return function(q,he,Ve,Ye,yt,it){var Nt,$;for(he||(he=3),Ve||(Ve=0),Ye?$=Math.min(Ye*he+Ve,q.length):$=q.length,Nt=Ve;Nt<$;Nt+=he)R[0]=q[Nt],R[1]=q[Nt+1],R[2]=q[Nt+2],yt(R,R,it),q[Nt]=R[0],q[Nt+1]=R[1],q[Nt+2]=R[2];return q}}()},n2J3:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.unmanaged=void 0;var b=o("xfSm"),v=o("GXnB"),Z=o("Ztfv");function F(){return function(a,Y,B){var Q=new v.Metadata(b.UNMANAGED_TAG,!0);Z.tagParameter(a,Y,B,Q)}}x.unmanaged=F},n3AX:function(Ie,x,o){var b=o("Nsbk");function v(Z,F){for(;!Object.prototype.hasOwnProperty.call(Z,F)&&(Z=b(Z),Z!==null););return Z}Ie.exports=v},"o+pz":function(Ie,x,o){"use strict";o.d(x,"a",function(){return b});var b;(function(v){v[v.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",v[v.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",v[v.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",v[v.POINTS=0]="POINTS",v[v.LINES=1]="LINES",v[v.LINE_LOOP=2]="LINE_LOOP",v[v.LINE_STRIP=3]="LINE_STRIP",v[v.TRIANGLES=4]="TRIANGLES",v[v.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",v[v.TRIANGLE_FAN=6]="TRIANGLE_FAN",v[v.ZERO=0]="ZERO",v[v.ONE=1]="ONE",v[v.SRC_COLOR=768]="SRC_COLOR",v[v.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",v[v.SRC_ALPHA=770]="SRC_ALPHA",v[v.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",v[v.DST_ALPHA=772]="DST_ALPHA",v[v.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",v[v.DST_COLOR=774]="DST_COLOR",v[v.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",v[v.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",v[v.FUNC_ADD=32774]="FUNC_ADD",v[v.BLEND_EQUATION=32777]="BLEND_EQUATION",v[v.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",v[v.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",v[v.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",v[v.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",v[v.MAX_EXT=32776]="MAX_EXT",v[v.MIN_EXT=32775]="MIN_EXT",v[v.BLEND_DST_RGB=32968]="BLEND_DST_RGB",v[v.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",v[v.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",v[v.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",v[v.CONSTANT_COLOR=32769]="CONSTANT_COLOR",v[v.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",v[v.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",v[v.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",v[v.BLEND_COLOR=32773]="BLEND_COLOR",v[v.ARRAY_BUFFER=34962]="ARRAY_BUFFER",v[v.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",v[v.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",v[v.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",v[v.STREAM_DRAW=35040]="STREAM_DRAW",v[v.STATIC_DRAW=35044]="STATIC_DRAW",v[v.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",v[v.BUFFER_SIZE=34660]="BUFFER_SIZE",v[v.BUFFER_USAGE=34661]="BUFFER_USAGE",v[v.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",v[v.FRONT=1028]="FRONT",v[v.BACK=1029]="BACK",v[v.FRONT_AND_BACK=1032]="FRONT_AND_BACK",v[v.CULL_FACE=2884]="CULL_FACE",v[v.BLEND=3042]="BLEND",v[v.DITHER=3024]="DITHER",v[v.STENCIL_TEST=2960]="STENCIL_TEST",v[v.DEPTH_TEST=2929]="DEPTH_TEST",v[v.SCISSOR_TEST=3089]="SCISSOR_TEST",v[v.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",v[v.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",v[v.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",v[v.NO_ERROR=0]="NO_ERROR",v[v.INVALID_ENUM=1280]="INVALID_ENUM",v[v.INVALID_VALUE=1281]="INVALID_VALUE",v[v.INVALID_OPERATION=1282]="INVALID_OPERATION",v[v.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",v[v.CW=2304]="CW",v[v.CCW=2305]="CCW",v[v.LINE_WIDTH=2849]="LINE_WIDTH",v[v.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",v[v.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",v[v.CULL_FACE_MODE=2885]="CULL_FACE_MODE",v[v.FRONT_FACE=2886]="FRONT_FACE",v[v.DEPTH_RANGE=2928]="DEPTH_RANGE",v[v.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",v[v.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",v[v.DEPTH_FUNC=2932]="DEPTH_FUNC",v[v.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",v[v.STENCIL_FUNC=2962]="STENCIL_FUNC",v[v.STENCIL_FAIL=2964]="STENCIL_FAIL",v[v.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",v[v.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",v[v.STENCIL_REF=2967]="STENCIL_REF",v[v.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",v[v.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",v[v.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",v[v.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",v[v.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",v[v.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",v[v.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",v[v.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",v[v.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",v[v.VIEWPORT=2978]="VIEWPORT",v[v.SCISSOR_BOX=3088]="SCISSOR_BOX",v[v.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",v[v.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",v[v.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",v[v.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",v[v.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",v[v.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",v[v.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",v[v.RED_BITS=3410]="RED_BITS",v[v.GREEN_BITS=3411]="GREEN_BITS",v[v.BLUE_BITS=3412]="BLUE_BITS",v[v.ALPHA_BITS=3413]="ALPHA_BITS",v[v.DEPTH_BITS=3414]="DEPTH_BITS",v[v.STENCIL_BITS=3415]="STENCIL_BITS",v[v.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",v[v.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",v[v.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",v[v.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",v[v.SAMPLES=32937]="SAMPLES",v[v.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",v[v.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",v[v.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",v[v.DONT_CARE=4352]="DONT_CARE",v[v.FASTEST=4353]="FASTEST",v[v.NICEST=4354]="NICEST",v[v.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",v[v.BYTE=5120]="BYTE",v[v.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",v[v.SHORT=5122]="SHORT",v[v.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",v[v.INT=5124]="INT",v[v.UNSIGNED_INT=5125]="UNSIGNED_INT",v[v.FLOAT=5126]="FLOAT",v[v.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",v[v.ALPHA=6406]="ALPHA",v[v.RGB=6407]="RGB",v[v.RGBA=6408]="RGBA",v[v.LUMINANCE=6409]="LUMINANCE",v[v.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",v[v.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",v[v.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",v[v.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",v[v.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",v[v.VERTEX_SHADER=35633]="VERTEX_SHADER",v[v.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",v[v.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",v[v.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",v[v.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",v[v.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",v[v.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",v[v.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",v[v.SHADER_TYPE=35663]="SHADER_TYPE",v[v.DELETE_STATUS=35712]="DELETE_STATUS",v[v.LINK_STATUS=35714]="LINK_STATUS",v[v.VALIDATE_STATUS=35715]="VALIDATE_STATUS",v[v.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",v[v.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",v[v.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",v[v.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",v[v.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",v[v.NEVER=512]="NEVER",v[v.LESS=513]="LESS",v[v.EQUAL=514]="EQUAL",v[v.LEQUAL=515]="LEQUAL",v[v.GREATER=516]="GREATER",v[v.NOTEQUAL=517]="NOTEQUAL",v[v.GEQUAL=518]="GEQUAL",v[v.ALWAYS=519]="ALWAYS",v[v.KEEP=7680]="KEEP",v[v.REPLACE=7681]="REPLACE",v[v.INCR=7682]="INCR",v[v.DECR=7683]="DECR",v[v.INVERT=5386]="INVERT",v[v.INCR_WRAP=34055]="INCR_WRAP",v[v.DECR_WRAP=34056]="DECR_WRAP",v[v.VENDOR=7936]="VENDOR",v[v.RENDERER=7937]="RENDERER",v[v.VERSION=7938]="VERSION",v[v.NEAREST=9728]="NEAREST",v[v.LINEAR=9729]="LINEAR",v[v.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",v[v.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",v[v.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",v[v.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",v[v.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",v[v.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",v[v.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",v[v.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",v[v.TEXTURE_2D=3553]="TEXTURE_2D",v[v.TEXTURE=5890]="TEXTURE",v[v.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",v[v.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",v[v.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",v[v.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",v[v.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",v[v.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",v[v.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",v[v.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",v[v.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",v[v.TEXTURE0=33984]="TEXTURE0",v[v.TEXTURE1=33985]="TEXTURE1",v[v.TEXTURE2=33986]="TEXTURE2",v[v.TEXTURE3=33987]="TEXTURE3",v[v.TEXTURE4=33988]="TEXTURE4",v[v.TEXTURE5=33989]="TEXTURE5",v[v.TEXTURE6=33990]="TEXTURE6",v[v.TEXTURE7=33991]="TEXTURE7",v[v.TEXTURE8=33992]="TEXTURE8",v[v.TEXTURE9=33993]="TEXTURE9",v[v.TEXTURE10=33994]="TEXTURE10",v[v.TEXTURE11=33995]="TEXTURE11",v[v.TEXTURE12=33996]="TEXTURE12",v[v.TEXTURE13=33997]="TEXTURE13",v[v.TEXTURE14=33998]="TEXTURE14",v[v.TEXTURE15=33999]="TEXTURE15",v[v.TEXTURE16=34e3]="TEXTURE16",v[v.TEXTURE17=34001]="TEXTURE17",v[v.TEXTURE18=34002]="TEXTURE18",v[v.TEXTURE19=34003]="TEXTURE19",v[v.TEXTURE20=34004]="TEXTURE20",v[v.TEXTURE21=34005]="TEXTURE21",v[v.TEXTURE22=34006]="TEXTURE22",v[v.TEXTURE23=34007]="TEXTURE23",v[v.TEXTURE24=34008]="TEXTURE24",v[v.TEXTURE25=34009]="TEXTURE25",v[v.TEXTURE26=34010]="TEXTURE26",v[v.TEXTURE27=34011]="TEXTURE27",v[v.TEXTURE28=34012]="TEXTURE28",v[v.TEXTURE29=34013]="TEXTURE29",v[v.TEXTURE30=34014]="TEXTURE30",v[v.TEXTURE31=34015]="TEXTURE31",v[v.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",v[v.REPEAT=10497]="REPEAT",v[v.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",v[v.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",v[v.FLOAT_VEC2=35664]="FLOAT_VEC2",v[v.FLOAT_VEC3=35665]="FLOAT_VEC3",v[v.FLOAT_VEC4=35666]="FLOAT_VEC4",v[v.INT_VEC2=35667]="INT_VEC2",v[v.INT_VEC3=35668]="INT_VEC3",v[v.INT_VEC4=35669]="INT_VEC4",v[v.BOOL=35670]="BOOL",v[v.BOOL_VEC2=35671]="BOOL_VEC2",v[v.BOOL_VEC3=35672]="BOOL_VEC3",v[v.BOOL_VEC4=35673]="BOOL_VEC4",v[v.FLOAT_MAT2=35674]="FLOAT_MAT2",v[v.FLOAT_MAT3=35675]="FLOAT_MAT3",v[v.FLOAT_MAT4=35676]="FLOAT_MAT4",v[v.SAMPLER_2D=35678]="SAMPLER_2D",v[v.SAMPLER_CUBE=35680]="SAMPLER_CUBE",v[v.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",v[v.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",v[v.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",v[v.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",v[v.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",v[v.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",v[v.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",v[v.COMPILE_STATUS=35713]="COMPILE_STATUS",v[v.LOW_FLOAT=36336]="LOW_FLOAT",v[v.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",v[v.HIGH_FLOAT=36338]="HIGH_FLOAT",v[v.LOW_INT=36339]="LOW_INT",v[v.MEDIUM_INT=36340]="MEDIUM_INT",v[v.HIGH_INT=36341]="HIGH_INT",v[v.FRAMEBUFFER=36160]="FRAMEBUFFER",v[v.RENDERBUFFER=36161]="RENDERBUFFER",v[v.RGBA4=32854]="RGBA4",v[v.RGB5_A1=32855]="RGB5_A1",v[v.RGB565=36194]="RGB565",v[v.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",v[v.STENCIL_INDEX=6401]="STENCIL_INDEX",v[v.STENCIL_INDEX8=36168]="STENCIL_INDEX8",v[v.DEPTH_STENCIL=34041]="DEPTH_STENCIL",v[v.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",v[v.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",v[v.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",v[v.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",v[v.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",v[v.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",v[v.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",v[v.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",v[v.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",v[v.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",v[v.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",v[v.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",v[v.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",v[v.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",v[v.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",v[v.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",v[v.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",v[v.NONE=0]="NONE",v[v.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",v[v.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",v[v.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",v[v.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",v[v.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",v[v.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",v[v.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",v[v.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",v[v.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",v[v.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",v[v.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",v[v.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",v[v.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",v[v.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(b||(b={}))},"oCl/":function(Ie,x,o){var b=o("CH3K"),v=o("LcsW"),Z=o("MvSz"),F=o("0ycA"),a=Object.getOwnPropertySymbols,Y=a?function(B){for(var Q=[];B;)b(Q,Z(B)),B=v(B);return Q}:F;Ie.exports=Y},oIFs:function(Ie,x,o){Ie.exports={"ant-skeleton":"ant-skeleton","ant-skeleton-header":"ant-skeleton-header","ant-skeleton-avatar":"ant-skeleton-avatar","ant-skeleton-avatar-circle":"ant-skeleton-avatar-circle","ant-skeleton-avatar-lg":"ant-skeleton-avatar-lg","ant-skeleton-avatar-sm":"ant-skeleton-avatar-sm","ant-skeleton-content":"ant-skeleton-content","ant-skeleton-title":"ant-skeleton-title","ant-skeleton-paragraph":"ant-skeleton-paragraph","ant-skeleton-with-avatar":"ant-skeleton-with-avatar","ant-skeleton-round":"ant-skeleton-round","ant-skeleton-active":"ant-skeleton-active","ant-skeleton-loading":"ant-skeleton-loading","ant-skeleton-button":"ant-skeleton-button","ant-skeleton-input":"ant-skeleton-input","ant-skeleton-image":"ant-skeleton-image","ant-skeleton-element":"ant-skeleton-element","ant-skeleton-button-circle":"ant-skeleton-button-circle","ant-skeleton-button-round":"ant-skeleton-button-round","ant-skeleton-button-lg":"ant-skeleton-button-lg","ant-skeleton-button-sm":"ant-skeleton-button-sm","ant-skeleton-input-lg":"ant-skeleton-input-lg","ant-skeleton-input-sm":"ant-skeleton-input-sm","ant-skeleton-image-circle":"ant-skeleton-image-circle","ant-skeleton-image-path":"ant-skeleton-image-path","ant-skeleton-image-svg":"ant-skeleton-image-svg","ant-skeleton-rtl":"ant-skeleton-rtl","ant-skeleton-loading-rtl":"ant-skeleton-loading-rtl"}},oShl:function(Ie,x,o){var b=o("Nsbk"),v=o("SksO"),Z=o("xfeJ"),F=o("sXyB");function a(Y){var B=typeof Map=="function"?new Map:void 0;return Ie.exports=a=function(re){if(re===null||!Z(re))return re;if(typeof re!="function")throw new TypeError("Super expression must either be null or a function");if(typeof B!="undefined"){if(B.has(re))return B.get(re);B.set(re,we)}function we(){return F(re,arguments,b(this).constructor)}return we.prototype=Object.create(re.prototype,{constructor:{value:we,enumerable:!1,writable:!0,configurable:!0}}),v(we,re)},a(Y)}Ie.exports=a},oaX6:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.targetName=void 0;var b=o("xfSm"),v=o("GXnB"),Z=o("Ztfv");function F(a){return function(Y,B,Q){var re=new v.Metadata(b.NAME_TAG,a);Z.tagParameter(Y,B,Q,re)}}x.targetName=F},"otv/":function(Ie,x,o){var b=o("nmnc"),v=b?b.prototype:void 0,Z=v?v.valueOf:void 0;function F(a){return Z?Object(Z.call(a)):{}}Ie.exports=F},"oy+k":function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Context=void 0;var b=o("d9O0"),v=function(){function Z(F){this.id=b.id(),this.container=F}return Z.prototype.addPlan=function(F){this.plan=F},Z.prototype.setCurrentRequest=function(F){this.currentRequest=F},Z}();x.Context=v},pFRH:function(Ie,x,o){var b=o("cvCv"),v=o("O0oS"),Z=o("zZ0H"),F=v?function(a,Y){return v(a,"toString",{configurable:!0,enumerable:!1,value:b(Y),writable:!0})}:Z;Ie.exports=F},q4HE:function(Ie,x){var o="\\ud800-\\udfff",b="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",F=b+v+Z,a="\\ufe0e\\ufe0f",Y="["+o+"]",B="["+F+"]",Q="\\ud83c[\\udffb-\\udfff]",re="(?:"+B+"|"+Q+")",we="[^"+o+"]",J="(?:\\ud83c[\\udde6-\\uddff]){2}",Ke="[\\ud800-\\udbff][\\udc00-\\udfff]",Ge="\\u200d",_e=re+"?",Re="["+a+"]?",at="(?:"+Ge+"(?:"+[we,J,Ke].join("|")+")"+Re+_e+")*",Oe=Re+_e+at,xt="(?:"+[we+B+"?",B,J,Ke,Y].join("|")+")",Mt=RegExp(Q+"(?="+Q+")|"+xt+Oe,"g");function Et(St){for(var or=Mt.lastIndex=0;Mt.test(St);)++or;return or}Ie.exports=Et},qK8v:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.isStackOverflowExeption=void 0;var b=o("MON2");function v(Z){return Z instanceof RangeError||Z.message===b.STACK_OVERFLOW}x.isStackOverflowExeption=v},qRkn:function(Ie,x,o){var b=o("3cYt"),v={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Z=b(v);Ie.exports=Z},qd8s:function(Ie,x,o){(function(b,v){var Z=200,F="__lodash_hash_undefined__",a=800,Y=16,B=9007199254740991,Q="[object Arguments]",re="[object Array]",we="[object AsyncFunction]",J="[object Boolean]",Ke="[object Date]",Ge="[object Error]",_e="[object Function]",Re="[object GeneratorFunction]",at="[object Map]",Oe="[object Number]",xt="[object Null]",Mt="[object Object]",Et="[object Proxy]",St="[object RegExp]",or="[object Set]",$t="[object String]",Ht="[object Undefined]",mt="[object WeakMap]",Xe="[object ArrayBuffer]",Tt="[object DataView]",ze="[object Float32Array]",st="[object Float64Array]",Wt="[object Int8Array]",bt="[object Int16Array]",dt="[object Int32Array]",H="[object Uint8Array]",z="[object Uint8ClampedArray]",V="[object Uint16Array]",Se="[object Uint32Array]",ve=/[\\^$.*+?()[\]{}|]/g,ce=/^\[object .+?Constructor\]$/,fe=/^(?:0|[1-9]\d*)$/,ke={};ke[ze]=ke[st]=ke[Wt]=ke[bt]=ke[dt]=ke[H]=ke[z]=ke[V]=ke[Se]=!0,ke[Q]=ke[re]=ke[Xe]=ke[J]=ke[Tt]=ke[Ke]=ke[Ge]=ke[_e]=ke[at]=ke[Oe]=ke[Mt]=ke[St]=ke[or]=ke[$t]=ke[mt]=!1;var lt=typeof b=="object"&&b&&b.Object===Object&&b,nt=typeof self=="object"&&self&&self.Object===Object&&self,le=lt||nt||Function("return this")(),ye=x&&!x.nodeType&&x,He=ye&&typeof v=="object"&&v&&!v.nodeType&&v,ft=He&&He.exports===ye,De=ft&&lt.process,Ze=function(){try{var It=He&&He.require&&He.require("util").types;return It||De&&De.binding&&De.binding("util")}catch(ir){}}(),w=Ze&&Ze.isTypedArray;function R(It,ir,Mr){switch(Mr.length){case 0:return It.call(ir);case 1:return It.call(ir,Mr[0]);case 2:return It.call(ir,Mr[0],Mr[1]);case 3:return It.call(ir,Mr[0],Mr[1],Mr[2])}return It.apply(ir,Mr)}function q(It,ir){for(var Mr=-1,Gn=Array(It);++Mr<It;)Gn[Mr]=ir(Mr);return Gn}function he(It){return function(ir){return It(ir)}}function Ve(It,ir){return It==null?void 0:It[ir]}function Ye(It,ir){return function(Mr){return It(ir(Mr))}}var yt=Array.prototype,it=Function.prototype,Nt=Object.prototype,$=le["__core-js_shared__"],$e=it.toString,ie=Nt.hasOwnProperty,qe=function(){var It=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||"");return It?"Symbol(src)_1."+It:""}(),jt=Nt.toString,lr=$e.call(Object),ct=RegExp("^"+$e.call(ie).replace(ve,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ht=ft?le.Buffer:void 0,Pt=le.Symbol,vt=le.Uint8Array,Pe=ht?ht.allocUnsafe:void 0,ut=Ye(Object.getPrototypeOf,Object),Qe=Object.create,Vt=Nt.propertyIsEnumerable,pr=yt.splice,Zr=Pt?Pt.toStringTag:void 0,cr=function(){try{var It=Ks(Object,"defineProperty");return It({},"",{}),It}catch(ir){}}(),jn=ht?ht.isBuffer:void 0,En=Math.max,ni=Date.now,fi=Ks(le,"Map"),Zn=Ks(Object,"create"),Vn=function(){function It(){}return function(ir){if(!fo(ir))return{};if(Qe)return Qe(ir);It.prototype=ir;var Mr=new It;return It.prototype=void 0,Mr}}();function Te(It){var ir=-1,Mr=It==null?0:It.length;for(this.clear();++ir<Mr;){var Gn=It[ir];this.set(Gn[0],Gn[1])}}function de(){this.__data__=Zn?Zn(null):{},this.size=0}function W(It){var ir=this.has(It)&&delete this.__data__[It];return this.size-=ir?1:0,ir}function se(It){var ir=this.__data__;if(Zn){var Mr=ir[It];return Mr===F?void 0:Mr}return ie.call(ir,It)?ir[It]:void 0}function Le(It){var ir=this.__data__;return Zn?ir[It]!==void 0:ie.call(ir,It)}function et(It,ir){var Mr=this.__data__;return this.size+=this.has(It)?0:1,Mr[It]=Zn&&ir===void 0?F:ir,this}Te.prototype.clear=de,Te.prototype.delete=W,Te.prototype.get=se,Te.prototype.has=Le,Te.prototype.set=et;function wt(It){var ir=-1,Mr=It==null?0:It.length;for(this.clear();++ir<Mr;){var Gn=It[ir];this.set(Gn[0],Gn[1])}}function Ne(){this.__data__=[],this.size=0}function gt(It){var ir=this.__data__,Mr=Ka(ir,It);if(Mr<0)return!1;var Gn=ir.length-1;return Mr==Gn?ir.pop():pr.call(ir,Mr,1),--this.size,!0}function qt(It){var ir=this.__data__,Mr=Ka(ir,It);return Mr<0?void 0:ir[Mr][1]}function zr(It){return Ka(this.__data__,It)>-1}function Br(It,ir){var Mr=this.__data__,Gn=Ka(Mr,It);return Gn<0?(++this.size,Mr.push([It,ir])):Mr[Gn][1]=ir,this}wt.prototype.clear=Ne,wt.prototype.delete=gt,wt.prototype.get=qt,wt.prototype.has=zr,wt.prototype.set=Br;function sr(It){var ir=-1,Mr=It==null?0:It.length;for(this.clear();++ir<Mr;){var Gn=It[ir];this.set(Gn[0],Gn[1])}}function kr(){this.size=0,this.__data__={hash:new Te,map:new(fi||wt),string:new Te}}function Cn(It){var ir=co(this,It).delete(It);return this.size-=ir?1:0,ir}function dn(It){return co(this,It).get(It)}function Er(It){return co(this,It).has(It)}function Tn(It,ir){var Mr=co(this,It),Gn=Mr.size;return Mr.set(It,ir),this.size+=Mr.size==Gn?0:1,this}sr.prototype.clear=kr,sr.prototype.delete=Cn,sr.prototype.get=dn,sr.prototype.has=Er,sr.prototype.set=Tn;function vn(It){var ir=this.__data__=new wt(It);this.size=ir.size}function mn(){this.__data__=new wt,this.size=0}function Ar(It){var ir=this.__data__,Mr=ir.delete(It);return this.size=ir.size,Mr}function $r(It){return this.__data__.get(It)}function Mn(It){return this.__data__.has(It)}function Ki(It,ir){var Mr=this.__data__;if(Mr instanceof wt){var Gn=Mr.__data__;if(!fi||Gn.length<Z-1)return Gn.push([It,ir]),this.size=++Mr.size,this;Mr=this.__data__=new sr(Gn)}return Mr.set(It,ir),this.size=Mr.size,this}vn.prototype.clear=mn,vn.prototype.delete=Ar,vn.prototype.get=$r,vn.prototype.has=Mn,vn.prototype.set=Ki;function vi(It,ir){var Mr=Wl(It),Gn=!Mr&&Vu(It),Qi=!Mr&&!Gn&&Il(It),za=!Mr&&!Gn&&!Qi&&lu(It),Za=Mr||Gn||Qi||za,qi=Za?q(It.length,String):[],ba=qi.length;for(var _o in It)(ir||ie.call(It,_o))&&!(Za&&(_o=="length"||Qi&&(_o=="offset"||_o=="parent")||za&&(_o=="buffer"||_o=="byteLength"||_o=="byteOffset")||$s(_o,ba)))&&qi.push(_o);return qi}function Mi(It,ir,Mr){(Mr!==void 0&&!Fo(It[ir],Mr)||Mr===void 0&&!(ir in It))&&hi(It,ir,Mr)}function zi(It,ir,Mr){var Gn=It[ir];(!(ie.call(It,ir)&&Fo(Gn,Mr))||Mr===void 0&&!(ir in It))&&hi(It,ir,Mr)}function Ka(It,ir){for(var Mr=It.length;Mr--;)if(Fo(It[Mr][0],ir))return Mr;return-1}function hi(It,ir,Mr){ir=="__proto__"&&cr?cr(It,ir,{configurable:!0,enumerable:!0,value:Mr,writable:!0}):It[ir]=Mr}var ya=lo();function Ii(It){return It==null?It===void 0?Ht:xt:Zr&&Zr in Object(It)?wo(It):rn(It)}function yi(It){return ds(It)&&Ii(It)==Q}function ci(It){if(!fo(It)||Fe(It))return!1;var ir=hs(It)?ct:ce;return ir.test(bo(It))}function Ra(It){return ds(It)&&Ns(It.length)&&!!ke[Ii(It)]}function xo(It){if(!fo(It))return fr(It);var ir=Ot(It),Mr=[];for(var Gn in It)Gn=="constructor"&&(ir||!ie.call(It,Gn))||Mr.push(Gn);return Mr}function $a(It,ir,Mr,Gn,Qi){It!==ir&&ya(ir,function(za,Za){if(Qi||(Qi=new vn),fo(za))Ko(It,ir,Za,Mr,$a,Gn,Qi);else{var qi=Gn?Gn(Un(It,Za),za,Za+"",It,ir,Qi):void 0;qi===void 0&&(qi=za),Mi(It,Za,qi)}},xa)}function Ko(It,ir,Mr,Gn,Qi,za,Za){var qi=Un(It,Mr),ba=Un(ir,Mr),_o=Za.get(ba);if(_o){Mi(It,Mr,_o);return}var Bs=za?za(qi,ba,Mr+"",It,ir,Za):void 0,ha=Bs===void 0;if(ha){var Yl=Wl(ba),cu=!Yl&&Il(ba),_s=!Yl&&!cu&&lu(ba);Bs=ba,Yl||cu||_s?Wl(qi)?Bs=qi:Ic(qi)?Bs=Ja(qi):cu?(ha=!1,Bs=Pa(ba,!0)):_s?(ha=!1,Bs=na(ba,!0)):Bs=[]:Qs(ba)||Vu(ba)?(Bs=qi,Vu(qi)?Bs=Xl(qi):(!fo(qi)||hs(qi))&&(Bs=Zl(ba))):ha=!1}ha&&(Za.set(ba,Bs),Qi(Bs,ba,Gn,za,Za),Za.delete(ba)),Mi(It,Mr,Bs)}function Uu(It,ir){return Da(bn(It,ir,Fs),It+"")}var Gi=cr?function(It,ir){return cr(It,"toString",{configurable:!0,enumerable:!1,value:ml(ir),writable:!0})}:Fs;function Pa(It,ir){if(ir)return It.slice();var Mr=It.length,Gn=Pe?Pe(Mr):new It.constructor(Mr);return It.copy(Gn),Gn}function ns(It){var ir=new It.constructor(It.byteLength);return new vt(ir).set(new vt(It)),ir}function na(It,ir){var Mr=ir?ns(It.buffer):It.buffer;return new It.constructor(Mr,It.byteOffset,It.length)}function Ja(It,ir){var Mr=-1,Gn=It.length;for(ir||(ir=Array(Gn));++Mr<Gn;)ir[Mr]=It[Mr];return ir}function is(It,ir,Mr,Gn){var Qi=!Mr;Mr||(Mr={});for(var za=-1,Za=ir.length;++za<Za;){var qi=ir[za],ba=Gn?Gn(Mr[qi],It[qi],qi,Mr,It):void 0;ba===void 0&&(ba=It[qi]),Qi?hi(Mr,qi,ba):zi(Mr,qi,ba)}return Mr}function Ji(It){return Uu(function(ir,Mr){var Gn=-1,Qi=Mr.length,za=Qi>1?Mr[Qi-1]:void 0,Za=Qi>2?Mr[2]:void 0;for(za=It.length>3&&typeof za=="function"?(Qi--,za):void 0,Za&&Po(Mr[0],Mr[1],Za)&&(za=Qi<3?void 0:za,Qi=1),ir=Object(ir);++Gn<Qi;){var qi=Mr[Gn];qi&&It(ir,qi,Gn,za)}return ir})}function lo(It){return function(ir,Mr,Gn){for(var Qi=-1,za=Object(ir),Za=Gn(ir),qi=Za.length;qi--;){var ba=Za[It?qi:++Qi];if(Mr(za[ba],ba,za)===!1)break}return ir}}function co(It,ir){var Mr=It.__data__;return Bt(ir)?Mr[typeof ir=="string"?"string":"hash"]:Mr.map}function Ks(It,ir){var Mr=Ve(It,ir);return ci(Mr)?Mr:void 0}function wo(It){var ir=ie.call(It,Zr),Mr=It[Zr];try{It[Zr]=void 0;var Gn=!0}catch(za){}var Qi=jt.call(It);return Gn&&(ir?It[Zr]=Mr:delete It[Zr]),Qi}function Zl(It){return typeof It.constructor=="function"&&!Ot(It)?Vn(ut(It)):{}}function $s(It,ir){var Mr=typeof It;return ir=ir==null?B:ir,!!ir&&(Mr=="number"||Mr!="symbol"&&fe.test(It))&&It>-1&&It%1==0&&It<ir}function Po(It,ir,Mr){if(!fo(Mr))return!1;var Gn=typeof ir;return(Gn=="number"?Js(Mr)&&$s(ir,Mr.length):Gn=="string"&&ir in Mr)?Fo(Mr[ir],It):!1}function Bt(It){var ir=typeof It;return ir=="string"||ir=="number"||ir=="symbol"||ir=="boolean"?It!=="__proto__":It===null}function Fe(It){return!!qe&&qe in It}function Ot(It){var ir=It&&It.constructor,Mr=typeof ir=="function"&&ir.prototype||Nt;return It===Mr}function fr(It){var ir=[];if(It!=null)for(var Mr in Object(It))ir.push(Mr);return ir}function rn(It){return jt.call(It)}function bn(It,ir,Mr){return ir=En(ir===void 0?It.length-1:ir,0),function(){for(var Gn=arguments,Qi=-1,za=En(Gn.length-ir,0),Za=Array(za);++Qi<za;)Za[Qi]=Gn[ir+Qi];Qi=-1;for(var qi=Array(ir+1);++Qi<ir;)qi[Qi]=Gn[Qi];return qi[ir]=Mr(Za),R(It,this,qi)}}function Un(It,ir){if(!(ir==="constructor"&&typeof It[ir]=="function")&&ir!="__proto__")return It[ir]}var Da=ao(Gi);function ao(It){var ir=0,Mr=0;return function(){var Gn=ni(),Qi=Y-(Gn-Mr);if(Mr=Gn,Qi>0){if(++ir>=a)return arguments[0]}else ir=0;return It.apply(void 0,arguments)}}function bo(It){if(It!=null){try{return $e.call(It)}catch(ir){}try{return It+""}catch(ir){}}return""}function Fo(It,ir){return It===ir||It!==It&&ir!==ir}var Vu=yi(function(){return arguments}())?yi:function(It){return ds(It)&&ie.call(It,"callee")&&!Vt.call(It,"callee")},Wl=Array.isArray;function Js(It){return It!=null&&Ns(It.length)&&!hs(It)}function Ic(It){return ds(It)&&Js(It)}var Il=jn||ps;function hs(It){if(!fo(It))return!1;var ir=Ii(It);return ir==_e||ir==Re||ir==we||ir==Et}function Ns(It){return typeof It=="number"&&It>-1&&It%1==0&&It<=B}function fo(It){var ir=typeof It;return It!=null&&(ir=="object"||ir=="function")}function ds(It){return It!=null&&typeof It=="object"}function Qs(It){if(!ds(It)||Ii(It)!=Mt)return!1;var ir=ut(It);if(ir===null)return!0;var Mr=ie.call(ir,"constructor")&&ir.constructor;return typeof Mr=="function"&&Mr instanceof Mr&&$e.call(Mr)==lr}var lu=w?he(w):Ra;function Xl(It){return is(It,xa(It))}function xa(It){return Js(It)?vi(It,!0):xo(It)}var ka=Ji(function(It,ir,Mr,Gn){$a(It,ir,Mr,Gn)});function ml(It){return function(){return It}}function Fs(It){return It}function ps(){return!1}v.exports=ka}).call(this,o("yLpj"),o("YuTi")(Ie))},quyA:function(Ie,x){var o="\\ud800-\\udfff",b="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",F=b+v+Z,a="\\ufe0e\\ufe0f",Y="\\u200d",B=RegExp("["+Y+o+F+a+"]");function Q(re){return B.test(re)}Ie.exports=Q},qxNg:function(Ie,x,o){"use strict";o.d(x,"a",function(){return B});var b=o("lSNA"),v=o.n(b),Z=o("mpbz"),F=o.n(Z);function a(re,we){var J=Object.keys(re);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(re);we&&(Ke=Ke.filter(function(Ge){return Object.getOwnPropertyDescriptor(re,Ge).enumerable})),J.push.apply(J,Ke)}return J}function Y(re){for(var we=1;we<arguments.length;we++){var J=arguments[we]!=null?arguments[we]:{};we%2?a(Object(J),!0).forEach(function(Ke){v()(re,Ke,J[Ke])}):Object.getOwnPropertyDescriptors?Object.defineProperties(re,Object.getOwnPropertyDescriptors(J)):a(Object(J)).forEach(function(Ke){Object.defineProperty(re,Ke,Object.getOwnPropertyDescriptor(J,Ke))})}return re}function B(re,we){var J=we.radius,Ke=J===void 0?40:J,Ge=we.maxZoom,_e=Ge===void 0?18:Ge,Re=we.minZoom,at=Re===void 0?0:Re,Oe=we.zoom,xt=Oe===void 0?2:Oe;if(re.pointIndex){var Mt=re.pointIndex.getClusters(re.extent,Math.floor(xt));return re.dataArray=Q(Mt),re}var Et=new F.a({radius:Ke,minZoom:at,maxZoom:_e}),St={type:"FeatureCollection",features:[]};return St.features=re.dataArray.map(function(or){return{type:"Feature",geometry:{type:"Point",coordinates:or.coordinates},properties:Y({},or)}}),Et.load(St.features),Et}function Q(re){return re.map(function(we,J){return Y({coordinates:we.geometry.coordinates,_id:J+1},we.properties)})}},riiI:function(Ie,x){},rlAn:function(Ie,x,o){"use strict";var b=o("ISu3"),v=o("gMG2"),Z=o("5gLl"),F=o("BpBL"),a=o("5zYK"),Y=o("lJbI"),B=o("l94r"),Q=o("qxNg"),re=o("Y8BV"),we=o("VIsB"),J=o("+VLl"),Ke=o("aF1E"),Ge=o("fdMe");o.d(x,"getTransform",function(){return b.b}),o.d(x,"getParser",function(){return b.a});var _e=o("U1ZX"),Re=o.n(_e);x.default=B.a,Object(b.c)("geojson",Z.a),Object(b.c)("image",F.a),Object(b.c)("csv",v.a),Object(b.c)("json",a.a),Object(b.c)("raster",Y.a),Object(b.d)("cluster",Q.a),Object(b.d)("filter",re.a),Object(b.d)("join",Ke.a),Object(b.d)("map",Ge.a),Object(b.d)("grid",we.a),Object(b.d)("hexagon",J.a)},rxlC:function(Ie,x,o){"use strict";Ie.exports=v,Ie.exports.default=v;var b=1e20;function v(B,Q,re,we,J,Ke){this.fontSize=B||24,this.buffer=Q===void 0?3:Q,this.cutoff=we||.25,this.fontFamily=J||"sans-serif",this.fontWeight=Ke||"normal",this.radius=re||8;var Ge=this.size=this.fontSize+this.buffer*2,_e=Ge+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Ge,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(_e*_e),this.gridInner=new Float64Array(_e*_e),this.f=new Float64Array(Ge),this.z=new Float64Array(Ge+1),this.v=new Uint16Array(Ge),this.middle=Math.round(Ge/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Z(B,Q,re,we,J,Ke,Ge){Ke.fill(b,0,Q*re),Ge.fill(0,0,Q*re);for(var _e=(Q-we)/2,Re=0;Re<J;Re++)for(var at=0;at<we;at++){var Oe=(Re+_e)*Q+at+_e,xt=B.data[4*(Re*we+at)+3]/255;if(xt===1)Ke[Oe]=0,Ge[Oe]=b;else if(xt===0)Ke[Oe]=b,Ge[Oe]=0;else{var Mt=Math.max(0,.5-xt),Et=Math.max(0,xt-.5);Ke[Oe]=Mt*Mt,Ge[Oe]=Et*Et}}}function F(B,Q,re,we,J,Ke,Ge){for(var _e=0;_e<Q*re;_e++){var Re=Math.sqrt(we[_e])-Math.sqrt(J[_e]);B[_e]=Math.round(255-255*(Re/Ke+Ge))}}v.prototype._draw=function(B,Q){var re=this.ctx.measureText(B),we=re.width,J=2*this.buffer,Ke,Ge,_e,Re,at,Oe,xt;Q&&re.actualBoundingBoxLeft!==void 0?(at=Math.floor(re.actualBoundingBoxAscent)-this.middle,Oe=Math.max(0,this.middle-Math.ceil(re.actualBoundingBoxAscent)),xt=this.buffer,Ge=Math.min(this.size,Math.ceil(re.actualBoundingBoxRight-re.actualBoundingBoxLeft)),Re=Math.min(this.size-Oe,Math.ceil(re.actualBoundingBoxAscent+re.actualBoundingBoxDescent)),Ke=Ge+J,_e=Re+J):(Ke=Ge=this.size,_e=Re=this.size,at=0,Oe=xt=0);var Mt;Ge&&Re&&(this.ctx.clearRect(xt,Oe,Ge,Re),this.ctx.fillText(B,this.buffer,this.middle),Mt=this.ctx.getImageData(xt,Oe,Ge,Re));var Et=new Uint8ClampedArray(Ke*_e);return Z(Mt,Ke,_e,Ge,Re,this.gridOuter,this.gridInner),a(this.gridOuter,Ke,_e,this.f,this.v,this.z),a(this.gridInner,Ke,_e,this.f,this.v,this.z),F(Et,Ke,_e,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Et,metrics:{width:Ge,height:Re,sdfWidth:Ke,sdfHeight:_e,top:at,left:0,advance:we,fontAscent:re.fontBoundingBoxAscent}}},v.prototype.draw=function(B){return this._draw(B,!1).data},v.prototype.drawWithMetrics=function(B){return this._draw(B,!0)};function a(B,Q,re,we,J,Ke){for(var Ge=0;Ge<Q;Ge++)Y(B,Ge,Q,re,we,J,Ke);for(var _e=0;_e<re;_e++)Y(B,_e*Q,1,Q,we,J,Ke)}function Y(B,Q,re,we,J,Ke,Ge){var _e,Re,at,Oe;for(Ke[0]=0,Ge[0]=-b,Ge[1]=b,_e=0;_e<we;_e++)J[_e]=B[Q+_e*re];for(_e=1,Re=0,at=0;_e<we;_e++){do Oe=Ke[Re],at=(J[_e]-J[Oe]+_e*_e-Oe*Oe)/(_e-Oe)/2;while(at<=Ge[Re]&&--Re>-1);Re++,Ke[Re]=_e,Ge[Re]=at,Ge[Re+1]=b}for(_e=0,Re=0;_e<we;_e++){for(;Ge[Re+1]<_e;)Re++;Oe=Ke[Re],B[Q+_e*re]=J[Oe]+(_e-Oe)*(_e-Oe)}}},sGsY:function(Ie,x,o){"use strict";var b=o("rePB"),v=o("wx14"),Z=o("q1tI"),F=o("TSYQ"),a=o.n(F),Y=o("H84U"),B=o("/ezw"),Q=o("B6l+"),re=o.n(Q),we=function(dt){var H=dt.value,z=dt.formatter,V=dt.precision,Se=dt.decimalSeparator,ve=dt.groupSeparator,ce=ve===void 0?"":ve,fe=dt.prefixCls,ke;if(typeof z=="function")ke=z(H);else{var lt=String(H),nt=lt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!nt||lt==="-")ke=lt;else{var le=nt[1],ye=nt[2]||"0",He=nt[4]||"";ye=ye.replace(/\B(?=(\d{3})+(?!\d))/g,ce),typeof V=="number"&&(He=re()(He,V,"0").slice(0,V)),He&&(He="".concat(Se).concat(He)),ke=[Z.createElement("span",{key:"int",className:"".concat(fe,"-content-value-int")},le,ye),He&&Z.createElement("span",{key:"decimal",className:"".concat(fe,"-content-value-decimal")},He)]}}return Z.createElement("span",{className:"".concat(fe,"-content-value")},ke)},J=we,Ke=function(dt){var H=dt.prefixCls,z=dt.className,V=dt.style,Se=dt.valueStyle,ve=dt.value,ce=ve===void 0?0:ve,fe=dt.title,ke=dt.valueRender,lt=dt.prefix,nt=dt.suffix,le=dt.loading,ye=dt.direction,He=dt.onMouseEnter,ft=dt.onMouseLeave,De=Z.createElement(J,Object(v.a)({},dt,{value:ce})),Ze=a()(H,Object(b.a)({},"".concat(H,"-rtl"),ye==="rtl"),z);return Z.createElement("div",{className:Ze,style:V,onMouseEnter:He,onMouseLeave:ft},fe&&Z.createElement("div",{className:"".concat(H,"-title")},fe),Z.createElement(B.a,{paragraph:!1,loading:le},Z.createElement("div",{style:Se,className:"".concat(H,"-content")},lt&&Z.createElement("span",{className:"".concat(H,"-content-prefix")},lt),ke?ke(De):De,nt&&Z.createElement("span",{className:"".concat(H,"-content-suffix")},nt))))};Ke.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var Ge=Object(Y.c)({prefixCls:"statistic"})(Ke),_e=Ge,Re=o("1OyB"),at=o("vuIU"),Oe=o("Ji7U"),xt=o("LK+K"),Mt=o("ODXe"),Et=o("QQZ/"),St=o.n(Et),or=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function $t(bt,dt){var H=bt,z=/\[[^\]]*]/g,V=(dt.match(z)||[]).map(function(fe){return fe.slice(1,-1)}),Se=dt.replace(z,"[]"),ve=or.reduce(function(fe,ke){var lt=Object(Mt.a)(ke,2),nt=lt[0],le=lt[1];if(fe.indexOf(nt)!==-1){var ye=Math.floor(H/le);return H-=ye*le,fe.replace(new RegExp("".concat(nt,"+"),"g"),function(He){var ft=He.length;return St()(ye.toString(),ft,"0")})}return fe},Se),ce=0;return ve.replace(z,function(){var fe=V[ce];return ce+=1,fe})}function Ht(bt,dt){var H=dt.format,z=H===void 0?"":H,V=new Date(bt).getTime(),Se=Date.now(),ve=Math.max(V-Se,0);return $t(ve,z)}var mt=o("0n0R"),Xe=1e3/30;function Tt(bt){return new Date(bt).getTime()}var ze=function(bt){Object(Oe.a)(H,bt);var dt=Object(xt.a)(H);function H(){var z;return Object(Re.a)(this,H),z=dt.apply(this,arguments),z.syncTimer=function(){var V=z.props.value,Se=Tt(V);Se>=Date.now()?z.startTimer():z.stopTimer()},z.startTimer=function(){z.countdownId||(z.countdownId=window.setInterval(function(){z.forceUpdate()},Xe))},z.stopTimer=function(){var V=z.props,Se=V.onFinish,ve=V.value;if(z.countdownId){clearInterval(z.countdownId),z.countdownId=void 0;var ce=Tt(ve);Se&&ce<Date.now()&&Se()}},z.formatCountdown=function(V,Se){var ve=z.props.format;return Ht(V,Object(v.a)(Object(v.a)({},Se),{format:ve}))},z.valueRender=function(V){return Object(mt.a)(V,{title:void 0})},z}return Object(at.a)(H,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return Z.createElement(_e,Object(v.a)({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),H}(Z.Component);ze.defaultProps={format:"HH:mm:ss"};var st=ze;_e.Countdown=st;var Wt=x.a=_e},sKgW:function(Ie,x){var o=9007199254740991,b=Math.floor;function v(Z,F){var a="";if(!Z||F<1||F>o)return a;do F%2&&(a+=Z),F=b(F/2),F&&(Z+=Z);while(F);return a}Ie.exports=v},sXyB:function(Ie,x,o){var b=o("SksO"),v=o("b48C");function Z(F,a,Y){return v()?Ie.exports=Z=Reflect.construct:Ie.exports=Z=function(Q,re,we){var J=[null];J.push.apply(J,re);var Ke=Function.bind.apply(Q,J),Ge=new Ke;return we&&b(Ge,we.prototype),Ge},Z.apply(null,arguments)}Ie.exports=Z},sgoq:function(Ie,x,o){var b=o("asDA"),v=o("TKrE"),Z=o("6nK8"),F="['\u2019]",a=RegExp(F,"g");function Y(B){return function(Q){return b(Z(v(Q).replace(a,"")),B,"")}}Ie.exports=Y},sxDa:function(Ie,x,o){"use strict";o.d(x,"e",function(){return Xu}),o.d(x,"f",function(){return ll}),o.d(x,"d",function(){return gc}),o.d(x,"a",function(){return co}),o.d(x,"c",function(){return ba}),o.d(x,"g",function(){return Bl}),o.d(x,"b",function(){return Fs});var b=o("h1nZ"),v=o("lwsE"),Z=o.n(v),F=o("W8MJ"),a=o.n(F),Y=o("7W2i"),B=o.n(Y),Q=o("a1gu"),re=o.n(Q),we=o("Nsbk"),J=o.n(we),Ke=o("QILm"),Ge=o.n(Ke),_e=o("lSNA"),Re=o.n(_e),at=o("yG8O"),Oe=o.n(at),xt=o("PJYZ"),Mt=o.n(xt),Et=o("U+yc"),St=o.n(Et),or=o("1ABj"),$t=o("GoyQ"),Ht=o.n($t),mt=o("lSCD"),Xe=o.n(mt),Tt=o("xp6e"),ze=o("Hel2"),st=o("uhBA"),Wt=o("4U9+"),bt=o.n(Wt),dt=o("4cb6"),H,z,V,Se,ve,ce;function fe(h){return h.map(function(T){return typeof T=="string"&&(T=[T,{}]),T})}var ke=(H=Object(dt.injectable)(),z=Object(dt.inject)(b.TYPES.IGlobalConfigService),H(V=(Se=(ce=function(){function h(){Z()(this,h),Oe()(this,"configService",ve,this),this.enabled=void 0}return a()(h,[{key:"apply",value:function(E,S){var C=this,M=S.rendererService,j=S.postProcessingPassFactory,ae=S.normalPassFactory;E.hooks.init.tap("MultiPassRendererPlugin",function(){var ge=E.getLayerConfig(),Ue=ge.enableMultiPassRenderer,Dt=ge.passes,Jt=Dt===void 0?[]:Dt;C.enabled=!!Ue&&E.getLayerConfig().enableMultiPassRenderer!==!1,C.enabled&&(E.multiPassRenderer=C.createMultiPassRenderer(E,Jt,j,ae),E.multiPassRenderer.setRenderFlag(!0))}),E.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(E,S,C,M){var j=E.multiPassRenderer,ae=E.getLayerConfig(),ge=ae.enablePicking,Ue=ae.enableTAA;return ge&&j.add(M("pixelPicking")),j}}]),h}(),ce),ve=St()(Se.prototype,"configService",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Se))||V),lt,nt=(lt={},Re()(lt,b.BlendType.additive,{enable:!0,func:{srcRGB:b.gl.ONE,dstRGB:b.gl.ONE,srcAlpha:1,dstAlpha:1}}),Re()(lt,b.BlendType.none,{enable:!1}),Re()(lt,b.BlendType.normal,{enable:!0,func:{srcRGB:b.gl.SRC_ALPHA,dstRGB:b.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),Re()(lt,b.BlendType.subtractive,{enable:!0,func:{srcRGB:b.gl.ONE,dstRGB:b.gl.ONE,srcAlpha:b.gl.ZERO,dstAlpha:b.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:b.gl.FUNC_SUBTRACT,alpha:b.gl.FUNC_SUBTRACT}}),Re()(lt,b.BlendType.max,{enable:!0,func:{srcRGB:b.gl.ONE,dstRGB:b.gl.ONE},equation:{rgb:b.gl.MAX_EXT}}),Re()(lt,b.BlendType.min,{enable:!0,func:{srcRGB:b.gl.ONE,dstRGB:b.gl.ONE},equation:{rgb:b.gl.MIN_EXT}}),lt),le={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},ye,He,ft,De,Ze,w,R,q;function he(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=Ve(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var S=0,C=function(){};return{s:C,n:function(){return S>=h.length?{done:!0}:{done:!1,value:h[S++]}},e:function(Ue){throw Ue},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,j=!1,ae;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ue=E.next();return M=Ue.done,Ue},e:function(Ue){j=!0,ae=Ue},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(j)throw ae}}}}function Ve(h,T){if(!!h){if(typeof h=="string")return Ye(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return Ye(h,T)}}function Ye(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,S=new Array(T);E<T;E++)S[E]=h[E];return S}function yt(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(h);T&&(S=S.filter(function(C){return Object.getOwnPropertyDescriptor(h,C).enumerable})),E.push.apply(E,S)}return E}function it(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?yt(Object(E),!0).forEach(function(S){Re()(h,S,E[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):yt(Object(E)).forEach(function(S){Object.defineProperty(h,S,Object.getOwnPropertyDescriptor(E,S))})}return h}function Nt(h){var T=$();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function $(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var $e=0,ie=(ye=Object(b.lazyInject)(b.TYPES.ILogService),He=Object(b.lazyInject)(b.TYPES.IGlobalConfigService),ft=Object(b.lazyInject)(b.TYPES.IShaderModuleService),De=(q=function(h){B()(E,h);var T=Nt(E);function E(){var S,C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Z()(this,E),S=T.call(this),S.id="".concat($e++),S.name="".concat($e),S.type=void 0,S.visible=!0,S.zIndex=0,S.minZoom=void 0,S.maxZoom=void 0,S.inited=!1,S.layerModelNeedUpdate=!1,S.pickedFeatureID=null,S.selectedFeatureID=null,S.styleNeedUpdate=!1,S.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},S.hooks={init:new Tt.b,afterInit:new Tt.b,beforeRender:new Tt.b,beforeRenderData:new Tt.d,afterRender:new Tt.c,beforePickingEncode:new Tt.c,afterPickingEncode:new Tt.c,beforeHighlight:new Tt.c(["pickedColor"]),afterHighlight:new Tt.c,beforeSelect:new Tt.c(["pickedColor"]),afterSelect:new Tt.c,beforeDestroy:new Tt.c,afterDestroy:new Tt.c},S.models=[],S.multiPassRenderer=void 0,S.plugins=void 0,S.sourceOption=void 0,S.layerModel=void 0,Oe()(S,"logger",Ze,Mt()(S)),Oe()(S,"configService",w,Mt()(S)),Oe()(S,"shaderModuleService",R,Mt()(S)),S.cameraService=void 0,S.coordinateService=void 0,S.iconService=void 0,S.fontService=void 0,S.pickingService=void 0,S.rendererService=void 0,S.layerService=void 0,S.interactionService=void 0,S.mapService=void 0,S.styleAttributeService=void 0,S.layerSource=void 0,S.postProcessingPassFactory=void 0,S.normalPassFactory=void 0,S.animateOptions={enable:!1},S.container=void 0,S.encodedData=void 0,S.configSchema=void 0,S.currentPickId=null,S.rawConfig=void 0,S.needUpdateConfig=void 0,S.pendingStyleAttributes=[],S.scaleOptions={},S.animateStartTime=void 0,S.aniamateStatus=!1,S.sourceEvent=function(){S.dataState.dataSourceNeedUpdate=!0;var M=S.getLayerConfig(),j=M.autoFit,ae=M.fitBoundsOptions;j&&S.fitBounds(ae),S.emit("dataUpdate"),S.reRender()},S.name=C.name||S.id,S.zIndex=C.zIndex||0,S.rawConfig=C,S}return a()(E,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(C){if(!this.inited)this.needUpdateConfig=it(it({},this.needUpdateConfig),C);else{var M=this.container.get(b.TYPES.SceneID);this.configService.setLayerConfig(M,this.id,it(it(it({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),C)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(C){this.container=C}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(C){return this.plugins.push(C),this}},{key:"init",value:function(){var C=this,M=this.container.get(b.TYPES.SceneID),j=this.rawConfig.enableMultiPassRenderer,ae=j===void 0?!1:j;this.configService.setLayerConfig(M,this.id,{enableMultiPassRenderer:ae}),this.iconService=this.container.get(b.TYPES.IIconService),this.fontService=this.container.get(b.TYPES.IFontService),this.rendererService=this.container.get(b.TYPES.IRendererService),this.layerService=this.container.get(b.TYPES.ILayerService),this.interactionService=this.container.get(b.TYPES.IInteractionService),this.pickingService=this.container.get(b.TYPES.IPickingService),this.mapService=this.container.get(b.TYPES.IMapService),this.cameraService=this.container.get(b.TYPES.ICameraService),this.coordinateService=this.container.get(b.TYPES.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(b.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(b.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(b.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(b.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(Jt){var _r=Jt.attributeName,Dr=Jt.attributeField,xn=Jt.attributeValues,gn=Jt.updateOptions;C.styleAttributeService.updateStyleAttribute(_r,{scale:it({field:Dr},C.splitValuesAndCallbackInAttribute(xn,C.getLayerConfig()[_r]))},gn)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(b.TYPES.ILayerPlugin);var ge=he(this.plugins),Ue;try{for(ge.s();!(Ue=ge.n()).done;){var Dt=Ue.value;Dt.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(Jt){ge.e(Jt)}finally{ge.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(it(it({},this.getDefaultConfig()),this.rawConfig));var C=this.getLayerConfig(),M=C.animateOption;(M==null?void 0:M.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(C,M,j){return this.updateStyleAttribute("color",C,M,j),this}},{key:"rotate",value:function(C,M,j){return this.updateStyleAttribute("rotate",C,M,j),this}},{key:"size",value:function(C,M,j){return this.updateStyleAttribute("size",C,M,j),this}},{key:"filter",value:function(C,M,j){return this.updateStyleAttribute("filter",C,M,j),this}},{key:"shape",value:function(C,M,j){return this.updateStyleAttribute("shape",C,M,j),this}},{key:"label",value:function(C,M,j){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:C,attributeValues:M,updateOptions:j}),this}},{key:"animate",value:function(C){var M={};return Ht()(C)?(M.enable=!0,M=it(it({},M),C)):M.enable=C,this.updateLayerConfig({animateOption:M}),this}},{key:"source",value:function(C,M){return this.sourceOption={data:C,options:M},this}},{key:"setData",value:function(C,M){var j=this;return this.inited?this.layerSource.setData(C,M):this.on("inited",function(){j.layerSource.setData(C,M)}),this}},{key:"style",value:function(C){var M=this,j=C.passes,ae=Ge()(C,["passes"]);return j&&fe(j).forEach(function(ge){var Ue=M.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(ge[0]);Ue&&Ue.updateOptions(ge[1])}),this.rawConfig=it(it({},this.rawConfig),ae),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(C,M){return Ht()(C)?this.scaleOptions=it(it({},this.scaleOptions),C):this.scaleOptions[C]=M,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(C){var M={};return M.enableHighlight=Ht()(C)?!0:C,Ht()(C)?(M.enableHighlight=!0,C.color&&(M.highlightColor=C.color)):M.enableHighlight=!!C,this.updateLayerConfig(M),this}},{key:"setActive",value:function(C,M){var j=this;if(Ht()(C)){var ae=C.x,ge=ae===void 0?0:ae,Ue=C.y,Dt=Ue===void 0?0:Ue;this.updateLayerConfig({highlightColor:Ht()(M)?M.color:this.getLayerConfig().highlightColor}),this.pick({x:ge,y:Dt})}else this.updateLayerConfig({pickedFeatureID:C,highlightColor:Ht()(M)?M.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(ze.l)(C)).then(function(){setTimeout(function(){j.reRender()},1)})}},{key:"select",value:function(C){var M={};return M.enableSelect=Ht()(C)?!0:C,Ht()(C)?(M.enableSelect=!0,C.color&&(M.selectColor=C.color)):M.enableSelect=!!C,this.updateLayerConfig(M),this}},{key:"setSelect",value:function(C,M){var j=this;if(Ht()(C)){var ae=C.x,ge=ae===void 0?0:ae,Ue=C.y,Dt=Ue===void 0?0:Ue;this.updateLayerConfig({selectColor:Ht()(M)?M.color:this.getLayerConfig().selectColor}),this.pick({x:ge,y:Dt})}else this.updateLayerConfig({pickedFeatureID:C,selectColor:Ht()(M)?M.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(ze.l)(C)).then(function(){setTimeout(function(){j.reRender()},1)})}},{key:"setBlend",value:function(C){this.updateLayerConfig({blend:C}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(C){return this.zIndex=C,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(C){this.currentPickId=C}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(C){this.selectedFeatureID=C}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var C=this.mapService.getZoom(),M=this.getLayerConfig(),j=M.visible,ae=M.minZoom,ge=ae===void 0?-Infinity:ae,Ue=M.maxZoom,Dt=Ue===void 0?Infinity:Ue;return!!j&&C>=ge&&C<=Dt}},{key:"setMinZoom",value:function(C){return this.updateLayerConfig({minZoom:C}),this}},{key:"getMinZoom",value:function(){var C=this.getLayerConfig(),M=C.minZoom;return M}},{key:"getMaxZoom",value:function(){var C=this.getLayerConfig(),M=C.maxZoom;return M}},{key:"get",value:function(C){var M=this.getLayerConfig();return M[C]}},{key:"setMaxZoom",value:function(C){return this.updateLayerConfig({maxZoom:C}),this}},{key:"fitBounds",value:function(C){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var M=this.getSource(),j=M.extent,ae=j.some(function(ge){return Math.abs(ge)===Infinity});return ae?this:(this.mapService.fitBounds([[j[0],j[1]],[j[2],j[3]]],C),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(C){return C.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(C){return C.needRescale||C.needRemapping||C.needRegenerateVertices}).length}},{key:"setSource",value:function(C){this.layerSource=C;var M=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(M),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(C){this.encodedData=C}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=bt()([le,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(C){var M=this.styleAttributeService.getLayerAttributeScale(C);if(M){if(M.ticks){var j=M.ticks().map(function(ge){return Re()({value:ge},C,M(ge))});return j}else if(M.invertExtent){var ae=M.range().map(function(ge){return Re()({value:M.invertExtent(ge)},C,ge)});return ae}}else return[]}},{key:"pick",value:function(C){var M=C.x,j=C.y;this.interactionService.triggerHover({x:M,y:j})}},{key:"boxSelect",value:function(C,M){this.pickingService.boxPickLayer(this,C,M)}},{key:"buildLayerModel",value:function(C){var M=C.moduleName,j=C.vertexShader,ae=C.fragmentShader,ge=C.triangulation,Ue=Ge()(C,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(M,{vs:j,fs:ae});var Dt=this.shaderModuleService.getModule(M),Jt=Dt.vs,_r=Dt.fs,Dr=Dt.uniforms,xn=this.rendererService.createModel,gn=this.styleAttributeService.createAttributesAndIndices(this.encodedData,ge),Bn=gn.attributes,Ei=gn.elements;return xn(it({attributes:Bn,uniforms:Dr,fs:_r,vs:Jt,elements:Ei,blend:nt[b.BlendType.normal]},Ue))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(C){var M=this.getLayerConfig(),j=M.enableHighlight,ae=j===void 0?!0:j,ge=M.enableSelect,Ue=ge===void 0?!0:ge,Dt=this.eventNames().indexOf(C)!==-1||this.eventNames().indexOf("un"+C)!==-1;return(C==="click"||C==="dblclick")&&Ue&&(Dt=!0),C==="mousemove"&&(ae||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(Dt=!0),this.isVisible()&&Dt}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var C=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(M){M.draw({uniforms:C.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(C,M){return{values:Xe()(C)?void 0:C||M,callback:Xe()(C)?C:void 0}}},{key:"updateStyleAttribute",value:function(C,M,j,ae){this.inited?this.styleAttributeService.updateStyleAttribute(C,{scale:it({field:M},this.splitValuesAndCallbackInAttribute(j,this.getLayerConfig()[M]))},ae):this.pendingStyleAttributes.push({attributeName:C,attributeField:M,attributeValues:j,updateOptions:ae})}}]),E}(st.EventEmitter),q),Ze=St()(De.prototype,"logger",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=St()(De.prototype,"configService",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=St()(De.prototype,"shaderModuleService",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De),qe,jt,lr,ct,ht,Pt,vt=(qe=Object(b.lazyInject)(b.TYPES.IGlobalConfigService),jt=Object(b.lazyInject)(b.TYPES.IShaderModuleService),lr=(Pt=function(){function h(T){Z()(this,h),this.triangulation=void 0,this.layer=void 0,Oe()(this,"configService",ct,this),Oe()(this,"shaderModuleService",ht,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=T,this.rendererService=T.getContainer().get(b.TYPES.IRendererService),this.styleAttributeService=T.getContainer().get(b.TYPES.IStyleAttributeService),this.mapService=T.getContainer().get(b.TYPES.IMapService),this.iconService=T.getContainer().get(b.TYPES.IIconService),this.fontService=T.getContainer().get(b.TYPES.IFontService),this.cameraService=T.getContainer().get(b.TYPES.ICameraService),this.layerService=T.getContainer().get(b.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return a()(h,[{key:"getBlend",value:function(){var E=this.layer.getLayerConfig(),S=E.blend,C=S===void 0?"normal":S;return nt[b.BlendType[C]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(E){return[E.enable?0:1,E.duration||4,E.interval||.2,E.trailLength||.1]}},{key:"startModelAnimate",value:function(){var E=this.layer.getLayerConfig(),S=E.animateOption;S.enable&&this.layer.setAnimateStartTime()}}]),h}(),Pt),ct=St()(lr.prototype,"configService",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ht=St()(lr.prototype,"shaderModuleService",[jt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lr),Pe=o("J4zp"),ut=o.n(Pe),Qe=o("RIqP"),Vt=o.n(Qe),pr=o("VmRL"),Zr=o.n(pr),cr=o("IOcx"),jn=cr.c.create(),En=cr.c.create(),ni=cr.c.create(),fi=cr.c.create(),Zn=cr.c.create();function Vn(h,T,E,S,C){cr.c.add(h,E,S),cr.c.normalize(h,h),T=cr.c.fromValues(-h[1],h[0]);var M=cr.c.fromValues(-E[1],E[0]);return[C/cr.c.dot(T,M),T]}function Te(h,T){return cr.c.set(h,-T[1],T[0])}function de(h,T,E){return cr.c.sub(h,T,E),cr.c.normalize(h,h),h}function W(h,T){return h[0]===T[0]&&h[1]===T[1]}function se(h){for(var T=new Map,E=0;E<h.length;E++){var S=h[0].toString()+"-"+h[1].toString();T.get(S)?(h.splice(E,1),E++):T.set(S,S)}return h}var Le=function(){function h(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Z()(this,h),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=cr.c.fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=T.join||"miter",this.cap=T.cap||"butt",this.miterLimit=T.miterLimit||10,this.thickness=T.thickness||1,this.dash=T.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return a()(h,[{key:"extrude",value:function(E){var S=this.complex;if(E.length<=1)return S;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var C=E.length,M=S.startIndex,j=1;j<C;j++){var ae=E[j-1],ge=E[j],Ue=j<E.length-1?E[j+1]:null,Dt=this.segment(S,M,ae,ge,Ue);M+=Dt}if(this.dash)for(var Jt=0;Jt<S.positions.length/6;Jt++)S.positions[Jt*6+5]=this.totalDistance;return S.startIndex=S.positions.length/6,S}},{key:"segment",value:function(E,S,C,M,j){var ae=0,ge=E.indices,Ue=E.positions,Dt=E.normals,Jt=this.cap==="square",_r=this.join==="bevel",Dr=Object(ze.d)([M[0],M[1]]),xn=Object(ze.d)([C[0],C[1]]);de(ni,Dr,xn);var gn=0;if(this.dash&&(gn=this.lineSegmentDistance(Dr,xn),this.totalDistance+=gn),this.normal||(this.normal=cr.c.create(),Te(this.normal,ni)),!this.started)if(this.started=!0,Jt){var Bn=cr.c.create(),Ei=cr.c.create();cr.c.add(Bn,this.normal,ni),cr.c.add(Ei,this.normal,ni),Dt.push(Ei[0],Ei[1],0),Dt.push(Bn[0],Bn[1],0),Ue.push(C[0],C[1],0,this.totalDistance-gn,-this.thickness,0),Ue.push(C[0],C[1],0,this.totalDistance-gn,this.thickness,0)}else this.extrusions(Ue,Dt,C,this.normal,this.thickness,this.totalDistance-gn);if(ge.push(S+0,S+1,S+2),j){var sa=Object(ze.d)([j[0],j[1]]);W(Dr,sa)&&cr.c.add(sa,Dr,cr.c.normalize(sa,cr.c.subtract(sa,Dr,xn))),de(fi,sa,Dr);var ua=Vn(Zn,cr.c.create(),ni,fi,this.thickness),no=ut()(ua,2),Ci=no[0],io=no[1],Co=cr.c.dot(Zn,this.normal)<0?-1:1,Ys=_r;if(!Ys&&this.join==="miter"){var Yi=Ci;Yi>this.miterLimit&&(Ys=!0)}Ys?(Dt.push(this.normal[0],this.normal[1],0),Dt.push(io[0],io[1],0),Ue.push(M[0],M[1],0,this.totalDistance,-this.thickness*Co,0),Ue.push(M[0],M[1],0,this.totalDistance,this.thickness*Co,0),ge.push.apply(ge,Vt()(this.lastFlip!==-Co?[S,S+2,S+3]:[S+2,S+1,S+3])),ge.push(S+2,S+3,S+4),Te(jn,fi),cr.c.copy(this.normal,jn),Dt.push(this.normal[0],this.normal[1],0),Ue.push(M[0],M[1],0,this.totalDistance,-this.thickness*Co,0),ae+=3):(this.extrusions(Ue,Dt,M,io,Ci,this.totalDistance),ge.push.apply(ge,Vt()(this.lastFlip===1?[S,S+2,S+3]:[S+2,S+1,S+3])),Co=-1,cr.c.copy(this.normal,io),ae+=2),this.lastFlip=Co}else{if(Te(this.normal,ni),Jt){var Ai=cr.c.create(),Ba=cr.c.create();cr.c.sub(Ba,ni,this.normal),cr.c.add(Ai,ni,this.normal),Dt.push(Ba[0],Ba[1],0),Dt.push(Ai[0],Ai[1],0),Ue.push(M[0],M[1],0,this.totalDistance,this.thickness,0),Ue.push(M[0],M[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(Ue,Dt,M,this.normal,this.thickness,this.totalDistance);ge.push.apply(ge,Vt()(this.lastFlip===1?[S,S+2,S+3]:[S+2,S+1,S+3])),ae+=2}return ae}},{key:"extrusions",value:function(E,S,C,M,j,ae){S.push(M[0],M[1],0),S.push(M[0],M[1],0),E.push(C[0],C[1],0,ae,-j,0),E.push(C[0],C[1],0,ae,j,0)}},{key:"lineSegmentDistance",value:function(E,S){var C=S[0]-E[0],M=S[1]-E[1];return Math.sqrt(C*C+M*M)}}]),h}(),et=o("UB5X"),wt=o.n(et);function Ne(h){if(wt()(h[0]))return h;if(wt()(h[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(wt()(h[0][0][0])){var T=h,E=0,S=0,C=0;return T.forEach(function(M){M.forEach(function(j){E+=j[0],S+=j[1],C++})}),[E/C,S/C,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function gt(h){var T=h[0][0],E=h[0][h[0].length-1];T[0]===E[0]&&T[1]===E[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var S=h[0].length,C=Zr.a.flatten(h),M=C.vertices,j=C.dimensions,ae=[],ge=[],Ue=0;Ue<M.length/j;Ue++)j===2?ae.push(M[Ue*2],M[Ue*2+1],1):ae.push(M[Ue*3],M[Ue*3+1],1);var Dt=Zr()(C.vertices,C.holes,C.dimensions);ge.push.apply(ge,Vt()(Dt));for(var Jt=function(xn){var gn=C.vertices.slice(xn*j,(xn+1)*j),Bn=C.vertices.slice((xn+1)*j,(xn+2)*j);Bn.length===0&&(Bn=C.vertices.slice(0,j));var Ei=ae.length/3;ae.push(gn[0],gn[1],1,Bn[0],Bn[1],1,gn[0],gn[1],0,Bn[0],Bn[1],0),ge.push.apply(ge,Vt()([0,2,1,2,3,1].map(function(Ai){return Ai+Ei})))},_r=0;_r<S;_r++)Jt(_r);return{positions:ae,index:ge}}function qt(h){var T=Zr.a.flatten(h),E=Zr()(T.vertices,T.holes,T.dimensions);return{positions:T.vertices,index:E}}function zr(h){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,E=h[0][0],S=h[0][h[0].length-1];E[0]===S[0]&&E[1]===S[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var C=h[0].length,M=Zr.a.flatten(h),j=M.vertices,ae=M.dimensions,ge=[],Ue=[],Dt=[],Jt=0;Jt<j.length/ae;Jt++)ae===2?ge.push(j[Jt*2],j[Jt*2+1],1,-1,-1):ge.push(j[Jt*3],j[Jt*3+1],1,-1,-1),Dt.push(0,0,1);var _r=Zr()(M.vertices,M.holes,M.dimensions);Ue.push.apply(Ue,Vt()(_r));for(var Dr=function(Bn){var Ei=M.vertices.slice(Bn*ae,(Bn+1)*ae),Ai=M.vertices.slice((Bn+1)*ae,(Bn+2)*ae);Ai.length===0&&(Ai=M.vertices.slice(0,ae));var Ba=ge.length/5;ge.push(Ei[0],Ei[1],1,0,0,Ai[0],Ai[1],1,.1,0,Ei[0],Ei[1],0,0,.8,Ai[0],Ai[1],0,.1,.8);var sa=Br([Ai[0],Ai[1],1],[Ei[0],Ei[1],0],[Ei[0],Ei[1],1],T);Dt.push.apply(Dt,Vt()(sa).concat(Vt()(sa),Vt()(sa),Vt()(sa))),Ue.push.apply(Ue,Vt()([1,2,0,3,2,1].map(function(ua){return ua+Ba})))},xn=0;xn<C;xn++)Dr(xn);return{positions:ge,index:Ue,normals:Dt}}function Br(h,T,E){var S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,C=cr.d.create(),M=cr.d.create(),j=cr.d.create();S&&(h=Object(ze.p)(h),T=Object(ze.p)(T),E=Object(ze.p)(E));var ae=cr.d.fromValues.apply(cr.d,Vt()(h)),ge=cr.d.fromValues.apply(cr.d,Vt()(T)),Ue=cr.d.fromValues.apply(cr.d,Vt()(E));cr.d.sub(C,Ue,ge),cr.d.sub(M,ae,ge),cr.d.cross(j,C,M);var Dt=cr.d.create();return cr.d.normalize(Dt,j),Dt}var sr,kr;(function(h){h.CYLINDER="cylinder",h.SQUARECOLUMN="squareColumn",h.TRIANGLECOLUMN="triangleColumn",h.HEXAGONCOLUMN="hexagonColumn",h.PENTAGONCOLUMN="pentagonColumn"})(kr||(kr={}));var Cn;(function(h){h.CIRCLE="circle",h.SQUARE="square",h.TRIANGLE="triangle",h.HEXAGON="hexagon",h.PENTAGON="pentagon"})(Cn||(Cn={}));function dn(h){for(var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=Math.PI*2/h,S=[],C=0;C<h;C++)S.push(E*C+T*Math.PI/12);var M=S.map(function(j){var ae=Math.sin(j+Math.PI/4),ge=Math.cos(j+Math.PI/4);return[ae,ge,0]});return M}function Er(){return dn(30)}function Tn(){return dn(4)}function vn(){return dn(3)}function mn(){return dn(6,1)}function Ar(){return dn(5)}var $r=(sr={},Re()(sr,Cn.CIRCLE,Er),Re()(sr,Cn.HEXAGON,mn),Re()(sr,Cn.TRIANGLE,vn),Re()(sr,Cn.SQUARE,Tn),Re()(sr,Cn.PENTAGON,Ar),Re()(sr,kr.CYLINDER,Er),Re()(sr,kr.HEXAGONCOLUMN,mn),Re()(sr,kr.TRIANGLECOLUMN,vn),Re()(sr,kr.SQUARECOLUMN,Tn),Re()(sr,kr.PENTAGONCOLUMN,Ar),sr),Mn={};function Ki(h){var T=Ne(h.coordinates);return{vertices:[].concat(Vt()(T),Vt()(T),Vt()(T),Vt()(T)),indices:[0,1,2,2,3,0],size:T.length}}function vi(h){var T=h.shape,E=Ra(T,!1),S=E.positions,C=E.index,M=E.normals;return{vertices:S,indices:C,normals:M,size:5}}function Mi(h){var T=Ne(h.coordinates);return{vertices:Vt()(T),indices:[0],size:T.length}}function zi(h){var T=h.coordinates,E=T;Array.isArray(E[0][0])||(E=[T]);var S=new Le({dash:!0,join:"bevel"});E.forEach(function(M){S.extrude(M)});var C=S.complex;return{vertices:C.positions,indices:C.indices,normals:C.normals,size:6}}function Ka(h){var T=h.coordinates,E=Zr.a.flatten(T),S=E.vertices,C=E.dimensions,M=E.holes;return{indices:Zr()(S,M,C),vertices:S,size:C}}function hi(h){var T=h.coordinates,E=zr(T,!0),S=E.positions,C=E.index,M=E.normals;return{vertices:S,indices:C,normals:M,size:5}}function ya(h){var T=h.shape,E=Uu(T),S=E.positions,C=E.index;return{vertices:S,indices:C,size:3}}function Ii(h){var T=h.coordinates,E=[].concat(Vt()(T[0]),[0,0,1,T[1][0],T[0][1],0,1,1],Vt()(T[1]),[0,1,0],Vt()(T[0]),[0,0,1],Vt()(T[1]),[0,1,0,T[0][0],T[1][1],0,0,0]),S=[0,1,2,3,4,5];return{vertices:E,indices:S,size:5}}function yi(h){for(var T=30,E=h.coordinates,S=[],C=[],M=function(ge){S.push(ge,1,ge,E[0][0],E[0][1],E[1][0],E[1][1],ge,-1,ge,E[0][0],E[0][1],E[1][0],E[1][1]),ge!==T-1&&C.push.apply(C,Vt()([0,1,2,1,3,2].map(function(Ue){return ge*2+Ue})))},j=0;j<T;j++)M(j);return{vertices:S,indices:C,size:7}}function ci(h){var T=h.coordinates;T.length===2&&T.push(0);var E=h.size,S=Gi(-1,1),C=Gi(1,1),M=Gi(-1,-1),j=Gi(1,-1),ae=[].concat(Vt()(T),Vt()(S),Vt()(T),Vt()(M),Vt()(T),Vt()(j),Vt()(T),Vt()(C)),ge=[0,1,2,3,0,2];return{vertices:ae,indices:ge,size:5}}function Ra(h){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Mn&&Mn[h])return Mn[h];var E=$r[h]?$r[h]():$r.cylinder(),S=zr([E],T);return Mn[h]=S,S}function xo(h,T){for(var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,C=new Float32Array(h.length/E*3),M,j,ae,ge=cr.d.create(),Ue=cr.d.create(),Dt=cr.d.create(),Jt=0,_r=T.length;Jt<_r;Jt+=3){M=T[Jt+0]*3,j=T[Jt+1]*3,ae=T[Jt+2]*3;var Dr=[h[M],h[M+1]],xn=[h[j],h[j+1]],gn=[h[ae],h[ae+1]];S&&(Dr=Object(ze.p)(Dr),xn=Object(ze.p)(xn),gn=Object(ze.p)(gn));var Bn=Dr,Ei=ut()(Bn,2),Ai=Ei[0],Ba=Ei[1],sa=cr.d.fromValues(Ai,Ba,h[M+2]),ua=xn,no=ut()(ua,2),Ci=no[0],io=no[1],Co=cr.d.fromValues(Ci,io,h[j+2]),Ys=gn,Yi=ut()(Ys,2),Ps=Yi[0],rs=Yi[1],vf=cr.d.fromValues(Ps,rs,h[ae+2]);cr.d.sub(ge,vf,Co),cr.d.sub(Ue,sa,Co),cr.d.cross(Dt,ge,Ue),C[M]+=ge[0],C[M+1]+=ge[1],C[M+2]+=ge[2],C[j]+=ge[0],C[j+1]+=ge[1],C[j+2]+=ge[2],C[ae]+=ge[0],C[ae+1]+=ge[1],C[ae+2]+=ge[2]}return $a(C),C}function $a(h){for(var T=0,E=h.length;T<E;T+=3){var S=cr.d.fromValues(h[T],h[T+1],h[T+2]),C=cr.d.create();cr.d.normalize(C,S),h.set(C,T)}}function Ko(h){var T=h[0][0],E=h[0][h[0].length-1];return T[0]===E[0]&&T[1]===E[1]}function Uu(h){var T=["cylinder","triangleColumn","hexagonColumn","squareColumn"],E=$r[h]?$r[h]():$r.circle(),S=T.indexOf(h)===-1?qt([E]):gt([E]);return S}function Gi(h,T){var E=(h+1)/2,S=(T+1)/2;return[E,S]}function Pa(h){var T=ns();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function ns(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var na=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ja=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,is=function(h){B()(E,h);var T=Pa(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=M===void 0?1:M,ae=C.baseColor,ge=ae===void 0?"rgb(16,16,16)":ae,Ue=C.brightColor,Dt=Ue===void 0?"rgb(255,176,38)":Ue,Jt=C.windowColor,_r=Jt===void 0?"rgb(30,60,89)":Jt,Dr=C.time,xn=Dr===void 0?0:Dr;return{u_opacity:j,u_baseColor:Object(ze.s)(ge),u_brightColor:Object(ze.s)(Dt),u_windowColor:Object(ze.s)(_r),u_time:this.layer.getLayerAnimateTime()||xn}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Ja,fragmentShader:na,triangulation:hi})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:b.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,j,ae,ge,Ue){return Ue}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,j,ae,ge){var Ue=M.size,Dt=Ue===void 0?10:Ue;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:b.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,j,ae,ge){var Ue=M.size;return[ae[3],ae[4]]}}})}}]),E}(vt);function Ji(h){var T=lo();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function lo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var co=function(h){B()(E,h);var T=Ji(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.type="PolygonLayer",S}return a()(E,[{key:"buildModels",value:function(){this.layerModel=new is(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(C){this.updateLayerConfig({time:C})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),E}(ie);function Ks(h){var T=wo();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function wo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Zl=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
varying vec4 v_color;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,$s=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Po=function(h){B()(E,h);var T=Ks(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=C.coverage,ae=C.angle;return{u_opacity:M||1,u_coverage:j||.9,u_angle:ae||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:Zl,fragmentShader:$s,triangulation:ya,depth:{enable:!1},primitive:b.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:b.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,j){var ae=M.coordinates;return[ae[0],ae[1],0]}}})}}]),E}(vt);function Bt(h){var T=Fe();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function Fe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ot=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);
  setPickingColor(a_PickingColor);
}
`,fr=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,rn=function(h){B()(E,h);var T=Bt(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=C.coverage,ae=C.angle;return{u_opacity:M||1,u_coverage:j||1,u_angle:ae||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:Ot,fragmentShader:fr,triangulation:vi,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,j,ae,ge){var Ue=M.size;return Array.isArray(Ue)?[Ue[0]]:[Ue]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:b.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,j,ae,ge,Ue){return Ue}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:b.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,j){var ae=M.coordinates;return[ae[0],ae[1],0]}}})}}]),E}(vt);function bn(h,T){for(var E=[],S=[],C=[],M=h+1,j=T+1,ae=h/2,ge=T/2,Ue=0;Ue<j;Ue++)for(var Dt=Ue-ge,Jt=0;Jt<M;Jt++){var _r=Jt-ae;S.push(_r/ae,-Dt/ge,0),C.push(Jt/h),C.push(1-Ue/T)}for(var Dr=0;Dr<T;Dr++)for(var xn=0;xn<h;xn++){var gn=xn+M*Dr,Bn=xn+M*(Dr+1),Ei=xn+1+M*(Dr+1),Ai=xn+1+M*Dr;E.push(gn,Bn,Ai),E.push(Bn,Ei,Ai)}return{vertices:S,indices:E,uvs:C}}function Un(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(h);T&&(S=S.filter(function(C){return Object.getOwnPropertyDescriptor(h,C).enumerable})),E.push.apply(E,S)}return E}function Da(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?Un(Object(E),!0).forEach(function(S){Re()(h,S,E[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):Un(Object(E)).forEach(function(S){Object.defineProperty(h,S,Object.getOwnPropertyDescriptor(E,S))})}return h}function ao(h){var T=bo();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function bo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Fo=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Vu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));


  vec4 p1 = vec4(pos, 0.0, 1.0);
	vec4 p2 = vec4(pos, 1.0, 1.0);

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1;
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w;
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0, 1, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);

}
`,Wl=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Js=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,Ic=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
}
`,Il=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,hs=function(h){B()(E,h);var T=ao(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.texture=void 0,S.colorTexture=void 0,S.heatmapFramerBuffer=void 0,S.intensityModel=void 0,S.colorModel=void 0,S.shapeType=void 0,S}return a()(E,[{key:"render",value:function(){var C=this,M=this.rendererService,j=M.clear,ae=M.useFramebuffer;ae(this.heatmapFramerBuffer,function(){j({color:[0,0,0,0],depth:1,stencil:0,framebuffer:C.heatmapFramerBuffer}),C.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var C,M=this.rendererService,j=M.createFramebuffer,ae=M.clear,ge=M.getViewportSize,Ue=M.createTexture2D,Dt=M.useFramebuffer,Jt=this.styleAttributeService.getLayerStyleAttribute("shape"),_r=(Jt==null||(C=Jt.scale)===null||C===void 0?void 0:C.field)||"heatmap";this.shapeType=_r,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=_r==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var Dr=this.layer.getLayerConfig(),xn=Dr.rampColors,gn=Object(ze.n)(xn),Bn=ge(),Ei=Bn.width,Ai=Bn.height;return this.heatmapFramerBuffer=j({color:Ue({width:Math.floor(Ei/4),height:Math.floor(Ai/4),wrapS:b.gl.CLAMP_TO_EDGE,wrapT:b.gl.CLAMP_TO_EDGE,min:b.gl.LINEAR,mag:b.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:b.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,j,ae,ge){return[ae[3],ae[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,j,ae,ge){var Ue=M.size,Dt=Ue===void 0?1:Ue;return[Dt]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:Ic,fragmentShader:Js,triangulation:ci,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:b.gl.ONE,srcAlpha:1,dstRGB:b.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:Il,fs:Wl});var C=this.shaderModuleService.getModule("heatmapColor"),M=C.vs,j=C.fs,ae=C.uniforms,ge=this.rendererService,Ue=ge.createAttribute,Dt=ge.createElements,Jt=ge.createBuffer,_r=ge.createModel;return _r({vs:M,fs:j,attributes:{a_Position:Ue({buffer:Jt({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:b.gl.FLOAT}),size:3}),a_Uv:Ue({buffer:Jt({data:[0,1,1,1,0,0,1,0],type:b.gl.FLOAT}),size:2})},uniforms:Da({},ae),depth:{enable:!1},blend:this.getBlend(),count:6,elements:Dt({data:[0,2,1,2,3,1],type:b.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=C.intensity,ae=j===void 0?10:j,ge=C.radius,Ue=ge===void 0?5:ge;this.intensityModel.draw({uniforms:{u_opacity:M||1,u_radius:Ue,u_intensity:ae}})}},{key:"drawColorMode",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=cr.b.invert(cr.b.create(),cr.b.fromValues.apply(cr.b,Vt()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Vt()(j)}})}},{key:"build3dHeatMap",value:function(){var C=this.rendererService.getViewportSize,M=C(),j=M.width,ae=M.height,ge=bn(j/4,ae/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Vu,fs:Fo});var Ue=this.shaderModuleService.getModule("heatmap3dColor"),Dt=Ue.vs,Jt=Ue.fs,_r=Ue.uniforms,Dr=this.rendererService,xn=Dr.createAttribute,gn=Dr.createElements,Bn=Dr.createBuffer,Ei=Dr.createModel;return Ei({vs:Dt,fs:Jt,attributes:{a_Position:xn({buffer:Bn({data:ge.vertices,type:b.gl.FLOAT}),size:3}),a_Uv:xn({buffer:Bn({data:ge.uvs,type:b.gl.FLOAT}),size:2})},primitive:b.gl.TRIANGLES,uniforms:Da({},_r),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:b.gl.SRC_ALPHA,srcAlpha:1,dstRGB:b.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:gn({data:ge.indices,type:b.gl.UNSIGNED_INT,count:ge.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var C=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var M=this.layer.getLayerConfig(),j=M.rampColors,ae=Object(ze.n)(j);this.colorTexture=C({data:new Uint8Array(ae.data),width:ae.width,height:ae.height,wrapS:b.gl.CLAMP_TO_EDGE,wrapT:b.gl.CLAMP_TO_EDGE,min:b.gl.NEAREST,mag:b.gl.NEAREST,flipY:!1})}}]),E}(vt);function Ns(h){var T=fo();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function fo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ds=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Qs=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  setPickingColor(a_PickingColor);
}
`,lu=function(h){B()(E,h);var T=Ns(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=C.coverage,ae=C.angle;return{u_opacity:M||1,u_coverage:j||.9,u_angle:ae||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:Qs,fragmentShader:ds,triangulation:ya,depth:{enable:!1},primitive:b.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:b.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,j){var ae=M.coordinates;return[ae[0],ae[1],0]}}})}}]),E}(vt),Xl={heatmap:hs,heatmap3d:hs,grid:Po,grid3d:rn,hexagon:lu},xa=Xl;function ka(h){var T=ml();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function ml(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Fs=function(h){B()(E,h);var T=ka(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.type="HeatMapLayer",S}return a()(E,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new xa[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var C=this,M=this.getModelType();return M==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(j){return j.draw({uniforms:C.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),j=this.getLayerConfig(),ae=j.shape3d,ge=this.getSource(),Ue=ge.data.type,Dt=(M==null||(C=M.scale)===null||C===void 0?void 0:C.field)||"heatmap";return Dt==="heatmap"||Dt==="heatmap3d"?"heatmap":Ue==="hexagon"?(ae==null?void 0:ae.indexOf(Dt))===-1?"hexagon":"grid3d":Ue==="grid"?(ae==null?void 0:ae.indexOf(Dt))===-1?"grid":"grid3d":"heatmap"}}]),E}(ie);function ps(h){var T=It();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function It(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ir=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,Mr=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Gn=function(h){B()(E,h);var T=ps(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.texture=void 0,S}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return{u_opacity:M||1,u_texture:this.texture}}},{key:"initModels",value:function(){var C=this,M=this.layer.getSource(),j=this.rendererService.createTexture2D;return this.texture=j({height:0,width:0}),M.data.images.then(function(ae){C.texture=j({data:ae[0],width:ae[0].width,height:ae[0].height}),C.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Mr,fragmentShader:ir,triangulation:Ii,primitive:b.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:b.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,j,ae,ge){return[ae[3],ae[4]]}}})}}]),E}(vt),Qi={image:Gn},za=Qi;function Za(h){var T=qi();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function qi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ba=function(h){B()(E,h);var T=Za(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.type="ImageLayer",S}return a()(E,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new za[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={image:{}};return M[C]}},{key:"getModelType",value:function(){return"image"}}]),E}(ie);function _o(h){var T=Bs();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function Bs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ha=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Yl=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}
`,cu={solid:0,dash:1},_s=function(h){B()(E,h);var T=_o(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=C.lineType,ae=j===void 0?"solid":j,ge=C.dashArray,Ue=ge===void 0?[10,5]:ge;return Ue.length===2&&Ue.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:cu[ae||"solid"],u_dash_array:Ue,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Yl,fragmentShader:ha,triangulation:yi,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,j,ae,ge){var Ue=M.size,Dt=Ue===void 0?1:Ue;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:b.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:4,update:function(M,j,ae,ge){return[ae[3],ae[4],ae[5],ae[6]]}}})}}]),E}(vt);function gl(h){var T=fu();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function fu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Gu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  setPickingColor(a_PickingColor);
}
`,qs=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,rl={solid:0,dash:1},hu=function(h){B()(E,h);var T=gl(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=C.lineType,ae=j===void 0?"solid":j,ge=C.dashArray,Ue=ge===void 0?[10,5]:ge;return Ue.length===2&&Ue.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:rl[ae]||0,u_dash_array:Ue}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:Gu,fragmentShader:qs,triangulation:yi,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,j,ae,ge){var Ue=M.size,Dt=Ue===void 0?1:Ue;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:b.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:4,update:function(M,j,ae,ge){return[ae[3],ae[4],ae[5],ae[6]]}}})}}]),E}(vt);function pc(h){var T=_f();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function _f(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var da=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Oc=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}
vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  setPickingColor(a_PickingColor);
}

`,vc={solid:0,dash:1},qc=function(h){B()(E,h);var T=pc(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=C.lineType,ae=j===void 0?"solid":j,ge=C.dashArray,Ue=ge===void 0?[10,5]:ge;return Ue.length===2&&Ue.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:vc[ae]||0,u_dash_array:Ue}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Oc,fragmentShader:da,triangulation:yi,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,j,ae,ge){var Ue=M.size,Dt=Ue===void 0?1:Ue;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:b.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:4,update:function(M,j,ae,ge){return[ae[3],ae[4],ae[5],ae[6]]}}})}}]),E}(vt);function ef(h){var T=tf();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function tf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Qa=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;


// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
// [animate, duration, interval, trailLength],
void main() {
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Au=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5.\uFF0C0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;


void main() {

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));
  v_color = a_Color;
  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  setPickingColor(a_PickingColor);
}
`,eu={solid:0,dash:1},vs=function(h){B()(E,h);var T=ef(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=C.lineType,ae=j===void 0?"solid":j,ge=C.dashArray,Ue=ge===void 0?[10,5,0,0]:ge;return Ue.length===2&&Ue.push(0,0),{u_opacity:M||1,u_line_type:eu[ae],u_dash_array:Ue}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:Au,fragmentShader:Qa,triangulation:zi,primitive:b.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var C=this.layer.getLayerConfig(),M=C.lineType,j=M===void 0?"solid":M;this.styleAttributeService.registerStyleAttribute({name:"distance",type:b.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(ge,Ue,Dt,Jt){return[Dt[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:b.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(ge,Ue,Dt,Jt){return[Dt[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(ge,Ue,Dt,Jt){var _r=ge.size,Dr=_r===void 0?1:_r;return Array.isArray(Dr)?[Dr[0],Dr[1]]:[Dr,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:b.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(ge,Ue,Dt,Jt,_r){return _r}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:b.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(ge,Ue,Dt,Jt){return[Dt[4]]}}})}}]),E}(vt),Lc={arc:_s,arc3d:hu,greatcircle:qc,line:vs},mc=Lc;function yl(h){var T=nl();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function nl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var gc=function(h){B()(E,h);var T=yl(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.type="LineLayer",S}return a()(E,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new mc[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return M[C]}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),j=M==null||(C=M.scale)===null||C===void 0?void 0:C.field;return j||"line"}}]),E}(ie);function tu(h){var T=Hu();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function Hu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Rc=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Kl=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(pos);
  setPickingColor(a_PickingColor);
}
`,_a=function(h){B()(E,h);var T=tu(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=C.offsets;return{u_opacity:M||1,u_offsets:j||[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:Kl,fragmentShader:Rc,triangulation:vi,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,j,ae,ge){var Ue=M.size;if(Ue){var Dt=[];return Array.isArray(Ue)&&(Dt=Ue.length===2?[Ue[0],Ue[0],Ue[1]]:Ue),Array.isArray(Ue)||(Dt=[Ue]),Dt}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:b.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,j,ae,ge,Ue){return Ue}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:b.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,j){var ae=Ne(M.coordinates);return[ae[0],ae[1],0]}}})}}]),E}(vt);function Dc(h){var T=Mf();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function Mf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var yc=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,zc=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform float u_stroke_width : 2;
uniform vec2 u_offsets;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  // unpack color(vec2)
  v_color = a_Color;
  vec2 extrude = a_Extrude;

  float shape_type = a_Shape;

  float newSize = setPickingSize(a_Size);

  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  setPickingColor(a_PickingColor);
}
`,$l=function(h){B()(E,h);var T=Dc(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=M===void 0?1:M,ae=C.stroke,ge=ae===void 0?"rgb(0,0,0,0)":ae,Ue=C.strokeWidth,Dt=Ue===void 0?1:Ue,Jt=C.strokeOpacity,_r=Jt===void 0?1:Jt,Dr=C.offsets,xn=Dr===void 0?[0,0]:Dr;return{u_opacity:j,u_stroke_width:Dt,u_stroke_color:Object(ze.s)(ge),u_stroke_opacity:_r,u_offsets:[-xn[0],xn[1]]}}},{key:"getAnimateUniforms",value:function(){var C=this.layer.getLayerConfig(),M=C.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Ki)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:zc,fragmentShader:yc,triangulation:Ki,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(C){return[C.enable?0:1,C.speed||1,C.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:b.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(j,ae,ge,Ue){var Dt=[1,1,-1,1,-1,-1,1,-1],Jt=Ue%4*2;return[Dt[Jt],Dt[Jt+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(j,ae,ge,Ue){var Dt=j.size,Jt=Dt===void 0?5:Dt;return Array.isArray(Jt)?[Jt[0]]:[Jt]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:b.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(j,ae,ge,Ue){var Dt=j.shape,Jt=Dt===void 0?2:Dt,_r=C.layer.getLayerConfig().shape2d,Dr=_r.indexOf(Jt);return[Dr]}}})}}]),E}(vt);function Zu(h){var T=Cu();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function Cu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ol=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec4 textureColor=texture2D(u_texture,pos);
if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
      gl_FragColor= textureColor;
}else {
      gl_FragColor= step(0.01, textureColor.z) * v_color;
}
gl_FragColor.a =gl_FragColor.a * u_opacity;
gl_FragColor = filterColor(gl_FragColor);
}
`,Bo=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Jl=function(h){B()(E,h);var T=Zu(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.texture=void 0,S}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity;return{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var C=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){C.updateTexture(),C.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Bo,fragmentShader:Ol,triangulation:Mi,primitive:b.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(j,ae,ge,Ue){var Dt=j.size;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:b.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(j,ae,ge,Ue){var Dt=C.fontService.mapping,Jt=j.shape,_r=C.fontService.getGlyph(Jt),Dr=Dt[_r],xn=Dr.x,gn=Dr.y;return[xn,gn]}}})}},{key:"updateTexture",value:function(){var C=this.rendererService.createTexture2D,M=this.fontService.canvas;this.texture=C({data:M,mag:b.gl.LINEAR,min:b.gl.LINEAR,width:M.width,height:M.height})}},{key:"initIconFontGlyphs",value:function(){var C=this,M=this.layer.getLayerConfig(),j=M.fontWeight,ae=j===void 0?"normal":j,ge=M.fontFamily,Ue=ge===void 0?"sans-serif":ge,Dt=this.layer.getEncodedData(),Jt=[];Dt.forEach(function(_r){var Dr=_r.shape,xn=Dr===void 0?"":Dr;xn=xn.toString();var gn=C.fontService.getGlyph(xn);Jt.indexOf(gn)===-1&&Jt.push(gn)}),this.fontService.setFontOptions({characterSet:Jt,fontWeight:ae,fontFamily:Ue,fontSize:48})}}]),E}(vt);function Ll(h){var T=xl();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function xl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Nc=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec4 textureColor=texture2D(u_texture,pos);
if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
      gl_FragColor= textureColor;
}else {
      gl_FragColor= step(0.01, textureColor.z) * v_color;
}
gl_FragColor.a =gl_FragColor.a * u_opacity;
gl_FragColor = filterColor(gl_FragColor);
}
`,Rl=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,ru=function(h){B()(E,h);var T=Ll(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.texture=void 0,S.updateTexture=function(){var ae=S.rendererService.createTexture2D;if(S.texture){S.texture.update({data:S.iconService.getCanvas()}),S.layer.render();return}S.texture=ae({data:S.iconService.getCanvas(),mag:b.gl.NEAREST,min:b.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:S.iconService.canvasHeight||128})},S}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=C.offsets,ae=j===void 0?[0,0]:j;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_offsets:[-ae[0],ae[1]]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:Rl,fragmentShader:Nc,triangulation:Mi,primitive:b.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var C=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(j,ae,ge,Ue){var Dt=j.size,Jt=Dt===void 0?5:Dt;return Array.isArray(Jt)?[Jt[0]]:[Jt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:b.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(j,ae,ge,Ue){var Dt=C.iconService.getIconMap(),Jt=j.shape,_r=Dt[Jt]||{x:0,y:0},Dr=_r.x,xn=_r.y;return[Dr,xn]}}})}}]),E}(vt);function mf(h){var T=gf();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function gf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var rf=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,bl=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform vec2 u_offsets;

#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  vec2 offset = project_pixel(u_offsets);
  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
    setPickingColor(a_PickingColor);
}
`;function ja(h){var T=h.coordinates;return{vertices:Vt()(T),indices:[0],size:T.length}}var il=function(h){B()(E,h);var T=mf(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=M===void 0?1:M,ae=C.stroke,ge=ae===void 0?"rgb(0,0,0,0)":ae,Ue=C.strokeWidth,Dt=Ue===void 0?1:Ue,Jt=C.offsets,_r=Jt===void 0?[0,0]:Jt;return{u_opacity:j,u_stroke_width:Dt,u_stroke_color:Object(ze.s)(ge),u_offsets:[-_r[0],_r[1]]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:bl,fragmentShader:rf,triangulation:ja,depth:{enable:!1},primitive:b.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,j,ae,ge){var Ue=M.size,Dt=Ue===void 0?1:Ue;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:b.BlendType.additive}}}]),E}(vt);function Dl(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=xc(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var S=0,C=function(){};return{s:C,n:function(){return S>=h.length?{done:!0}:{done:!1,value:h[S++]}},e:function(Ue){throw Ue},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,j=!1,ae;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ue=E.next();return M=Ue.done,Ue},e:function(Ue){j=!0,ae=Ue},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(j)throw ae}}}}function xc(h,T){if(!!h){if(typeof h=="string")return Fc(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return Fc(h,T)}}function Fc(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,S=new Array(T);E<T;E++)S[E]=h[E];return S}var zl=function(){function h(T,E,S){Z()(this,h),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var C=this.boxCells;this.xCellCount=Math.ceil(T/S),this.yCellCount=Math.ceil(E/S);for(var M=0;M<this.xCellCount*this.yCellCount;M++)C.push([]);this.boxKeys=[],this.bboxes=[],this.width=T,this.height=E,this.xScale=this.xCellCount/T,this.yScale=this.yCellCount/E,this.boxUid=0}return a()(h,[{key:"insert",value:function(E,S,C,M,j){this.forEachCell(S,C,M,j,this.insertBoxCell,this.boxUid++),this.boxKeys.push(E),this.bboxes.push(S),this.bboxes.push(C),this.bboxes.push(M),this.bboxes.push(j)}},{key:"query",value:function(E,S,C,M,j){return this.queryHitTest(E,S,C,M,!1,j)}},{key:"hitTest",value:function(E,S,C,M,j){return this.queryHitTest(E,S,C,M,!0,j)}},{key:"insertBoxCell",value:function(E,S,C,M,j,ae){this.boxCells[j].push(ae)}},{key:"queryHitTest",value:function(E,S,C,M,j,ae){if(C<0||E>this.width||M<0||S>this.height)return j?!1:[];var ge=[];if(E<=0&&S<=0&&this.width<=C&&this.height<=M){if(j)return!0;for(var Ue=0;Ue<this.boxKeys.length;Ue++)ge.push({key:this.boxKeys[Ue],x1:this.bboxes[Ue*4],y1:this.bboxes[Ue*4+1],x2:this.bboxes[Ue*4+2],y2:this.bboxes[Ue*4+3]});return ae?ge.filter(ae):ge}var Dt={hitTest:j,seenUids:{box:{},circle:{}}};return this.forEachCell(E,S,C,M,this.queryCell,ge,Dt,ae),j?ge.length>0:ge}},{key:"queryCell",value:function(E,S,C,M,j,ae,ge,Ue){var Dt=ge.seenUids,Jt=this.boxCells[j];if(Jt!==null){var _r=this.bboxes,Dr=Dl(Jt),xn;try{for(Dr.s();!(xn=Dr.n()).done;){var gn=xn.value;if(!Dt.box[gn]){Dt.box[gn]=!0;var Bn=gn*4;if(E<=_r[Bn+2]&&S<=_r[Bn+3]&&C>=_r[Bn+0]&&M>=_r[Bn+1]&&(!Ue||Ue(this.boxKeys[gn]))){if(ge.hitTest)return ae.push(!0),!0;ae.push({key:this.boxKeys[gn],x1:_r[Bn],y1:_r[Bn+1],x2:_r[Bn+2],y2:_r[Bn+3]})}}}}catch(Ei){Dr.e(Ei)}finally{Dr.f()}}return!1}},{key:"forEachCell",value:function(E,S,C,M,j,ae,ge,Ue){for(var Dt=this.convertToXCellCoord(E),Jt=this.convertToYCellCoord(S),_r=this.convertToXCellCoord(C),Dr=this.convertToYCellCoord(M),xn=Dt;xn<=_r;xn++)for(var gn=Jt;gn<=Dr;gn++){var Bn=this.xCellCount*gn+xn;if(j.call(this,E,S,C,M,Bn,ae,ge,Ue))return}}},{key:"convertToXCellCoord",value:function(E){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(E*this.xScale)))}},{key:"convertToYCellCoord",value:function(E){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(E*this.yScale)))}}]),h}(),If=zl,Of=function(){function h(T,E){Z()(this,h),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=T,this.height=E,this.viewportPadding=Math.max(T,E),this.grid=new If(T+this.viewportPadding,E+this.viewportPadding,25),this.screenRightBoundary=T+this.viewportPadding,this.screenBottomBoundary=E+this.viewportPadding,this.gridRightBoundary=T+2*this.viewportPadding,this.gridBottomBoundary=E+2*this.viewportPadding}return a()(h,[{key:"placeCollisionBox",value:function(E){var S=E.x1+E.anchorPointX+this.viewportPadding,C=E.y1+E.anchorPointY+this.viewportPadding,M=E.x2+E.anchorPointX+this.viewportPadding,j=E.y2+E.anchorPointY+this.viewportPadding;return!this.isInsideGrid(S,C,M,j)||this.grid.hitTest(S,C,M,j)?{box:[]}:{box:[S,C,M,j]}}},{key:"insertCollisionBox",value:function(E,S){var C={featureIndex:S};this.grid.insert(C,E[0],E[1],E[2],E[3])}},{key:"project",value:function(E,S,C){var M=cr.e.fromValues(S,C,0,1),j=cr.e.create(),ae=cr.b.fromValues.apply(cr.b,Vt()(E));return cr.e.transformMat4(j,M,ae),{x:(j[0]/j[3]+1)/2*this.width+this.viewportPadding,y:(-j[1]/j[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(E,S,C,M){return C>=0&&E<this.gridRightBoundary&&M>=0&&S<this.gridBottomBoundary}}]),h}();function nf(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=Sl(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var S=0,C=function(){};return{s:C,n:function(){return S>=h.length?{done:!0}:{done:!1,value:h[S++]}},e:function(Ue){throw Ue},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,j=!1,ae;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ue=E.next();return M=Ue.done,Ue},e:function(Ue){j=!0,ae=Ue},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(j)throw ae}}}}function Sl(h,T){if(!!h){if(typeof h=="string")return Ql(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return Ql(h,T)}}function Ql(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,S=new Array(T);E<T;E++)S[E]=h[E];return S}function wu(h){var T=.5,E=.5;switch(h){case"right":case"top-right":case"bottom-right":T=1;break;case"left":case"top-left":case"bottom-left":T=0;break;default:T=.5}switch(h){case"bottom":case"bottom-right":case"bottom-left":E=1;break;case"top":case"top-right":case"top-left":E=0;break;default:E=.5}return{horizontalAlign:T,verticalAlign:E}}function ks(h,T,E,S,C){if(!!C){var M=h[S],j=M.glyph;if(j)for(var ae=T[j].advance*M.scale,ge=(h[S].x+ae)*C,Ue=E;Ue<=S;Ue++)h[Ue].x-=ge}}function al(h,T,E,S,C,M,j){var ae=(T-E)*C,ge=(-S*j+.5)*M,Ue=nf(h),Dt;try{for(Ue.s();!(Dt=Ue.n()).done;){var Jt=Dt.value;Jt.x+=ae,Jt.y+=ge}}catch(_r){Ue.e(_r)}finally{Ue.f()}}function Bc(h,T,E,S,C,M,j){var ae=-8,ge=0,Ue=ae,Dt=0,Jt=h.positionedGlyphs,_r=M==="right"?1:M==="left"?0:.5,Dr=Jt.length;E.forEach(function(Ai){if(Ai.split("").forEach(function(sa){var ua=T[sa],no=0;ua&&(Jt.push({glyph:sa,x:ge,y:Ue+no,vertical:!1,scale:1,metrics:ua}),ge+=ua.advance+j)}),Jt.length!==Dr){var Ba=ge-j;Dt=Math.max(Ba,Dt),ks(Jt,T,Dr,Jt.length-1,_r)}ge=0,Ue+=S});var xn=wu(C),gn=xn.horizontalAlign,Bn=xn.verticalAlign;al(Jt,_r,gn,Bn,Dt,S,E.length);var Ei=Ue-ae;h.top+=-Bn*Ei,h.bottom=h.top+Ei,h.left+=-gn*Dt,h.right=h.left+Dt}function Wu(h,T,E,S,C,M){var j=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],ae=h.split(`
`),ge=[],Ue={positionedGlyphs:ge,top:j[1],bottom:j[1],left:j[0],right:j[0],lineCount:ae.length,text:h};return Bc(Ue,T,ae,E,S,C,M),ge.length?Ue:!1}function Ua(h){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],E=arguments.length>2?arguments[2]:void 0,S=h.positionedGlyphs,C=S===void 0?[]:S,M=[],j=nf(C),ae;try{for(j.s();!(ae=j.n()).done;){var ge=ae.value,Ue=ge.metrics,Dt=4,Jt=Ue.advance*ge.scale/2,_r=E?[ge.x+Jt,ge.y]:[0,0],Dr=E?[0,0]:[ge.x+Jt+T[0],ge.y+T[1]],xn=(0-Dt)*ge.scale-Jt+Dr[0],gn=(0-Dt)*ge.scale+Dr[1],Bn=xn+Ue.width*ge.scale,Ei=gn+Ue.height*ge.scale,Ai={x:xn,y:gn},Ba={x:Bn,y:gn},sa={x:xn,y:Ei},ua={x:Bn,y:Ei};M.push({tl:Ai,tr:Ba,bl:sa,br:ua,tex:Ue,glyphOffset:_r})}}catch(no){j.e(no)}finally{j.f()}return M}function du(h,T){var E;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(E=ol(h))||T&&h&&typeof h.length=="number"){E&&(h=E);var S=0,C=function(){};return{s:C,n:function(){return S>=h.length?{done:!0}:{done:!1,value:h[S++]}},e:function(Ue){throw Ue},f:C}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,j=!1,ae;return{s:function(){E=h[Symbol.iterator]()},n:function(){var Ue=E.next();return M=Ue.done,Ue},e:function(Ue){j=!0,ae=Ue},f:function(){try{!M&&E.return!=null&&E.return()}finally{if(j)throw ae}}}}function ol(h,T){if(!!h){if(typeof h=="string")return sl(h,T);var E=Object.prototype.toString.call(h).slice(8,-1);if(E==="Object"&&h.constructor&&(E=h.constructor.name),E==="Map"||E==="Set")return Array.from(h);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return sl(h,T)}}function sl(h,T){(T==null||T>h.length)&&(T=h.length);for(var E=0,S=new Array(T);E<T;E++)S[E]=h[E];return S}function Ni(h){var T=pa();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function pa(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ms=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ea=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
   v_fontScale = fontScale;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
 highp float angle_sin = sin(a_Rotate);
 highp float angle_cos = cos(a_Rotate);
 mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  gl_Position = vec4(projected_position.xy / projected_position.w
    + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Zi(h){var T=this,E=h.id,S=[],C=[];if(!T.glyphInfoMap||!T.glyphInfoMap[E])return{vertices:[],indices:[],size:7};var M=T.glyphInfoMap[E].centroid,j=M.length===2?[M[0],M[1],0]:M;return T.glyphInfoMap[E].glyphQuads.forEach(function(ae,ge){S.push.apply(S,Vt()(j).concat([ae.tex.x,ae.tex.y+ae.tex.height,ae.tl.x,ae.tl.y],Vt()(j),[ae.tex.x+ae.tex.width,ae.tex.y+ae.tex.height,ae.tr.x,ae.tr.y],Vt()(j),[ae.tex.x+ae.tex.width,ae.tex.y,ae.br.x,ae.br.y],Vt()(j),[ae.tex.x,ae.tex.y,ae.bl.x,ae.bl.y])),C.push(0+ge*4,1+ge*4,2+ge*4,2+ge*4,3+ge*4,0+ge*4)}),{vertices:S,indices:C,size:7}}var ql=function(h){B()(E,h);var T=Ni(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.glyphInfo=void 0,S.glyphInfoMap={},S.texture=void 0,S.currentZoom=-1,S.extent=void 0,S.textureHeight=0,S.textCount=0,S.preTextStyle={},S.buildModels=function(){return S.initGlyph(),S.updateTexture(),S.filterGlyphs(),[S.layer.buildLayerModel({moduleName:"pointText",vertexShader:Ea,fragmentShader:Ms,triangulation:Zi.bind(Mt()(S)),depth:{enable:!1},blend:S.getBlend()})]},S}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=M===void 0?1:M,ae=C.stroke,ge=ae===void 0?"#fff":ae,Ue=C.strokeWidth,Dt=Ue===void 0?0:Ue,Jt=C.strokeOpacity,_r=Jt===void 0?1:Jt,Dr=C.textAnchor,xn=Dr===void 0?"center":Dr,gn=C.textAllowOverlap,Bn=gn===void 0?!1:gn,Ei=C.halo,Ai=Ei===void 0?.5:Ei,Ba=C.gamma,sa=Ba===void 0?2:Ba,ua=this.fontService,no=ua.canvas,Ci=ua.mapping;return Object.keys(Ci).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(Ci).length),this.preTextStyle={textAnchor:xn,textAllowOverlap:Bn},{u_opacity:j,u_stroke_opacity:_r,u_sdf_map:this.texture,u_stroke:Object(ze.s)(ge),u_halo_blur:Ai,u_gamma_scale:sa,u_sdf_map_size:[no.width,no.height],u_strokeWidth:Dt}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var C=this.layer.getLayerConfig(),M=C.textAnchor,j=M===void 0?"center":M,ae=C.textAllowOverlap,ge=ae===void 0?!0:ae;return this.preTextStyle={textAnchor:j,textAllowOverlap:ge},this.buildModels()}},{key:"needUpdate",value:function(){var C=this.layer.getLayerConfig(),M=C.textAllowOverlap,j=M===void 0?!1:M,ae=this.mapService.getZoom(),ge=this.mapService.getBounds(),Ue=Object(ze.j)(this.extent,ge);return!j&&(Math.abs(this.currentZoom-ae)>1||!Ue)||j!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:b.AttributeType.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,j,ae,ge){var Ue=M.rotate,Dt=Ue===void 0?0:Ue;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:b.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,j,ae,ge){return[ae[5],ae[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,j,ae,ge){var Ue=M.size,Dt=Ue===void 0?12:Ue;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:b.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,j,ae,ge){return[ae[3],ae[4]]}}})}},{key:"textExtent",value:function(){var C=this.mapService.getBounds();return Object(ze.r)(C,.5)}},{key:"initTextFont",value:function(){var C=this.layer.getLayerConfig(),M=C.fontWeight,j=M===void 0?"400":M,ae=C.fontFamily,ge=ae===void 0?"sans-serif":ae,Ue=this.layer.getEncodedData(),Dt=[];Ue.forEach(function(Jt){var _r=Jt.shape,Dr=_r===void 0?"":_r;Dr=Dr.toString();var xn=du(Dr),gn;try{for(xn.s();!(gn=xn.n()).done;){var Bn=gn.value;Dt.indexOf(Bn)===-1&&Dt.push(Bn)}}catch(Ei){xn.e(Ei)}finally{xn.f()}}),this.fontService.setFontOptions({characterSet:Dt,fontWeight:j,fontFamily:ge})}},{key:"generateGlyphLayout",value:function(){var C=this,M=this.fontService.mapping,j=this.layer.getLayerConfig(),ae=j.spacing,ge=ae===void 0?2:ae,Ue=j.textAnchor,Dt=Ue===void 0?"center":Ue,Jt=j.textOffset,_r=this.layer.getEncodedData();this.glyphInfo=_r.map(function(Dr){var xn=Dr.shape,gn=xn===void 0?"":xn,Bn=Dr.coordinates,Ei=Dr.id,Ai=Dr.size,Ba=Ai===void 0?1:Ai,sa=Wu(gn.toString(),M,Ba,Dt,"center",ge,Jt),ua=Ua(sa,Jt,!1);return Dr.shaping=sa,Dr.glyphQuads=ua,Dr.centroid=Ne(Bn),C.glyphInfoMap[Ei]={shaping:sa,glyphQuads:ua,centroid:Ne(Bn)},Dr})}},{key:"filterGlyphs",value:function(){var C=this,M=this.layer.getLayerConfig(),j=M.padding,ae=j===void 0?[4,4]:j,ge=M.textAllowOverlap,Ue=ge===void 0?!1:ge;if(!Ue){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var Dt=this.rendererService.getViewportSize(),Jt=Dt.width,_r=Dt.height,Dr=new Of(Jt,_r),xn=this.glyphInfo.filter(function(gn){var Bn=gn.shaping,Ei=gn.id,Ai=Ei===void 0?0:Ei,Ba=gn.centroid,sa=gn.size,ua=sa/24,no=C.mapService.lngLatToContainer(Ba),Ci=Dr.placeCollisionBox({x1:Bn.left*ua-ae[0],x2:Bn.right*ua+ae[0],y1:Bn.top*ua-ae[1],y2:Bn.bottom*ua+ae[1],anchorPointX:no.x,anchorPointY:no.y}),io=Ci.box;return io&&io.length?(Dr.insertCollisionBox(io,Ai),!0):!1});xn.forEach(function(gn){C.glyphInfoMap[gn.id]=gn})}}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var C=this.rendererService.createTexture2D,M=this.fontService.canvas;this.textureHeight=M.height,this.texture&&this.texture.destroy(),this.texture=C({data:M,mag:b.gl.LINEAR,min:b.gl.LINEAR,width:M.width,height:M.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Ea,fragmentShader:Ms,triangulation:Zi.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),E}(vt),yf={fill:$l,image:ru,normal:il,extrude:_a,text:ql,icon:Jl},as=yf;function ul(h){var T=pu();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function pu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Xu=function(h){B()(E,h);var T=ul(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.type="PointLayer",S}return a()(E,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new as[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return M[C]}},{key:"getModelType",value:function(){var C=this.getEncodedData(),M=this.getLayerConfig(),j=M.shape2d,ae=M.shape3d,ge=this.iconService.getIconMap(),Ue=C.find(function(Jt){return Jt.hasOwnProperty("shape")});if(Ue){var Dt=Ue.shape;return Dt==="dot"?"normal":(j==null?void 0:j.indexOf(Dt))!==-1?"fill":(ae==null?void 0:ae.indexOf(Dt))!==-1?"extrude":ge.hasOwnProperty(Dt)?"image":this.fontService.getGlyph(Dt)!==""?"icon":"text"}else return"normal"}}]),E}(ie);function oo(h){var T=os();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function os(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Nl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,ho=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,In=function(h){B()(E,h);var T=oo(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=M===void 0?1:M;return{u_opacity:j}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:ho,fragmentShader:Nl,triangulation:hi})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:b.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:b.gl.STATIC_DRAW,data:[],type:b.gl.FLOAT},size:3,update:function(M,j,ae,ge,Ue){return Ue}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:b.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(M,j,ae,ge){var Ue=M.size,Dt=Ue===void 0?10:Ue;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}})}}]),E}(vt);function js(h){var T=bc();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function bc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var El=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Pu=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,Us=function(h){B()(E,h);var T=js(E);function E(){return Z()(this,E),T.apply(this,arguments)}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=M===void 0?1:M;return{u_opacity:j}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:Pu,fragmentShader:El,triangulation:Ka,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),E}(vt),ea={fill:Us,line:vs,extrude:In,text:ql,point_fill:$l,point_image:ru,point_normal:il,point_extrude:_a},en=ea;function kc(h){var T=Sc();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function Sc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ll=function(h){B()(E,h);var T=kc(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.type="PolygonLayer",S}return a()(E,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new en[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var C,M=this.styleAttributeService.getLayerStyleAttribute("shape"),j=M==null||(C=M.scale)===null||C===void 0?void 0:C.field;return j==="fill"?"fill":j==="extrude"?"extrude":j==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var C=this.getEncodedData(),M=this.getLayerConfig(),j=M.shape2d,ae=M.shape3d,ge=this.iconService.getIconMap(),Ue=C.find(function(Jt){return Jt.hasOwnProperty("shape")});if(Ue){var Dt=Ue.shape;return Dt==="dot"?"point_normal":(j==null?void 0:j.indexOf(Dt))!==-1?"point_fill":(ae==null?void 0:ae.indexOf(Dt))!==-1?"point_extrude":ge.hasOwnProperty(Dt)?"point_image":"text"}else return"fill"}}]),E}(ie);function vu(h){var T=Is();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function Is(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Os=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,$o=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,ko=function(h){B()(E,h);var T=vu(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.texture=void 0,S.colorTexture=void 0,S}return a()(E,[{key:"getUninforms",value:function(){var C=this.layer.getLayerConfig(),M=C.opacity,j=M===void 0?1:M,ae=C.clampLow,ge=ae===void 0?!0:ae,Ue=C.clampHigh,Dt=Ue===void 0?!0:Ue,Jt=C.noDataValue,_r=Jt===void 0?-9999999:Jt,Dr=C.domain,xn=Dr===void 0?[0,1]:Dr;return this.updateColorTexure(),{u_opacity:j||1,u_texture:this.texture,u_domain:xn,u_clampLow:ge,u_clampHigh:typeof Dt!="undefined"?Dt:ge,u_noDataValue:_r,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var C=this.layer.getSource(),M=this.rendererService.createTexture2D,j=C.data.dataArray[0];this.texture=M({data:j.data,width:j.width,height:j.height,format:b.gl.LUMINANCE,type:b.gl.FLOAT});var ae=this.layer.getLayerConfig(),ge=ae.rampColors,Ue=Object(ze.n)(ge);return this.colorTexture=M({data:Ue.data,width:Ue.width,height:Ue.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:$o,fragmentShader:Os,triangulation:Ii,primitive:b.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:b.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:2,update:function(M,j,ae,ge){return[ae[3],ae[4]]}}})}},{key:"updateColorTexure",value:function(){var C=this.rendererService.createTexture2D,M=this.layer.getLayerConfig(),j=M.rampColors,ae=Object(ze.n)(j);this.colorTexture=C({data:ae.data,width:ae.width,height:ae.height,flipY:!1})}}]),E}(vt),cl={raster:ko,raster3d:ko},Tl=cl;function Fl(h){var T=af();return function(){var S=J()(h),C;if(T){var M=J()(this).constructor;C=Reflect.construct(S,arguments,M)}else C=S.apply(this,arguments);return re()(this,C)}}function af(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Bl=function(h){B()(E,h);var T=Fl(E);function E(){var S;Z()(this,E);for(var C=arguments.length,M=new Array(C),j=0;j<C;j++)M[j]=arguments[j];return S=T.call.apply(T,[this].concat(M)),S.type="RasterLayer",S}return a()(E,[{key:"buildModels",value:function(){var C=this.getModelType();this.layerModel=new Tl[C](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var C=this.getModelType(),M={raster:{},raster3d:{}};return M[C]}},{key:"getModelType",value:function(){return"raster"}}]),E}(ie),Ls,ss,Oi,Yu,Va,Mo,Al,mu;function gu(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(h);T&&(S=S.filter(function(C){return Object.getOwnPropertyDescriptor(h,C).enumerable})),E.push.apply(E,S)}return E}function Ts(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?gu(Object(E),!0).forEach(function(S){Re()(h,S,E[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):gu(Object(E)).forEach(function(S){Object.defineProperty(h,S,Object.getOwnPropertyDescriptor(E,S))})}return h}var Ec=(Ls=Object(dt.injectable)(),ss=Object(dt.inject)(b.TYPES.IGlobalConfigService),Oi=Object(dt.inject)(b.TYPES.ILogService),Ls(Yu=(Va=(mu=function(){function h(){Z()(this,h),Oe()(this,"configService",Mo,this),Oe()(this,"logger",Al,this)}return a()(h,[{key:"apply",value:function(E,S){var C=this,M=S.styleAttributeService;E.hooks.init.tap("DataMappingPlugin",function(){C.generateMaping(E,{styleAttributeService:M})}),E.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return E.dataState.dataMappingNeedUpdate=!1,C.generateMaping(E,{styleAttributeService:M}),!0}),E.hooks.beforeRender.tap("DataMappingPlugin",function(){if(!E.layerModelNeedUpdate){var j=M.getLayerStyleAttributes()||[],ae=M.getLayerStyleAttribute("filter"),ge=E.getSource().data.dataArray,Ue=j.filter(function(Jt){return Jt.needRemapping}),Dt=ge;(ae==null?void 0:ae.needRemapping)&&(ae==null?void 0:ae.scale)&&(Dt=ge.filter(function(Jt){return C.applyAttributeMapping(ae,Jt)[0]})),Ue.length&&((ae==null?void 0:ae.needRemapping)?(E.setEncodedData(C.mapping(j,Dt)),ae.needRemapping=!1):E.setEncodedData(C.mapping(Ue,Dt,E.getEncodedData())),C.logger.debug("remapping finished"),E.emit("remapping",null))}})}},{key:"generateMaping",value:function(E,S){var C=this,M=S.styleAttributeService,j=M.getLayerStyleAttributes()||[],ae=M.getLayerStyleAttribute("filter"),ge=E.getSource().data.dataArray,Ue=ge;(ae==null?void 0:ae.scale)&&(Ue=ge.filter(function(Dt){return C.applyAttributeMapping(ae,Dt)[0]})),E.setEncodedData(this.mapping(j,Ue))}},{key:"mapping",value:function(E,S,C){var M=this;return S.map(function(j,ae){var ge=C?C[ae]:{},Ue=Ts({id:j._id,coordinates:j.coordinates},ge);return E.filter(function(Dt){return Dt.scale!==void 0}).forEach(function(Dt){var Jt=M.applyAttributeMapping(Dt,j);Dt.needRemapping=!1,Dt.name==="color"&&(Jt=Jt.map(function(_r){return Object(ze.s)(_r)})),Ue[Dt.name]=Array.isArray(Jt)&&Jt.length===1?Jt[0]:Jt}),Ue})}},{key:"applyAttributeMapping",value:function(E,S){var C;if(!E.scale)return[];var M=(E==null||(C=E.scale)===null||C===void 0?void 0:C.scalers)||[],j=[];return M.forEach(function(ae){var ge,Ue=ae.field;(S.hasOwnProperty(Ue)||((ge=E.scale)===null||ge===void 0?void 0:ge.type)==="variable")&&j.push(S[Ue])}),E.mapping?E.mapping(j):[]}}]),h}(),mu),Mo=St()(Va.prototype,"configService",[ss],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Al=St()(Va.prototype,"logger",[Oi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Va))||Yu),$n=o("rlAn"),Fn,Tc,ms,jo=(Fn=Object(dt.injectable)(),Fn(Tc=(ms=function(){function h(){Z()(this,h),this.mapService=void 0}return a()(h,[{key:"apply",value:function(E){var S=this;this.mapService=E.getContainer().get(b.TYPES.IMapService),E.hooks.init.tap("DataSourcePlugin",function(){var C=E.sourceOption,M=C.data,j=C.options;E.setSource(new $n.default(M,j)),S.updateClusterData(E)}),E.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var C=S.updateClusterData(E),M=E.dataState.dataSourceNeedUpdate;return E.dataState.dataSourceNeedUpdate=!1,C||M})}},{key:"updateClusterData",value:function(E){var S=E.getSource(),C=S.cluster,M=S.clusterOptions,j=M.zoom,ae=j===void 0?0:j,ge=M.maxZoom,Ue=ge===void 0?16:ge,Dt=this.mapService.getZoom()-1;return C&&Math.abs(ae-Dt)>1&&Ue>ae?(S.updateClusterData(Math.floor(Dt)),!0):!1}}]),h}(),ms))||Tc),Io=o("7tbW"),nu=o.n(Io),_u=o("4qC0"),ec=o.n(_u),Wi=o("J2iB"),Wa=o.n(Wi),fl=function(h,T){return h<T?-1:h>T?1:h>=T?0:NaN},hl=function(h){return h.length===1&&(h=tc(h)),{left:function(E,S,C,M){for(C==null&&(C=0),M==null&&(M=E.length);C<M;){var j=C+M>>>1;h(E[j],S)<0?C=j+1:M=j}return C},right:function(E,S,C,M){for(C==null&&(C=0),M==null&&(M=E.length);C<M;){var j=C+M>>>1;h(E[j],S)>0?M=j:C=j+1}return C}}};function tc(h){return function(T,E){return fl(h(T),E)}}var Mu=hl(fl),Rs=Mu.right,kl=Mu.left,gs=Rs,xf=function(h,T){T==null&&(T=jl);for(var E=0,S=h.length-1,C=h[0],M=new Array(S<0?0:S);E<S;)M[E]=T(C,C=h[++E]);return M};function jl(h,T){return[h,T]}var jc=function(h,T,E){var S=h.length,C=T.length,M=new Array(S*C),j,ae,ge,Ue;for(E==null&&(E=jl),j=ge=0;j<S;++j)for(Ue=h[j],ae=0;ae<C;++ae,++ge)M[ge]=E(Ue,T[ae]);return M},bf=function(h,T){return T<h?-1:T>h?1:T>=h?0:NaN},Vs=function(h){return h===null?NaN:+h},Cl=function(h,T){var E=h.length,S=0,C=-1,M=0,j,ae,ge=0;if(T==null)for(;++C<E;)isNaN(j=Vs(h[C]))||(ae=j-M,M+=ae/++S,ge+=ae*(j-M));else for(;++C<E;)isNaN(j=Vs(T(h[C],C,h)))||(ae=j-M,M+=ae/++S,ge+=ae*(j-M));if(S>1)return ge/(S-1)},Ul=function(h,T){var E=Cl(h,T);return E&&Math.sqrt(E)},Iu=function(h,T){var E=h.length,S=-1,C,M,j;if(T==null){for(;++S<E;)if((C=h[S])!=null&&C>=C)for(M=j=C;++S<E;)(C=h[S])!=null&&(M>C&&(M=C),j<C&&(j=C))}else for(;++S<E;)if((C=T(h[S],S,h))!=null&&C>=C)for(M=j=C;++S<E;)(C=T(h[S],S,h))!=null&&(M>C&&(M=C),j<C&&(j=C));return[M,j]},Ou=Array.prototype,wl=Ou.slice,Ku=Ou.map,Ds=function(h){return function(){return h}},Ac=function(h){return h},rc=function(h,T,E){h=+h,T=+T,E=(C=arguments.length)<2?(T=h,h=0,1):C<3?1:+E;for(var S=-1,C=Math.max(0,Math.ceil((T-h)/E))|0,M=new Array(C);++S<C;)M[S]=h+S*E;return M},nc=Math.sqrt(50),ic=Math.sqrt(10),u=Math.sqrt(2),i=function(h,T,E){var S,C=-1,M,j,ae;if(T=+T,h=+h,E=+E,h===T&&E>0)return[h];if((S=T<h)&&(M=h,h=T,T=M),(ae=n(h,T,E))===0||!isFinite(ae))return[];if(ae>0)for(h=Math.ceil(h/ae),T=Math.floor(T/ae),j=new Array(M=Math.ceil(T-h+1));++C<M;)j[C]=(h+C)*ae;else for(h=Math.floor(h*ae),T=Math.ceil(T*ae),j=new Array(M=Math.ceil(h-T+1));++C<M;)j[C]=(h-C)/ae;return S&&j.reverse(),j};function n(h,T,E){var S=(T-h)/Math.max(0,E),C=Math.floor(Math.log(S)/Math.LN10),M=S/Math.pow(10,C);return C>=0?(M>=nc?10:M>=ic?5:M>=u?2:1)*Math.pow(10,C):-Math.pow(10,-C)/(M>=nc?10:M>=ic?5:M>=u?2:1)}function c(h,T,E){var S=Math.abs(T-h)/Math.max(0,E),C=Math.pow(10,Math.floor(Math.log(S)/Math.LN10)),M=S/C;return M>=nc?C*=10:M>=ic?C*=5:M>=u&&(C*=2),T<h?-C:C}var y=function(h){return Math.ceil(Math.log(h.length)/Math.LN2)+1},_=function(){var h=Ac,T=Iu,E=y;function S(C){var M,j=C.length,ae,ge=new Array(j);for(M=0;M<j;++M)ge[M]=h(C[M],M,C);var Ue=T(ge),Dt=Ue[0],Jt=Ue[1],_r=E(ge,Dt,Jt);Array.isArray(_r)||(_r=c(Dt,Jt,_r),_r=rc(Math.ceil(Dt/_r)*_r,Jt,_r));for(var Dr=_r.length;_r[0]<=Dt;)_r.shift(),--Dr;for(;_r[Dr-1]>Jt;)_r.pop(),--Dr;var xn=new Array(Dr+1),gn;for(M=0;M<=Dr;++M)gn=xn[M]=[],gn.x0=M>0?_r[M-1]:Dt,gn.x1=M<Dr?_r[M]:Jt;for(M=0;M<j;++M)ae=ge[M],Dt<=ae&&ae<=Jt&&xn[gs(_r,ae,0,Dr)].push(C[M]);return xn}return S.value=function(C){return arguments.length?(h=typeof C=="function"?C:Ds(C),S):h},S.domain=function(C){return arguments.length?(T=typeof C=="function"?C:Ds([C[0],C[1]]),S):T},S.thresholds=function(C){return arguments.length?(E=typeof C=="function"?C:Array.isArray(C)?Ds(wl.call(C)):Ds(C),S):E},S},O=function(h,T,E){if(E==null&&(E=Vs),!!(S=h.length)){if((T=+T)<=0||S<2)return+E(h[0],0,h);if(T>=1)return+E(h[S-1],S-1,h);var S,C=(S-1)*T,M=Math.floor(C),j=+E(h[M],M,h),ae=+E(h[M+1],M+1,h);return j+(ae-j)*(C-M)}},k=function(h,T,E){return h=Ku.call(h,Vs).sort(fl),Math.ceil((E-T)/(2*(O(h,.75)-O(h,.25))*Math.pow(h.length,-1/3)))},ue=function(h,T,E){return Math.ceil((E-T)/(3.5*Ul(h)*Math.pow(h.length,-1/3)))},Ae=function(h,T){var E=h.length,S=-1,C,M;if(T==null){for(;++S<E;)if((C=h[S])!=null&&C>=C)for(M=C;++S<E;)(C=h[S])!=null&&C>M&&(M=C)}else for(;++S<E;)if((C=T(h[S],S,h))!=null&&C>=C)for(M=C;++S<E;)(C=T(h[S],S,h))!=null&&C>M&&(M=C);return M},We=function(h,T){var E=h.length,S=E,C=-1,M,j=0;if(T==null)for(;++C<E;)isNaN(M=Vs(h[C]))?--S:j+=M;else for(;++C<E;)isNaN(M=Vs(T(h[C],C,h)))?--S:j+=M;if(S)return j/S},Je=function(h,T){var E=h.length,S=-1,C,M=[];if(T==null)for(;++S<E;)isNaN(C=Vs(h[S]))||M.push(C);else for(;++S<E;)isNaN(C=Vs(T(h[S],S,h)))||M.push(C);return O(M.sort(fl),.5)},rt=function(h){for(var T=h.length,E,S=-1,C=0,M,j;++S<T;)C+=h[S].length;for(M=new Array(C);--T>=0;)for(j=h[T],E=j.length;--E>=0;)M[--C]=j[E];return M},Ft=function(h,T){var E=h.length,S=-1,C,M;if(T==null){for(;++S<E;)if((C=h[S])!=null&&C>=C)for(M=C;++S<E;)(C=h[S])!=null&&M>C&&(M=C)}else for(;++S<E;)if((C=T(h[S],S,h))!=null&&C>=C)for(M=C;++S<E;)(C=T(h[S],S,h))!=null&&M>C&&(M=C);return M},Rt=function(h,T){for(var E=T.length,S=new Array(E);E--;)S[E]=h[T[E]];return S},Yt=function(h,T){if(!!(E=h.length)){var E,S=0,C=0,M,j=h[C];for(T==null&&(T=fl);++S<E;)(T(M=h[S],j)<0||T(j,j)!==0)&&(j=M,C=S);if(T(j,j)===0)return C}},zt=function(h,T,E){for(var S=(E==null?h.length:E)-(T=T==null?0:+T),C,M;S;)M=Math.random()*S--|0,C=h[S+T],h[S+T]=h[M+T],h[M+T]=C;return h},Ut=function(h,T){var E=h.length,S=-1,C,M=0;if(T==null)for(;++S<E;)(C=+h[S])&&(M+=C);else for(;++S<E;)(C=+T(h[S],S,h))&&(M+=C);return M},nr=function(h){if(!(M=h.length))return[];for(var T=-1,E=Ft(h,rr),S=new Array(E);++T<E;)for(var C=-1,M,j=S[T]=new Array(M);++C<M;)j[C]=h[C][T];return S};function rr(h){return h.length}var Or=function(){return nr(arguments)};function hr(h,T){switch(arguments.length){case 0:break;case 1:this.range(h);break;default:this.range(T).domain(h);break}return this}function Tr(h,T){switch(arguments.length){case 0:break;case 1:this.interpolator(h);break;default:this.interpolator(T).domain(h);break}return this}var Cr="$";function an(){}an.prototype=Yr.prototype={constructor:an,has:function(T){return Cr+T in this},get:function(T){return this[Cr+T]},set:function(T,E){return this[Cr+T]=E,this},remove:function(T){var E=Cr+T;return E in this&&delete this[E]},clear:function(){for(var T in this)T[0]===Cr&&delete this[T]},keys:function(){var T=[];for(var E in this)E[0]===Cr&&T.push(E.slice(1));return T},values:function(){var T=[];for(var E in this)E[0]===Cr&&T.push(this[E]);return T},entries:function(){var T=[];for(var E in this)E[0]===Cr&&T.push({key:E.slice(1),value:this[E]});return T},size:function(){var T=0;for(var E in this)E[0]===Cr&&++T;return T},empty:function(){for(var T in this)if(T[0]===Cr)return!1;return!0},each:function(T){for(var E in this)E[0]===Cr&&T(this[E],E.slice(1),this)}};function Yr(h,T){var E=new an;if(h instanceof an)h.each(function(ae,ge){E.set(ge,ae)});else if(Array.isArray(h)){var S=-1,C=h.length,M;if(T==null)for(;++S<C;)E.set(S,h[S]);else for(;++S<C;)E.set(T(M=h[S],S,h),M)}else if(h)for(var j in h)E.set(j,h[j]);return E}var yn=Yr,On=function(){var h=[],T=[],E,S,C;function M(ae,ge,Ue,Dt){if(ge>=h.length)return E!=null&&ae.sort(E),S!=null?S(ae):ae;for(var Jt=-1,_r=ae.length,Dr=h[ge++],xn,gn,Bn=yn(),Ei,Ai=Ue();++Jt<_r;)(Ei=Bn.get(xn=Dr(gn=ae[Jt])+""))?Ei.push(gn):Bn.set(xn,[gn]);return Bn.each(function(Ba,sa){Dt(Ai,sa,M(Ba,ge,Ue,Dt))}),Ai}function j(ae,ge){if(++ge>h.length)return ae;var Ue,Dt=T[ge-1];return S!=null&&ge>=h.length?Ue=ae.entries():(Ue=[],ae.each(function(Jt,_r){Ue.push({key:_r,values:j(Jt,ge)})})),Dt!=null?Ue.sort(function(Jt,_r){return Dt(Jt.key,_r.key)}):Ue}return C={object:function(ge){return M(ge,0,Qn,oi)},map:function(ge){return M(ge,0,xi,Xi)},entries:function(ge){return j(M(ge,0,xi,Xi),0)},key:function(ge){return h.push(ge),C},sortKeys:function(ge){return T[h.length-1]=ge,C},sortValues:function(ge){return E=ge,C},rollup:function(ge){return S=ge,C}}};function Qn(){return{}}function oi(h,T,E){h[T]=E}function xi(){return yn()}function Xi(h,T,E){h.set(T,E)}function An(){}var si=yn.prototype;An.prototype=bi.prototype={constructor:An,has:si.has,add:function(T){return T+="",this[Cr+T]=T,this},remove:si.remove,clear:si.clear,values:si.keys,size:si.size,empty:si.empty,each:si.each};function bi(h,T){var E=new An;if(h instanceof An)h.each(function(M){E.add(M)});else if(h){var S=-1,C=h.length;if(T==null)for(;++S<C;)E.add(h[S]);else for(;++S<C;)E.add(T(h[S],S,h))}return E}var Wn=bi,Ti=function(h){var T=[];for(var E in h)T.push(E);return T},ii=function(h){var T=[];for(var E in h)T.push(h[E]);return T},Li=function(h){var T=[];for(var E in h)T.push({key:E,value:h[E]});return T},ji=Array.prototype,qa=ji.map,Ma=ji.slice,So={name:"implicit"};function Ta(){var h=yn(),T=[],E=[],S=So;function C(M){var j=M+"",ae=h.get(j);if(!ae){if(S!==So)return S;h.set(j,ae=T.push(M))}return E[(ae-1)%E.length]}return C.domain=function(M){if(!arguments.length)return T.slice();T=[],h=yn();for(var j=-1,ae=M.length,ge,Ue;++j<ae;)h.has(Ue=(ge=M[j])+"")||h.set(Ue,T.push(ge));return C},C.range=function(M){return arguments.length?(E=Ma.call(M),C):E.slice()},C.unknown=function(M){return arguments.length?(S=M,C):S},C.copy=function(){return Ta(T,E).unknown(S)},hr.apply(C,arguments),C}function Xa(){var h=Ta().unknown(void 0),T=h.domain,E=h.range,S=[0,1],C,M,j=!1,ae=0,ge=0,Ue=.5;delete h.unknown;function Dt(){var Jt=T().length,_r=S[1]<S[0],Dr=S[_r-0],xn=S[1-_r];C=(xn-Dr)/Math.max(1,Jt-ae+ge*2),j&&(C=Math.floor(C)),Dr+=(xn-Dr-C*(Jt-ae))*Ue,M=C*(1-ae),j&&(Dr=Math.round(Dr),M=Math.round(M));var gn=rc(Jt).map(function(Bn){return Dr+C*Bn});return E(_r?gn.reverse():gn)}return h.domain=function(Jt){return arguments.length?(T(Jt),Dt()):T()},h.range=function(Jt){return arguments.length?(S=[+Jt[0],+Jt[1]],Dt()):S.slice()},h.rangeRound=function(Jt){return S=[+Jt[0],+Jt[1]],j=!0,Dt()},h.bandwidth=function(){return M},h.step=function(){return C},h.round=function(Jt){return arguments.length?(j=!!Jt,Dt()):j},h.padding=function(Jt){return arguments.length?(ae=Math.min(1,ge=+Jt),Dt()):ae},h.paddingInner=function(Jt){return arguments.length?(ae=Math.min(1,Jt),Dt()):ae},h.paddingOuter=function(Jt){return arguments.length?(ge=+Jt,Dt()):ge},h.align=function(Jt){return arguments.length?(Ue=Math.max(0,Math.min(1,Jt)),Dt()):Ue},h.copy=function(){return Xa(T(),S).round(j).paddingInner(ae).paddingOuter(ge).align(Ue)},hr.apply(Dt(),arguments)}function zs(h){var T=h.copy;return h.padding=h.paddingOuter,delete h.paddingInner,delete h.paddingOuter,h.copy=function(){return zs(T())},h}function Eo(){return zs(Xa.apply(null,arguments).paddingInner(1))}var yu=o("FmoU");function xu(h,T,E,S,C){var M=h*h,j=M*h;return((1-3*h+3*M-j)*T+(4-6*M+3*j)*E+(1+3*h+3*M-3*j)*S+j*C)/6}var Uo=function(h){var T=h.length-1;return function(E){var S=E<=0?E=0:E>=1?(E=1,T-1):Math.floor(E*T),C=h[S],M=h[S+1],j=S>0?h[S-1]:2*C-M,ae=S<T-1?h[S+2]:2*M-C;return xu((E-S/T)*T,j,C,M,ae)}},As=function(h){var T=h.length;return function(E){var S=Math.floor(((E%=1)<0?++E:E)*T),C=h[(S+T-1)%T],M=h[S%T],j=h[(S+1)%T],ae=h[(S+2)%T];return xu((E-S/T)*T,C,M,j,ae)}},Lu=function(h){return function(){return h}};function ac(h,T){return function(E){return h+E*T}}function $u(h,T,E){return h=Math.pow(h,E),T=Math.pow(T,E)-h,E=1/E,function(S){return Math.pow(h+S*T,E)}}function oc(h,T){var E=T-h;return E?ac(h,E>180||E<-180?E-360*Math.round(E/360):E):Lu(isNaN(h)?T:h)}function sc(h){return(h=+h)==1?Ru:function(T,E){return E-T?$u(T,E,h):Lu(isNaN(T)?E:T)}}function Ru(h,T){var E=T-h;return E?ac(h,E):Lu(isNaN(h)?T:h)}var dl=function h(T){var E=sc(T);function S(C,M){var j=E((C=Object(yu.b)(C)).r,(M=Object(yu.b)(M)).r),ae=E(C.g,M.g),ge=E(C.b,M.b),Ue=Ru(C.opacity,M.opacity);return function(Dt){return C.r=j(Dt),C.g=ae(Dt),C.b=ge(Dt),C.opacity=Ue(Dt),C+""}}return S.gamma=h,S}(1);function Cs(h){return function(T){var E=T.length,S=new Array(E),C=new Array(E),M=new Array(E),j,ae;for(j=0;j<E;++j)ae=Object(yu.b)(T[j]),S[j]=ae.r||0,C[j]=ae.g||0,M[j]=ae.b||0;return S=h(S),C=h(C),M=h(M),ae.opacity=1,function(ge){return ae.r=S(ge),ae.g=C(ge),ae.b=M(ge),ae+""}}}var po=Cs(Uo),Du=Cs(As),bu=function(h,T){T||(T=[]);var E=h?Math.min(T.length,h.length):0,S=T.slice(),C;return function(M){for(C=0;C<E;++C)S[C]=h[C]*(1-M)+T[C]*M;return S}};function Oo(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)}var Lo=function(h,T){return(Oo(T)?bu:Ro)(h,T)};function Ro(h,T){var E=T?T.length:0,S=h?Math.min(E,h.length):0,C=new Array(S),M=new Array(E),j;for(j=0;j<S;++j)C[j]=zu(h[j],T[j]);for(;j<E;++j)M[j]=T[j];return function(ae){for(j=0;j<S;++j)M[j]=C[j](ae);return M}}var Jo=function(h,T){var E=new Date;return h=+h,T=+T,function(S){return E.setTime(h*(1-S)+T*S),E}},To=function(h,T){return h=+h,T=+T,function(E){return h*(1-E)+T*E}},Vo=function(h,T){var E={},S={},C;(h===null||typeof h!="object")&&(h={}),(T===null||typeof T!="object")&&(T={});for(C in T)C in h?E[C]=zu(h[C],T[C]):S[C]=T[C];return function(M){for(C in E)S[C]=E[C](M);return S}},Gs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Pl=new RegExp(Gs.source,"g");function Uc(h){return function(){return h}}function Vl(h){return function(T){return h(T)+""}}var Ju=function(h,T){var E=Gs.lastIndex=Pl.lastIndex=0,S,C,M,j=-1,ae=[],ge=[];for(h=h+"",T=T+"";(S=Gs.exec(h))&&(C=Pl.exec(T));)(M=C.index)>E&&(M=T.slice(E,M),ae[j]?ae[j]+=M:ae[++j]=M),(S=S[0])===(C=C[0])?ae[j]?ae[j]+=C:ae[++j]=C:(ae[++j]=null,ge.push({i:j,x:To(S,C)})),E=Pl.lastIndex;return E<T.length&&(M=T.slice(E),ae[j]?ae[j]+=M:ae[++j]=M),ae.length<2?ge[0]?Vl(ge[0].x):Uc(T):(T=ge.length,function(Ue){for(var Dt=0,Jt;Dt<T;++Dt)ae[(Jt=ge[Dt]).i]=Jt.x(Ue);return ae.join("")})},zu=function(h,T){var E=typeof T,S;return T==null||E==="boolean"?Lu(T):(E==="number"?To:E==="string"?(S=Object(yu.a)(T))?(T=S,dl):Ju:T instanceof yu.a?dl:T instanceof Date?Jo:Oo(T)?bu:Array.isArray(T)?Ro:typeof T.valueOf!="function"&&typeof T.toString!="function"||isNaN(T)?Vo:To)(h,T)},Nu=function(h,T){return h=+h,T=+T,function(E){return Math.round(h*(1-E)+T*E)}},Hs=function(h){return function(){return h}},Do=function(h){return+h},Vc=[0,1];function ys(h){return h}function of(h,T){return(T-=h=+h)?function(E){return(E-h)/T}:Hs(isNaN(T)?NaN:.5)}function Lf(h){var T=h[0],E=h[h.length-1],S;return T>E&&(S=T,T=E,E=S),function(C){return Math.max(T,Math.min(E,C))}}function Rf(h,T,E){var S=h[0],C=h[1],M=T[0],j=T[1];return C<S?(S=of(C,S),M=E(j,M)):(S=of(S,C),M=E(M,j)),function(ae){return M(S(ae))}}function Uf(h,T,E){var S=Math.min(h.length,T.length)-1,C=new Array(S),M=new Array(S),j=-1;for(h[S]<h[0]&&(h=h.slice().reverse(),T=T.slice().reverse());++j<S;)C[j]=of(h[j],h[j+1]),M[j]=E(T[j],T[j+1]);return function(ae){var ge=gs(h,ae,1,S)-1;return M[ge](C[ge](ae))}}function Qu(h,T){return T.domain(h.domain()).range(h.range()).interpolate(h.interpolate()).clamp(h.clamp()).unknown(h.unknown())}function Sf(){var h=Vc,T=Vc,E=zu,S,C,M,j=ys,ae,ge,Ue;function Dt(){return ae=Math.min(h.length,T.length)>2?Uf:Rf,ge=Ue=null,Jt}function Jt(_r){return isNaN(_r=+_r)?M:(ge||(ge=ae(h.map(S),T,E)))(S(j(_r)))}return Jt.invert=function(_r){return j(C((Ue||(Ue=ae(T,h.map(S),To)))(_r)))},Jt.domain=function(_r){return arguments.length?(h=qa.call(_r,Do),j===ys||(j=Lf(h)),Dt()):h.slice()},Jt.range=function(_r){return arguments.length?(T=Ma.call(_r),Dt()):T.slice()},Jt.rangeRound=function(_r){return T=Ma.call(_r),E=Nu,Dt()},Jt.clamp=function(_r){return arguments.length?(j=_r?Lf(h):ys,Jt):j!==ys},Jt.interpolate=function(_r){return arguments.length?(E=_r,Dt()):E},Jt.unknown=function(_r){return arguments.length?(M=_r,Jt):M},function(_r,Dr){return S=_r,C=Dr,Dt()}}function sf(h,T){return Sf()(h,T)}var uc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Fu(h){if(!(T=uc.exec(h)))throw new Error("invalid format: "+h);var T;return new lc({fill:T[1],align:T[2],sign:T[3],symbol:T[4],zero:T[5],width:T[6],comma:T[7],precision:T[8]&&T[8].slice(1),trim:T[9],type:T[10]})}Fu.prototype=lc.prototype;function lc(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}lc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var Vf=function(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)};function Cc(h,T){if((E=(h=T?h.toExponential(T-1):h.toExponential()).indexOf("e"))<0)return null;var E,S=h.slice(0,E);return[S.length>1?S[0]+S.slice(2):S,+h.slice(E+1)]}var wc=function(h){return h=Cc(Math.abs(h)),h?h[1]:NaN},Gf=function(h,T){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(wc(T)/3)))*3-wc(Math.abs(h)))},Hf=function(h,T){return function(E,S){for(var C=E.length,M=[],j=0,ae=h[0],ge=0;C>0&&ae>0&&(ge+ae+1>S&&(ae=Math.max(1,S-ge)),M.push(E.substring(C-=ae,C+ae)),!((ge+=ae+1)>S));)ae=h[j=(j+1)%h.length];return M.reverse().join(T)}},ah=function(h){return function(T){return T.replace(/[0-9]/g,function(E){return h[+E]})}},Zf=function(h){e:for(var T=h.length,E=1,S=-1,C;E<T;++E)switch(h[E]){case".":S=C=E;break;case"0":S===0&&(S=E),C=E;break;default:if(!+h[E])break e;S>0&&(S=0);break}return S>0?h.slice(0,S)+h.slice(C+1):h},Df,ch=function(h,T){var E=Cc(h,T);if(!E)return h+"";var S=E[0],C=E[1],M=C-(Df=Math.max(-8,Math.min(8,Math.floor(C/3)))*3)+1,j=S.length;return M===j?S:M>j?S+new Array(M-j+1).join("0"):M>0?S.slice(0,M)+"."+S.slice(M):"0."+new Array(1-M).join("0")+Cc(h,Math.max(0,T+M-1))[0]},cc=function(h,T){var E=Cc(h,T);if(!E)return h+"";var S=E[0],C=E[1];return C<0?"0."+new Array(-C).join("0")+S:S.length>C+1?S.slice(0,C+1)+"."+S.slice(C+1):S+new Array(C-S.length+2).join("0")},uf={"%":function(T,E){return(T*100).toFixed(E)},b:function(T){return Math.round(T).toString(2)},c:function(T){return T+""},d:Vf,e:function(T,E){return T.toExponential(E)},f:function(T,E){return T.toFixed(E)},g:function(T,E){return T.toPrecision(E)},o:function(T){return Math.round(T).toString(8)},p:function(T,E){return cc(T*100,E)},r:cc,s:ch,X:function(T){return Math.round(T).toString(16).toUpperCase()},x:function(T){return Math.round(T).toString(16)}},so=function(h){return h},Gl=Array.prototype.map,lf=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Gc=function(h){var T=h.grouping===void 0||h.thousands===void 0?so:Hf(Gl.call(h.grouping,Number),h.thousands+""),E=h.currency===void 0?"":h.currency[0]+"",S=h.currency===void 0?"":h.currency[1]+"",C=h.decimal===void 0?".":h.decimal+"",M=h.numerals===void 0?so:ah(Gl.call(h.numerals,String)),j=h.percent===void 0?"%":h.percent+"",ae=h.minus===void 0?"-":h.minus+"",ge=h.nan===void 0?"NaN":h.nan+"";function Ue(Jt){Jt=Fu(Jt);var _r=Jt.fill,Dr=Jt.align,xn=Jt.sign,gn=Jt.symbol,Bn=Jt.zero,Ei=Jt.width,Ai=Jt.comma,Ba=Jt.precision,sa=Jt.trim,ua=Jt.type;ua==="n"?(Ai=!0,ua="g"):uf[ua]||(Ba===void 0&&(Ba=12),sa=!0,ua="g"),(Bn||_r==="0"&&Dr==="=")&&(Bn=!0,_r="0",Dr="=");var no=gn==="$"?E:gn==="#"&&/[boxX]/.test(ua)?"0"+ua.toLowerCase():"",Ci=gn==="$"?S:/[%p]/.test(ua)?j:"",io=uf[ua],Co=/[defgprs%]/.test(ua);Ba=Ba===void 0?6:/[gprs]/.test(ua)?Math.max(1,Math.min(21,Ba)):Math.max(0,Math.min(20,Ba));function Ys(Yi){var Ps=no,rs=Ci,vf,Nh,_c;if(ua==="c")rs=io(Yi)+rs,Yi="";else{Yi=+Yi;var Sh=Yi<0||1/Yi<0;if(Yi=isNaN(Yi)?ge:io(Math.abs(Yi),Ba),sa&&(Yi=Zf(Yi)),Sh&&+Yi==0&&xn!=="+"&&(Sh=!1),Ps=(Sh?xn==="("?xn:ae:xn==="-"||xn==="("?"":xn)+Ps,rs=(ua==="s"?lf[8+Df/3]:"")+rs+(Sh&&xn==="("?")":""),Co){for(vf=-1,Nh=Yi.length;++vf<Nh;)if(_c=Yi.charCodeAt(vf),48>_c||_c>57){rs=(_c===46?C+Yi.slice(vf+1):Yi.slice(vf))+rs,Yi=Yi.slice(0,vf);break}}}Ai&&!Bn&&(Yi=T(Yi,Infinity));var uh=Ps.length+Yi.length+rs.length,$c=uh<Ei?new Array(Ei-uh+1).join(_r):"";switch(Ai&&Bn&&(Yi=T($c+Yi,$c.length?Ei-rs.length:Infinity),$c=""),Dr){case"<":Yi=Ps+Yi+rs+$c;break;case"=":Yi=Ps+$c+Yi+rs;break;case"^":Yi=$c.slice(0,uh=$c.length>>1)+Ps+Yi+rs+$c.slice(uh);break;default:Yi=$c+Ps+Yi+rs;break}return M(Yi)}return Ys.toString=function(){return Jt+""},Ys}function Dt(Jt,_r){var Dr=Ue((Jt=Fu(Jt),Jt.type="f",Jt)),xn=Math.max(-8,Math.min(8,Math.floor(wc(_r)/3)))*3,gn=Math.pow(10,-xn),Bn=lf[8+xn/3];return function(Ei){return Dr(gn*Ei)+Bn}}return{format:Ue,formatPrefix:Dt}},iu,_l,Ef;Tf({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Tf(h){return iu=Gc(h),_l=iu.format,Ef=iu.formatPrefix,iu}var Hc=function(h,T){return h=Math.abs(h),T=Math.abs(T)-h,Math.max(0,wc(T)-wc(h))+1},cf=function(h){return Math.max(0,-wc(Math.abs(h)))},Zc=function(h,T,E,S){var C=c(h,T,E),M;switch(S=Fu(S==null?",f":S),S.type){case"s":{var j=Math.max(Math.abs(h),Math.abs(T));return S.precision==null&&!isNaN(M=Gf(C,j))&&(S.precision=M),Ef(S,j)}case"":case"e":case"g":case"p":case"r":{S.precision==null&&!isNaN(M=Hc(C,Math.max(Math.abs(h),Math.abs(T))))&&(S.precision=M-(S.type==="e"));break}case"f":case"%":{S.precision==null&&!isNaN(M=cf(C))&&(S.precision=M-(S.type==="%")*2);break}}return _l(S)};function Hl(h){var T=h.domain;return h.ticks=function(E){var S=T();return i(S[0],S[S.length-1],E==null?10:E)},h.tickFormat=function(E,S){var C=T();return Zc(C[0],C[C.length-1],E==null?10:E,S)},h.nice=function(E){E==null&&(E=10);var S=T(),C=0,M=S.length-1,j=S[C],ae=S[M],ge;return ae<j&&(ge=j,j=ae,ae=ge,ge=C,C=M,M=ge),ge=n(j,ae,E),ge>0?(j=Math.floor(j/ge)*ge,ae=Math.ceil(ae/ge)*ge,ge=n(j,ae,E)):ge<0&&(j=Math.ceil(j*ge)/ge,ae=Math.floor(ae*ge)/ge,ge=n(j,ae,E)),ge>0?(S[C]=Math.floor(j/ge)*ge,S[M]=Math.ceil(ae/ge)*ge,T(S)):ge<0&&(S[C]=Math.ceil(j*ge)/ge,S[M]=Math.floor(ae*ge)/ge,T(S)),h},h}function ne(){var h=sf(ys,ys);return h.copy=function(){return Qu(h,ne())},hr.apply(h,arguments),Hl(h)}function oe(h){var T;function E(S){return isNaN(S=+S)?T:S}return E.invert=E,E.domain=E.range=function(S){return arguments.length?(h=qa.call(S,Do),E):h.slice()},E.unknown=function(S){return arguments.length?(T=S,E):T},E.copy=function(){return oe(h).unknown(T)},h=arguments.length?qa.call(h,Do):[0,1],Hl(E)}var D=function(h,T){h=h.slice();var E=0,S=h.length-1,C=h[E],M=h[S],j;return M<C&&(j=E,E=S,S=j,j=C,C=M,M=j),h[E]=T.floor(C),h[S]=T.ceil(M),h};function U(h){return Math.log(h)}function Ee(h){return Math.exp(h)}function tt(h){return-Math.log(-h)}function Gt(h){return-Math.exp(-h)}function tr(h){return isFinite(h)?+("1e"+h):h<0?0:h}function er(h){return h===10?tr:h===Math.E?Math.exp:function(T){return Math.pow(h,T)}}function Pr(h){return h===Math.E?Math.log:h===10&&Math.log10||h===2&&Math.log2||(h=Math.log(h),function(T){return Math.log(T)/h})}function Jr(h){return function(T){return-h(-T)}}function Rn(h){var T=h(U,Ee),E=T.domain,S=10,C,M;function j(){return C=Pr(S),M=er(S),E()[0]<0?(C=Jr(C),M=Jr(M),h(tt,Gt)):h(U,Ee),T}return T.base=function(ae){return arguments.length?(S=+ae,j()):S},T.domain=function(ae){return arguments.length?(E(ae),j()):E()},T.ticks=function(ae){var ge=E(),Ue=ge[0],Dt=ge[ge.length-1],Jt;(Jt=Dt<Ue)&&(_r=Ue,Ue=Dt,Dt=_r);var _r=C(Ue),Dr=C(Dt),xn,gn,Bn,Ei=ae==null?10:+ae,Ai=[];if(!(S%1)&&Dr-_r<Ei){if(_r=Math.round(_r)-1,Dr=Math.round(Dr)+1,Ue>0){for(;_r<Dr;++_r)for(gn=1,xn=M(_r);gn<S;++gn)if(Bn=xn*gn,!(Bn<Ue)){if(Bn>Dt)break;Ai.push(Bn)}}else for(;_r<Dr;++_r)for(gn=S-1,xn=M(_r);gn>=1;--gn)if(Bn=xn*gn,!(Bn<Ue)){if(Bn>Dt)break;Ai.push(Bn)}}else Ai=i(_r,Dr,Math.min(Dr-_r,Ei)).map(M);return Jt?Ai.reverse():Ai},T.tickFormat=function(ae,ge){if(ge==null&&(ge=S===10?".0e":","),typeof ge!="function"&&(ge=_l(ge)),ae===Infinity)return ge;ae==null&&(ae=10);var Ue=Math.max(1,S*ae/T.ticks().length);return function(Dt){var Jt=Dt/M(Math.round(C(Dt)));return Jt*S<S-.5&&(Jt*=S),Jt<=Ue?ge(Dt):""}},T.nice=function(){return E(D(E(),{floor:function(ge){return M(Math.floor(C(ge)))},ceil:function(ge){return M(Math.ceil(C(ge)))}}))},T}function Xn(){var h=Rn(Sf()).domain([1,10]);return h.copy=function(){return Qu(h,Xn()).base(h.base())},hr.apply(h,arguments),h}function ri(h){return function(T){return Math.sign(T)*Math.log1p(Math.abs(T/h))}}function wi(h){return function(T){return Math.sign(T)*Math.expm1(Math.abs(T))*h}}function Pi(h){var T=1,E=h(ri(T),wi(T));return E.constant=function(S){return arguments.length?h(ri(T=+S),wi(T)):T},Hl(E)}function ia(){var h=Pi(Sf());return h.copy=function(){return Qu(h,ia()).constant(h.constant())},hr.apply(h,arguments)}function ra(h){return function(T){return T<0?-Math.pow(-T,h):Math.pow(T,h)}}function Ia(h){return h<0?-Math.sqrt(-h):Math.sqrt(h)}function uo(h){return h<0?-h*h:h*h}function eo(h){var T=h(ys,ys),E=1;function S(){return E===1?h(ys,ys):E===.5?h(Ia,uo):h(ra(E),ra(1/E))}return T.exponent=function(C){return arguments.length?(E=+C,S()):E},Hl(T)}function Na(){var h=eo(Sf());return h.copy=function(){return Qu(h,Na()).exponent(h.exponent())},hr.apply(h,arguments),h}function vo(){return Na.apply(null,arguments).exponent(.5)}function Fi(){var h=[],T=[],E=[],S;function C(){var j=0,ae=Math.max(1,T.length);for(E=new Array(ae-1);++j<ae;)E[j-1]=O(h,j/ae);return M}function M(j){return isNaN(j=+j)?S:T[gs(E,j)]}return M.invertExtent=function(j){var ae=T.indexOf(j);return ae<0?[NaN,NaN]:[ae>0?E[ae-1]:h[0],ae<E.length?E[ae]:h[h.length-1]]},M.domain=function(j){if(!arguments.length)return h.slice();h=[];for(var ae=0,ge=j.length,Ue;ae<ge;++ae)Ue=j[ae],Ue!=null&&!isNaN(Ue=+Ue)&&h.push(Ue);return h.sort(fl),C()},M.range=function(j){return arguments.length?(T=Ma.call(j),C()):T.slice()},M.unknown=function(j){return arguments.length?(S=j,M):S},M.quantiles=function(){return E.slice()},M.copy=function(){return Fi().domain(h).range(T).unknown(S)},hr.apply(M,arguments)}function to(){var h=0,T=1,E=1,S=[.5],C=[0,1],M;function j(ge){return ge<=ge?C[gs(S,ge,0,E)]:M}function ae(){var ge=-1;for(S=new Array(E);++ge<E;)S[ge]=((ge+1)*T-(ge-E)*h)/(E+1);return j}return j.domain=function(ge){return arguments.length?(h=+ge[0],T=+ge[1],ae()):[h,T]},j.range=function(ge){return arguments.length?(E=(C=Ma.call(ge)).length-1,ae()):C.slice()},j.invertExtent=function(ge){var Ue=C.indexOf(ge);return Ue<0?[NaN,NaN]:Ue<1?[h,S[0]]:Ue>=E?[S[E-1],T]:[S[Ue-1],S[Ue]]},j.unknown=function(ge){return arguments.length&&(M=ge),j},j.thresholds=function(){return S.slice()},j.copy=function(){return to().domain([h,T]).range(C).unknown(M)},hr.apply(Hl(j),arguments)}function us(){var h=[.5],T=[0,1],E,S=1;function C(M){return M<=M?T[gs(h,M,0,S)]:E}return C.domain=function(M){return arguments.length?(h=Ma.call(M),S=Math.min(h.length,T.length-1),C):h.slice()},C.range=function(M){return arguments.length?(T=Ma.call(M),S=Math.min(h.length,T.length-1),C):T.slice()},C.invertExtent=function(M){var j=T.indexOf(M);return[h[j-1],h[j]]},C.unknown=function(M){return arguments.length?(E=M,C):E},C.copy=function(){return us().domain(h).range(T).unknown(E)},hr.apply(C,arguments)}var va=new Date,Aa=new Date;function mi(h,T,E,S){function C(M){return h(M=arguments.length===0?new Date:new Date(+M)),M}return C.floor=function(M){return h(M=new Date(+M)),M},C.ceil=function(M){return h(M=new Date(M-1)),T(M,1),h(M),M},C.round=function(M){var j=C(M),ae=C.ceil(M);return M-j<ae-M?j:ae},C.offset=function(M,j){return T(M=new Date(+M),j==null?1:Math.floor(j)),M},C.range=function(M,j,ae){var ge=[],Ue;if(M=C.ceil(M),ae=ae==null?1:Math.floor(ae),!(M<j)||!(ae>0))return ge;do ge.push(Ue=new Date(+M)),T(M,ae),h(M);while(Ue<M&&M<j);return ge},C.filter=function(M){return mi(function(j){if(j>=j)for(;h(j),!M(j);)j.setTime(j-1)},function(j,ae){if(j>=j)if(ae<0)for(;++ae<=0;)for(;T(j,-1),!M(j););else for(;--ae>=0;)for(;T(j,1),!M(j););})},E&&(C.count=function(M,j){return va.setTime(+M),Aa.setTime(+j),h(va),h(Aa),Math.floor(E(va,Aa))},C.every=function(M){return M=Math.floor(M),!isFinite(M)||!(M>0)?null:M>1?C.filter(S?function(j){return S(j)%M==0}:function(j){return C.count(0,j)%M==0}):C}),C}var zo=mi(function(h){h.setMonth(0,1),h.setHours(0,0,0,0)},function(h,T){h.setFullYear(h.getFullYear()+T)},function(h,T){return T.getFullYear()-h.getFullYear()},function(h){return h.getFullYear()});zo.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:mi(function(T){T.setFullYear(Math.floor(T.getFullYear()/h)*h),T.setMonth(0,1),T.setHours(0,0,0,0)},function(T,E){T.setFullYear(T.getFullYear()+E*h)})};var fc=zo,Wf=zo.range,fh=mi(function(h){h.setDate(1),h.setHours(0,0,0,0)},function(h,T){h.setMonth(h.getMonth()+T)},function(h,T){return T.getMonth()-h.getMonth()+(T.getFullYear()-h.getFullYear())*12},function(h){return h.getMonth()}),Xf=fh,Bu=fh.range,Yf=1e3,ff=6e4,Kf=36e5,Th=864e5,hh=6048e5;function Af(h){return mi(function(T){T.setDate(T.getDate()-(T.getDay()+7-h)%7),T.setHours(0,0,0,0)},function(T,E){T.setDate(T.getDate()+E*7)},function(T,E){return(E-T-(E.getTimezoneOffset()-T.getTimezoneOffset())*ff)/hh})}var oh=Af(0),$f=Af(1),dh=Af(2),Fh=Af(3),Cf=Af(4),zf=Af(5),Ah=Af(6),xe=oh.range,je=$f.range,At=dh.range,gr=Fh.range,Ir=Cf.range,wr=zf.range,xr=Ah.range,Wr=mi(function(h){h.setHours(0,0,0,0)},function(h,T){h.setDate(h.getDate()+T)},function(h,T){return(T-h-(T.getTimezoneOffset()-h.getTimezoneOffset())*ff)/Th},function(h){return h.getDate()-1}),sn=Wr,tn=Wr.range,qr=mi(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*Yf-h.getMinutes()*ff)},function(h,T){h.setTime(+h+T*Kf)},function(h,T){return(T-h)/Kf},function(h){return h.getHours()}),fn=qr,wn=qr.range,cn=mi(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*Yf)},function(h,T){h.setTime(+h+T*ff)},function(h,T){return(T-h)/ff},function(h){return h.getMinutes()}),nn=cn,yr=cn.range,vr=mi(function(h){h.setTime(h-h.getMilliseconds())},function(h,T){h.setTime(+h+T*Yf)},function(h,T){return(T-h)/Yf},function(h){return h.getUTCSeconds()}),Xr=vr,_n=vr.range,Lr=mi(function(){},function(h,T){h.setTime(+h+T)},function(h,T){return T-h});Lr.every=function(h){return h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?mi(function(T){T.setTime(Math.floor(T/h)*h)},function(T,E){T.setTime(+T+E*h)},function(T,E){return(E-T)/h}):Lr};var qn=Lr,Qr=Lr.range;function jr(h){return mi(function(T){T.setUTCDate(T.getUTCDate()-(T.getUTCDay()+7-h)%7),T.setUTCHours(0,0,0,0)},function(T,E){T.setUTCDate(T.getUTCDate()+E*7)},function(T,E){return(E-T)/hh})}var Vr=jr(0),Kr=jr(1),Yn=jr(2),ti=jr(3),un=jr(4),Gr=jr(5),Fr=jr(6),di=Vr.range,pi=Kr.range,kn=Yn.range,Bi=ti.range,_i=un.range,Ui=Gr.range,ca=Fr.range,Go=mi(function(h){h.setUTCHours(0,0,0,0)},function(h,T){h.setUTCDate(h.getUTCDate()+T)},function(h,T){return(T-h)/Th},function(h){return h.getUTCDate()-1}),Ho=Go,ta=Go.range,mo=mi(function(h){h.setUTCMonth(0,1),h.setUTCHours(0,0,0,0)},function(h,T){h.setUTCFullYear(h.getUTCFullYear()+T)},function(h,T){return T.getUTCFullYear()-h.getUTCFullYear()},function(h){return h.getUTCFullYear()});mo.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:mi(function(T){T.setUTCFullYear(Math.floor(T.getUTCFullYear()/h)*h),T.setUTCMonth(0,1),T.setUTCHours(0,0,0,0)},function(T,E){T.setUTCFullYear(T.getUTCFullYear()+E*h)})};var Oa=mo,ws=mo.range;function Qo(h){if(0<=h.y&&h.y<100){var T=new Date(-1,h.m,h.d,h.H,h.M,h.S,h.L);return T.setFullYear(h.y),T}return new Date(h.y,h.m,h.d,h.H,h.M,h.S,h.L)}function xs(h){if(0<=h.y&&h.y<100){var T=new Date(Date.UTC(-1,h.m,h.d,h.H,h.M,h.S,h.L));return T.setUTCFullYear(h.y),T}return new Date(Date.UTC(h.y,h.m,h.d,h.H,h.M,h.S,h.L))}function qo(h,T,E){return{y:h,m:T,d:E,H:0,M:0,S:0,L:0}}function Zs(h){var T=h.dateTime,E=h.date,S=h.time,C=h.periods,M=h.days,j=h.shortDays,ae=h.months,ge=h.shortMonths,Ue=Vi(C),Dt=es(C),Jt=Vi(M),_r=es(M),Dr=Vi(j),xn=es(j),gn=Vi(ae),Bn=es(ae),Ei=Vi(ge),Ai=es(ge),Ba={a:Sh,A:uh,b:$c,B:dd,c:null,d:Kt,e:Kt,f:on,g:ls,G:Nf,H:kt,I:Qt,j:ur,L:Ur,m:Hr,M:ln,p:sd,q:pd,Q:rd,s:ld,S:Pn,u:Hn,U:ai,V:ma,w:La,W:qu,x:null,X:null,y:ts,Y:Su,Z:Ml,"%":td},sa={a:vd,A:ud,b:md,B:Gh,c:null,d:Wc,e:Wc,f:Xc,g:Zh,G:wh,H:wa,I:Fa,j:Pc,L:pl,m:Jf,M:go,p:gd,q:qh,Q:rd,s:ld,S:vl,u:hf,U:df,V:Ya,w:wf,W:Ff,x:null,X:null,y:Hh,Y:ed,Z:Qf,"%":td},ua={a:Ys,A:Yi,b:Ps,B:rs,c:vf,d:g,e:g,f:be,g:P,G:Dn,H:N,I:N,j:L,L:X,m:d,M:K,p:Co,q:s,Q:Be,s:pt,S:ee,u:hc,U:Lt,V:Sr,w:au,W:mr,x:Nh,X:_c,y:P,Y:Dn,Z:p,"%":me};Ba.x=no(E,Ba),Ba.X=no(S,Ba),Ba.c=no(T,Ba),sa.x=no(E,sa),sa.X=no(S,sa),sa.c=no(T,sa);function no(ki,Ha){return function(la){var zn=[],Mc=-1,Es=0,Jc=ki.length,Qc,Eh,yd;for(la instanceof Date||(la=new Date(+la));++Mc<Jc;)ki.charCodeAt(Mc)===37&&(zn.push(ki.slice(Es,Mc)),(Eh=No[Qc=ki.charAt(++Mc)])!=null?Qc=ki.charAt(++Mc):Eh=Qc==="e"?" ":"0",(yd=Ha[Qc])&&(Qc=yd(la,Eh)),zn.push(Qc),Es=Mc+1);return zn.push(ki.slice(Es,Mc)),zn.join("")}}function Ci(ki,Ha){return function(la){var zn=qo(1900,void 0,1),Mc=io(zn,ki,la+="",0),Es,Jc;if(Mc!=la.length)return null;if("Q"in zn)return new Date(zn.Q);if("s"in zn)return new Date(zn.s*1e3+("L"in zn?zn.L:0));if(Ha&&!("Z"in zn)&&(zn.Z=0),"p"in zn&&(zn.H=zn.H%12+zn.p*12),zn.m===void 0&&(zn.m="q"in zn?zn.q:0),"V"in zn){if(zn.V<1||zn.V>53)return null;"w"in zn||(zn.w=1),"Z"in zn?(Es=xs(qo(zn.y,0,1)),Jc=Es.getUTCDay(),Es=Jc>4||Jc===0?Kr.ceil(Es):Kr(Es),Es=Ho.offset(Es,(zn.V-1)*7),zn.y=Es.getUTCFullYear(),zn.m=Es.getUTCMonth(),zn.d=Es.getUTCDate()+(zn.w+6)%7):(Es=Qo(qo(zn.y,0,1)),Jc=Es.getDay(),Es=Jc>4||Jc===0?$f.ceil(Es):$f(Es),Es=sn.offset(Es,(zn.V-1)*7),zn.y=Es.getFullYear(),zn.m=Es.getMonth(),zn.d=Es.getDate()+(zn.w+6)%7)}else("W"in zn||"U"in zn)&&("w"in zn||(zn.w="u"in zn?zn.u%7:"W"in zn?1:0),Jc="Z"in zn?xs(qo(zn.y,0,1)).getUTCDay():Qo(qo(zn.y,0,1)).getDay(),zn.m=0,zn.d="W"in zn?(zn.w+6)%7+zn.W*7-(Jc+5)%7:zn.w+zn.U*7-(Jc+6)%7);return"Z"in zn?(zn.H+=zn.Z/100|0,zn.M+=zn.Z%100,xs(zn)):Qo(zn)}}function io(ki,Ha,la,zn){for(var Mc=0,Es=Ha.length,Jc=la.length,Qc,Eh;Mc<Es;){if(zn>=Jc)return-1;if(Qc=Ha.charCodeAt(Mc++),Qc===37){if(Qc=Ha.charAt(Mc++),Eh=ua[Qc in No?Ha.charAt(Mc++):Qc],!Eh||(zn=Eh(ki,la,zn))<0)return-1}else if(Qc!=la.charCodeAt(zn++))return-1}return zn}function Co(ki,Ha,la){var zn=Ue.exec(Ha.slice(la));return zn?(ki.p=Dt[zn[0].toLowerCase()],la+zn[0].length):-1}function Ys(ki,Ha,la){var zn=Dr.exec(Ha.slice(la));return zn?(ki.w=xn[zn[0].toLowerCase()],la+zn[0].length):-1}function Yi(ki,Ha,la){var zn=Jt.exec(Ha.slice(la));return zn?(ki.w=_r[zn[0].toLowerCase()],la+zn[0].length):-1}function Ps(ki,Ha,la){var zn=Ei.exec(Ha.slice(la));return zn?(ki.m=Ai[zn[0].toLowerCase()],la+zn[0].length):-1}function rs(ki,Ha,la){var zn=gn.exec(Ha.slice(la));return zn?(ki.m=Bn[zn[0].toLowerCase()],la+zn[0].length):-1}function vf(ki,Ha,la){return io(ki,T,Ha,la)}function Nh(ki,Ha,la){return io(ki,E,Ha,la)}function _c(ki,Ha,la){return io(ki,S,Ha,la)}function Sh(ki){return j[ki.getDay()]}function uh(ki){return M[ki.getDay()]}function $c(ki){return ge[ki.getMonth()]}function dd(ki){return ae[ki.getMonth()]}function sd(ki){return C[+(ki.getHours()>=12)]}function pd(ki){return 1+~~(ki.getMonth()/3)}function vd(ki){return j[ki.getUTCDay()]}function ud(ki){return M[ki.getUTCDay()]}function md(ki){return ge[ki.getUTCMonth()]}function Gh(ki){return ae[ki.getUTCMonth()]}function gd(ki){return C[+(ki.getUTCHours()>=12)]}function qh(ki){return 1+~~(ki.getUTCMonth()/3)}return{format:function(Ha){var la=no(Ha+="",Ba);return la.toString=function(){return Ha},la},parse:function(Ha){var la=Ci(Ha+="",!1);return la.toString=function(){return Ha},la},utcFormat:function(Ha){var la=no(Ha+="",sa);return la.toString=function(){return Ha},la},utcParse:function(Ha){var la=Ci(Ha+="",!0);return la.toString=function(){return Ha},la}}}var No={"-":"",_:" ","0":"0"},ui=/^\s*\d+/,Ws=/^%/,Ca=/[\\^$*+?|[\]().{}]/g;function Sn(h,T,E){var S=h<0?"-":"",C=(S?-h:h)+"",M=C.length;return S+(M<E?new Array(E-M+1).join(T)+C:C)}function Ri(h){return h.replace(Ca,"\\$&")}function Vi(h){return new RegExp("^(?:"+h.map(Ri).join("|")+")","i")}function es(h){for(var T={},E=-1,S=h.length;++E<S;)T[h[E].toLowerCase()]=E;return T}function au(h,T,E){var S=ui.exec(T.slice(E,E+1));return S?(h.w=+S[0],E+S[0].length):-1}function hc(h,T,E){var S=ui.exec(T.slice(E,E+1));return S?(h.u=+S[0],E+S[0].length):-1}function Lt(h,T,E){var S=ui.exec(T.slice(E,E+2));return S?(h.U=+S[0],E+S[0].length):-1}function Sr(h,T,E){var S=ui.exec(T.slice(E,E+2));return S?(h.V=+S[0],E+S[0].length):-1}function mr(h,T,E){var S=ui.exec(T.slice(E,E+2));return S?(h.W=+S[0],E+S[0].length):-1}function Dn(h,T,E){var S=ui.exec(T.slice(E,E+4));return S?(h.y=+S[0],E+S[0].length):-1}function P(h,T,E){var S=ui.exec(T.slice(E,E+2));return S?(h.y=+S[0]+(+S[0]>68?1900:2e3),E+S[0].length):-1}function p(h,T,E){var S=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(T.slice(E,E+6));return S?(h.Z=S[1]?0:-(S[2]+(S[3]||"00")),E+S[0].length):-1}function s(h,T,E){var S=ui.exec(T.slice(E,E+1));return S?(h.q=S[0]*3-3,E+S[0].length):-1}function d(h,T,E){var S=ui.exec(T.slice(E,E+2));return S?(h.m=S[0]-1,E+S[0].length):-1}function g(h,T,E){var S=ui.exec(T.slice(E,E+2));return S?(h.d=+S[0],E+S[0].length):-1}function L(h,T,E){var S=ui.exec(T.slice(E,E+3));return S?(h.m=0,h.d=+S[0],E+S[0].length):-1}function N(h,T,E){var S=ui.exec(T.slice(E,E+2));return S?(h.H=+S[0],E+S[0].length):-1}function K(h,T,E){var S=ui.exec(T.slice(E,E+2));return S?(h.M=+S[0],E+S[0].length):-1}function ee(h,T,E){var S=ui.exec(T.slice(E,E+2));return S?(h.S=+S[0],E+S[0].length):-1}function X(h,T,E){var S=ui.exec(T.slice(E,E+3));return S?(h.L=+S[0],E+S[0].length):-1}function be(h,T,E){var S=ui.exec(T.slice(E,E+6));return S?(h.L=Math.floor(S[0]/1e3),E+S[0].length):-1}function me(h,T,E){var S=Ws.exec(T.slice(E,E+1));return S?E+S[0].length:-1}function Be(h,T,E){var S=ui.exec(T.slice(E));return S?(h.Q=+S[0],E+S[0].length):-1}function pt(h,T,E){var S=ui.exec(T.slice(E));return S?(h.s=+S[0],E+S[0].length):-1}function Kt(h,T){return Sn(h.getDate(),T,2)}function kt(h,T){return Sn(h.getHours(),T,2)}function Qt(h,T){return Sn(h.getHours()%12||12,T,2)}function ur(h,T){return Sn(1+sn.count(fc(h),h),T,3)}function Ur(h,T){return Sn(h.getMilliseconds(),T,3)}function on(h,T){return Ur(h,T)+"000"}function Hr(h,T){return Sn(h.getMonth()+1,T,2)}function ln(h,T){return Sn(h.getMinutes(),T,2)}function Pn(h,T){return Sn(h.getSeconds(),T,2)}function Hn(h){var T=h.getDay();return T===0?7:T}function ai(h,T){return Sn(oh.count(fc(h)-1,h),T,2)}function Hi(h){var T=h.getDay();return T>=4||T===0?Cf(h):Cf.ceil(h)}function ma(h,T){return h=Hi(h),Sn(Cf.count(fc(h),h)+(fc(h).getDay()===4),T,2)}function La(h){return h.getDay()}function qu(h,T){return Sn($f.count(fc(h)-1,h),T,2)}function ts(h,T){return Sn(h.getFullYear()%100,T,2)}function ls(h,T){return h=Hi(h),Sn(h.getFullYear()%100,T,2)}function Su(h,T){return Sn(h.getFullYear()%1e4,T,4)}function Nf(h,T){var E=h.getDay();return h=E>=4||E===0?Cf(h):Cf.ceil(h),Sn(h.getFullYear()%1e4,T,4)}function Ml(h){var T=h.getTimezoneOffset();return(T>0?"-":(T*=-1,"+"))+Sn(T/60|0,"0",2)+Sn(T%60,"0",2)}function Wc(h,T){return Sn(h.getUTCDate(),T,2)}function wa(h,T){return Sn(h.getUTCHours(),T,2)}function Fa(h,T){return Sn(h.getUTCHours()%12||12,T,2)}function Pc(h,T){return Sn(1+Ho.count(Oa(h),h),T,3)}function pl(h,T){return Sn(h.getUTCMilliseconds(),T,3)}function Xc(h,T){return pl(h,T)+"000"}function Jf(h,T){return Sn(h.getUTCMonth()+1,T,2)}function go(h,T){return Sn(h.getUTCMinutes(),T,2)}function vl(h,T){return Sn(h.getUTCSeconds(),T,2)}function hf(h){var T=h.getUTCDay();return T===0?7:T}function df(h,T){return Sn(Vr.count(Oa(h)-1,h),T,2)}function Ch(h){var T=h.getUTCDay();return T>=4||T===0?un(h):un.ceil(h)}function Ya(h,T){return h=Ch(h),Sn(un.count(Oa(h),h)+(Oa(h).getUTCDay()===4),T,2)}function wf(h){return h.getUTCDay()}function Ff(h,T){return Sn(Kr.count(Oa(h)-1,h),T,2)}function Hh(h,T){return Sn(h.getUTCFullYear()%100,T,2)}function Zh(h,T){return h=Ch(h),Sn(h.getUTCFullYear()%100,T,2)}function ed(h,T){return Sn(h.getUTCFullYear()%1e4,T,4)}function wh(h,T){var E=h.getUTCDay();return h=E>=4||E===0?un(h):un.ceil(h),Sn(h.getUTCFullYear()%1e4,T,4)}function Qf(){return"+0000"}function td(){return"%"}function rd(h){return+h}function ld(h){return Math.floor(+h/1e3)}var bs,qf,cd,e,t;r({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function r(h){return bs=Zs(h),qf=bs.format,cd=bs.parse,e=bs.utcFormat,t=bs.utcParse,bs}var l=1e3,f=l*60,m=f*60,A=m*24,I=A*7,G=A*30,te=A*365;function pe(h){return new Date(h)}function Ce(h){return h instanceof Date?+h:+new Date(+h)}function Me(h,T,E,S,C,M,j,ae,ge){var Ue=sf(ys,ys),Dt=Ue.invert,Jt=Ue.domain,_r=ge(".%L"),Dr=ge(":%S"),xn=ge("%I:%M"),gn=ge("%I %p"),Bn=ge("%a %d"),Ei=ge("%b %d"),Ai=ge("%B"),Ba=ge("%Y"),sa=[[j,1,l],[j,5,5*l],[j,15,15*l],[j,30,30*l],[M,1,f],[M,5,5*f],[M,15,15*f],[M,30,30*f],[C,1,m],[C,3,3*m],[C,6,6*m],[C,12,12*m],[S,1,A],[S,2,2*A],[E,1,I],[T,1,G],[T,3,3*G],[h,1,te]];function ua(Ci){return(j(Ci)<Ci?_r:M(Ci)<Ci?Dr:C(Ci)<Ci?xn:S(Ci)<Ci?gn:T(Ci)<Ci?E(Ci)<Ci?Bn:Ei:h(Ci)<Ci?Ai:Ba)(Ci)}function no(Ci,io,Co,Ys){if(Ci==null&&(Ci=10),typeof Ci=="number"){var Yi=Math.abs(Co-io)/Ci,Ps=hl(function(rs){return rs[2]}).right(sa,Yi);Ps===sa.length?(Ys=c(io/te,Co/te,Ci),Ci=h):Ps?(Ps=sa[Yi/sa[Ps-1][2]<sa[Ps][2]/Yi?Ps-1:Ps],Ys=Ps[1],Ci=Ps[0]):(Ys=Math.max(c(io,Co,Ci),1),Ci=ae)}return Ys==null?Ci:Ci.every(Ys)}return Ue.invert=function(Ci){return new Date(Dt(Ci))},Ue.domain=function(Ci){return arguments.length?Jt(qa.call(Ci,Ce)):Jt().map(pe)},Ue.ticks=function(Ci,io){var Co=Jt(),Ys=Co[0],Yi=Co[Co.length-1],Ps=Yi<Ys,rs;return Ps&&(rs=Ys,Ys=Yi,Yi=rs),rs=no(Ci,Ys,Yi,io),rs=rs?rs.range(Ys,Yi+1):[],Ps?rs.reverse():rs},Ue.tickFormat=function(Ci,io){return io==null?ua:ge(io)},Ue.nice=function(Ci,io){var Co=Jt();return(Ci=no(Ci,Co[0],Co[Co.length-1],io))?Jt(D(Co,Ci)):Ue},Ue.copy=function(){return Qu(Ue,Me(h,T,E,S,C,M,j,ae,ge))},Ue}var ot=function(){return hr.apply(Me(fc,Xf,oh,sn,fn,nn,Xr,qn,qf).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},_t=mi(function(h){h.setUTCDate(1),h.setUTCHours(0,0,0,0)},function(h,T){h.setUTCMonth(h.getUTCMonth()+T)},function(h,T){return T.getUTCMonth()-h.getUTCMonth()+(T.getUTCFullYear()-h.getUTCFullYear())*12},function(h){return h.getUTCMonth()}),Ct=_t,Xt=_t.range,Zt=mi(function(h){h.setUTCMinutes(0,0,0)},function(h,T){h.setTime(+h+T*Kf)},function(h,T){return(T-h)/Kf},function(h){return h.getUTCHours()}),ar=Zt,dr=Zt.range,br=mi(function(h){h.setUTCSeconds(0,0)},function(h,T){h.setTime(+h+T*ff)},function(h,T){return(T-h)/ff},function(h){return h.getUTCMinutes()}),Nr=br,Rr=br.range,pn=function(){return hr.apply(Me(Oa,Ct,Vr,Ho,ar,Nr,Xr,qn,e).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function hn(){var h=0,T=1,E,S,C,M,j=ys,ae=!1,ge;function Ue(Dt){return isNaN(Dt=+Dt)?ge:j(C===0?.5:(Dt=(M(Dt)-E)*C,ae?Math.max(0,Math.min(1,Dt)):Dt))}return Ue.domain=function(Dt){return arguments.length?(E=M(h=+Dt[0]),S=M(T=+Dt[1]),C=E===S?0:1/(S-E),Ue):[h,T]},Ue.clamp=function(Dt){return arguments.length?(ae=!!Dt,Ue):ae},Ue.interpolator=function(Dt){return arguments.length?(j=Dt,Ue):j},Ue.unknown=function(Dt){return arguments.length?(ge=Dt,Ue):ge},function(Dt){return M=Dt,E=Dt(h),S=Dt(T),C=E===S?0:1/(S-E),Ue}}function Ln(h,T){return T.domain(h.domain()).interpolator(h.interpolator()).clamp(h.clamp()).unknown(h.unknown())}function Jn(){var h=Hl(hn()(ys));return h.copy=function(){return Ln(h,Jn())},Tr.apply(h,arguments)}function Kn(){var h=Rn(hn()).domain([1,10]);return h.copy=function(){return Ln(h,Kn()).base(h.base())},Tr.apply(h,arguments)}function Nn(){var h=Pi(hn());return h.copy=function(){return Ln(h,Nn()).constant(h.constant())},Tr.apply(h,arguments)}function Si(){var h=eo(hn());return h.copy=function(){return Ln(h,Si()).exponent(h.exponent())},Tr.apply(h,arguments)}function li(){return Si.apply(null,arguments).exponent(.5)}function ei(){var h=[],T=ys;function E(S){if(!isNaN(S=+S))return T((gs(h,S)-1)/(h.length-1))}return E.domain=function(S){if(!arguments.length)return h.slice();h=[];for(var C=0,M=S.length,j;C<M;++C)j=S[C],j!=null&&!isNaN(j=+j)&&h.push(j);return h.sort(fl),E},E.interpolator=function(S){return arguments.length?(T=S,E):T},E.copy=function(){return ei(T).domain(h)},Tr.apply(E,arguments)}function $i(){var h=0,T=.5,E=1,S,C,M,j,ae,ge=ys,Ue,Dt=!1,Jt;function _r(Dr){return isNaN(Dr=+Dr)?Jt:(Dr=.5+((Dr=+Ue(Dr))-C)*(Dr<C?j:ae),ge(Dt?Math.max(0,Math.min(1,Dr)):Dr))}return _r.domain=function(Dr){return arguments.length?(S=Ue(h=+Dr[0]),C=Ue(T=+Dr[1]),M=Ue(E=+Dr[2]),j=S===C?0:.5/(C-S),ae=C===M?0:.5/(M-C),_r):[h,T,E]},_r.clamp=function(Dr){return arguments.length?(Dt=!!Dr,_r):Dt},_r.interpolator=function(Dr){return arguments.length?(ge=Dr,_r):ge},_r.unknown=function(Dr){return arguments.length?(Jt=Dr,_r):Jt},function(Dr){return Ue=Dr,S=Dr(h),C=Dr(T),M=Dr(E),j=S===C?0:.5/(C-S),ae=C===M?0:.5/(M-C),_r}}function Di(){var h=Hl($i()(ys));return h.copy=function(){return Ln(h,Di())},Tr.apply(h,arguments)}function Ga(){var h=Rn($i()).domain([.1,1,10]);return h.copy=function(){return Ln(h,Ga()).base(h.base())},Tr.apply(h,arguments)}function gi(){var h=Pi($i());return h.copy=function(){return Ln(h,gi()).constant(h.constant())},Tr.apply(h,arguments)}function aa(){var h=eo($i());return h.copy=function(){return Ln(h,aa()).exponent(h.exponent())},Tr.apply(h,arguments)}function Zo(){return aa.apply(null,arguments).exponent(.5)}var Sa,Wo,Xo,cs,Eu,fs,el,ou,tl,su=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Xs=(Sa={},Re()(Sa,b.ScaleTypes.LINEAR,ne),Re()(Sa,b.ScaleTypes.POWER,Na),Re()(Sa,b.ScaleTypes.LOG,Xn),Re()(Sa,b.ScaleTypes.IDENTITY,oe),Re()(Sa,b.ScaleTypes.TIME,ot),Re()(Sa,b.ScaleTypes.QUANTILE,Fi),Re()(Sa,b.ScaleTypes.QUANTIZE,to),Re()(Sa,b.ScaleTypes.THRESHOLD,us),Re()(Sa,b.ScaleTypes.CAT,Ta),Sa),uu=(Wo=Object(dt.injectable)(),Xo=Object(dt.inject)(b.TYPES.IGlobalConfigService),cs=Object(dt.inject)(b.TYPES.ILogService),Wo(Eu=(fs=(tl=function(){function h(){Z()(this,h),Oe()(this,"configService",el,this),Oe()(this,"logger",ou,this),this.scaleCache={},this.scaleOptions={}}return a()(h,[{key:"apply",value:function(E,S){var C=this,M=S.styleAttributeService;E.hooks.init.tap("FeatureScalePlugin",function(){C.scaleOptions=E.getScaleOptions();var j=M.getLayerStyleAttributes(),ae=E.getSource().data.dataArray;ae.length!==0&&C.caculateScalesForAttributes(j||[],ae)}),E.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){C.scaleOptions=E.getScaleOptions();var j=M.getLayerStyleAttributes(),ae=E.getSource().data.dataArray;return C.caculateScalesForAttributes(j||[],ae),E.layerModelNeedUpdate=!0,!0}),E.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!E.layerModelNeedUpdate){C.scaleOptions=E.getScaleOptions();var j=M.getLayerStyleAttributes();if(j){var ae=E.getSource().data.dataArray;if(ae.length===0)return;var ge=j.filter(function(Ue){return Ue.needRescale});ge.length&&(C.caculateScalesForAttributes(ge,ae),C.logger.debug("rescale finished"))}}})}},{key:"isNumber",value:function(E){return!isNaN(parseFloat(E))&&isFinite(E)}},{key:"caculateScalesForAttributes",value:function(E,S){var C=this;this.scaleCache={},E.forEach(function(M){if(M.scale){var j=M.scale,ae=M.name;j.names=C.parseFields(M.scale.field||[]);var ge=[];j.names.forEach(function(Ue){ge.push(C.getOrCreateScale(Ue,M,S))}),ge.some(function(Ue){return Ue.type===b.StyleScaleType.VARIABLE})?(j.type=b.StyleScaleType.VARIABLE,ge.forEach(function(Ue){if(!j.callback){var Dt;if(j.values&&j.values!=="text"){var Jt;if(((Jt=Ue.option)===null||Jt===void 0?void 0:Jt.type)==="linear"&&j.values.length>2){var _r=Ue.scale.ticks(j.values.length);ae==="color"&&Ue.scale.domain(_r)}Ue.scale.range(j.values)}else((Dt=Ue.option)===null||Dt===void 0?void 0:Dt.type)==="cat"&&Ue.scale.range(Ue.option.domain)}})):(j.type=b.StyleScaleType.CONSTANT,j.defaultValues=ge.map(function(Ue,Dt){return Ue.scale(j.names[Dt])})),j.scalers=ge.map(function(Ue){return{field:Ue.field,func:Ue.scale,option:Ue.option}}),M.needRescale=!1}})}},{key:"getOrCreateScale",value:function(E,S,C){var M,j=[E,S.name].join("_"),ae=(M=S.scale)===null||M===void 0?void 0:M.values,ge=this.createScale(E,S.name,ae,C);return ge}},{key:"parseFields",value:function(E){return Array.isArray(E)?E:ec()(E)?E.split("*"):[E]}},{key:"createScale",value:function(E,S,C,M){var j,ae=this.scaleOptions[S]&&this.scaleOptions[S].field===E?this.scaleOptions[S]:this.scaleOptions[E],ge={field:E,scale:void 0,type:b.StyleScaleType.VARIABLE,option:ae};if(!M||!M.length)return ae&&ae.type?ge.scale=this.createDefaultScale(ae):(ge.scale=Ta([E]),ge.type=b.StyleScaleType.CONSTANT),ge;var Ue=(j=M.find(function(_r){return!Wa()(_r[E])}))===null||j===void 0?void 0:j[E];if(this.isNumber(E)||Wa()(Ue)&&!ae)ge.scale=Ta([E]),ge.type=b.StyleScaleType.CONSTANT;else{var Dt=ae&&ae.type||this.getDefaultType(Ue);C==="text"&&(Dt=b.ScaleTypes.CAT);var Jt=this.createDefaultScaleConfig(Dt,E,M);Object.assign(Jt,ae),ge.scale=this.createDefaultScale(Jt),ge.option=Jt}return ge}},{key:"getDefaultType",value:function(E){var S=b.ScaleTypes.LINEAR;return typeof E=="string"&&(S=su.test(E)?b.ScaleTypes.TIME:b.ScaleTypes.CAT),S}},{key:"createDefaultScaleConfig",value:function(E,S,C){var M={type:E},j=(C==null?void 0:C.map(function(ae){return ae[S]}))||[];return E!==b.ScaleTypes.CAT&&E!==b.ScaleTypes.QUANTILE?M.domain=Iu(j):E===b.ScaleTypes.CAT?M.domain=nu()(j):E===b.ScaleTypes.QUANTILE&&(M.domain=j),M}},{key:"createDefaultScale",value:function(E){var S=E.type,C=E.domain,M=Xs[S]();return C&&M.domain(C),M}}]),h}(),tl),el=St()(fs.prototype,"configService",[Xo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ou=St()(fs.prototype,"logger",[cs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fs))||Eu),ga,oa,ro,yo,Tu,Ao,Yo,ku;function fa(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(h);T&&(S=S.filter(function(C){return Object.getOwnPropertyDescriptor(h,C).enumerable})),E.push.apply(E,S)}return E}function eh(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?fa(Object(E),!0).forEach(function(S){Re()(h,S,E[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):fa(Object(E)).forEach(function(S){Object.defineProperty(h,S,Object.getOwnPropertyDescriptor(E,S))})}return h}var Yc=(ga=Object(dt.injectable)(),oa=Object(dt.inject)(b.TYPES.ICameraService),ro=Object(dt.inject)(b.TYPES.IRendererService),ga(yo=(Tu=(ku=function(){function h(){Z()(this,h),Oe()(this,"cameraService",Ao,this),Oe()(this,"rendererService",Yo,this)}return a()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){E.models.forEach(function(S){S.addUniforms(eh({},E.layerModel.getAnimateUniforms()))})})}}]),h}(),ku),Ao=St()(Tu.prototype,"cameraService",[oa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yo=St()(Tu.prototype,"rendererService",[ro],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu))||yo),pf,dc,ju=(pf=Object(dt.injectable)(),pf(dc=function(){function h(){Z()(this,h)}return a()(h,[{key:"apply",value:function(E){E.hooks.init.tap("LayerModelPlugin",function(){E.prepareBuildModel(),E.buildModels(),E.styleNeedUpdate=!1}),E.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return E.prepareBuildModel(),E.clearModels(),E.buildModels(),E.layerModelNeedUpdate=!1,!1})}}]),h}())||dc),Bf,kf,th=(Bf=Object(dt.injectable)(),Bf(kf=function(){function h(){Z()(this,h)}return a()(h,[{key:"apply",value:function(E){E.hooks.afterInit.tap("LayerStylePlugin",function(){E.updateLayerConfig({});var S=E.getLayerConfig(),C=S.autoFit,M=S.fitBoundsOptions;C&&setTimeout(function(){E.fitBounds(M)},100)})}}]),h}())||kf),Ph,Pf;function _h(h,T){var E=Object.keys(h);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(h);T&&(S=S.filter(function(C){return Object.getOwnPropertyDescriptor(h,C).enumerable})),E.push.apply(E,S)}return E}function rh(h){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?_h(Object(E),!0).forEach(function(S){Re()(h,S,E[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(E)):_h(Object(E)).forEach(function(S){Object.defineProperty(h,S,Object.getOwnPropertyDescriptor(E,S))})}return h}var ph={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Wh={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Bh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Xh={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},vh=["ambient","diffuse","specular"];function Mh(h){var T={u_DirectionalLights:new Array(3).fill(rh({},Bh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(rh({},Xh)),u_NumOfSpotLights:0};return(!h||!h.length)&&(h=[Wh]),h.forEach(function(E,S){var C=E.type,M=C===void 0?"directional":C,j=Ge()(E,["type"]),ae=ph[M].lights,ge=ph[M].num,Ue=T[ge];T[ae][Ue]=rh(rh({},T[ae][Ue]),j),T[ge]++}),T}var Yh=(Ph=Object(dt.injectable)(),Ph(Pf=function(){function h(){Z()(this,h)}return a()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("LightingPlugin",function(){var S=E.getLayerConfig(),C=S.enableLighting;C&&E.models.forEach(function(M){return M.addUniforms(rh({},Mh()))})})}}]),h}())||Pf),mh,nh,sh={NONE:0,ENCODE:1,HIGHLIGHT:2},Kh=(mh=Object(dt.injectable)(),mh(nh=function(){function h(){Z()(this,h)}return a()(h,[{key:"apply",value:function(E,S){var C=S.rendererService,M=S.styleAttributeService;E.hooks.init.tap("PixelPickingPlugin",function(){var j=E.getLayerConfig(),ae=j.enablePicking;M.registerStyleAttribute({name:"pickingColor",type:b.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:b.gl.FLOAT},size:3,update:function(Ue,Dt){var Jt=Ue.id;return ae?Object(ze.l)(Jt):[0,0,0]}}})}),E.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var j=E.getLayerConfig(),ae=j.enablePicking;ae&&E.isVisible()&&E.models.forEach(function(ge){return ge.addUniforms({u_PickingStage:sh.ENCODE})})}),E.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var j=E.getLayerConfig(),ae=j.enablePicking;ae&&E.isVisible()&&E.models.forEach(function(ge){return ge.addUniforms({u_PickingStage:sh.HIGHLIGHT})})}),E.hooks.beforeHighlight.tap("PixelPickingPlugin",function(j){var ae=E.getLayerConfig(),ge=ae.highlightColor,Ue=typeof ge=="string"?Object(ze.s)(ge):ge||[1,0,0,1];E.updateLayerConfig({pickedFeatureID:Object(ze.k)(new Uint8Array(j))}),E.models.forEach(function(Dt){return Dt.addUniforms({u_PickingStage:sh.HIGHLIGHT,u_PickingColor:j,u_HighlightColor:Ue.map(function(Jt){return Jt*255})})})}),E.hooks.beforeSelect.tap("PixelPickingPlugin",function(j){var ae=E.getLayerConfig(),ge=ae.selectColor,Ue=typeof ge=="string"?Object(ze.s)(ge):ge||[1,0,0,1];E.updateLayerConfig({pickedFeatureID:Object(ze.k)(new Uint8Array(j))}),E.models.forEach(function(Dt){return Dt.addUniforms({u_PickingStage:sh.HIGHLIGHT,u_PickingColor:j,u_HighlightColor:Ue.map(function(Jt){return Jt*255})})})})}}]),h}())||nh),kh,gh,jh,Ih,yh,Uh,Vh=(kh=Object(dt.injectable)(),gh=Object(dt.inject)(b.TYPES.ILogService),kh(jh=(Ih=(Uh=function(){function h(){Z()(this,h),Oe()(this,"logger",yh,this)}return a()(h,[{key:"apply",value:function(E,S){var C=this,M=S.styleAttributeService;E.hooks.init.tap("RegisterStyleAttributePlugin",function(){C.registerBuiltinAttributes(M)})}},{key:"registerBuiltinAttributes",value:function(E){E.registerStyleAttribute({name:"position",type:b.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:b.gl.FLOAT},size:3,update:function(C,M,j){return j.length===2?[j[0],j[1],0]:[j[0],j[1],j[2]]}}}),E.registerStyleAttribute({name:"filter",type:b.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:1,update:function(C,M){var j=C.filter;return j?[1]:[0]}}}),E.registerStyleAttribute({name:"color",type:b.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:b.gl.DYNAMIC_DRAW,data:[],type:b.gl.FLOAT},size:4,update:function(C,M){var j=C.color;return!j||!j.length?[1,1,1,1]:j}}})}}]),h}(),Uh),yh=St()(Ih.prototype,"logger",[gh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ih))||jh),Oh,Lh,xh,Rh,bh,jf,Dh,$h,Jh,nd,id=(Oh=Object(dt.injectable)(),Lh=Object(dt.inject)(b.TYPES.ICameraService),xh=Object(dt.inject)(b.TYPES.ICoordinateSystemService),Rh=Object(dt.inject)(b.TYPES.IRendererService),Oh(bh=(jf=(nd=function(){function h(){Z()(this,h),Oe()(this,"cameraService",Dh,this),Oe()(this,"coordinateSystemService",$h,this),Oe()(this,"rendererService",Jh,this)}return a()(h,[{key:"apply",value:function(E){var S=this;E.hooks.beforeRender.tap("ShaderUniformPlugin",function(){S.coordinateSystemService.refresh();var C=S.rendererService.getViewportSize(),M=C.width,j=C.height;E.models.forEach(function(ae){var ge;return ae.addUniforms((ge={},Re()(ge,b.CameraUniform.ProjectionMatrix,S.cameraService.getProjectionMatrix()),Re()(ge,b.CameraUniform.ViewMatrix,S.cameraService.getViewMatrix()),Re()(ge,b.CameraUniform.ViewProjectionMatrix,S.cameraService.getViewProjectionMatrix()),Re()(ge,b.CameraUniform.Zoom,S.cameraService.getZoom()),Re()(ge,b.CameraUniform.ZoomScale,S.cameraService.getZoomScale()),Re()(ge,b.CameraUniform.FocalDistance,S.cameraService.getFocalDistance()),Re()(ge,b.CameraUniform.CameraPosition,S.cameraService.getCameraPosition()),Re()(ge,b.CoordinateUniform.CoordinateSystem,S.coordinateSystemService.getCoordinateSystem()),Re()(ge,b.CoordinateUniform.ViewportCenter,S.coordinateSystemService.getViewportCenter()),Re()(ge,b.CoordinateUniform.ViewportCenterProjection,S.coordinateSystemService.getViewportCenterProjection()),Re()(ge,b.CoordinateUniform.PixelsPerDegree,S.coordinateSystemService.getPixelsPerDegree()),Re()(ge,b.CoordinateUniform.PixelsPerDegree2,S.coordinateSystemService.getPixelsPerDegree2()),Re()(ge,b.CoordinateUniform.PixelsPerMeter,S.coordinateSystemService.getPixelsPerMeter()),Re()(ge,"u_ViewportSize",[M,j]),Re()(ge,"u_DevicePixelRatio",window.devicePixelRatio),Re()(ge,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Re()(ge,"u_PickingBuffer",E.getLayerConfig().pickingBuffer||0),ge))})})}}]),h}(),nd),Dh=St()(jf.prototype,"cameraService",[Lh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=St()(jf.prototype,"coordinateSystemService",[xh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jh=St()(jf.prototype,"rendererService",[Rh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jf))||bh),ad,Qh,Sd=(ad=Object(dt.injectable)(),ad(Qh=function(){function h(){Z()(this,h)}return a()(h,[{key:"apply",value:function(E){E.hooks.beforeRender.tap("UpdateModelPlugin",function(){E.layerModel&&E.layerModel.needUpdate()})}}]),h}())||Qh),fd,zh,Ss,Kc,hd,ih,od=(fd=Object(dt.injectable)(),zh=Object(dt.inject)(b.TYPES.ILogService),fd(Ss=(Kc=(ih=function(){function h(){Z()(this,h),Oe()(this,"logger",hd,this)}return a()(h,[{key:"apply",value:function(E,S){var C=this,M=S.styleAttributeService;E.hooks.init.tap("UpdateStyleAttributePlugin",function(){C.initStyleAttribute(E,{styleAttributeService:M})}),E.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){E.layerModelNeedUpdate||C.updateStyleAtrribute(E,{styleAttributeService:M})})}},{key:"updateStyleAtrribute",value:function(E,S){var C=this,M=S.styleAttributeService,j=M.getLayerStyleAttributes()||[],ae=M.getLayerStyleAttribute("filter"),ge=M.getLayerStyleAttribute("shape");if(ae&&ae.needRegenerateVertices||ge&&ge.needRegenerateVertices){E.layerModelNeedUpdate=!0,j.forEach(function(Ue){return Ue.needRegenerateVertices=!1});return}j.filter(function(Ue){return Ue.needRegenerateVertices}).forEach(function(Ue){M.updateAttributeByFeatureRange(Ue.name,E.getEncodedData(),Ue.featureRange.startIndex,Ue.featureRange.endIndex),Ue.needRegenerateVertices=!1,C.logger.debug("regenerate vertex attributes: ".concat(Ue.name," finished"))})}},{key:"initStyleAttribute",value:function(E,S){var C=this,M=S.styleAttributeService,j=M.getLayerStyleAttributes()||[];j.filter(function(ae){return ae.needRegenerateVertices}).forEach(function(ae){M.updateAttributeByFeatureRange(ae.name,E.getEncodedData(),ae.featureRange.startIndex,ae.featureRange.endIndex),ae.needRegenerateVertices=!1,C.logger.debug("init vertex attributes: ".concat(ae.name," finished"))})}}]),h}(),ih),hd=St()(Kc.prototype,"logger",[zh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kc))||Ss);b.container.bind(b.TYPES.ILayerPlugin).to(jo).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Vh).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(uu).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Ec).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(th).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(od).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Sd).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(ke).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(id).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Yc).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Yh).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(Kh).inRequestScope(),b.container.bind(b.TYPES.ILayerPlugin).to(ju).inRequestScope()},t2Dn:function(Ie,x,o){var b=o("hypo"),v=o("ljhN");function Z(F,a,Y){(Y!==void 0&&!v(F[a],Y)||Y===void 0&&!(a in F))&&b(F,a,Y)}Ie.exports=Z},u6S6:function(Ie,x,o){var b=o("6acW"),v=o("sgoq"),Z=v(function(F,a,Y){return a=a.toLowerCase(),F+(Y?b(a):a)});Ie.exports=Z},uhBA:function(Ie,x,o){"use strict";var b=Object.prototype.hasOwnProperty,v="~";function Z(){}Object.create&&(Z.prototype=Object.create(null),new Z().__proto__||(v=!1));function F(Q,re,we){this.fn=Q,this.context=re,this.once=we||!1}function a(Q,re,we,J,Ke){if(typeof we!="function")throw new TypeError("The listener must be a function");var Ge=new F(we,J||Q,Ke),_e=v?v+re:re;return Q._events[_e]?Q._events[_e].fn?Q._events[_e]=[Q._events[_e],Ge]:Q._events[_e].push(Ge):(Q._events[_e]=Ge,Q._eventsCount++),Q}function Y(Q,re){--Q._eventsCount==0?Q._events=new Z:delete Q._events[re]}function B(){this._events=new Z,this._eventsCount=0}B.prototype.eventNames=function(){var re=[],we,J;if(this._eventsCount===0)return re;for(J in we=this._events)b.call(we,J)&&re.push(v?J.slice(1):J);return Object.getOwnPropertySymbols?re.concat(Object.getOwnPropertySymbols(we)):re},B.prototype.listeners=function(re){var we=v?v+re:re,J=this._events[we];if(!J)return[];if(J.fn)return[J.fn];for(var Ke=0,Ge=J.length,_e=new Array(Ge);Ke<Ge;Ke++)_e[Ke]=J[Ke].fn;return _e},B.prototype.listenerCount=function(re){var we=v?v+re:re,J=this._events[we];return J?J.fn?1:J.length:0},B.prototype.emit=function(re,we,J,Ke,Ge,_e){var Re=v?v+re:re;if(!this._events[Re])return!1;var at=this._events[Re],Oe=arguments.length,xt,Mt;if(at.fn){switch(at.once&&this.removeListener(re,at.fn,void 0,!0),Oe){case 1:return at.fn.call(at.context),!0;case 2:return at.fn.call(at.context,we),!0;case 3:return at.fn.call(at.context,we,J),!0;case 4:return at.fn.call(at.context,we,J,Ke),!0;case 5:return at.fn.call(at.context,we,J,Ke,Ge),!0;case 6:return at.fn.call(at.context,we,J,Ke,Ge,_e),!0}for(Mt=1,xt=new Array(Oe-1);Mt<Oe;Mt++)xt[Mt-1]=arguments[Mt];at.fn.apply(at.context,xt)}else{var Et=at.length,St;for(Mt=0;Mt<Et;Mt++)switch(at[Mt].once&&this.removeListener(re,at[Mt].fn,void 0,!0),Oe){case 1:at[Mt].fn.call(at[Mt].context);break;case 2:at[Mt].fn.call(at[Mt].context,we);break;case 3:at[Mt].fn.call(at[Mt].context,we,J);break;case 4:at[Mt].fn.call(at[Mt].context,we,J,Ke);break;default:if(!xt)for(St=1,xt=new Array(Oe-1);St<Oe;St++)xt[St-1]=arguments[St];at[Mt].fn.apply(at[Mt].context,xt)}}return!0},B.prototype.on=function(re,we,J){return a(this,re,we,J,!1)},B.prototype.once=function(re,we,J){return a(this,re,we,J,!0)},B.prototype.removeListener=function(re,we,J,Ke){var Ge=v?v+re:re;if(!this._events[Ge])return this;if(!we)return Y(this,Ge),this;var _e=this._events[Ge];if(_e.fn)_e.fn===we&&(!Ke||_e.once)&&(!J||_e.context===J)&&Y(this,Ge);else{for(var Re=0,at=[],Oe=_e.length;Re<Oe;Re++)(_e[Re].fn!==we||Ke&&!_e[Re].once||J&&_e[Re].context!==J)&&at.push(_e[Re]);at.length?this._events[Ge]=at.length===1?at[0]:at:Y(this,Ge)}return this},B.prototype.removeAllListeners=function(re){var we;return re?(we=v?v+re:re,this._events[we]&&Y(this,we)):(this._events=new Z,this._eventsCount=0),this},B.prototype.off=B.prototype.removeListener,B.prototype.addListener=B.prototype.on,B.prefixed=v,B.EventEmitter=B,Ie.exports=B},ujMp:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.circularDependencyToException=x.listMetadataForTarget=x.listRegisteredBindingsForServiceIdentifier=x.getServiceIdentifierAsString=x.getFunctionName=void 0;var b=o("MON2");function v(re){if(typeof re=="function"){var we=re;return we.name}else{if(typeof re=="symbol")return re.toString();var we=re;return we}}x.getServiceIdentifierAsString=v;function Z(re,we,J){var Ke="",Ge=J(re,we);return Ge.length!==0&&(Ke=`
Registered bindings:`,Ge.forEach(function(_e){var Re="Object";_e.implementationType!==null&&(Re=Q(_e.implementationType)),Ke=Ke+`
 `+Re,_e.constraint.metaData&&(Ke=Ke+" - "+_e.constraint.metaData)})),Ke}x.listRegisteredBindingsForServiceIdentifier=Z;function F(re,we){return re.parentRequest===null?!1:re.parentRequest.serviceIdentifier===we?!0:F(re.parentRequest,we)}function a(re){function we(Ke,Ge){Ge===void 0&&(Ge=[]);var _e=v(Ke.serviceIdentifier);return Ge.push(_e),Ke.parentRequest!==null?we(Ke.parentRequest,Ge):Ge}var J=we(re);return J.reverse().join(" --> ")}function Y(re){re.childRequests.forEach(function(we){if(F(we,we.serviceIdentifier)){var J=a(we);throw new Error(b.CIRCULAR_DEPENDENCY+" "+J)}else Y(we)})}x.circularDependencyToException=Y;function B(re,we){if(we.isTagged()||we.isNamed()){var J="",Ke=we.getNamedTag(),Ge=we.getCustomTags();return Ke!==null&&(J+=Ke.toString()+`
`),Ge!==null&&Ge.forEach(function(_e){J+=_e.toString()+`
`})," "+re+`
 `+re+" - "+J}else return" "+re}x.listMetadataForTarget=B;function Q(re){if(re.name)return re.name;var we=re.toString(),J=we.match(/^function\s*([^\s(]+)/);return J?J[1]:"Anonymous function: "+we}x.getFunctionName=Q},"vN+2":function(Ie,x){function o(){}Ie.exports=o},"w/wX":function(Ie,x,o){var b=o("QqLw"),v=o("ExA7"),Z="[object Set]";function F(a){return v(a)&&b(a)==Z}Ie.exports=F},w26f:function(Ie,x,o){(function(b){var v=200,Z="__lodash_hash_undefined__",F=1/0,a="[object Function]",Y="[object GeneratorFunction]",B=/[\\^$.*+?()[\]{}|]/g,Q=/^\[object .+?Constructor\]$/,re=typeof b=="object"&&b&&b.Object===Object&&b,we=typeof self=="object"&&self&&self.Object===Object&&self,J=re||we||Function("return this")();function Ke(ut,Qe){var Vt=ut?ut.length:0;return!!Vt&&Re(ut,Qe,0)>-1}function Ge(ut,Qe,Vt){for(var pr=-1,Zr=ut?ut.length:0;++pr<Zr;)if(Vt(Qe,ut[pr]))return!0;return!1}function _e(ut,Qe,Vt,pr){for(var Zr=ut.length,cr=Vt+(pr?1:-1);pr?cr--:++cr<Zr;)if(Qe(ut[cr],cr,ut))return cr;return-1}function Re(ut,Qe,Vt){if(Qe!==Qe)return _e(ut,at,Vt);for(var pr=Vt-1,Zr=ut.length;++pr<Zr;)if(ut[pr]===Qe)return pr;return-1}function at(ut){return ut!==ut}function Oe(ut,Qe){return ut.has(Qe)}function xt(ut,Qe){return ut==null?void 0:ut[Qe]}function Mt(ut){var Qe=!1;if(ut!=null&&typeof ut.toString!="function")try{Qe=!!(ut+"")}catch(Vt){}return Qe}function Et(ut){var Qe=-1,Vt=Array(ut.size);return ut.forEach(function(pr){Vt[++Qe]=pr}),Vt}var St=Array.prototype,or=Function.prototype,$t=Object.prototype,Ht=J["__core-js_shared__"],mt=function(){var ut=/[^.]+$/.exec(Ht&&Ht.keys&&Ht.keys.IE_PROTO||"");return ut?"Symbol(src)_1."+ut:""}(),Xe=or.toString,Tt=$t.hasOwnProperty,ze=$t.toString,st=RegExp("^"+Xe.call(Tt).replace(B,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wt=St.splice,bt=ie(J,"Map"),dt=ie(J,"Set"),H=ie(Object,"create");function z(ut){var Qe=-1,Vt=ut?ut.length:0;for(this.clear();++Qe<Vt;){var pr=ut[Qe];this.set(pr[0],pr[1])}}function V(){this.__data__=H?H(null):{}}function Se(ut){return this.has(ut)&&delete this.__data__[ut]}function ve(ut){var Qe=this.__data__;if(H){var Vt=Qe[ut];return Vt===Z?void 0:Vt}return Tt.call(Qe,ut)?Qe[ut]:void 0}function ce(ut){var Qe=this.__data__;return H?Qe[ut]!==void 0:Tt.call(Qe,ut)}function fe(ut,Qe){var Vt=this.__data__;return Vt[ut]=H&&Qe===void 0?Z:Qe,this}z.prototype.clear=V,z.prototype.delete=Se,z.prototype.get=ve,z.prototype.has=ce,z.prototype.set=fe;function ke(ut){var Qe=-1,Vt=ut?ut.length:0;for(this.clear();++Qe<Vt;){var pr=ut[Qe];this.set(pr[0],pr[1])}}function lt(){this.__data__=[]}function nt(ut){var Qe=this.__data__,Vt=yt(Qe,ut);if(Vt<0)return!1;var pr=Qe.length-1;return Vt==pr?Qe.pop():Wt.call(Qe,Vt,1),!0}function le(ut){var Qe=this.__data__,Vt=yt(Qe,ut);return Vt<0?void 0:Qe[Vt][1]}function ye(ut){return yt(this.__data__,ut)>-1}function He(ut,Qe){var Vt=this.__data__,pr=yt(Vt,ut);return pr<0?Vt.push([ut,Qe]):Vt[pr][1]=Qe,this}ke.prototype.clear=lt,ke.prototype.delete=nt,ke.prototype.get=le,ke.prototype.has=ye,ke.prototype.set=He;function ft(ut){var Qe=-1,Vt=ut?ut.length:0;for(this.clear();++Qe<Vt;){var pr=ut[Qe];this.set(pr[0],pr[1])}}function De(){this.__data__={hash:new z,map:new(bt||ke),string:new z}}function Ze(ut){return $e(this,ut).delete(ut)}function w(ut){return $e(this,ut).get(ut)}function R(ut){return $e(this,ut).has(ut)}function q(ut,Qe){return $e(this,ut).set(ut,Qe),this}ft.prototype.clear=De,ft.prototype.delete=Ze,ft.prototype.get=w,ft.prototype.has=R,ft.prototype.set=q;function he(ut){var Qe=-1,Vt=ut?ut.length:0;for(this.__data__=new ft;++Qe<Vt;)this.add(ut[Qe])}function Ve(ut){return this.__data__.set(ut,Z),this}function Ye(ut){return this.__data__.has(ut)}he.prototype.add=he.prototype.push=Ve,he.prototype.has=Ye;function yt(ut,Qe){for(var Vt=ut.length;Vt--;)if(ht(ut[Vt][0],Qe))return Vt;return-1}function it(ut){if(!vt(ut)||jt(ut))return!1;var Qe=Pt(ut)||Mt(ut)?st:Q;return Qe.test(lr(ut))}function Nt(ut,Qe,Vt){var pr=-1,Zr=Ke,cr=ut.length,jn=!0,En=[],ni=En;if(Vt)jn=!1,Zr=Ge;else if(cr>=v){var fi=Qe?null:$(ut);if(fi)return Et(fi);jn=!1,Zr=Oe,ni=new he}else ni=Qe?[]:En;e:for(;++pr<cr;){var Zn=ut[pr],Vn=Qe?Qe(Zn):Zn;if(Zn=Vt||Zn!==0?Zn:0,jn&&Vn===Vn){for(var Te=ni.length;Te--;)if(ni[Te]===Vn)continue e;Qe&&ni.push(Vn),En.push(Zn)}else Zr(ni,Vn,Vt)||(ni!==En&&ni.push(Vn),En.push(Zn))}return En}var $=dt&&1/Et(new dt([,-0]))[1]==F?function(ut){return new dt(ut)}:Pe;function $e(ut,Qe){var Vt=ut.__data__;return qe(Qe)?Vt[typeof Qe=="string"?"string":"hash"]:Vt.map}function ie(ut,Qe){var Vt=xt(ut,Qe);return it(Vt)?Vt:void 0}function qe(ut){var Qe=typeof ut;return Qe=="string"||Qe=="number"||Qe=="symbol"||Qe=="boolean"?ut!=="__proto__":ut===null}function jt(ut){return!!mt&&mt in ut}function lr(ut){if(ut!=null){try{return Xe.call(ut)}catch(Qe){}try{return ut+""}catch(Qe){}}return""}function ct(ut){return ut&&ut.length?Nt(ut):[]}function ht(ut,Qe){return ut===Qe||ut!==ut&&Qe!==Qe}function Pt(ut){var Qe=vt(ut)?ze.call(ut):"";return Qe==a||Qe==Y}function vt(ut){var Qe=typeof ut;return!!ut&&(Qe=="object"||Qe=="function")}function Pe(){}Ie.exports=ct}).call(this,o("yLpj"))},wclG:function(Ie,x,o){var b=o("pFRH"),v=o("88Gu"),Z=v(b);Ie.exports=Z},wnjb:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.MetadataReader=void 0;var b=o("xfSm"),v=function(){function Z(){}return Z.prototype.getConstructorMetadata=function(F){var a=Reflect.getMetadata(b.PARAM_TYPES,F),Y=Reflect.getMetadata(b.TAGGED,F);return{compilerGeneratedMetadata:a,userGeneratedMetadata:Y||{}}},Z.prototype.getPropertiesMetadata=function(F){var a=Reflect.getMetadata(b.TAGGED_PROP,F)||[];return a},Z}();x.MetadataReader=v},wrZu:function(Ie,x,o){var b=o("+K+b"),v=o("XYm9"),Z=o("b2z7"),F=o("otv/"),a=o("yP5f"),Y="[object Boolean]",B="[object Date]",Q="[object Map]",re="[object Number]",we="[object RegExp]",J="[object Set]",Ke="[object String]",Ge="[object Symbol]",_e="[object ArrayBuffer]",Re="[object DataView]",at="[object Float32Array]",Oe="[object Float64Array]",xt="[object Int8Array]",Mt="[object Int16Array]",Et="[object Int32Array]",St="[object Uint8Array]",or="[object Uint8ClampedArray]",$t="[object Uint16Array]",Ht="[object Uint32Array]";function mt(Xe,Tt,ze){var st=Xe.constructor;switch(Tt){case _e:return b(Xe);case Y:case B:return new st(+Xe);case Re:return v(Xe,ze);case at:case Oe:case xt:case Mt:case Et:case St:case or:case $t:case Ht:return a(Xe,ze);case Q:return new st;case re:case Ke:return new st(Xe);case we:return Z(Xe);case J:return new st;case Ge:return F(Xe)}}Ie.exports=mt},wy8a:function(Ie,x,o){var b=o("KxBF");function v(Z,F,a){var Y=Z.length;return a=a===void 0?Y:a,!F&&a>=Y?Z:b(Z,F,a)}Ie.exports=v},xfSm:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.POST_CONSTRUCT=x.DESIGN_PARAM_TYPES=x.PARAM_TYPES=x.TAGGED_PROP=x.TAGGED=x.MULTI_INJECT_TAG=x.INJECT_TAG=x.OPTIONAL_TAG=x.UNMANAGED_TAG=x.NAME_TAG=x.NAMED_TAG=void 0,x.NAMED_TAG="named",x.NAME_TAG="name",x.UNMANAGED_TAG="unmanaged",x.OPTIONAL_TAG="optional",x.INJECT_TAG="inject",x.MULTI_INJECT_TAG="multi_inject",x.TAGGED="inversify:tagged",x.TAGGED_PROP="inversify:tagged_props",x.PARAM_TYPES="inversify:paramtypes",x.DESIGN_PARAM_TYPES="design:paramtypes",x.POST_CONSTRUCT="post_construct"},xfeJ:function(Ie,x){function o(b){return Function.toString.call(b).indexOf("[native code]")!==-1}Ie.exports=o},xiII:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Request=void 0;var b=o("d9O0"),v=function(){function Z(F,a,Y,B,Q){this.id=b.id(),this.serviceIdentifier=F,this.parentContext=a,this.parentRequest=Y,this.target=Q,this.childRequests=[],this.bindings=Array.isArray(B)?B:[B],this.requestScope=Y===null?new Map:null}return Z.prototype.addChildRequest=function(F,a,Y){var B=new Z(F,this.parentContext,this,a,Y);return this.childRequests.push(B),B},Z}();x.Request=v},xp6e:function(Ie,x,o){"use strict";(function(b){o.d(x,"a",function(){return ve}),o.d(x,"b",function(){return lt}),o.d(x,"c",function(){return H}),o.d(x,"d",function(){return ke});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function v(nt,le,ye,He){function ft(De){return De instanceof ye?De:new ye(function(Ze){Ze(De)})}return new(ye||(ye=Promise))(function(De,Ze){function w(he){try{q(He.next(he))}catch(Ve){Ze(Ve)}}function R(he){try{q(He.throw(he))}catch(Ve){Ze(Ve)}}function q(he){he.done?De(he.value):ft(he.value).then(w,R)}q((He=He.apply(nt,le||[])).next())})}function Z(nt,le){var ye={label:0,sent:function(){if(De[0]&1)throw De[1];return De[1]},trys:[],ops:[]},He,ft,De,Ze;return Ze={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(Ze[Symbol.iterator]=function(){return this}),Ze;function w(q){return function(he){return R([q,he])}}function R(q){if(He)throw new TypeError("Generator is already executing.");for(;ye;)try{if(He=1,ft&&(De=q[0]&2?ft.return:q[0]?ft.throw||((De=ft.return)&&De.call(ft),0):ft.next)&&!(De=De.call(ft,q[1])).done)return De;switch(ft=0,De&&(q=[q[0]&2,De.value]),q[0]){case 0:case 1:De=q;break;case 4:return ye.label++,{value:q[1],done:!1};case 5:ye.label++,ft=q[1],q=[0];continue;case 7:q=ye.ops.pop(),ye.trys.pop();continue;default:if(De=ye.trys,!(De=De.length>0&&De[De.length-1])&&(q[0]===6||q[0]===2)){ye=0;continue}if(q[0]===3&&(!De||q[1]>De[0]&&q[1]<De[3])){ye.label=q[1];break}if(q[0]===6&&ye.label<De[1]){ye.label=De[1],De=q;break}if(De&&ye.label<De[2]){ye.label=De[2],ye.ops.push(q);break}De[2]&&ye.ops.pop(),ye.trys.pop();continue}q=le.call(nt,ye)}catch(he){q=[6,he],ft=0}finally{He=De=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}function F(nt,le){var ye=typeof Symbol=="function"&&nt[Symbol.iterator];if(!ye)return nt;var He=ye.call(nt),ft,De=[],Ze;try{for(;(le===void 0||le-- >0)&&!(ft=He.next()).done;)De.push(ft.value)}catch(w){Ze={error:w}}finally{try{ft&&!ft.done&&(ye=He.return)&&ye.call(He)}finally{if(Ze)throw Ze.error}}return De}function a(){for(var nt=[],le=0;le<arguments.length;le++)nt=nt.concat(F(arguments[le]));return nt}function Y(nt){return nt&&nt.__esModule&&Object.prototype.hasOwnProperty.call(nt,"default")?nt.default:nt}function B(nt,le){return le={exports:{}},nt(le,le.exports),le.exports}var Q=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=ye;function ye(He){return He&&typeof He.length=="number"&&He.length>=0&&He.length%1==0}nt.exports=le.default});Y(Q);var re=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=function(ye){return function(){for(var He=[],ft=arguments.length;ft--;)He[ft]=arguments[ft];var De=He.pop();return ye.call(this,He,De)}},nt.exports=le.default});Y(re);var we=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.fallback=ft,le.wrap=De;var ye=le.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,He=le.hasNextTick=typeof b=="object"&&typeof b.nextTick=="function";function ft(w){setTimeout(w,0)}function De(w){return function(R){for(var q=[],he=arguments.length-1;he-- >0;)q[he]=arguments[he+1];return w(function(){return R.apply(void 0,q)})}}var Ze;ye?Ze=setImmediate:He?Ze=b.nextTick:Ze=ft,le.default=De(Ze)});Y(we);var J=we.fallback,Ke=we.wrap,Ge=we.hasSetImmediate,_e=we.hasNextTick,Re=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=De;var ye=ft(re),He=ft(we);function ft(R){return R&&R.__esModule?R:{default:R}}function De(R){return(0,at.isAsync)(R)?function(){for(var q=[],he=arguments.length;he--;)q[he]=arguments[he];var Ve=q.pop(),Ye=R.apply(this,q);return Ze(Ye,Ve)}:(0,ye.default)(function(q,he){var Ve;try{Ve=R.apply(this,q)}catch(Ye){return he(Ye)}if(Ve&&typeof Ve.then=="function")return Ze(Ve,he);he(null,Ve)})}function Ze(R,q){return R.then(function(he){w(q,null,he)},function(he){w(q,he&&he.message?he:new Error(he))})}function w(R,q,he){try{R(q,he)}catch(Ve){(0,He.default)(function(Ye){throw Ye},Ve)}}nt.exports=le.default});Y(Re);var at=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.isAsyncIterable=le.isAsyncGenerator=le.isAsync=void 0;var ye=He(Re);function He(R){return R&&R.__esModule?R:{default:R}}function ft(R){return R[Symbol.toStringTag]==="AsyncFunction"}function De(R){return R[Symbol.toStringTag]==="AsyncGenerator"}function Ze(R){return typeof R[Symbol.asyncIterator]=="function"}function w(R){if(typeof R!="function")throw new Error("expected a function");return ft(R)?(0,ye.default)(R):R}le.default=w,le.isAsync=ft,le.isAsyncGenerator=De,le.isAsyncIterable=Ze});Y(at);var Oe=at.isAsyncIterable,xt=at.isAsyncGenerator,Mt=at.isAsync,Et=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=ye;function ye(He,ft){if(ft===void 0&&(ft=He.length),!ft)throw new Error("arity is undefined");function De(){for(var Ze=this,w=[],R=arguments.length;R--;)w[R]=arguments[R];return typeof w[ft-1]=="function"?He.apply(this,w):new Promise(function(q,he){w[ft-1]=function(Ve){for(var Ye=[],yt=arguments.length-1;yt-- >0;)Ye[yt]=arguments[yt+1];if(Ve)return he(Ve);q(Ye.length>1?Ye:Ye[0])},He.apply(Ze,w)})}return Object.defineProperty(De,"name",{configurable:!0,value:"awaitable("+He.name+")"}),De}nt.exports=le.default});Y(Et);var St=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0});var ye=De(Q),He=De(at),ft=De(Et);function De(Ze){return Ze&&Ze.__esModule?Ze:{default:Ze}}le.default=(0,ft.default)(function(Ze,w,R){var q=(0,ye.default)(w)?[]:{};Ze(w,function(he,Ve,Ye){(0,He.default)(he)(function(yt){for(var it,Nt=[],$=arguments.length-1;$-- >0;)Nt[$]=arguments[$+1];Nt.length<2&&(it=Nt,Nt=it[0]),q[Ve]=Nt,Ye(yt)})},function(he){return R(he,q)})},3),nt.exports=le.default});Y(St);var or=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=ye;function ye(He){function ft(){for(var De=[],Ze=arguments.length;Ze--;)De[Ze]=arguments[Ze];if(He!==null){var w=He;He=null,w.apply(this,De)}}return Object.assign(ft,He),ft}nt.exports=le.default});Y(or);var $t=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=function(ye){return ye[Symbol.iterator]&&ye[Symbol.iterator]()},nt.exports=le.default});Y($t);var Ht=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=R;var ye=ft(Q),He=ft($t);function ft(q){return q&&q.__esModule?q:{default:q}}function De(q){var he=-1,Ve=q.length;return function(){return++he<Ve?{value:q[he],key:he}:null}}function Ze(q){var he=-1;return function(){var Ye=q.next();return Ye.done?null:(he++,{value:Ye.value,key:he})}}function w(q){var he=q?Object.keys(q):[],Ve=-1,Ye=he.length;return function(){var it=he[++Ve];return Ve<Ye?{value:q[it],key:it}:null}}function R(q){if((0,ye.default)(q))return De(q);var he=(0,He.default)(q);return he?Ze(he):w(q)}nt.exports=le.default});Y(Ht);var mt=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=ye;function ye(He){return function(){for(var ft=[],De=arguments.length;De--;)ft[De]=arguments[De];if(He===null)throw new Error("Callback was already called.");var Ze=He;He=null,Ze.apply(this,ft)}}nt.exports=le.default});Y(mt);var Xe=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0});var ye={};le.default=ye,nt.exports=le.default});Y(Xe);var Tt=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=ft;var ye=He(Xe);function He(De){return De&&De.__esModule?De:{default:De}}function ft(De,Ze,w,R){var q=!1,he=!1,Ve=!1,Ye=0,yt=0;function it(){Ye>=Ze||Ve||q||(Ve=!0,De.next().then(function($e){var ie=$e.value,qe=$e.done;if(!(he||q)){if(Ve=!1,qe){q=!0,Ye<=0&&R(null);return}Ye++,w(ie,yt,Nt),yt++,it()}}).catch($))}function Nt($e,ie){if(Ye-=1,!he){if($e)return $($e);if($e===!1){q=!0,he=!0;return}if(ie===ye.default||q&&Ye<=0)return q=!0,R(null);it()}}function $($e){he||(Ve=!1,q=!0,R($e))}it()}nt.exports=le.default});Y(Tt);var ze=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0});var ye=w(or),He=w(Ht),ft=w(mt),De=w(Tt),Ze=w(Xe);function w(R){return R&&R.__esModule?R:{default:R}}le.default=function(R){return function(q,he,Ve){if(Ve=(0,ye.default)(Ve),R<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!q)return Ve(null);if((0,at.isAsyncGenerator)(q))return(0,De.default)(q,R,he,Ve);if((0,at.isAsyncIterable)(q))return(0,De.default)(q[Symbol.asyncIterator](),R,he,Ve);var Ye=(0,He.default)(q),yt=!1,it=!1,Nt=0,$=!1;function $e(qe,jt){if(!it)if(Nt-=1,qe)yt=!0,Ve(qe);else if(qe===!1)yt=!0,it=!0;else{if(jt===Ze.default||yt&&Nt<=0)return yt=!0,Ve(null);$||ie()}}function ie(){for($=!0;Nt<R&&!yt;){var qe=Ye();if(qe===null){yt=!0,Nt<=0&&Ve(null);return}Nt+=1,he(qe.value,qe.key,(0,ft.default)($e))}$=!1}ie()}},nt.exports=le.default});Y(ze);var st=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0});var ye=De(ze),He=De(at),ft=De(Et);function De(w){return w&&w.__esModule?w:{default:w}}function Ze(w,R,q,he){return(0,ye.default)(R)(w,(0,He.default)(q),he)}le.default=(0,ft.default)(Ze,4),nt.exports=le.default});Y(st);var Wt=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0});var ye=ft(st),He=ft(Et);function ft(Ze){return Ze&&Ze.__esModule?Ze:{default:Ze}}function De(Ze,w,R){return(0,ye.default)(Ze,1,w,R)}le.default=(0,He.default)(De,3),nt.exports=le.default});Y(Wt);var bt=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=De;var ye=ft(St),He=ft(Wt);function ft(Ze){return Ze&&Ze.__esModule?Ze:{default:Ze}}function De(Ze,w){return(0,ye.default)(He.default,Ze,w)}nt.exports=le.default}),dt=Y(bt),H=function(){function nt(){for(var le=arguments,ye=[],He=0;He<arguments.length;He++)ye[He]=le[He];this.args=[],this.tasks=[]}return nt.prototype.call=function(){for(var le=arguments,ye=[],He=0;He<arguments.length;He++)ye[He]=le[He];return this.args=ye,dt(this.tasks)},nt.prototype.tap=function(le,ye){var He=this;this.tasks.push(function(ft){ye.apply(void 0,a(He.args)),ft(null,le)})},nt}(),z=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0});var ye=q(Q),He=q(Xe),ft=q(st),De=q(or),Ze=q(mt),w=q(at),R=q(Et);function q(yt){return yt&&yt.__esModule?yt:{default:yt}}function he(yt,it,Nt){Nt=(0,De.default)(Nt);var $=0,$e=0,ie=yt.length,qe=!1;ie===0&&Nt(null);function jt(lr,ct){lr===!1&&(qe=!0),qe!==!0&&(lr?Nt(lr):(++$e===ie||ct===He.default)&&Nt(null))}for(;$<ie;$++)it(yt[$],$,(0,Ze.default)(jt))}function Ve(yt,it,Nt){return(0,ft.default)(yt,Infinity,it,Nt)}function Ye(yt,it,Nt){var $=(0,ye.default)(yt)?he:Ve;return $(yt,(0,w.default)(it),Nt)}le.default=(0,R.default)(Ye,3),nt.exports=le.default});Y(z);var V=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0}),le.default=De;var ye=ft(z),He=ft(St);function ft(Ze){return Ze&&Ze.__esModule?Ze:{default:Ze}}function De(Ze,w){return(0,He.default)(ye.default,Ze,w)}nt.exports=le.default}),Se=Y(V),ve=function(){function nt(){for(var le=arguments,ye=[],He=0;He<arguments.length;He++)ye[He]=le[He];this.tasks=[]}return nt.prototype.promise=function(){for(var le=arguments,ye=[],He=0;He<arguments.length;He++)ye[He]=le[He];return Se(this.tasks)},nt.prototype.tapPromise=function(le,ye){var He=this;this.tasks.push(function(ft){return v(He,void 0,void 0,function(){return Z(this,function(De){switch(De.label){case 0:return[4,ye()];case 1:return De.sent(),ft(null,le),[2]}})})})},nt}(),ce=B(function(nt,le){Object.defineProperty(le,"__esModule",{value:!0});var ye=Ze(or),He=Ze(mt),ft=Ze(at),De=Ze(Et);function Ze(R){return R&&R.__esModule?R:{default:R}}function w(R,q){if(q=(0,ye.default)(q),!Array.isArray(R))return q(new Error("First argument to waterfall must be an array of functions"));if(!R.length)return q();var he=0;function Ve(yt){var it=(0,ft.default)(R[he++]);it.apply(void 0,yt.concat([(0,He.default)(Ye)]))}function Ye(yt){for(var it=[],Nt=arguments.length-1;Nt-- >0;)it[Nt]=arguments[Nt+1];if(yt!==!1){if(yt||he===R.length)return q.apply(void 0,[yt].concat(it));Ve(it)}}Ve([])}le.default=(0,De.default)(w),nt.exports=le.default}),fe=Y(ce),ke=function(){function nt(){for(var le=arguments,ye=[],He=0;He<arguments.length;He++)ye[He]=le[He];this.tasks=[]}return nt.prototype.call=function(){for(var le=arguments,ye=[],He=0;He<arguments.length;He++)ye[He]=le[He];return fe(this.tasks)},nt.prototype.tap=function(le,ye){this.tasks.length===0?this.tasks.push(function(He){var ft=ye();He(ft?null:!1,ft)}):this.tasks.push(function(He,ft){var De=ye();ft(De?null:!1,le)})},nt}(),lt=function(){function nt(){for(var le=arguments,ye=[],He=0;He<arguments.length;He++)ye[He]=le[He];this.tasks=[]}return nt.prototype.call=function(){for(var le=arguments,ye=[],He=0;He<arguments.length;He++)ye[He]=le[He];return dt(this.tasks)},nt.prototype.tap=function(le,ye){this.tasks.push(function(He){var ft=ye();He(ft,le)})},nt}()}).call(this,o("Q2Ig"))},yG8O:function(Ie,x){function o(b,v,Z,F){!Z||Object.defineProperty(b,v,{enumerable:Z.enumerable,configurable:Z.configurable,writable:Z.writable,value:Z.initializer?Z.initializer.call(F):void 0})}Ie.exports=o},yHx3:function(Ie,x){var o=Object.prototype,b=o.hasOwnProperty;function v(Z){var F=Z.length,a=new Z.constructor(F);return F&&typeof Z[0]=="string"&&b.call(Z,"index")&&(a.index=Z.index,a.input=Z.input),a}Ie.exports=v},yLV6:function(Ie,x,o){var b;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(v,Z,F,a){"use strict";var Y=["","webkit","Moz","MS","ms","o"],B=Z.createElement("div"),Q="function",re=Math.round,we=Math.abs,J=Date.now;function Ke(Bt,Fe,Ot){return setTimeout(Et(Bt,Ot),Fe)}function Ge(Bt,Fe,Ot){return Array.isArray(Bt)?(_e(Bt,Ot[Fe],Ot),!0):!1}function _e(Bt,Fe,Ot){var fr;if(!!Bt)if(Bt.forEach)Bt.forEach(Fe,Ot);else if(Bt.length!==a)for(fr=0;fr<Bt.length;)Fe.call(Ot,Bt[fr],fr,Bt),fr++;else for(fr in Bt)Bt.hasOwnProperty(fr)&&Fe.call(Ot,Bt[fr],fr,Bt)}function Re(Bt,Fe,Ot){var fr="DEPRECATED METHOD: "+Fe+`
`+Ot+` AT 
`;return function(){var rn=new Error("get-stack-trace"),bn=rn&&rn.stack?rn.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Un=v.console&&(v.console.warn||v.console.log);return Un&&Un.call(v.console,fr,bn),Bt.apply(this,arguments)}}var at;typeof Object.assign!="function"?at=function(Fe){if(Fe===a||Fe===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ot=Object(Fe),fr=1;fr<arguments.length;fr++){var rn=arguments[fr];if(rn!==a&&rn!==null)for(var bn in rn)rn.hasOwnProperty(bn)&&(Ot[bn]=rn[bn])}return Ot}:at=Object.assign;var Oe=Re(function(Fe,Ot,fr){for(var rn=Object.keys(Ot),bn=0;bn<rn.length;)(!fr||fr&&Fe[rn[bn]]===a)&&(Fe[rn[bn]]=Ot[rn[bn]]),bn++;return Fe},"extend","Use `assign`."),xt=Re(function(Fe,Ot){return Oe(Fe,Ot,!0)},"merge","Use `assign`.");function Mt(Bt,Fe,Ot){var fr=Fe.prototype,rn;rn=Bt.prototype=Object.create(fr),rn.constructor=Bt,rn._super=fr,Ot&&at(rn,Ot)}function Et(Bt,Fe){return function(){return Bt.apply(Fe,arguments)}}function St(Bt,Fe){return typeof Bt==Q?Bt.apply(Fe&&Fe[0]||a,Fe):Bt}function or(Bt,Fe){return Bt===a?Fe:Bt}function $t(Bt,Fe,Ot){_e(Tt(Fe),function(fr){Bt.addEventListener(fr,Ot,!1)})}function Ht(Bt,Fe,Ot){_e(Tt(Fe),function(fr){Bt.removeEventListener(fr,Ot,!1)})}function mt(Bt,Fe){for(;Bt;){if(Bt==Fe)return!0;Bt=Bt.parentNode}return!1}function Xe(Bt,Fe){return Bt.indexOf(Fe)>-1}function Tt(Bt){return Bt.trim().split(/\s+/g)}function ze(Bt,Fe,Ot){if(Bt.indexOf&&!Ot)return Bt.indexOf(Fe);for(var fr=0;fr<Bt.length;){if(Ot&&Bt[fr][Ot]==Fe||!Ot&&Bt[fr]===Fe)return fr;fr++}return-1}function st(Bt){return Array.prototype.slice.call(Bt,0)}function Wt(Bt,Fe,Ot){for(var fr=[],rn=[],bn=0;bn<Bt.length;){var Un=Fe?Bt[bn][Fe]:Bt[bn];ze(rn,Un)<0&&fr.push(Bt[bn]),rn[bn]=Un,bn++}return Ot&&(Fe?fr=fr.sort(function(ao,bo){return ao[Fe]>bo[Fe]}):fr=fr.sort()),fr}function bt(Bt,Fe){for(var Ot,fr,rn=Fe[0].toUpperCase()+Fe.slice(1),bn=0;bn<Y.length;){if(Ot=Y[bn],fr=Ot?Ot+rn:Fe,fr in Bt)return fr;bn++}return a}var dt=1;function H(){return dt++}function z(Bt){var Fe=Bt.ownerDocument||Bt;return Fe.defaultView||Fe.parentWindow||v}var V=/mobile|tablet|ip(ad|hone|od)|android/i,Se="ontouchstart"in v,ve=bt(v,"PointerEvent")!==a,ce=Se&&V.test(navigator.userAgent),fe="touch",ke="pen",lt="mouse",nt="kinect",le=25,ye=1,He=2,ft=4,De=8,Ze=1,w=2,R=4,q=8,he=16,Ve=w|R,Ye=q|he,yt=Ve|Ye,it=["x","y"],Nt=["clientX","clientY"];function $(Bt,Fe){var Ot=this;this.manager=Bt,this.callback=Fe,this.element=Bt.element,this.target=Bt.options.inputTarget,this.domHandler=function(fr){St(Bt.options.enable,[Bt])&&Ot.handler(fr)},this.init()}$.prototype={handler:function(){},init:function(){this.evEl&&$t(this.element,this.evEl,this.domHandler),this.evTarget&&$t(this.target,this.evTarget,this.domHandler),this.evWin&&$t(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ht(this.element,this.evEl,this.domHandler),this.evTarget&&Ht(this.target,this.evTarget,this.domHandler),this.evWin&&Ht(z(this.element),this.evWin,this.domHandler)}};function $e(Bt){var Fe,Ot=Bt.options.inputClass;return Ot?Fe=Ot:ve?Fe=Vn:ce?Fe=Ne:Se?Fe=Br:Fe=jn,new Fe(Bt,ie)}function ie(Bt,Fe,Ot){var fr=Ot.pointers.length,rn=Ot.changedPointers.length,bn=Fe&ye&&fr-rn==0,Un=Fe&(ft|De)&&fr-rn==0;Ot.isFirst=!!bn,Ot.isFinal=!!Un,bn&&(Bt.session={}),Ot.eventType=Fe,qe(Bt,Ot),Bt.emit("hammer.input",Ot),Bt.recognize(Ot),Bt.session.prevInput=Ot}function qe(Bt,Fe){var Ot=Bt.session,fr=Fe.pointers,rn=fr.length;Ot.firstInput||(Ot.firstInput=ct(Fe)),rn>1&&!Ot.firstMultiple?Ot.firstMultiple=ct(Fe):rn===1&&(Ot.firstMultiple=!1);var bn=Ot.firstInput,Un=Ot.firstMultiple,Da=Un?Un.center:bn.center,ao=Fe.center=ht(fr);Fe.timeStamp=J(),Fe.deltaTime=Fe.timeStamp-bn.timeStamp,Fe.angle=ut(Da,ao),Fe.distance=Pe(Da,ao),jt(Ot,Fe),Fe.offsetDirection=vt(Fe.deltaX,Fe.deltaY);var bo=Pt(Fe.deltaTime,Fe.deltaX,Fe.deltaY);Fe.overallVelocityX=bo.x,Fe.overallVelocityY=bo.y,Fe.overallVelocity=we(bo.x)>we(bo.y)?bo.x:bo.y,Fe.scale=Un?Vt(Un.pointers,fr):1,Fe.rotation=Un?Qe(Un.pointers,fr):0,Fe.maxPointers=Ot.prevInput?Fe.pointers.length>Ot.prevInput.maxPointers?Fe.pointers.length:Ot.prevInput.maxPointers:Fe.pointers.length,lr(Ot,Fe);var Fo=Bt.element;mt(Fe.srcEvent.target,Fo)&&(Fo=Fe.srcEvent.target),Fe.target=Fo}function jt(Bt,Fe){var Ot=Fe.center,fr=Bt.offsetDelta||{},rn=Bt.prevDelta||{},bn=Bt.prevInput||{};(Fe.eventType===ye||bn.eventType===ft)&&(rn=Bt.prevDelta={x:bn.deltaX||0,y:bn.deltaY||0},fr=Bt.offsetDelta={x:Ot.x,y:Ot.y}),Fe.deltaX=rn.x+(Ot.x-fr.x),Fe.deltaY=rn.y+(Ot.y-fr.y)}function lr(Bt,Fe){var Ot=Bt.lastInterval||Fe,fr=Fe.timeStamp-Ot.timeStamp,rn,bn,Un,Da;if(Fe.eventType!=De&&(fr>le||Ot.velocity===a)){var ao=Fe.deltaX-Ot.deltaX,bo=Fe.deltaY-Ot.deltaY,Fo=Pt(fr,ao,bo);bn=Fo.x,Un=Fo.y,rn=we(Fo.x)>we(Fo.y)?Fo.x:Fo.y,Da=vt(ao,bo),Bt.lastInterval=Fe}else rn=Ot.velocity,bn=Ot.velocityX,Un=Ot.velocityY,Da=Ot.direction;Fe.velocity=rn,Fe.velocityX=bn,Fe.velocityY=Un,Fe.direction=Da}function ct(Bt){for(var Fe=[],Ot=0;Ot<Bt.pointers.length;)Fe[Ot]={clientX:re(Bt.pointers[Ot].clientX),clientY:re(Bt.pointers[Ot].clientY)},Ot++;return{timeStamp:J(),pointers:Fe,center:ht(Fe),deltaX:Bt.deltaX,deltaY:Bt.deltaY}}function ht(Bt){var Fe=Bt.length;if(Fe===1)return{x:re(Bt[0].clientX),y:re(Bt[0].clientY)};for(var Ot=0,fr=0,rn=0;rn<Fe;)Ot+=Bt[rn].clientX,fr+=Bt[rn].clientY,rn++;return{x:re(Ot/Fe),y:re(fr/Fe)}}function Pt(Bt,Fe,Ot){return{x:Fe/Bt||0,y:Ot/Bt||0}}function vt(Bt,Fe){return Bt===Fe?Ze:we(Bt)>=we(Fe)?Bt<0?w:R:Fe<0?q:he}function Pe(Bt,Fe,Ot){Ot||(Ot=it);var fr=Fe[Ot[0]]-Bt[Ot[0]],rn=Fe[Ot[1]]-Bt[Ot[1]];return Math.sqrt(fr*fr+rn*rn)}function ut(Bt,Fe,Ot){Ot||(Ot=it);var fr=Fe[Ot[0]]-Bt[Ot[0]],rn=Fe[Ot[1]]-Bt[Ot[1]];return Math.atan2(rn,fr)*180/Math.PI}function Qe(Bt,Fe){return ut(Fe[1],Fe[0],Nt)+ut(Bt[1],Bt[0],Nt)}function Vt(Bt,Fe){return Pe(Fe[0],Fe[1],Nt)/Pe(Bt[0],Bt[1],Nt)}var pr={mousedown:ye,mousemove:He,mouseup:ft},Zr="mousedown",cr="mousemove mouseup";function jn(){this.evEl=Zr,this.evWin=cr,this.pressed=!1,$.apply(this,arguments)}Mt(jn,$,{handler:function(Fe){var Ot=pr[Fe.type];Ot&ye&&Fe.button===0&&(this.pressed=!0),Ot&He&&Fe.which!==1&&(Ot=ft),!!this.pressed&&(Ot&ft&&(this.pressed=!1),this.callback(this.manager,Ot,{pointers:[Fe],changedPointers:[Fe],pointerType:lt,srcEvent:Fe}))}});var En={pointerdown:ye,pointermove:He,pointerup:ft,pointercancel:De,pointerout:De},ni={2:fe,3:ke,4:lt,5:nt},fi="pointerdown",Zn="pointermove pointerup pointercancel";v.MSPointerEvent&&!v.PointerEvent&&(fi="MSPointerDown",Zn="MSPointerMove MSPointerUp MSPointerCancel");function Vn(){this.evEl=fi,this.evWin=Zn,$.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Mt(Vn,$,{handler:function(Fe){var Ot=this.store,fr=!1,rn=Fe.type.toLowerCase().replace("ms",""),bn=En[rn],Un=ni[Fe.pointerType]||Fe.pointerType,Da=Un==fe,ao=ze(Ot,Fe.pointerId,"pointerId");bn&ye&&(Fe.button===0||Da)?ao<0&&(Ot.push(Fe),ao=Ot.length-1):bn&(ft|De)&&(fr=!0),!(ao<0)&&(Ot[ao]=Fe,this.callback(this.manager,bn,{pointers:Ot,changedPointers:[Fe],pointerType:Un,srcEvent:Fe}),fr&&Ot.splice(ao,1))}});var Te={touchstart:ye,touchmove:He,touchend:ft,touchcancel:De},de="touchstart",W="touchstart touchmove touchend touchcancel";function se(){this.evTarget=de,this.evWin=W,this.started=!1,$.apply(this,arguments)}Mt(se,$,{handler:function(Fe){var Ot=Te[Fe.type];if(Ot===ye&&(this.started=!0),!!this.started){var fr=Le.call(this,Fe,Ot);Ot&(ft|De)&&fr[0].length-fr[1].length==0&&(this.started=!1),this.callback(this.manager,Ot,{pointers:fr[0],changedPointers:fr[1],pointerType:fe,srcEvent:Fe})}}});function Le(Bt,Fe){var Ot=st(Bt.touches),fr=st(Bt.changedTouches);return Fe&(ft|De)&&(Ot=Wt(Ot.concat(fr),"identifier",!0)),[Ot,fr]}var et={touchstart:ye,touchmove:He,touchend:ft,touchcancel:De},wt="touchstart touchmove touchend touchcancel";function Ne(){this.evTarget=wt,this.targetIds={},$.apply(this,arguments)}Mt(Ne,$,{handler:function(Fe){var Ot=et[Fe.type],fr=gt.call(this,Fe,Ot);!fr||this.callback(this.manager,Ot,{pointers:fr[0],changedPointers:fr[1],pointerType:fe,srcEvent:Fe})}});function gt(Bt,Fe){var Ot=st(Bt.touches),fr=this.targetIds;if(Fe&(ye|He)&&Ot.length===1)return fr[Ot[0].identifier]=!0,[Ot,Ot];var rn,bn,Un=st(Bt.changedTouches),Da=[],ao=this.target;if(bn=Ot.filter(function(bo){return mt(bo.target,ao)}),Fe===ye)for(rn=0;rn<bn.length;)fr[bn[rn].identifier]=!0,rn++;for(rn=0;rn<Un.length;)fr[Un[rn].identifier]&&Da.push(Un[rn]),Fe&(ft|De)&&delete fr[Un[rn].identifier],rn++;if(!!Da.length)return[Wt(bn.concat(Da),"identifier",!0),Da]}var qt=2500,zr=25;function Br(){$.apply(this,arguments);var Bt=Et(this.handler,this);this.touch=new Ne(this.manager,Bt),this.mouse=new jn(this.manager,Bt),this.primaryTouch=null,this.lastTouches=[]}Mt(Br,$,{handler:function(Fe,Ot,fr){var rn=fr.pointerType==fe,bn=fr.pointerType==lt;if(!(bn&&fr.sourceCapabilities&&fr.sourceCapabilities.firesTouchEvents)){if(rn)sr.call(this,Ot,fr);else if(bn&&Cn.call(this,fr))return;this.callback(Fe,Ot,fr)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function sr(Bt,Fe){Bt&ye?(this.primaryTouch=Fe.changedPointers[0].identifier,kr.call(this,Fe)):Bt&(ft|De)&&kr.call(this,Fe)}function kr(Bt){var Fe=Bt.changedPointers[0];if(Fe.identifier===this.primaryTouch){var Ot={x:Fe.clientX,y:Fe.clientY};this.lastTouches.push(Ot);var fr=this.lastTouches,rn=function(){var Un=fr.indexOf(Ot);Un>-1&&fr.splice(Un,1)};setTimeout(rn,qt)}}function Cn(Bt){for(var Fe=Bt.srcEvent.clientX,Ot=Bt.srcEvent.clientY,fr=0;fr<this.lastTouches.length;fr++){var rn=this.lastTouches[fr],bn=Math.abs(Fe-rn.x),Un=Math.abs(Ot-rn.y);if(bn<=zr&&Un<=zr)return!0}return!1}var dn=bt(B.style,"touchAction"),Er=dn!==a,Tn="compute",vn="auto",mn="manipulation",Ar="none",$r="pan-x",Mn="pan-y",Ki=zi();function vi(Bt,Fe){this.manager=Bt,this.set(Fe)}vi.prototype={set:function(Fe){Fe==Tn&&(Fe=this.compute()),Er&&this.manager.element.style&&Ki[Fe]&&(this.manager.element.style[dn]=Fe),this.actions=Fe.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Fe=[];return _e(this.manager.recognizers,function(Ot){St(Ot.options.enable,[Ot])&&(Fe=Fe.concat(Ot.getTouchAction()))}),Mi(Fe.join(" "))},preventDefaults:function(Fe){var Ot=Fe.srcEvent,fr=Fe.offsetDirection;if(this.manager.session.prevented){Ot.preventDefault();return}var rn=this.actions,bn=Xe(rn,Ar)&&!Ki[Ar],Un=Xe(rn,Mn)&&!Ki[Mn],Da=Xe(rn,$r)&&!Ki[$r];if(bn){var ao=Fe.pointers.length===1,bo=Fe.distance<2,Fo=Fe.deltaTime<250;if(ao&&bo&&Fo)return}if(!(Da&&Un)&&(bn||Un&&fr&Ve||Da&&fr&Ye))return this.preventSrc(Ot)},preventSrc:function(Fe){this.manager.session.prevented=!0,Fe.preventDefault()}};function Mi(Bt){if(Xe(Bt,Ar))return Ar;var Fe=Xe(Bt,$r),Ot=Xe(Bt,Mn);return Fe&&Ot?Ar:Fe||Ot?Fe?$r:Mn:Xe(Bt,mn)?mn:vn}function zi(){if(!Er)return!1;var Bt={},Fe=v.CSS&&v.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ot){Bt[Ot]=Fe?v.CSS.supports("touch-action",Ot):!0}),Bt}var Ka=1,hi=2,ya=4,Ii=8,yi=Ii,ci=16,Ra=32;function xo(Bt){this.options=at({},this.defaults,Bt||{}),this.id=H(),this.manager=null,this.options.enable=or(this.options.enable,!0),this.state=Ka,this.simultaneous={},this.requireFail=[]}xo.prototype={defaults:{},set:function(Fe){return at(this.options,Fe),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Fe){if(Ge(Fe,"recognizeWith",this))return this;var Ot=this.simultaneous;return Fe=Uu(Fe,this),Ot[Fe.id]||(Ot[Fe.id]=Fe,Fe.recognizeWith(this)),this},dropRecognizeWith:function(Fe){return Ge(Fe,"dropRecognizeWith",this)?this:(Fe=Uu(Fe,this),delete this.simultaneous[Fe.id],this)},requireFailure:function(Fe){if(Ge(Fe,"requireFailure",this))return this;var Ot=this.requireFail;return Fe=Uu(Fe,this),ze(Ot,Fe)===-1&&(Ot.push(Fe),Fe.requireFailure(this)),this},dropRequireFailure:function(Fe){if(Ge(Fe,"dropRequireFailure",this))return this;Fe=Uu(Fe,this);var Ot=ze(this.requireFail,Fe);return Ot>-1&&this.requireFail.splice(Ot,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Fe){return!!this.simultaneous[Fe.id]},emit:function(Fe){var Ot=this,fr=this.state;function rn(bn){Ot.manager.emit(bn,Fe)}fr<Ii&&rn(Ot.options.event+$a(fr)),rn(Ot.options.event),Fe.additionalEvent&&rn(Fe.additionalEvent),fr>=Ii&&rn(Ot.options.event+$a(fr))},tryEmit:function(Fe){if(this.canEmit())return this.emit(Fe);this.state=Ra},canEmit:function(){for(var Fe=0;Fe<this.requireFail.length;){if(!(this.requireFail[Fe].state&(Ra|Ka)))return!1;Fe++}return!0},recognize:function(Fe){var Ot=at({},Fe);if(!St(this.options.enable,[this,Ot])){this.reset(),this.state=Ra;return}this.state&(yi|ci|Ra)&&(this.state=Ka),this.state=this.process(Ot),this.state&(hi|ya|Ii|ci)&&this.tryEmit(Ot)},process:function(Fe){},getTouchAction:function(){},reset:function(){}};function $a(Bt){return Bt&ci?"cancel":Bt&Ii?"end":Bt&ya?"move":Bt&hi?"start":""}function Ko(Bt){return Bt==he?"down":Bt==q?"up":Bt==w?"left":Bt==R?"right":""}function Uu(Bt,Fe){var Ot=Fe.manager;return Ot?Ot.get(Bt):Bt}function Gi(){xo.apply(this,arguments)}Mt(Gi,xo,{defaults:{pointers:1},attrTest:function(Fe){var Ot=this.options.pointers;return Ot===0||Fe.pointers.length===Ot},process:function(Fe){var Ot=this.state,fr=Fe.eventType,rn=Ot&(hi|ya),bn=this.attrTest(Fe);return rn&&(fr&De||!bn)?Ot|ci:rn||bn?fr&ft?Ot|Ii:Ot&hi?Ot|ya:hi:Ra}});function Pa(){Gi.apply(this,arguments),this.pX=null,this.pY=null}Mt(Pa,Gi,{defaults:{event:"pan",threshold:10,pointers:1,direction:yt},getTouchAction:function(){var Fe=this.options.direction,Ot=[];return Fe&Ve&&Ot.push(Mn),Fe&Ye&&Ot.push($r),Ot},directionTest:function(Fe){var Ot=this.options,fr=!0,rn=Fe.distance,bn=Fe.direction,Un=Fe.deltaX,Da=Fe.deltaY;return bn&Ot.direction||(Ot.direction&Ve?(bn=Un===0?Ze:Un<0?w:R,fr=Un!=this.pX,rn=Math.abs(Fe.deltaX)):(bn=Da===0?Ze:Da<0?q:he,fr=Da!=this.pY,rn=Math.abs(Fe.deltaY))),Fe.direction=bn,fr&&rn>Ot.threshold&&bn&Ot.direction},attrTest:function(Fe){return Gi.prototype.attrTest.call(this,Fe)&&(this.state&hi||!(this.state&hi)&&this.directionTest(Fe))},emit:function(Fe){this.pX=Fe.deltaX,this.pY=Fe.deltaY;var Ot=Ko(Fe.direction);Ot&&(Fe.additionalEvent=this.options.event+Ot),this._super.emit.call(this,Fe)}});function ns(){Gi.apply(this,arguments)}Mt(ns,Gi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ar]},attrTest:function(Fe){return this._super.attrTest.call(this,Fe)&&(Math.abs(Fe.scale-1)>this.options.threshold||this.state&hi)},emit:function(Fe){if(Fe.scale!==1){var Ot=Fe.scale<1?"in":"out";Fe.additionalEvent=this.options.event+Ot}this._super.emit.call(this,Fe)}});function na(){xo.apply(this,arguments),this._timer=null,this._input=null}Mt(na,xo,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[vn]},process:function(Fe){var Ot=this.options,fr=Fe.pointers.length===Ot.pointers,rn=Fe.distance<Ot.threshold,bn=Fe.deltaTime>Ot.time;if(this._input=Fe,!rn||!fr||Fe.eventType&(ft|De)&&!bn)this.reset();else if(Fe.eventType&ye)this.reset(),this._timer=Ke(function(){this.state=yi,this.tryEmit()},Ot.time,this);else if(Fe.eventType&ft)return yi;return Ra},reset:function(){clearTimeout(this._timer)},emit:function(Fe){this.state===yi&&(Fe&&Fe.eventType&ft?this.manager.emit(this.options.event+"up",Fe):(this._input.timeStamp=J(),this.manager.emit(this.options.event,this._input)))}});function Ja(){Gi.apply(this,arguments)}Mt(Ja,Gi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ar]},attrTest:function(Fe){return this._super.attrTest.call(this,Fe)&&(Math.abs(Fe.rotation)>this.options.threshold||this.state&hi)}});function is(){Gi.apply(this,arguments)}Mt(is,Gi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ve|Ye,pointers:1},getTouchAction:function(){return Pa.prototype.getTouchAction.call(this)},attrTest:function(Fe){var Ot=this.options.direction,fr;return Ot&(Ve|Ye)?fr=Fe.overallVelocity:Ot&Ve?fr=Fe.overallVelocityX:Ot&Ye&&(fr=Fe.overallVelocityY),this._super.attrTest.call(this,Fe)&&Ot&Fe.offsetDirection&&Fe.distance>this.options.threshold&&Fe.maxPointers==this.options.pointers&&we(fr)>this.options.velocity&&Fe.eventType&ft},emit:function(Fe){var Ot=Ko(Fe.offsetDirection);Ot&&this.manager.emit(this.options.event+Ot,Fe),this.manager.emit(this.options.event,Fe)}});function Ji(){xo.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Mt(Ji,xo,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[mn]},process:function(Fe){var Ot=this.options,fr=Fe.pointers.length===Ot.pointers,rn=Fe.distance<Ot.threshold,bn=Fe.deltaTime<Ot.time;if(this.reset(),Fe.eventType&ye&&this.count===0)return this.failTimeout();if(rn&&bn&&fr){if(Fe.eventType!=ft)return this.failTimeout();var Un=this.pTime?Fe.timeStamp-this.pTime<Ot.interval:!0,Da=!this.pCenter||Pe(this.pCenter,Fe.center)<Ot.posThreshold;this.pTime=Fe.timeStamp,this.pCenter=Fe.center,!Da||!Un?this.count=1:this.count+=1,this._input=Fe;var ao=this.count%Ot.taps;if(ao===0)return this.hasRequireFailures()?(this._timer=Ke(function(){this.state=yi,this.tryEmit()},Ot.interval,this),hi):yi}return Ra},failTimeout:function(){return this._timer=Ke(function(){this.state=Ra},this.options.interval,this),Ra},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==yi&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function lo(Bt,Fe){return Fe=Fe||{},Fe.recognizers=or(Fe.recognizers,lo.defaults.preset),new wo(Bt,Fe)}lo.VERSION="2.0.7",lo.defaults={domEvents:!1,touchAction:Tn,enable:!0,inputTarget:null,inputClass:null,preset:[[Ja,{enable:!1}],[ns,{enable:!1},["rotate"]],[is,{direction:Ve}],[Pa,{direction:Ve},["swipe"]],[Ji],[Ji,{event:"doubletap",taps:2},["tap"]],[na]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var co=1,Ks=2;function wo(Bt,Fe){this.options=at({},lo.defaults,Fe||{}),this.options.inputTarget=this.options.inputTarget||Bt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Bt,this.input=$e(this),this.touchAction=new vi(this,this.options.touchAction),Zl(this,!0),_e(this.options.recognizers,function(Ot){var fr=this.add(new Ot[0](Ot[1]));Ot[2]&&fr.recognizeWith(Ot[2]),Ot[3]&&fr.requireFailure(Ot[3])},this)}wo.prototype={set:function(Fe){return at(this.options,Fe),Fe.touchAction&&this.touchAction.update(),Fe.inputTarget&&(this.input.destroy(),this.input.target=Fe.inputTarget,this.input.init()),this},stop:function(Fe){this.session.stopped=Fe?Ks:co},recognize:function(Fe){var Ot=this.session;if(!Ot.stopped){this.touchAction.preventDefaults(Fe);var fr,rn=this.recognizers,bn=Ot.curRecognizer;(!bn||bn&&bn.state&yi)&&(bn=Ot.curRecognizer=null);for(var Un=0;Un<rn.length;)fr=rn[Un],Ot.stopped!==Ks&&(!bn||fr==bn||fr.canRecognizeWith(bn))?fr.recognize(Fe):fr.reset(),!bn&&fr.state&(hi|ya|Ii)&&(bn=Ot.curRecognizer=fr),Un++}},get:function(Fe){if(Fe instanceof xo)return Fe;for(var Ot=this.recognizers,fr=0;fr<Ot.length;fr++)if(Ot[fr].options.event==Fe)return Ot[fr];return null},add:function(Fe){if(Ge(Fe,"add",this))return this;var Ot=this.get(Fe.options.event);return Ot&&this.remove(Ot),this.recognizers.push(Fe),Fe.manager=this,this.touchAction.update(),Fe},remove:function(Fe){if(Ge(Fe,"remove",this))return this;if(Fe=this.get(Fe),Fe){var Ot=this.recognizers,fr=ze(Ot,Fe);fr!==-1&&(Ot.splice(fr,1),this.touchAction.update())}return this},on:function(Fe,Ot){if(Fe!==a&&Ot!==a){var fr=this.handlers;return _e(Tt(Fe),function(rn){fr[rn]=fr[rn]||[],fr[rn].push(Ot)}),this}},off:function(Fe,Ot){if(Fe!==a){var fr=this.handlers;return _e(Tt(Fe),function(rn){Ot?fr[rn]&&fr[rn].splice(ze(fr[rn],Ot),1):delete fr[rn]}),this}},emit:function(Fe,Ot){this.options.domEvents&&$s(Fe,Ot);var fr=this.handlers[Fe]&&this.handlers[Fe].slice();if(!(!fr||!fr.length)){Ot.type=Fe,Ot.preventDefault=function(){Ot.srcEvent.preventDefault()};for(var rn=0;rn<fr.length;)fr[rn](Ot),rn++}},destroy:function(){this.element&&Zl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Zl(Bt,Fe){var Ot=Bt.element;if(!!Ot.style){var fr;_e(Bt.options.cssProps,function(rn,bn){fr=bt(Ot.style,bn),Fe?(Bt.oldCssProps[fr]=Ot.style[fr],Ot.style[fr]=rn):Ot.style[fr]=Bt.oldCssProps[fr]||""}),Fe||(Bt.oldCssProps={})}}function $s(Bt,Fe){var Ot=Z.createEvent("Event");Ot.initEvent(Bt,!0,!0),Ot.gesture=Fe,Fe.target.dispatchEvent(Ot)}at(lo,{INPUT_START:ye,INPUT_MOVE:He,INPUT_END:ft,INPUT_CANCEL:De,STATE_POSSIBLE:Ka,STATE_BEGAN:hi,STATE_CHANGED:ya,STATE_ENDED:Ii,STATE_RECOGNIZED:yi,STATE_CANCELLED:ci,STATE_FAILED:Ra,DIRECTION_NONE:Ze,DIRECTION_LEFT:w,DIRECTION_RIGHT:R,DIRECTION_UP:q,DIRECTION_DOWN:he,DIRECTION_HORIZONTAL:Ve,DIRECTION_VERTICAL:Ye,DIRECTION_ALL:yt,Manager:wo,Input:$,TouchAction:vi,TouchInput:Ne,MouseInput:jn,PointerEventInput:Vn,TouchMouseInput:Br,SingleTouchInput:se,Recognizer:xo,AttrRecognizer:Gi,Tap:Ji,Pan:Pa,Swipe:is,Pinch:ns,Rotate:Ja,Press:na,on:$t,off:Ht,each:_e,merge:xt,extend:Oe,assign:at,inherit:Mt,bindFn:Et,prefixed:bt});var Po=typeof v!="undefined"?v:typeof self!="undefined"?self:{};Po.Hammer=lo,b=function(){return lo}.call(x,o,x,Ie),b!==a&&(Ie.exports=b)})(window,document,"Hammer")},yMAV:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Plan=void 0;var b=function(){function v(Z,F){this.parentContext=Z,this.rootRequest=F}return v}();x.Plan=b},yP5f:function(Ie,x,o){var b=o("+K+b");function v(Z,F){var a=F?b(Z.buffer):Z.buffer;return new Z.constructor(a,Z.byteOffset,Z.length)}Ie.exports=v},yU0y:function(Ie,x,o){"use strict";o.d(x,"b",function(){return b}),o.d(x,"a",function(){return v}),o.d(x,"c",function(){return Z});var b=1e-6,v=typeof Float32Array!="undefined"?Float32Array:Array,Z=Math.random;function F(Q){v=Q}var a=Math.PI/180;function Y(Q){return Q*a}function B(Q,re){return Math.abs(Q-re)<=b*Math.max(1,Math.abs(Q),Math.abs(re))}Math.hypot||(Math.hypot=function(){for(var Q=0,re=arguments.length;re--;)Q+=arguments[re]*arguments[re];return Math.sqrt(Q)})},yXPU:function(Ie,x){function o(v,Z,F,a,Y,B,Q){try{var re=v[B](Q),we=re.value}catch(J){F(J);return}re.done?Z(we):Promise.resolve(we).then(a,Y)}function b(v){return function(){var Z=this,F=arguments;return new Promise(function(a,Y){var B=v.apply(Z,F);function Q(we){o(B,a,Y,Q,re,"next",we)}function re(we){o(B,a,Y,Q,re,"throw",we)}Q(void 0)})}}Ie.exports=b},ycre:function(Ie,x,o){var b=o("711d"),v=b("length");Ie.exports=v},z4Hk:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingWhenSyntax=void 0;var b=o("406g"),v=o("RR/i"),Z=function(){function F(a){this._binding=a}return F.prototype.when=function(a){return this._binding.constraint=a,new b.BindingOnSyntax(this._binding)},F.prototype.whenTargetNamed=function(a){return this._binding.constraint=v.namedConstraint(a),new b.BindingOnSyntax(this._binding)},F.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(a){var Y=a.target!==null&&!a.target.isNamed()&&!a.target.isTagged();return Y},new b.BindingOnSyntax(this._binding)},F.prototype.whenTargetTagged=function(a,Y){return this._binding.constraint=v.taggedConstraint(a)(Y),new b.BindingOnSyntax(this._binding)},F.prototype.whenInjectedInto=function(a){return this._binding.constraint=function(Y){return v.typeConstraint(a)(Y.parentRequest)},new b.BindingOnSyntax(this._binding)},F.prototype.whenParentNamed=function(a){return this._binding.constraint=function(Y){return v.namedConstraint(a)(Y.parentRequest)},new b.BindingOnSyntax(this._binding)},F.prototype.whenParentTagged=function(a,Y){return this._binding.constraint=function(B){return v.taggedConstraint(a)(Y)(B.parentRequest)},new b.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorIs=function(a){return this._binding.constraint=function(Y){return v.traverseAncerstors(Y,v.typeConstraint(a))},new b.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorIs=function(a){return this._binding.constraint=function(Y){return!v.traverseAncerstors(Y,v.typeConstraint(a))},new b.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorNamed=function(a){return this._binding.constraint=function(Y){return v.traverseAncerstors(Y,v.namedConstraint(a))},new b.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorNamed=function(a){return this._binding.constraint=function(Y){return!v.traverseAncerstors(Y,v.namedConstraint(a))},new b.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorTagged=function(a,Y){return this._binding.constraint=function(B){return v.traverseAncerstors(B,v.taggedConstraint(a)(Y))},new b.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorTagged=function(a,Y){return this._binding.constraint=function(B){return!v.traverseAncerstors(B,v.taggedConstraint(a)(Y))},new b.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorMatches=function(a){return this._binding.constraint=function(Y){return v.traverseAncerstors(Y,a)},new b.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorMatches=function(a){return this._binding.constraint=function(Y){return!v.traverseAncerstors(Y,a)},new b.BindingOnSyntax(this._binding)},F}();x.BindingWhenSyntax=Z},zEVN:function(Ie,x,o){var b=o("Gi0A"),v=o("sEf8"),Z=o("mdPL"),F=Z&&Z.isMap,a=F?v(F):b;Ie.exports=a},zZ0H:function(Ie,x){function o(b){return b}Ie.exports=o},zZPE:function(Ie,x){var o="[object Object]";function b(Ke){var Ge=!1;if(Ke!=null&&typeof Ke.toString!="function")try{Ge=!!(Ke+"")}catch(_e){}return Ge}function v(Ke,Ge){return function(_e){return Ke(Ge(_e))}}var Z=Function.prototype,F=Object.prototype,a=Z.toString,Y=F.hasOwnProperty,B=a.call(Object),Q=F.toString,re=v(Object.getPrototypeOf,Object);function we(Ke){return!!Ke&&typeof Ke=="object"}function J(Ke){if(!we(Ke)||Q.call(Ke)!=o||b(Ke))return!1;var Ge=re(Ke);if(Ge===null)return!0;var _e=Y.call(Ge,"constructor")&&Ge.constructor;return typeof _e=="function"&&_e instanceof _e&&a.call(_e)==B}Ie.exports=J},zoYe:function(Ie,x,o){var b=o("nmnc"),v=o("eUgh"),Z=o("Z0cm"),F=o("/9aa"),a=1/0,Y=b?b.prototype:void 0,B=Y?Y.toString:void 0;function Q(re){if(typeof re=="string")return re;if(Z(re))return v(re,Q)+"";if(F(re))return B?B.call(re):"";var we=re+"";return we=="0"&&1/re==-a?"-0":we}Ie.exports=Q},zvhG:function(Ie,x){Ie.exports=o;function o(b,v,Z,F){this.cx=3*b,this.bx=3*(Z-b)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*v,this.by=3*(F-v)-this.cy,this.ay=1-this.cy-this.by,this.p1x=b,this.p1y=F,this.p2x=Z,this.p2y=F}o.prototype.sampleCurveX=function(b){return((this.ax*b+this.bx)*b+this.cx)*b},o.prototype.sampleCurveY=function(b){return((this.ay*b+this.by)*b+this.cy)*b},o.prototype.sampleCurveDerivativeX=function(b){return(3*this.ax*b+2*this.bx)*b+this.cx},o.prototype.solveCurveX=function(b,v){typeof v=="undefined"&&(v=1e-6);var Z,F,a,Y,B;for(a=b,B=0;B<8;B++){if(Y=this.sampleCurveX(a)-b,Math.abs(Y)<v)return a;var Q=this.sampleCurveDerivativeX(a);if(Math.abs(Q)<1e-6)break;a=a-Y/Q}if(Z=0,F=1,a=b,a<Z)return Z;if(a>F)return F;for(;Z<F;){if(Y=this.sampleCurveX(a),Math.abs(Y-b)<v)return a;b>Y?Z=a:F=a,a=(F-Z)*.5+Z}return a},o.prototype.solve=function(b,v){return this.sampleCurveY(this.solveCurveX(b,v))}},zxMA:function(Ie,x,o){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.QueryableString=void 0;var b=function(){function v(Z){this.str=Z}return v.prototype.startsWith=function(Z){return this.str.indexOf(Z)===0},v.prototype.endsWith=function(Z){var F="",a=Z.split("").reverse().join("");return F=this.str.split("").reverse().join(""),this.startsWith.call({str:F},a)},v.prototype.contains=function(Z){return this.str.indexOf(Z)!==-1},v.prototype.equals=function(Z){return this.str===Z},v.prototype.value=function(){return this.str},v}();x.QueryableString=b}}]);
